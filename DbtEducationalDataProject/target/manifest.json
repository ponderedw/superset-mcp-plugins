{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v12.json", "dbt_version": "1.8.0", "generated_at": "2025-11-29T18:25:10.636752Z", "invocation_id": "3aeb19ae-00af-489d-b00b-9fba27181a46", "env": {}, "project_name": "DbtEducationalDataProject", "project_id": "2071e5fae01cb7486b489bd4daa12b9b", "user_id": "38a6af5e-4794-4adf-9ede-c31b13e42a9a", "send_anonymous_usage_stats": true, "adapter_type": "postgres"}, "nodes": {"model.DbtEducationalDataProject.stg_courses": {"database": "postgres", "schema": "edu_dbt", "name": "stg_courses", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_courses.sql", "original_file_path": "models/staging/stg_courses.sql", "unique_id": "model.DbtEducationalDataProject.stg_courses", "fqn": ["DbtEducationalDataProject", "staging", "stg_courses"], "alias": "stg_courses", "checksum": {"name": "sha256", "checksum": "b901134cdfbd0b1323640da16afefbbbe885ca61d276ace802e39977a6cd1587"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.1819415, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_courses\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        course_id,\n        course_code,\n        course_name,\n        description,\n        credits,\n        department_id,\n        prerequisite_course_id,\n        difficulty_level,\n        case \n            when difficulty_level = 1 then 'Beginner'\n            when difficulty_level = 2 then 'Intermediate'\n            when difficulty_level = 3 then 'Advanced'\n            when difficulty_level = 4 then 'Expert'\n            when difficulty_level = 5 then 'Graduate'\n            else 'Unknown'\n        end as difficulty_description,\n        case\n            when credits <= 1 then 'Workshop'\n            when credits = 2 then 'Seminar'\n            when credits = 3 then 'Standard'\n            when credits >= 4 then 'Intensive'\n            else 'Other'\n        end as credit_category,\n        created_at\n    from {{ source('raw_edu', 'courses') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "courses"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.courses"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_courses.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        course_id,\n        course_code,\n        course_name,\n        description,\n        credits,\n        department_id,\n        prerequisite_course_id,\n        difficulty_level,\n        case \n            when difficulty_level = 1 then 'Beginner'\n            when difficulty_level = 2 then 'Intermediate'\n            when difficulty_level = 3 then 'Advanced'\n            when difficulty_level = 4 then 'Expert'\n            when difficulty_level = 5 then 'Graduate'\n            else 'Unknown'\n        end as difficulty_description,\n        case\n            when credits <= 1 then 'Workshop'\n            when credits = 2 then 'Seminar'\n            when credits = 3 then 'Standard'\n            when credits >= 4 then 'Intensive'\n            else 'Other'\n        end as credit_category,\n        created_at\n    from \"postgres\".\"raw_edu\".\"courses\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_departments": {"database": "postgres", "schema": "edu_dbt", "name": "stg_departments", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_departments.sql", "original_file_path": "models/staging/stg_departments.sql", "unique_id": "model.DbtEducationalDataProject.stg_departments", "fqn": ["DbtEducationalDataProject", "staging", "stg_departments"], "alias": "stg_departments", "checksum": {"name": "sha256", "checksum": "bd7886d5ddf47198b3abe1191d5e3dd92a313d8da441af03af0630eedc1a3dc4"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.1920252, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_departments\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        department_id,\n        department_name,\n        department_code,\n        head_faculty_id,\n        budget,\n        building_location,\n        case \n            when budget >= 3000000 then 'Large'\n            when budget >= 2000000 then 'Medium'\n            when budget >= 1000000 then 'Small'\n            else 'Micro'\n        end as department_size,\n        round(budget / 1000000.0, 2) as budget_millions,\n        created_at\n    from {{ source('raw_edu', 'departments') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "departments"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.departments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_departments.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        department_id,\n        department_name,\n        department_code,\n        head_faculty_id,\n        budget,\n        building_location,\n        case \n            when budget >= 3000000 then 'Large'\n            when budget >= 2000000 then 'Medium'\n            when budget >= 1000000 then 'Small'\n            else 'Micro'\n        end as department_size,\n        round(budget / 1000000.0, 2) as budget_millions,\n        created_at\n    from \"postgres\".\"raw_edu\".\"departments\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_financial_aid": {"database": "postgres", "schema": "edu_dbt", "name": "stg_financial_aid", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_financial_aid.sql", "original_file_path": "models/staging/stg_financial_aid.sql", "unique_id": "model.DbtEducationalDataProject.stg_financial_aid", "fqn": ["DbtEducationalDataProject", "staging", "stg_financial_aid"], "alias": "stg_financial_aid", "checksum": {"name": "sha256", "checksum": "36341c0bb43e9eba8bd93c0c5a7c15308a11f67419167e6bc451bf44bfe86302"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.1933303, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_financial_aid\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        aid_id,\n        student_id,\n        aid_type,\n        amount,\n        academic_year,\n        disbursement_date,\n        case\n            when aid_type ilike '%scholarship%' then 'Merit-Based'\n            when aid_type ilike '%grant%' then 'Need-Based'\n            when aid_type ilike '%loan%' then 'Loan'\n            when aid_type ilike '%work%' then 'Work-Study'\n            else 'Other'\n        end as aid_category,\n        case\n            when amount >= 10000 then 'High Support'\n            when amount >= 5000 then 'Medium Support'\n            when amount >= 1000 then 'Low Support'\n            else 'Minimal Support'\n        end as support_level,\n        extract(year from disbursement_date) as disbursement_year,\n        extract(month from disbursement_date) as disbursement_month,\n        case\n            when extract(month from disbursement_date) between 8 and 12 then 'Fall Disbursement'\n            when extract(month from disbursement_date) between 1 and 5 then 'Spring Disbursement'\n            else 'Summer Disbursement'\n        end as disbursement_period,\n        created_at\n    from {{ source('raw_edu', 'financial_aid') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "financial_aid"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.financial_aid"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_financial_aid.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        aid_id,\n        student_id,\n        aid_type,\n        amount,\n        academic_year,\n        disbursement_date,\n        case\n            when aid_type ilike '%scholarship%' then 'Merit-Based'\n            when aid_type ilike '%grant%' then 'Need-Based'\n            when aid_type ilike '%loan%' then 'Loan'\n            when aid_type ilike '%work%' then 'Work-Study'\n            else 'Other'\n        end as aid_category,\n        case\n            when amount >= 10000 then 'High Support'\n            when amount >= 5000 then 'Medium Support'\n            when amount >= 1000 then 'Low Support'\n            else 'Minimal Support'\n        end as support_level,\n        extract(year from disbursement_date) as disbursement_year,\n        extract(month from disbursement_date) as disbursement_month,\n        case\n            when extract(month from disbursement_date) between 8 and 12 then 'Fall Disbursement'\n            when extract(month from disbursement_date) between 1 and 5 then 'Spring Disbursement'\n            else 'Summer Disbursement'\n        end as disbursement_period,\n        created_at\n    from \"postgres\".\"raw_edu\".\"financial_aid\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_tuition_payments": {"database": "postgres", "schema": "edu_dbt", "name": "stg_tuition_payments", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_tuition_payments.sql", "original_file_path": "models/staging/stg_tuition_payments.sql", "unique_id": "model.DbtEducationalDataProject.stg_tuition_payments", "fqn": ["DbtEducationalDataProject", "staging", "stg_tuition_payments"], "alias": "stg_tuition_payments", "checksum": {"name": "sha256", "checksum": "d01d4acccb8a02288cf4c8bdf0688ee2de36e43cfa4edb9d0f2e3ffac760dee7"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.1945333, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_tuition_payments\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        payment_id,\n        student_id,\n        semester_id,\n        amount,\n        payment_date,\n        payment_method,\n        late_fee,\n        amount + coalesce(late_fee, 0) as total_payment,\n        case\n            when late_fee > 0 then 'Late Payment'\n            else 'On Time Payment'\n        end as payment_timeliness,\n        case\n            when payment_method ilike '%credit%' or payment_method ilike '%card%' then 'Credit Card'\n            when payment_method ilike '%check%' then 'Check'\n            when payment_method ilike '%transfer%' or payment_method ilike '%ach%' then 'Bank Transfer'\n            when payment_method ilike '%cash%' then 'Cash'\n            else 'Other'\n        end as payment_method_category,\n        extract(year from payment_date) as payment_year,\n        extract(month from payment_date) as payment_month,\n        case\n            when amount >= 10000 then 'High Amount'\n            when amount >= 5000 then 'Medium Amount'\n            when amount >= 1000 then 'Low Amount'\n            else 'Minimal Amount'\n        end as payment_size_category,\n        created_at\n    from {{ source('raw_edu', 'tuition_payments') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "tuition_payments"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.tuition_payments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_tuition_payments.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        payment_id,\n        student_id,\n        semester_id,\n        amount,\n        payment_date,\n        payment_method,\n        late_fee,\n        amount + coalesce(late_fee, 0) as total_payment,\n        case\n            when late_fee > 0 then 'Late Payment'\n            else 'On Time Payment'\n        end as payment_timeliness,\n        case\n            when payment_method ilike '%credit%' or payment_method ilike '%card%' then 'Credit Card'\n            when payment_method ilike '%check%' then 'Check'\n            when payment_method ilike '%transfer%' or payment_method ilike '%ach%' then 'Bank Transfer'\n            when payment_method ilike '%cash%' then 'Cash'\n            else 'Other'\n        end as payment_method_category,\n        extract(year from payment_date) as payment_year,\n        extract(month from payment_date) as payment_month,\n        case\n            when amount >= 10000 then 'High Amount'\n            when amount >= 5000 then 'Medium Amount'\n            when amount >= 1000 then 'Low Amount'\n            else 'Minimal Amount'\n        end as payment_size_category,\n        created_at\n    from \"postgres\".\"raw_edu\".\"tuition_payments\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_class_sessions": {"database": "postgres", "schema": "edu_dbt", "name": "stg_class_sessions", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_class_sessions.sql", "original_file_path": "models/staging/stg_class_sessions.sql", "unique_id": "model.DbtEducationalDataProject.stg_class_sessions", "fqn": ["DbtEducationalDataProject", "staging", "stg_class_sessions"], "alias": "stg_class_sessions", "checksum": {"name": "sha256", "checksum": "6b28c2e059d258e91668650cb4c569ffee9dfca513f8943ad8748cd95fedd5a8"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.1956112, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_class_sessions\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        session_id,\n        course_id,\n        faculty_id,\n        semester_id,\n        session_time,\n        session_date,\n        room_id,\n        attendance_count,\n        extract(dow from session_date) as day_of_week,\n        extract(hour from session_time) as session_hour,\n        case\n            when extract(hour from session_time) between 8 and 11 then 'Morning'\n            when extract(hour from session_time) between 12 and 16 then 'Afternoon'\n            when extract(hour from session_time) between 17 and 21 then 'Evening'\n            else 'Night'\n        end as time_block,\n        case\n            when extract(dow from session_date) = 0 then 'Sunday'\n            when extract(dow from session_date) = 1 then 'Monday'\n            when extract(dow from session_date) = 2 then 'Tuesday'\n            when extract(dow from session_date) = 3 then 'Wednesday'\n            when extract(dow from session_date) = 4 then 'Thursday'\n            when extract(dow from session_date) = 5 then 'Friday'\n            when extract(dow from session_date) = 6 then 'Saturday'\n        end as day_name,\n        created_at\n    from {{ source('raw_edu', 'class_sessions') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "class_sessions"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.class_sessions"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_class_sessions.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        session_id,\n        course_id,\n        faculty_id,\n        semester_id,\n        session_time,\n        session_date,\n        room_id,\n        attendance_count,\n        extract(dow from session_date) as day_of_week,\n        extract(hour from session_time) as session_hour,\n        case\n            when extract(hour from session_time) between 8 and 11 then 'Morning'\n            when extract(hour from session_time) between 12 and 16 then 'Afternoon'\n            when extract(hour from session_time) between 17 and 21 then 'Evening'\n            else 'Night'\n        end as time_block,\n        case\n            when extract(dow from session_date) = 0 then 'Sunday'\n            when extract(dow from session_date) = 1 then 'Monday'\n            when extract(dow from session_date) = 2 then 'Tuesday'\n            when extract(dow from session_date) = 3 then 'Wednesday'\n            when extract(dow from session_date) = 4 then 'Thursday'\n            when extract(dow from session_date) = 5 then 'Friday'\n            when extract(dow from session_date) = 6 then 'Saturday'\n        end as day_name,\n        created_at\n    from \"postgres\".\"raw_edu\".\"class_sessions\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_assignments": {"database": "postgres", "schema": "edu_dbt", "name": "stg_assignments", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_assignments.sql", "original_file_path": "models/staging/stg_assignments.sql", "unique_id": "model.DbtEducationalDataProject.stg_assignments", "fqn": ["DbtEducationalDataProject", "staging", "stg_assignments"], "alias": "stg_assignments", "checksum": {"name": "sha256", "checksum": "7906b06fd3467bf3b984482ce340e33f640ab3479a385d2031ff743b73518bfd"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.196744, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_assignments\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        assignment_id,\n        course_id,\n        semester_id,\n        assignment_name,\n        assignment_type,\n        due_date,\n        max_points,\n        weight_percentage,\n        case\n            when assignment_type ilike '%exam%' or assignment_type ilike '%test%' then 'Assessment'\n            when assignment_type ilike '%project%' then 'Project'\n            when assignment_type ilike '%homework%' or assignment_type ilike '%hw%' then 'Homework'\n            when assignment_type ilike '%quiz%' then 'Quiz'\n            when assignment_type ilike '%discussion%' then 'Discussion'\n            when assignment_type ilike '%presentation%' then 'Presentation'\n            else 'Other'\n        end as assignment_category,\n        case\n            when current_date > due_date then 'Past Due'\n            when current_date = due_date then 'Due Today'\n            when due_date - current_date <= 7 then 'Due This Week'\n            when due_date - current_date <= 30 then 'Due This Month'\n            else 'Future'\n        end as due_status,\n        due_date - current_date as days_until_due,\n        case\n            when weight_percentage >= 30 then 'High Weight'\n            when weight_percentage >= 15 then 'Medium Weight'\n            when weight_percentage >= 5 then 'Low Weight'\n            else 'Minimal Weight'\n        end as weight_category,\n        created_at\n    from {{ source('raw_edu', 'assignments') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "assignments"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.assignments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_assignments.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        assignment_id,\n        course_id,\n        semester_id,\n        assignment_name,\n        assignment_type,\n        due_date,\n        max_points,\n        weight_percentage,\n        case\n            when assignment_type ilike '%exam%' or assignment_type ilike '%test%' then 'Assessment'\n            when assignment_type ilike '%project%' then 'Project'\n            when assignment_type ilike '%homework%' or assignment_type ilike '%hw%' then 'Homework'\n            when assignment_type ilike '%quiz%' then 'Quiz'\n            when assignment_type ilike '%discussion%' then 'Discussion'\n            when assignment_type ilike '%presentation%' then 'Presentation'\n            else 'Other'\n        end as assignment_category,\n        case\n            when current_date > due_date then 'Past Due'\n            when current_date = due_date then 'Due Today'\n            when due_date - current_date <= 7 then 'Due This Week'\n            when due_date - current_date <= 30 then 'Due This Month'\n            else 'Future'\n        end as due_status,\n        due_date - current_date as days_until_due,\n        case\n            when weight_percentage >= 30 then 'High Weight'\n            when weight_percentage >= 15 then 'Medium Weight'\n            when weight_percentage >= 5 then 'Low Weight'\n            else 'Minimal Weight'\n        end as weight_category,\n        created_at\n    from \"postgres\".\"raw_edu\".\"assignments\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_enrollments": {"database": "postgres", "schema": "edu_dbt", "name": "stg_enrollments", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_enrollments.sql", "original_file_path": "models/staging/stg_enrollments.sql", "unique_id": "model.DbtEducationalDataProject.stg_enrollments", "fqn": ["DbtEducationalDataProject", "staging", "stg_enrollments"], "alias": "stg_enrollments", "checksum": {"name": "sha256", "checksum": "79c496ac398ec92a8e8e25e491e74109673380724a2ad8e71e7b1c02ca2a701f"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.1986349, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_enrollments\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        enrollment_id,\n        student_id,\n        course_id,\n        semester_id,\n        enrollment_date,\n        completion_date,\n        grade,\n        grade_points,\n        attendance_percentage,\n        case \n            when grade in ('A+', 'A', 'A-') then 'Excellent'\n            when grade in ('B+', 'B', 'B-') then 'Good'\n            when grade in ('C+', 'C', 'C-') then 'Satisfactory'\n            when grade in ('D+', 'D', 'D-') then 'Poor'\n            when grade in ('F', 'WF') then 'Failing'\n            when grade = 'W' then 'Withdrawn'\n            when grade = 'I' then 'Incomplete'\n            else 'Unknown'\n        end as grade_category,\n        case\n            when completion_date is not null then 'Completed'\n            when grade = 'W' then 'Withdrawn'\n            when grade = 'I' then 'Incomplete'\n            else 'In Progress'\n        end as enrollment_status,\n        case\n            when attendance_percentage >= 95 then 'Excellent'\n            when attendance_percentage >= 85 then 'Good'\n            when attendance_percentage >= 75 then 'Acceptable'\n            when attendance_percentage >= 65 then 'Poor'\n            else 'Critical'\n        end as attendance_level,\n        created_at\n    from {{ source('raw_edu', 'enrollments') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "enrollments"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.enrollments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_enrollments.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        enrollment_id,\n        student_id,\n        course_id,\n        semester_id,\n        enrollment_date,\n        completion_date,\n        grade,\n        grade_points,\n        attendance_percentage,\n        case \n            when grade in ('A+', 'A', 'A-') then 'Excellent'\n            when grade in ('B+', 'B', 'B-') then 'Good'\n            when grade in ('C+', 'C', 'C-') then 'Satisfactory'\n            when grade in ('D+', 'D', 'D-') then 'Poor'\n            when grade in ('F', 'WF') then 'Failing'\n            when grade = 'W' then 'Withdrawn'\n            when grade = 'I' then 'Incomplete'\n            else 'Unknown'\n        end as grade_category,\n        case\n            when completion_date is not null then 'Completed'\n            when grade = 'W' then 'Withdrawn'\n            when grade = 'I' then 'Incomplete'\n            else 'In Progress'\n        end as enrollment_status,\n        case\n            when attendance_percentage >= 95 then 'Excellent'\n            when attendance_percentage >= 85 then 'Good'\n            when attendance_percentage >= 75 then 'Acceptable'\n            when attendance_percentage >= 65 then 'Poor'\n            else 'Critical'\n        end as attendance_level,\n        created_at\n    from \"postgres\".\"raw_edu\".\"enrollments\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_assignment_submissions": {"database": "postgres", "schema": "edu_dbt", "name": "stg_assignment_submissions", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_assignment_submissions.sql", "original_file_path": "models/staging/stg_assignment_submissions.sql", "unique_id": "model.DbtEducationalDataProject.stg_assignment_submissions", "fqn": ["DbtEducationalDataProject", "staging", "stg_assignment_submissions"], "alias": "stg_assignment_submissions", "checksum": {"name": "sha256", "checksum": "51564584eade5c3cd916abbd2472b4ae2baecebd76e8269400be98ee483c34bb"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.1998143, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_assignment_submissions\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        submission_id,\n        assignment_id,\n        student_id,\n        submission_date,\n        score,\n        late_submission,\n        feedback,\n        case\n            when score is null then 'Not Graded'\n            when score = 0 then 'Zero Score'\n            when score > 0 then 'Graded'\n            else 'Unknown'\n        end as grading_status,\n        case\n            when late_submission then 'Late'\n            else 'On Time'\n        end as submission_timeliness,\n        case\n            when feedback is not null and trim(feedback) != '' then 'Has Feedback'\n            else 'No Feedback'\n        end as feedback_status,\n        created_at\n    from {{ source('raw_edu', 'assignment_submissions') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "assignment_submissions"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.assignment_submissions"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_assignment_submissions.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        submission_id,\n        assignment_id,\n        student_id,\n        submission_date,\n        score,\n        late_submission,\n        feedback,\n        case\n            when score is null then 'Not Graded'\n            when score = 0 then 'Zero Score'\n            when score > 0 then 'Graded'\n            else 'Unknown'\n        end as grading_status,\n        case\n            when late_submission then 'Late'\n            else 'On Time'\n        end as submission_timeliness,\n        case\n            when feedback is not null and trim(feedback) != '' then 'Has Feedback'\n            else 'No Feedback'\n        end as feedback_status,\n        created_at\n    from \"postgres\".\"raw_edu\".\"assignment_submissions\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_faculty": {"database": "postgres", "schema": "edu_dbt", "name": "stg_faculty", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_faculty.sql", "original_file_path": "models/staging/stg_faculty.sql", "unique_id": "model.DbtEducationalDataProject.stg_faculty", "fqn": ["DbtEducationalDataProject", "staging", "stg_faculty"], "alias": "stg_faculty", "checksum": {"name": "sha256", "checksum": "c85b5591e62f07ff087cde1966c70447e1ca034dcfdf402bc3bf46ab38cd8f06"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.201826, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_faculty\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        faculty_id,\n        first_name,\n        last_name,\n        first_name || ' ' || last_name as full_name,\n        email,\n        department_id,\n        position,\n        salary,\n        hire_date,\n        office_number,\n        research_interests,\n        extract(year from age(current_date, hire_date)) as years_of_service,\n        case \n            when position = 'Professor' then 4\n            when position = 'Associate Professor' then 3\n            when position = 'Assistant Professor' then 2\n            when position = 'Lecturer' then 1\n            else 0\n        end as rank_level,\n        case\n            when salary >= 100000 then 'Senior'\n            when salary >= 80000 then 'Mid-level'\n            when salary >= 60000 then 'Junior'\n            else 'Entry'\n        end as salary_band,\n        created_at\n    from {{ source('raw_edu', 'faculty') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "faculty"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.faculty"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_faculty.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        faculty_id,\n        first_name,\n        last_name,\n        first_name || ' ' || last_name as full_name,\n        email,\n        department_id,\n        position,\n        salary,\n        hire_date,\n        office_number,\n        research_interests,\n        extract(year from age(current_date, hire_date)) as years_of_service,\n        case \n            when position = 'Professor' then 4\n            when position = 'Associate Professor' then 3\n            when position = 'Assistant Professor' then 2\n            when position = 'Lecturer' then 1\n            else 0\n        end as rank_level,\n        case\n            when salary >= 100000 then 'Senior'\n            when salary >= 80000 then 'Mid-level'\n            when salary >= 60000 then 'Junior'\n            else 'Entry'\n        end as salary_band,\n        created_at\n    from \"postgres\".\"raw_edu\".\"faculty\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.stg_semesters": {"database": "postgres", "schema": "edu_dbt", "name": "stg_semesters", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_semesters.sql", "original_file_path": "models/staging/stg_semesters.sql", "unique_id": "model.DbtEducationalDataProject.stg_semesters", "fqn": ["DbtEducationalDataProject", "staging", "stg_semesters"], "alias": "stg_semesters", "checksum": {"name": "sha256", "checksum": "5c7c26d836a15596763df7e1fe81b95a8f9f3549221367280c014f84aea77d05"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.2028396, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_semesters\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        semester_id,\n        semester_name,\n        academic_year,\n        start_date,\n        end_date,\n        is_current,\n        extract(year from start_date) as start_year,\n        extract(month from start_date) as start_month,\n        case\n            when extract(month from start_date) between 8 and 12 then 'Fall'\n            when extract(month from start_date) between 1 and 5 then 'Spring'\n            when extract(month from start_date) between 6 and 7 then 'Summer'\n            else 'Special'\n        end as semester_type,\n        end_date - start_date as semester_duration_days,\n        case\n            when current_date between start_date and end_date then 'Active'\n            when current_date < start_date then 'Upcoming'\n            when current_date > end_date then 'Completed'\n            else 'Unknown'\n        end as semester_status,\n        created_at\n    from {{ source('raw_edu', 'semesters') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "semesters"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.semesters"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_semesters.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        semester_id,\n        semester_name,\n        academic_year,\n        start_date,\n        end_date,\n        is_current,\n        extract(year from start_date) as start_year,\n        extract(month from start_date) as start_month,\n        case\n            when extract(month from start_date) between 8 and 12 then 'Fall'\n            when extract(month from start_date) between 1 and 5 then 'Spring'\n            when extract(month from start_date) between 6 and 7 then 'Summer'\n            else 'Special'\n        end as semester_type,\n        end_date - start_date as semester_duration_days,\n        case\n            when current_date between start_date and end_date then 'Active'\n            when current_date < start_date then 'Upcoming'\n            when current_date > end_date then 'Completed'\n            else 'Unknown'\n        end as semester_status,\n        created_at\n    from \"postgres\".\"raw_edu\".\"semesters\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.department_efficiency_report": {"database": "postgres", "schema": "edu_dbt", "name": "department_efficiency_report", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/core/department_efficiency_report.sql", "original_file_path": "models/marts/core/department_efficiency_report.sql", "unique_id": "model.DbtEducationalDataProject.department_efficiency_report", "fqn": ["DbtEducationalDataProject", "marts", "core", "department_efficiency_report"], "alias": "department_efficiency_report", "checksum": {"name": "sha256", "checksum": "a19a1939f4eedf60851bb81a0abb82fdd2269e273f0e6f1672986e29ad007b4e"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2038598, "relation_name": "\"postgres\".\"edu_dbt\".\"department_efficiency_report\"", "raw_code": "{{ config(materialized='table') }}\n\nwith department_efficiency as (\n    select\n        da.department_id,\n        da.department_name,\n        da.department_code,\n        da.budget,\n        da.budget_millions,\n        da.department_size,\n        da.building_location,\n        da.faculty_count,\n        da.course_count,\n        da.student_count,\n        da.total_enrollments,\n        da.avg_faculty_salary,\n        da.total_faculty_salary_cost,\n        da.avg_student_gpa,\n        da.total_credit_hours_offered,\n        da.professor_count,\n        da.associate_professor_count,\n        da.assistant_professor_count,\n        da.avg_course_difficulty,\n        da.budget_per_faculty,\n        da.budget_per_student,\n        da.salary_cost_percentage,\n        da.student_faculty_ratio,\n        da.courses_per_faculty,\n        da.avg_enrollment_per_course,\n        da.department_scale,\n        da.ratio_category,\n        avg(cpm.pass_rate) as dept_avg_pass_rate,\n        avg(cpm.withdrawal_rate) as dept_avg_withdrawal_rate,\n        avg(cpm.avg_attendance) as dept_avg_attendance,\n        count(case when cpm.pass_rate >= 80 then 1 end) as high_performing_courses,\n        count(case when cpm.withdrawal_rate >= 15 then 1 end) as problematic_courses,\n        case\n            when da.salary_cost_percentage <= 60 then 'Efficient Budget Management'\n            when da.salary_cost_percentage <= 75 then 'Moderate Budget Management'\n            when da.salary_cost_percentage <= 90 then 'Tight Budget Management'\n            else 'Over Budget'\n        end as budget_efficiency,\n        case\n            when avg(cpm.pass_rate) >= 85 then 'Excellent Academic Performance'\n            when avg(cpm.pass_rate) >= 75 then 'Good Academic Performance'\n            when avg(cpm.pass_rate) >= 65 then 'Fair Academic Performance'\n            else 'Poor Academic Performance'\n        end as academic_performance_category,\n        round(da.total_enrollments::numeric / nullif(da.budget, 0) * 100000, 2) as enrollments_per_100k_budget,\n        round(da.student_count::numeric / nullif(da.budget, 0) * 100000, 2) as students_per_100k_budget\n    from {{ ref('int_department_analytics') }} da\n    left join {{ ref('int_course_performance_metrics') }} cpm on da.department_id = cpm.course_id  -- This assumes course_id maps to department for simplicity\n    group by \n        da.department_id, da.department_name, da.department_code, da.budget, \n        da.budget_millions, da.department_size, da.building_location, da.faculty_count, \n        da.course_count, da.student_count, da.total_enrollments, da.avg_faculty_salary, \n        da.total_faculty_salary_cost, da.avg_student_gpa, da.total_credit_hours_offered, \n        da.professor_count, da.associate_professor_count, da.assistant_professor_count, \n        da.avg_course_difficulty, da.budget_per_faculty, da.budget_per_student, \n        da.salary_cost_percentage, da.student_faculty_ratio, da.courses_per_faculty, \n        da.avg_enrollment_per_course, da.department_scale, da.ratio_category\n)\n\nselect * from department_efficiency", "language": "sql", "refs": [{"name": "int_department_analytics", "package": null, "version": null}, {"name": "int_course_performance_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.int_department_analytics", "model.DbtEducationalDataProject.int_course_performance_metrics"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/core/department_efficiency_report.sql", "compiled": true, "compiled_code": "\n\nwith department_efficiency as (\n    select\n        da.department_id,\n        da.department_name,\n        da.department_code,\n        da.budget,\n        da.budget_millions,\n        da.department_size,\n        da.building_location,\n        da.faculty_count,\n        da.course_count,\n        da.student_count,\n        da.total_enrollments,\n        da.avg_faculty_salary,\n        da.total_faculty_salary_cost,\n        da.avg_student_gpa,\n        da.total_credit_hours_offered,\n        da.professor_count,\n        da.associate_professor_count,\n        da.assistant_professor_count,\n        da.avg_course_difficulty,\n        da.budget_per_faculty,\n        da.budget_per_student,\n        da.salary_cost_percentage,\n        da.student_faculty_ratio,\n        da.courses_per_faculty,\n        da.avg_enrollment_per_course,\n        da.department_scale,\n        da.ratio_category,\n        avg(cpm.pass_rate) as dept_avg_pass_rate,\n        avg(cpm.withdrawal_rate) as dept_avg_withdrawal_rate,\n        avg(cpm.avg_attendance) as dept_avg_attendance,\n        count(case when cpm.pass_rate >= 80 then 1 end) as high_performing_courses,\n        count(case when cpm.withdrawal_rate >= 15 then 1 end) as problematic_courses,\n        case\n            when da.salary_cost_percentage <= 60 then 'Efficient Budget Management'\n            when da.salary_cost_percentage <= 75 then 'Moderate Budget Management'\n            when da.salary_cost_percentage <= 90 then 'Tight Budget Management'\n            else 'Over Budget'\n        end as budget_efficiency,\n        case\n            when avg(cpm.pass_rate) >= 85 then 'Excellent Academic Performance'\n            when avg(cpm.pass_rate) >= 75 then 'Good Academic Performance'\n            when avg(cpm.pass_rate) >= 65 then 'Fair Academic Performance'\n            else 'Poor Academic Performance'\n        end as academic_performance_category,\n        round(da.total_enrollments::numeric / nullif(da.budget, 0) * 100000, 2) as enrollments_per_100k_budget,\n        round(da.student_count::numeric / nullif(da.budget, 0) * 100000, 2) as students_per_100k_budget\n    from \"postgres\".\"edu_dbt\".\"int_department_analytics\" da\n    left join \"postgres\".\"edu_dbt\".\"int_course_performance_metrics\" cpm on da.department_id = cpm.course_id  -- This assumes course_id maps to department for simplicity\n    group by \n        da.department_id, da.department_name, da.department_code, da.budget, \n        da.budget_millions, da.department_size, da.building_location, da.faculty_count, \n        da.course_count, da.student_count, da.total_enrollments, da.avg_faculty_salary, \n        da.total_faculty_salary_cost, da.avg_student_gpa, da.total_credit_hours_offered, \n        da.professor_count, da.associate_professor_count, da.assistant_professor_count, \n        da.avg_course_difficulty, da.budget_per_faculty, da.budget_per_student, \n        da.salary_cost_percentage, da.student_faculty_ratio, da.courses_per_faculty, \n        da.avg_enrollment_per_course, da.department_scale, da.ratio_category\n)\n\nselect * from department_efficiency", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.course_catalog_enhanced": {"database": "postgres", "schema": "edu_dbt", "name": "course_catalog_enhanced", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/core/course_catalog_enhanced.sql", "original_file_path": "models/marts/core/course_catalog_enhanced.sql", "unique_id": "model.DbtEducationalDataProject.course_catalog_enhanced", "fqn": ["DbtEducationalDataProject", "marts", "core", "course_catalog_enhanced"], "alias": "course_catalog_enhanced", "checksum": {"name": "sha256", "checksum": "3ccca5ab2c46dfc0b986dffc18c9a6d91f0edaa562076a5e961c71fce3e6c435"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2069998, "relation_name": "\"postgres\".\"edu_dbt\".\"course_catalog_enhanced\"", "raw_code": "{{ config(materialized='table') }}\n\nwith course_details as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.description,\n        c.credits,\n        c.difficulty_level,\n        c.difficulty_description,\n        c.credit_category,\n        d.department_name,\n        d.department_code,\n        d.department_size,\n        prereq.course_code as prerequisite_course,\n        prereq.course_name as prerequisite_name,\n        cpm.total_enrollments,\n        cpm.unique_students,\n        cpm.semesters_offered,\n        cpm.avg_grade_points,\n        cpm.avg_attendance,\n        cpm.pass_rate,\n        cpm.withdrawal_rate,\n        cpm.excellent_grades,\n        cpm.good_grades,\n        cpm.satisfactory_grades,\n        cpm.poor_grades,\n        cpm.failing_grades,\n        case\n            when cpm.pass_rate >= 90 then 'High Success Rate'\n            when cpm.pass_rate >= 75 then 'Good Success Rate'\n            when cpm.pass_rate >= 60 then 'Moderate Success Rate'\n            else 'Low Success Rate'\n        end as success_category,\n        case\n            when cpm.withdrawal_rate >= 20 then 'High Dropout Risk'\n            when cpm.withdrawal_rate >= 10 then 'Moderate Dropout Risk'\n            when cpm.withdrawal_rate >= 5 then 'Low Dropout Risk'\n            else 'Minimal Dropout Risk'\n        end as dropout_risk,\n        case\n            when cpm.avg_attendance >= 95 then 'Excellent Engagement'\n            when cpm.avg_attendance >= 85 then 'Good Engagement'\n            when cpm.avg_attendance >= 75 then 'Fair Engagement'\n            else 'Poor Engagement'\n        end as engagement_level\n    from {{ ref('stg_courses') }} c\n    left join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    left join {{ ref('stg_courses') }} prereq on c.prerequisite_course_id = prereq.course_id\n    left join {{ ref('int_course_performance_metrics') }} cpm on c.course_id = cpm.course_id\n)\n\nselect * from course_details", "language": "sql", "refs": [{"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "int_course_performance_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_course_performance_metrics"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/core/course_catalog_enhanced.sql", "compiled": true, "compiled_code": "\n\nwith course_details as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.description,\n        c.credits,\n        c.difficulty_level,\n        c.difficulty_description,\n        c.credit_category,\n        d.department_name,\n        d.department_code,\n        d.department_size,\n        prereq.course_code as prerequisite_course,\n        prereq.course_name as prerequisite_name,\n        cpm.total_enrollments,\n        cpm.unique_students,\n        cpm.semesters_offered,\n        cpm.avg_grade_points,\n        cpm.avg_attendance,\n        cpm.pass_rate,\n        cpm.withdrawal_rate,\n        cpm.excellent_grades,\n        cpm.good_grades,\n        cpm.satisfactory_grades,\n        cpm.poor_grades,\n        cpm.failing_grades,\n        case\n            when cpm.pass_rate >= 90 then 'High Success Rate'\n            when cpm.pass_rate >= 75 then 'Good Success Rate'\n            when cpm.pass_rate >= 60 then 'Moderate Success Rate'\n            else 'Low Success Rate'\n        end as success_category,\n        case\n            when cpm.withdrawal_rate >= 20 then 'High Dropout Risk'\n            when cpm.withdrawal_rate >= 10 then 'Moderate Dropout Risk'\n            when cpm.withdrawal_rate >= 5 then 'Low Dropout Risk'\n            else 'Minimal Dropout Risk'\n        end as dropout_risk,\n        case\n            when cpm.avg_attendance >= 95 then 'Excellent Engagement'\n            when cpm.avg_attendance >= 85 then 'Good Engagement'\n            when cpm.avg_attendance >= 75 then 'Fair Engagement'\n            else 'Poor Engagement'\n        end as engagement_level\n    from \"postgres\".\"edu_dbt\".\"stg_courses\" c\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" prereq on c.prerequisite_course_id = prereq.course_id\n    left join \"postgres\".\"edu_dbt\".\"int_course_performance_metrics\" cpm on c.course_id = cpm.course_id\n)\n\nselect * from course_details", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.student_academic_summary": {"database": "postgres", "schema": "edu_dbt", "name": "student_academic_summary", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/core/student_academic_summary.sql", "original_file_path": "models/marts/core/student_academic_summary.sql", "unique_id": "model.DbtEducationalDataProject.student_academic_summary", "fqn": ["DbtEducationalDataProject", "marts", "core", "student_academic_summary"], "alias": "student_academic_summary", "checksum": {"name": "sha256", "checksum": "7843c866998684ce43c9c8f95ec6bb9252ca93f6ff30efa21ea2d150be3dd126"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2116067, "relation_name": "\"postgres\".\"edu_dbt\".\"student_academic_summary\"", "raw_code": "{{ config(materialized='table') }}\n\nwith student_summary as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.age,\n        s.years_enrolled,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        s.current_status,\n        d.department_name as major_department,\n        d.department_code as major_code,\n        eh.total_enrollments,\n        eh.total_credits_attempted,\n        eh.total_credits_earned,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        eh.avg_grade_points,\n        eh.avg_attendance,\n        round(eh.total_credits_earned::numeric / nullif(eh.total_credits_attempted, 0) * 100, 2) as completion_rate,\n        case\n            when eh.total_credits_earned >= 120 then 'Graduation Ready'\n            when eh.total_credits_earned >= 90 then 'Senior Standing'\n            when eh.total_credits_earned >= 60 then 'Junior Standing'\n            when eh.total_credits_earned >= 30 then 'Sophomore Standing'\n            else 'Freshman Standing'\n        end as class_standing,\n        case\n            when eh.failed_courses_count = 0 and eh.withdrawn_courses_count = 0 then 'Excellent Progress'\n            when eh.failed_courses_count <= 1 and eh.withdrawn_courses_count <= 1 then 'Good Progress'\n            when eh.failed_courses_count <= 3 or eh.withdrawn_courses_count <= 3 then 'At Risk'\n            else 'Critical Status'\n        end as progress_indicator\n    from {{ ref('stg_students') }} s\n    left join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_enrollments) as total_enrollments,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(total_credits_earned) as total_credits_earned,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count,\n            max(avg_grade_points) as avg_grade_points,\n            max(avg_attendance) as avg_attendance\n        from {{ ref('int_student_enrollment_history') }}\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n)\n\nselect * from student_summary", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_student_enrollment_history", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_student_enrollment_history"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/core/student_academic_summary.sql", "compiled": true, "compiled_code": "\n\nwith student_summary as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.age,\n        s.years_enrolled,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        s.current_status,\n        d.department_name as major_department,\n        d.department_code as major_code,\n        eh.total_enrollments,\n        eh.total_credits_attempted,\n        eh.total_credits_earned,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        eh.avg_grade_points,\n        eh.avg_attendance,\n        round(eh.total_credits_earned::numeric / nullif(eh.total_credits_attempted, 0) * 100, 2) as completion_rate,\n        case\n            when eh.total_credits_earned >= 120 then 'Graduation Ready'\n            when eh.total_credits_earned >= 90 then 'Senior Standing'\n            when eh.total_credits_earned >= 60 then 'Junior Standing'\n            when eh.total_credits_earned >= 30 then 'Sophomore Standing'\n            else 'Freshman Standing'\n        end as class_standing,\n        case\n            when eh.failed_courses_count = 0 and eh.withdrawn_courses_count = 0 then 'Excellent Progress'\n            when eh.failed_courses_count <= 1 and eh.withdrawn_courses_count <= 1 then 'Good Progress'\n            when eh.failed_courses_count <= 3 or eh.withdrawn_courses_count <= 3 then 'At Risk'\n            else 'Critical Status'\n        end as progress_indicator\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_enrollments) as total_enrollments,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(total_credits_earned) as total_credits_earned,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count,\n            max(avg_grade_points) as avg_grade_points,\n            max(avg_attendance) as avg_attendance\n        from \"postgres\".\"edu_dbt\".\"int_student_enrollment_history\"\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n)\n\nselect * from student_summary", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.faculty_performance_dashboard": {"database": "postgres", "schema": "edu_dbt", "name": "faculty_performance_dashboard", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/core/faculty_performance_dashboard.sql", "original_file_path": "models/marts/core/faculty_performance_dashboard.sql", "unique_id": "model.DbtEducationalDataProject.faculty_performance_dashboard", "fqn": ["DbtEducationalDataProject", "marts", "core", "faculty_performance_dashboard"], "alias": "faculty_performance_dashboard", "checksum": {"name": "sha256", "checksum": "d0449213c578b1ff3e87e991b9804282d7fe87afead36cc532bc8adfe0b8b209"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.212629, "relation_name": "\"postgres\".\"edu_dbt\".\"faculty_performance_dashboard\"", "raw_code": "{{ config(materialized='table') }}\n\nwith faculty_dashboard as (\n    select\n        f.faculty_id,\n        f.faculty_name,\n        f.position,\n        f.salary,\n        f.years_of_service,\n        f.salary_band,\n        f.department_name,\n        f.department_code,\n        f.unique_courses_taught,\n        f.semesters_active,\n        f.total_class_sessions,\n        f.total_students_taught,\n        f.avg_class_attendance,\n        f.total_credit_hours_taught,\n        f.avg_course_difficulty,\n        f.teaching_load_category,\n        f.credit_hour_load_category,\n        f.salary_per_course,\n        f.salary_per_credit_hour,\n        f.morning_sessions,\n        f.afternoon_sessions,\n        f.evening_sessions,\n        da.avg_faculty_salary as dept_avg_salary,\n        da.student_faculty_ratio as dept_student_faculty_ratio,\n        round(f.salary / nullif(da.avg_faculty_salary, 0) * 100, 2) as salary_vs_dept_avg_percent,\n        case\n            when f.total_students_taught >= 200 then 'High Impact Teacher'\n            when f.total_students_taught >= 100 then 'Moderate Impact Teacher'\n            when f.total_students_taught >= 50 then 'Standard Impact Teacher'\n            else 'Limited Impact Teacher'\n        end as teaching_impact_category,\n        case\n            when f.avg_class_attendance >= 95 then 'Excellent Student Engagement'\n            when f.avg_class_attendance >= 85 then 'Good Student Engagement'\n            when f.avg_class_attendance >= 75 then 'Fair Student Engagement'\n            else 'Poor Student Engagement'\n        end as engagement_effectiveness,\n        case\n            when f.years_of_service >= 15 then 'Senior Faculty'\n            when f.years_of_service >= 10 then 'Experienced Faculty'\n            when f.years_of_service >= 5 then 'Mid-Career Faculty'\n            else 'Junior Faculty'\n        end as career_stage,\n        round(f.total_students_taught::numeric / nullif(f.semesters_active, 0), 2) as avg_students_per_semester\n    from {{ ref('int_faculty_teaching_load') }} f\n    left join {{ ref('int_department_analytics') }} da on f.department_id = da.department_id\n)\n\nselect * from faculty_dashboard", "language": "sql", "refs": [{"name": "int_faculty_teaching_load", "package": null, "version": null}, {"name": "int_department_analytics", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.int_faculty_teaching_load", "model.DbtEducationalDataProject.int_department_analytics"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/core/faculty_performance_dashboard.sql", "compiled": true, "compiled_code": "\n\nwith faculty_dashboard as (\n    select\n        f.faculty_id,\n        f.faculty_name,\n        f.position,\n        f.salary,\n        f.years_of_service,\n        f.salary_band,\n        f.department_name,\n        f.department_code,\n        f.unique_courses_taught,\n        f.semesters_active,\n        f.total_class_sessions,\n        f.total_students_taught,\n        f.avg_class_attendance,\n        f.total_credit_hours_taught,\n        f.avg_course_difficulty,\n        f.teaching_load_category,\n        f.credit_hour_load_category,\n        f.salary_per_course,\n        f.salary_per_credit_hour,\n        f.morning_sessions,\n        f.afternoon_sessions,\n        f.evening_sessions,\n        da.avg_faculty_salary as dept_avg_salary,\n        da.student_faculty_ratio as dept_student_faculty_ratio,\n        round(f.salary / nullif(da.avg_faculty_salary, 0) * 100, 2) as salary_vs_dept_avg_percent,\n        case\n            when f.total_students_taught >= 200 then 'High Impact Teacher'\n            when f.total_students_taught >= 100 then 'Moderate Impact Teacher'\n            when f.total_students_taught >= 50 then 'Standard Impact Teacher'\n            else 'Limited Impact Teacher'\n        end as teaching_impact_category,\n        case\n            when f.avg_class_attendance >= 95 then 'Excellent Student Engagement'\n            when f.avg_class_attendance >= 85 then 'Good Student Engagement'\n            when f.avg_class_attendance >= 75 then 'Fair Student Engagement'\n            else 'Poor Student Engagement'\n        end as engagement_effectiveness,\n        case\n            when f.years_of_service >= 15 then 'Senior Faculty'\n            when f.years_of_service >= 10 then 'Experienced Faculty'\n            when f.years_of_service >= 5 then 'Mid-Career Faculty'\n            else 'Junior Faculty'\n        end as career_stage,\n        round(f.total_students_taught::numeric / nullif(f.semesters_active, 0), 2) as avg_students_per_semester\n    from \"postgres\".\"edu_dbt\".\"int_faculty_teaching_load\" f\n    left join \"postgres\".\"edu_dbt\".\"int_department_analytics\" da on f.department_id = da.department_id\n)\n\nselect * from faculty_dashboard", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.course_difficulty_calibration": {"database": "postgres", "schema": "edu_dbt", "name": "course_difficulty_calibration", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/academic/course_difficulty_calibration.sql", "original_file_path": "models/marts/academic/course_difficulty_calibration.sql", "unique_id": "model.DbtEducationalDataProject.course_difficulty_calibration", "fqn": ["DbtEducationalDataProject", "marts", "academic", "course_difficulty_calibration"], "alias": "course_difficulty_calibration", "checksum": {"name": "sha256", "checksum": "9ebd821bc4678a6496dfa52f6032447a305e18cf98d06b6d279203c11399af0a"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2150624, "relation_name": "\"postgres\".\"edu_dbt\".\"course_difficulty_calibration\"", "raw_code": "{{ config(materialized='table') }}\n\nwith course_performance_data as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level as assigned_difficulty,\n        c.credits,\n        c.prerequisite_course_id,\n        d.department_name,\n        cpm.total_enrollments,\n        cpm.avg_grade_points,\n        cpm.pass_rate,\n        cpm.withdrawal_rate,\n        cpm.avg_attendance,\n        prereq.difficulty_level as prerequisite_difficulty,\n        ia.avg_percentage_score as avg_assignment_score,\n        ia.late_submission_rate\n    from {{ ref('stg_courses') }} c\n    left join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    left join {{ ref('int_course_performance_metrics') }} cpm on c.course_id = cpm.course_id\n    left join {{ ref('stg_courses') }} prereq on c.prerequisite_course_id = prereq.course_id\n    left join (\n        select \n            course_id,\n            avg(avg_percentage_score) as avg_percentage_score,\n            avg(late_submission_rate) as late_submission_rate\n        from {{ ref('int_assignment_performance') }}\n        group by course_id\n    ) ia on c.course_id = ia.course_id\n),\n\ndifficulty_analysis as (\n    select\n        *,\n        -- Performance-based difficulty assessment\n        case\n            when avg_grade_points >= 3.5 and pass_rate >= 90 then 1\n            when avg_grade_points >= 3.0 and pass_rate >= 80 then 2\n            when avg_grade_points >= 2.5 and pass_rate >= 70 then 3\n            when avg_grade_points >= 2.0 and pass_rate >= 60 then 4\n            else 5\n        end as performance_based_difficulty,\n        \n        -- Engagement-based difficulty assessment\n        case\n            when avg_attendance >= 95 and late_submission_rate <= 10 then 1\n            when avg_attendance >= 85 and late_submission_rate <= 20 then 2\n            when avg_attendance >= 75 and late_submission_rate <= 30 then 3\n            when avg_attendance >= 65 and late_submission_rate <= 40 then 4\n            else 5\n        end as engagement_based_difficulty,\n        \n        -- Withdrawal-based difficulty assessment\n        case\n            when withdrawal_rate <= 5 then 1\n            when withdrawal_rate <= 10 then 2\n            when withdrawal_rate <= 15 then 3\n            when withdrawal_rate <= 25 then 4\n            else 5\n        end as withdrawal_based_difficulty\n    from course_performance_data\n    where total_enrollments >= 10  -- Only courses with sufficient data\n),\n\ncomposite_difficulty as (\n    select\n        da.*,\n        round(\n            (performance_based_difficulty + engagement_based_difficulty + withdrawal_based_difficulty) / 3.0, 1\n        ) as calculated_difficulty,\n        abs(assigned_difficulty - round(\n            (performance_based_difficulty + engagement_based_difficulty + withdrawal_based_difficulty) / 3.0, 1\n        )) as difficulty_calibration_error,\n        case\n            when prerequisite_course_id is not null and prerequisite_difficulty is not null then\n                assigned_difficulty - prerequisite_difficulty\n            else null\n        end as difficulty_progression_from_prerequisite\n    from difficulty_analysis da\n),\n\ncalibration_assessment as (\n    select\n        cd.*,\n        case\n            when difficulty_calibration_error <= 0.5 then 'Well Calibrated'\n            when difficulty_calibration_error <= 1.0 then 'Moderately Calibrated'\n            when difficulty_calibration_error <= 1.5 then 'Poorly Calibrated'\n            else 'Very Poorly Calibrated'\n        end as calibration_status,\n        \n        case\n            when calculated_difficulty > assigned_difficulty + 1 then 'Course Harder Than Expected'\n            when calculated_difficulty > assigned_difficulty + 0.5 then 'Course Somewhat Harder'\n            when calculated_difficulty < assigned_difficulty - 1 then 'Course Easier Than Expected'\n            when calculated_difficulty < assigned_difficulty - 0.5 then 'Course Somewhat Easier'\n            else 'Course As Expected'\n        end as difficulty_assessment,\n        \n        case\n            when difficulty_progression_from_prerequisite is not null then\n                case\n                    when difficulty_progression_from_prerequisite < 0 then 'Easier than prerequisite'\n                    when difficulty_progression_from_prerequisite = 0 then 'Same difficulty as prerequisite'\n                    when difficulty_progression_from_prerequisite = 1 then 'Appropriate progression'\n                    when difficulty_progression_from_prerequisite > 1 then 'Large difficulty jump'\n                    else 'Unknown progression'\n                end\n            else 'No prerequisite for comparison'\n        end as prerequisite_progression_assessment,\n        \n        -- Recommendations for difficulty recalibration\n        case\n            when calculated_difficulty > assigned_difficulty + 1 and pass_rate < 60 then\n                'Consider reducing course difficulty or improving support'\n            when calculated_difficulty < assigned_difficulty - 1 and pass_rate > 95 then\n                'Consider increasing course rigor or advancing difficulty level'\n            when withdrawal_rate > 20 then\n                'High dropout rate suggests course may be too demanding'\n            when avg_attendance < 70 then\n                'Low engagement suggests course structure review needed'\n            when difficulty_calibration_error > 1.5 then\n                'Significant calibration error - review course design'\n            else 'Course difficulty appropriately calibrated'\n        end as calibration_recommendation\n    from composite_difficulty cd\n),\n\ndepartment_difficulty_patterns as (\n    select\n        department_name,\n        count(*) as total_courses,\n        avg(assigned_difficulty) as avg_assigned_difficulty,\n        avg(calculated_difficulty) as avg_calculated_difficulty,\n        avg(difficulty_calibration_error) as avg_calibration_error,\n        count(case when calibration_status = 'Well Calibrated' then 1 end) as well_calibrated_courses,\n        count(case when difficulty_assessment like '%Harder%' then 1 end) as harder_than_expected_courses,\n        count(case when difficulty_assessment like '%Easier%' then 1 end) as easier_than_expected_courses,\n        round(\n            count(case when calibration_status = 'Well Calibrated' then 1 end) * 100.0 / count(*), 2\n        ) as calibration_accuracy_rate\n    from calibration_assessment\n    group by department_name\n),\n\nfinal_analysis as (\n    select\n        ca.*,\n        ddp.avg_assigned_difficulty as dept_avg_assigned_difficulty,\n        ddp.avg_calculated_difficulty as dept_avg_calculated_difficulty,\n        ddp.calibration_accuracy_rate as dept_calibration_accuracy,\n        case\n            when ca.calculated_difficulty > ddp.avg_calculated_difficulty + 1 then 'Above Department Average Difficulty'\n            when ca.calculated_difficulty < ddp.avg_calculated_difficulty - 1 then 'Below Department Average Difficulty'\n            else 'Near Department Average Difficulty'\n        end as relative_difficulty_in_department,\n        \n        -- Overall course health score\n        round(\n            (case when calibration_status = 'Well Calibrated' then 25\n                  when calibration_status = 'Moderately Calibrated' then 20\n                  when calibration_status = 'Poorly Calibrated' then 10\n                  else 5 end) +\n            (case when pass_rate >= 80 then 25\n                  when pass_rate >= 70 then 20\n                  when pass_rate >= 60 then 15\n                  else 10 end) +\n            (case when withdrawal_rate <= 10 then 25\n                  when withdrawal_rate <= 15 then 20\n                  when withdrawal_rate <= 20 then 15\n                  else 10 end) +\n            (case when avg_attendance >= 85 then 25\n                  when avg_attendance >= 75 then 20\n                  when avg_attendance >= 65 then 15\n                  else 10 end), 0\n        ) as course_health_score\n    from calibration_assessment ca\n    left join department_difficulty_patterns ddp on ca.department_name = ddp.department_name\n)\n\nselect * from final_analysis\norder by difficulty_calibration_error desc, course_health_score asc", "language": "sql", "refs": [{"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_course_performance_metrics", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "int_assignment_performance", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_assignment_performance"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/academic/course_difficulty_calibration.sql", "compiled": true, "compiled_code": "\n\nwith course_performance_data as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level as assigned_difficulty,\n        c.credits,\n        c.prerequisite_course_id,\n        d.department_name,\n        cpm.total_enrollments,\n        cpm.avg_grade_points,\n        cpm.pass_rate,\n        cpm.withdrawal_rate,\n        cpm.avg_attendance,\n        prereq.difficulty_level as prerequisite_difficulty,\n        ia.avg_percentage_score as avg_assignment_score,\n        ia.late_submission_rate\n    from \"postgres\".\"edu_dbt\".\"stg_courses\" c\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"int_course_performance_metrics\" cpm on c.course_id = cpm.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" prereq on c.prerequisite_course_id = prereq.course_id\n    left join (\n        select \n            course_id,\n            avg(avg_percentage_score) as avg_percentage_score,\n            avg(late_submission_rate) as late_submission_rate\n        from \"postgres\".\"edu_dbt\".\"int_assignment_performance\"\n        group by course_id\n    ) ia on c.course_id = ia.course_id\n),\n\ndifficulty_analysis as (\n    select\n        *,\n        -- Performance-based difficulty assessment\n        case\n            when avg_grade_points >= 3.5 and pass_rate >= 90 then 1\n            when avg_grade_points >= 3.0 and pass_rate >= 80 then 2\n            when avg_grade_points >= 2.5 and pass_rate >= 70 then 3\n            when avg_grade_points >= 2.0 and pass_rate >= 60 then 4\n            else 5\n        end as performance_based_difficulty,\n        \n        -- Engagement-based difficulty assessment\n        case\n            when avg_attendance >= 95 and late_submission_rate <= 10 then 1\n            when avg_attendance >= 85 and late_submission_rate <= 20 then 2\n            when avg_attendance >= 75 and late_submission_rate <= 30 then 3\n            when avg_attendance >= 65 and late_submission_rate <= 40 then 4\n            else 5\n        end as engagement_based_difficulty,\n        \n        -- Withdrawal-based difficulty assessment\n        case\n            when withdrawal_rate <= 5 then 1\n            when withdrawal_rate <= 10 then 2\n            when withdrawal_rate <= 15 then 3\n            when withdrawal_rate <= 25 then 4\n            else 5\n        end as withdrawal_based_difficulty\n    from course_performance_data\n    where total_enrollments >= 10  -- Only courses with sufficient data\n),\n\ncomposite_difficulty as (\n    select\n        da.*,\n        round(\n            (performance_based_difficulty + engagement_based_difficulty + withdrawal_based_difficulty) / 3.0, 1\n        ) as calculated_difficulty,\n        abs(assigned_difficulty - round(\n            (performance_based_difficulty + engagement_based_difficulty + withdrawal_based_difficulty) / 3.0, 1\n        )) as difficulty_calibration_error,\n        case\n            when prerequisite_course_id is not null and prerequisite_difficulty is not null then\n                assigned_difficulty - prerequisite_difficulty\n            else null\n        end as difficulty_progression_from_prerequisite\n    from difficulty_analysis da\n),\n\ncalibration_assessment as (\n    select\n        cd.*,\n        case\n            when difficulty_calibration_error <= 0.5 then 'Well Calibrated'\n            when difficulty_calibration_error <= 1.0 then 'Moderately Calibrated'\n            when difficulty_calibration_error <= 1.5 then 'Poorly Calibrated'\n            else 'Very Poorly Calibrated'\n        end as calibration_status,\n        \n        case\n            when calculated_difficulty > assigned_difficulty + 1 then 'Course Harder Than Expected'\n            when calculated_difficulty > assigned_difficulty + 0.5 then 'Course Somewhat Harder'\n            when calculated_difficulty < assigned_difficulty - 1 then 'Course Easier Than Expected'\n            when calculated_difficulty < assigned_difficulty - 0.5 then 'Course Somewhat Easier'\n            else 'Course As Expected'\n        end as difficulty_assessment,\n        \n        case\n            when difficulty_progression_from_prerequisite is not null then\n                case\n                    when difficulty_progression_from_prerequisite < 0 then 'Easier than prerequisite'\n                    when difficulty_progression_from_prerequisite = 0 then 'Same difficulty as prerequisite'\n                    when difficulty_progression_from_prerequisite = 1 then 'Appropriate progression'\n                    when difficulty_progression_from_prerequisite > 1 then 'Large difficulty jump'\n                    else 'Unknown progression'\n                end\n            else 'No prerequisite for comparison'\n        end as prerequisite_progression_assessment,\n        \n        -- Recommendations for difficulty recalibration\n        case\n            when calculated_difficulty > assigned_difficulty + 1 and pass_rate < 60 then\n                'Consider reducing course difficulty or improving support'\n            when calculated_difficulty < assigned_difficulty - 1 and pass_rate > 95 then\n                'Consider increasing course rigor or advancing difficulty level'\n            when withdrawal_rate > 20 then\n                'High dropout rate suggests course may be too demanding'\n            when avg_attendance < 70 then\n                'Low engagement suggests course structure review needed'\n            when difficulty_calibration_error > 1.5 then\n                'Significant calibration error - review course design'\n            else 'Course difficulty appropriately calibrated'\n        end as calibration_recommendation\n    from composite_difficulty cd\n),\n\ndepartment_difficulty_patterns as (\n    select\n        department_name,\n        count(*) as total_courses,\n        avg(assigned_difficulty) as avg_assigned_difficulty,\n        avg(calculated_difficulty) as avg_calculated_difficulty,\n        avg(difficulty_calibration_error) as avg_calibration_error,\n        count(case when calibration_status = 'Well Calibrated' then 1 end) as well_calibrated_courses,\n        count(case when difficulty_assessment like '%Harder%' then 1 end) as harder_than_expected_courses,\n        count(case when difficulty_assessment like '%Easier%' then 1 end) as easier_than_expected_courses,\n        round(\n            count(case when calibration_status = 'Well Calibrated' then 1 end) * 100.0 / count(*), 2\n        ) as calibration_accuracy_rate\n    from calibration_assessment\n    group by department_name\n),\n\nfinal_analysis as (\n    select\n        ca.*,\n        ddp.avg_assigned_difficulty as dept_avg_assigned_difficulty,\n        ddp.avg_calculated_difficulty as dept_avg_calculated_difficulty,\n        ddp.calibration_accuracy_rate as dept_calibration_accuracy,\n        case\n            when ca.calculated_difficulty > ddp.avg_calculated_difficulty + 1 then 'Above Department Average Difficulty'\n            when ca.calculated_difficulty < ddp.avg_calculated_difficulty - 1 then 'Below Department Average Difficulty'\n            else 'Near Department Average Difficulty'\n        end as relative_difficulty_in_department,\n        \n        -- Overall course health score\n        round(\n            (case when calibration_status = 'Well Calibrated' then 25\n                  when calibration_status = 'Moderately Calibrated' then 20\n                  when calibration_status = 'Poorly Calibrated' then 10\n                  else 5 end) +\n            (case when pass_rate >= 80 then 25\n                  when pass_rate >= 70 then 20\n                  when pass_rate >= 60 then 15\n                  else 10 end) +\n            (case when withdrawal_rate <= 10 then 25\n                  when withdrawal_rate <= 15 then 20\n                  when withdrawal_rate <= 20 then 15\n                  else 10 end) +\n            (case when avg_attendance >= 85 then 25\n                  when avg_attendance >= 75 then 20\n                  when avg_attendance >= 65 then 15\n                  else 10 end), 0\n        ) as course_health_score\n    from calibration_assessment ca\n    left join department_difficulty_patterns ddp on ca.department_name = ddp.department_name\n)\n\nselect * from final_analysis\norder by difficulty_calibration_error desc, course_health_score asc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.course_success_predictors": {"database": "postgres", "schema": "edu_dbt", "name": "course_success_predictors", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/academic/course_success_predictors.sql", "original_file_path": "models/marts/academic/course_success_predictors.sql", "unique_id": "model.DbtEducationalDataProject.course_success_predictors", "fqn": ["DbtEducationalDataProject", "marts", "academic", "course_success_predictors"], "alias": "course_success_predictors", "checksum": {"name": "sha256", "checksum": "532861a6aaa07c9b28e8993661cefc8a93ab71e5498112cbcc84574d5b5c1d51"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.21773, "relation_name": "\"postgres\".\"edu_dbt\".\"course_success_predictors\"", "raw_code": "{{ config(materialized='table') }}\n\nwith course_student_data as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.credits,\n        c.prerequisite_course_id,\n        d.department_name,\n        e.student_id,\n        e.grade,\n        e.grade_points,\n        e.attendance_percentage,\n        e.grade_category,\n        e.enrollment_status,\n        s.gpa as student_cumulative_gpa,\n        s.academic_standing,\n        s.age,\n        s.years_enrolled,\n        sem.semester_name,\n        sem.semester_type,\n        ap.total_submissions,\n        ap.avg_percentage_score as avg_assignment_score,\n        ap.late_submission_rate,\n        case when e.grade_points >= 3.0 then 1 else 0 end as successful_completion,\n        case when e.attendance_percentage >= 80 then 1 else 0 end as good_attendance,\n        case when s.gpa >= 3.0 then 1 else 0 end as strong_academic_record\n    from {{ ref('stg_courses') }} c\n    inner join {{ ref('stg_enrollments') }} e on c.course_id = e.course_id\n    inner join {{ ref('stg_students') }} s on e.student_id = s.student_id\n    inner join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    inner join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    left join (\n        select \n            course_id,\n            avg(total_submissions) as total_submissions,\n            avg(avg_percentage_score) as avg_percentage_score,\n            avg(late_submission_rate) as late_submission_rate\n        from {{ ref('int_assignment_performance') }}\n        group by course_id\n    ) ap on c.course_id = ap.course_id\n    where e.enrollment_status = 'Completed'\n),\n\nsuccess_factors as (\n    select\n        course_id,\n        course_code,\n        course_name,\n        difficulty_level,\n        credits,\n        department_name,\n        count(*) as total_completions,\n        sum(successful_completion) as successful_completions,\n        round(avg(successful_completion) * 100, 2) as success_rate,\n        avg(grade_points) as avg_course_grade_points,\n        avg(attendance_percentage) as avg_course_attendance,\n        avg(student_cumulative_gpa) as avg_student_entering_gpa,\n        avg(avg_assignment_score) as avg_assignment_performance,\n        corr(student_cumulative_gpa, grade_points) as gpa_correlation,\n        corr(attendance_percentage, grade_points) as attendance_correlation,\n        corr(avg_assignment_score, grade_points) as assignment_correlation,\n        corr(age, grade_points) as age_correlation,\n        count(case when strong_academic_record = 1 and successful_completion = 1 then 1 end) as strong_students_successful,\n        count(case when strong_academic_record = 1 then 1 end) as strong_students_total,\n        count(case when good_attendance = 1 and successful_completion = 1 then 1 end) as good_attendance_successful,\n        count(case when good_attendance = 1 then 1 end) as good_attendance_total,\n        avg(case when semester_type = 'Fall' then grade_points end) as fall_avg_performance,\n        avg(case when semester_type = 'Spring' then grade_points end) as spring_avg_performance,\n        avg(case when semester_type = 'Summer' then grade_points end) as summer_avg_performance\n    from course_student_data\n    group by \n        course_id, course_code, course_name, difficulty_level, \n        credits, department_name\n    having count(*) >= 5  -- Only courses with sufficient data\n),\n\npredictive_analysis as (\n    select\n        *,\n        round(\n            (strong_students_successful * 100.0) / nullif(strong_students_total, 0), 2\n        ) as strong_student_success_rate,\n        round(\n            (good_attendance_successful * 100.0) / nullif(good_attendance_total, 0), 2\n        ) as good_attendance_success_rate,\n        case\n            when success_rate >= 90 then 'Very High Success'\n            when success_rate >= 75 then 'High Success'\n            when success_rate >= 60 then 'Moderate Success'\n            when success_rate >= 45 then 'Low Success'\n            else 'Very Low Success'\n        end as success_category,\n        case\n            when abs(gpa_correlation) >= 0.7 then 'Strong GPA Predictor'\n            when abs(gpa_correlation) >= 0.4 then 'Moderate GPA Predictor'\n            when abs(gpa_correlation) >= 0.2 then 'Weak GPA Predictor'\n            else 'GPA Not Predictive'\n        end as gpa_predictive_strength,\n        case\n            when abs(attendance_correlation) >= 0.7 then 'Strong Attendance Predictor'\n            when abs(attendance_correlation) >= 0.4 then 'Moderate Attendance Predictor'\n            when abs(attendance_correlation) >= 0.2 then 'Weak Attendance Predictor'\n            else 'Attendance Not Predictive'\n        end as attendance_predictive_strength,\n        case\n            when abs(assignment_correlation) >= 0.7 then 'Strong Assignment Predictor'\n            when abs(assignment_correlation) >= 0.4 then 'Moderate Assignment Predictor'\n            when abs(assignment_correlation) >= 0.2 then 'Weak Assignment Predictor'\n            else 'Assignments Not Predictive'\n        end as assignment_predictive_strength,\n        case\n            when fall_avg_performance > spring_avg_performance \n                 and fall_avg_performance > summer_avg_performance then 'Fall Best Performance'\n            when spring_avg_performance > summer_avg_performance then 'Spring Best Performance'\n            when summer_avg_performance is not null then 'Summer Best Performance'\n            else 'No Clear Seasonal Pattern'\n        end as seasonal_performance_pattern,\n        case\n            when difficulty_level <= 2 and success_rate >= 85 then 'Appropriately Difficult'\n            when difficulty_level >= 4 and success_rate <= 60 then 'Appropriately Challenging'\n            when difficulty_level <= 2 and success_rate <= 60 then 'Unexpectedly Difficult'\n            when difficulty_level >= 4 and success_rate >= 85 then 'Easier Than Expected'\n            else 'Standard Difficulty-Success Alignment'\n        end as difficulty_alignment\n    from success_factors\n)\n\nselect * from predictive_analysis\norder by success_rate desc", "language": "sql", "refs": [{"name": "stg_courses", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "int_assignment_performance", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.int_assignment_performance"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/academic/course_success_predictors.sql", "compiled": true, "compiled_code": "\n\nwith course_student_data as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.credits,\n        c.prerequisite_course_id,\n        d.department_name,\n        e.student_id,\n        e.grade,\n        e.grade_points,\n        e.attendance_percentage,\n        e.grade_category,\n        e.enrollment_status,\n        s.gpa as student_cumulative_gpa,\n        s.academic_standing,\n        s.age,\n        s.years_enrolled,\n        sem.semester_name,\n        sem.semester_type,\n        ap.total_submissions,\n        ap.avg_percentage_score as avg_assignment_score,\n        ap.late_submission_rate,\n        case when e.grade_points >= 3.0 then 1 else 0 end as successful_completion,\n        case when e.attendance_percentage >= 80 then 1 else 0 end as good_attendance,\n        case when s.gpa >= 3.0 then 1 else 0 end as strong_academic_record\n    from \"postgres\".\"edu_dbt\".\"stg_courses\" c\n    inner join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on c.course_id = e.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_students\" s on e.student_id = s.student_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    left join (\n        select \n            course_id,\n            avg(total_submissions) as total_submissions,\n            avg(avg_percentage_score) as avg_percentage_score,\n            avg(late_submission_rate) as late_submission_rate\n        from \"postgres\".\"edu_dbt\".\"int_assignment_performance\"\n        group by course_id\n    ) ap on c.course_id = ap.course_id\n    where e.enrollment_status = 'Completed'\n),\n\nsuccess_factors as (\n    select\n        course_id,\n        course_code,\n        course_name,\n        difficulty_level,\n        credits,\n        department_name,\n        count(*) as total_completions,\n        sum(successful_completion) as successful_completions,\n        round(avg(successful_completion) * 100, 2) as success_rate,\n        avg(grade_points) as avg_course_grade_points,\n        avg(attendance_percentage) as avg_course_attendance,\n        avg(student_cumulative_gpa) as avg_student_entering_gpa,\n        avg(avg_assignment_score) as avg_assignment_performance,\n        corr(student_cumulative_gpa, grade_points) as gpa_correlation,\n        corr(attendance_percentage, grade_points) as attendance_correlation,\n        corr(avg_assignment_score, grade_points) as assignment_correlation,\n        corr(age, grade_points) as age_correlation,\n        count(case when strong_academic_record = 1 and successful_completion = 1 then 1 end) as strong_students_successful,\n        count(case when strong_academic_record = 1 then 1 end) as strong_students_total,\n        count(case when good_attendance = 1 and successful_completion = 1 then 1 end) as good_attendance_successful,\n        count(case when good_attendance = 1 then 1 end) as good_attendance_total,\n        avg(case when semester_type = 'Fall' then grade_points end) as fall_avg_performance,\n        avg(case when semester_type = 'Spring' then grade_points end) as spring_avg_performance,\n        avg(case when semester_type = 'Summer' then grade_points end) as summer_avg_performance\n    from course_student_data\n    group by \n        course_id, course_code, course_name, difficulty_level, \n        credits, department_name\n    having count(*) >= 5  -- Only courses with sufficient data\n),\n\npredictive_analysis as (\n    select\n        *,\n        round(\n            (strong_students_successful * 100.0) / nullif(strong_students_total, 0), 2\n        ) as strong_student_success_rate,\n        round(\n            (good_attendance_successful * 100.0) / nullif(good_attendance_total, 0), 2\n        ) as good_attendance_success_rate,\n        case\n            when success_rate >= 90 then 'Very High Success'\n            when success_rate >= 75 then 'High Success'\n            when success_rate >= 60 then 'Moderate Success'\n            when success_rate >= 45 then 'Low Success'\n            else 'Very Low Success'\n        end as success_category,\n        case\n            when abs(gpa_correlation) >= 0.7 then 'Strong GPA Predictor'\n            when abs(gpa_correlation) >= 0.4 then 'Moderate GPA Predictor'\n            when abs(gpa_correlation) >= 0.2 then 'Weak GPA Predictor'\n            else 'GPA Not Predictive'\n        end as gpa_predictive_strength,\n        case\n            when abs(attendance_correlation) >= 0.7 then 'Strong Attendance Predictor'\n            when abs(attendance_correlation) >= 0.4 then 'Moderate Attendance Predictor'\n            when abs(attendance_correlation) >= 0.2 then 'Weak Attendance Predictor'\n            else 'Attendance Not Predictive'\n        end as attendance_predictive_strength,\n        case\n            when abs(assignment_correlation) >= 0.7 then 'Strong Assignment Predictor'\n            when abs(assignment_correlation) >= 0.4 then 'Moderate Assignment Predictor'\n            when abs(assignment_correlation) >= 0.2 then 'Weak Assignment Predictor'\n            else 'Assignments Not Predictive'\n        end as assignment_predictive_strength,\n        case\n            when fall_avg_performance > spring_avg_performance \n                 and fall_avg_performance > summer_avg_performance then 'Fall Best Performance'\n            when spring_avg_performance > summer_avg_performance then 'Spring Best Performance'\n            when summer_avg_performance is not null then 'Summer Best Performance'\n            else 'No Clear Seasonal Pattern'\n        end as seasonal_performance_pattern,\n        case\n            when difficulty_level <= 2 and success_rate >= 85 then 'Appropriately Difficult'\n            when difficulty_level >= 4 and success_rate <= 60 then 'Appropriately Challenging'\n            when difficulty_level <= 2 and success_rate <= 60 then 'Unexpectedly Difficult'\n            when difficulty_level >= 4 and success_rate >= 85 then 'Easier Than Expected'\n            else 'Standard Difficulty-Success Alignment'\n        end as difficulty_alignment\n    from success_factors\n)\n\nselect * from predictive_analysis\norder by success_rate desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.assignment_workload_analysis": {"database": "postgres", "schema": "edu_dbt", "name": "assignment_workload_analysis", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/academic/assignment_workload_analysis.sql", "original_file_path": "models/marts/academic/assignment_workload_analysis.sql", "unique_id": "model.DbtEducationalDataProject.assignment_workload_analysis", "fqn": ["DbtEducationalDataProject", "marts", "academic", "assignment_workload_analysis"], "alias": "assignment_workload_analysis", "checksum": {"name": "sha256", "checksum": "ed815fda8ff0ee9eb22f30ded3ae8c874101354b0bb8e1be89e1a464f8aa2ab0"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2206562, "relation_name": "\"postgres\".\"edu_dbt\".\"assignment_workload_analysis\"", "raw_code": "{{ config(materialized='table') }}\n\nwith assignment_workload as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.credits,\n        c.difficulty_level,\n        d.department_name,\n        a.assignment_id,\n        a.assignment_name,\n        a.assignment_type,\n        a.assignment_category,\n        a.due_date,\n        a.max_points,\n        a.weight_percentage,\n        extract(week from a.due_date) as due_week,\n        extract(month from a.due_date) as due_month,\n        ap.total_submissions,\n        ap.avg_percentage_score,\n        ap.late_submission_rate,\n        ap.avg_score,\n        case\n            when extract(dow from a.due_date) in (0, 6) then 'Weekend'\n            else 'Weekday'\n        end as due_day_type\n    from {{ ref('stg_semesters') }} sem\n    inner join {{ ref('stg_assignments') }} a on sem.semester_id = a.semester_id\n    inner join {{ ref('stg_courses') }} c on a.course_id = c.course_id\n    inner join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    left join {{ ref('int_assignment_performance') }} ap on a.assignment_id = ap.assignment_id\n),\n\nsemester_workload_analysis as (\n    select\n        semester_id,\n        semester_name,\n        academic_year,\n        semester_type,\n        count(distinct assignment_id) as total_assignments,\n        count(distinct course_id) as courses_with_assignments,\n        sum(max_points) as total_possible_points,\n        avg(max_points) as avg_assignment_points,\n        sum(weight_percentage) as total_weight_percentage,\n        avg(weight_percentage) as avg_assignment_weight,\n        count(case when assignment_category = 'Assessment' then 1 end) as exam_count,\n        count(case when assignment_category = 'Project' then 1 end) as project_count,\n        count(case when assignment_category = 'Homework' then 1 end) as homework_count,\n        count(case when assignment_category = 'Quiz' then 1 end) as quiz_count,\n        count(case when due_day_type = 'Weekend' then 1 end) as weekend_due_assignments,\n        avg(avg_percentage_score) as semester_avg_score,\n        avg(late_submission_rate) as semester_late_rate\n    from assignment_workload\n    group by semester_id, semester_name, academic_year, semester_type\n),\n\ncourse_workload_analysis as (\n    select\n        course_id,\n        course_code,\n        course_name,\n        credits,\n        difficulty_level,\n        department_name,\n        count(distinct assignment_id) as assignments_per_course,\n        sum(max_points) as total_points_possible,\n        avg(max_points) as avg_points_per_assignment,\n        sum(weight_percentage) as total_course_weight,\n        round(count(distinct assignment_id)::numeric / credits, 2) as assignments_per_credit,\n        round(sum(max_points)::numeric / credits, 2) as points_per_credit,\n        count(case when assignment_category = 'Assessment' then 1 end) as course_exams,\n        count(case when assignment_category = 'Project' then 1 end) as course_projects,\n        count(case when assignment_category = 'Homework' then 1 end) as course_homework,\n        avg(avg_percentage_score) as course_avg_performance,\n        avg(late_submission_rate) as course_late_rate\n    from assignment_workload\n    group by course_id, course_code, course_name, credits, difficulty_level, department_name\n),\n\nweekly_workload_distribution as (\n    select\n        semester_id,\n        semester_name,\n        due_week,\n        count(distinct assignment_id) as assignments_due_this_week,\n        sum(max_points) as total_points_due_this_week,\n        count(distinct course_id) as courses_with_assignments_due,\n        avg(weight_percentage) as avg_weight_this_week\n    from assignment_workload\n    where due_week is not null\n    group by semester_id, semester_name, due_week\n),\n\nworkload_intensity as (\n    select\n        swa.*,\n        cwa.assignments_per_course,\n        cwa.assignments_per_credit,\n        cwa.points_per_credit,\n        www.max_weekly_assignments,\n        www.max_weekly_points,\n        www.avg_weekly_assignments,\n        case\n            when swa.total_assignments >= 100 then 'Very High Workload'\n            when swa.total_assignments >= 75 then 'High Workload'\n            when swa.total_assignments >= 50 then 'Moderate Workload'\n            when swa.total_assignments >= 25 then 'Light Workload'\n            else 'Very Light Workload'\n        end as semester_workload_category,\n        case\n            when www.max_weekly_assignments >= 15 then 'Overwhelming Weeks'\n            when www.max_weekly_assignments >= 10 then 'Heavy Weeks'\n            when www.max_weekly_assignments >= 7 then 'Busy Weeks'\n            else 'Manageable Weeks'\n        end as peak_week_intensity,\n        round(swa.total_assignments::numeric / 16, 2) as avg_assignments_per_week,  -- Assuming 16-week semester\n        case\n            when swa.semester_late_rate >= 25 then 'High Stress Semester'\n            when swa.semester_late_rate >= 15 then 'Moderate Stress Semester'\n            when swa.semester_late_rate >= 10 then 'Low Stress Semester'\n            else 'Well-Managed Semester'\n        end as stress_indicator\n    from semester_workload_analysis swa\n    left join (\n        select\n            course_id,\n            avg(assignments_per_course) as assignments_per_course,\n            avg(assignments_per_credit) as assignments_per_credit,\n            avg(points_per_credit) as points_per_credit\n        from course_workload_analysis\n        group by course_id\n    ) cwa on 1=1  -- Cross join for semester-level aggregation\n    left join (\n        select\n            semester_id,\n            max(assignments_due_this_week) as max_weekly_assignments,\n            max(total_points_due_this_week) as max_weekly_points,\n            avg(assignments_due_this_week) as avg_weekly_assignments\n        from weekly_workload_distribution\n        group by semester_id\n    ) www on swa.semester_id = www.semester_id\n)\n\nselect * from workload_intensity", "language": "sql", "refs": [{"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_assignments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_assignment_performance", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_assignment_performance"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/academic/assignment_workload_analysis.sql", "compiled": true, "compiled_code": "\n\nwith assignment_workload as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.credits,\n        c.difficulty_level,\n        d.department_name,\n        a.assignment_id,\n        a.assignment_name,\n        a.assignment_type,\n        a.assignment_category,\n        a.due_date,\n        a.max_points,\n        a.weight_percentage,\n        extract(week from a.due_date) as due_week,\n        extract(month from a.due_date) as due_month,\n        ap.total_submissions,\n        ap.avg_percentage_score,\n        ap.late_submission_rate,\n        ap.avg_score,\n        case\n            when extract(dow from a.due_date) in (0, 6) then 'Weekend'\n            else 'Weekday'\n        end as due_day_type\n    from \"postgres\".\"edu_dbt\".\"stg_semesters\" sem\n    inner join \"postgres\".\"edu_dbt\".\"stg_assignments\" a on sem.semester_id = a.semester_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on a.course_id = c.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"int_assignment_performance\" ap on a.assignment_id = ap.assignment_id\n),\n\nsemester_workload_analysis as (\n    select\n        semester_id,\n        semester_name,\n        academic_year,\n        semester_type,\n        count(distinct assignment_id) as total_assignments,\n        count(distinct course_id) as courses_with_assignments,\n        sum(max_points) as total_possible_points,\n        avg(max_points) as avg_assignment_points,\n        sum(weight_percentage) as total_weight_percentage,\n        avg(weight_percentage) as avg_assignment_weight,\n        count(case when assignment_category = 'Assessment' then 1 end) as exam_count,\n        count(case when assignment_category = 'Project' then 1 end) as project_count,\n        count(case when assignment_category = 'Homework' then 1 end) as homework_count,\n        count(case when assignment_category = 'Quiz' then 1 end) as quiz_count,\n        count(case when due_day_type = 'Weekend' then 1 end) as weekend_due_assignments,\n        avg(avg_percentage_score) as semester_avg_score,\n        avg(late_submission_rate) as semester_late_rate\n    from assignment_workload\n    group by semester_id, semester_name, academic_year, semester_type\n),\n\ncourse_workload_analysis as (\n    select\n        course_id,\n        course_code,\n        course_name,\n        credits,\n        difficulty_level,\n        department_name,\n        count(distinct assignment_id) as assignments_per_course,\n        sum(max_points) as total_points_possible,\n        avg(max_points) as avg_points_per_assignment,\n        sum(weight_percentage) as total_course_weight,\n        round(count(distinct assignment_id)::numeric / credits, 2) as assignments_per_credit,\n        round(sum(max_points)::numeric / credits, 2) as points_per_credit,\n        count(case when assignment_category = 'Assessment' then 1 end) as course_exams,\n        count(case when assignment_category = 'Project' then 1 end) as course_projects,\n        count(case when assignment_category = 'Homework' then 1 end) as course_homework,\n        avg(avg_percentage_score) as course_avg_performance,\n        avg(late_submission_rate) as course_late_rate\n    from assignment_workload\n    group by course_id, course_code, course_name, credits, difficulty_level, department_name\n),\n\nweekly_workload_distribution as (\n    select\n        semester_id,\n        semester_name,\n        due_week,\n        count(distinct assignment_id) as assignments_due_this_week,\n        sum(max_points) as total_points_due_this_week,\n        count(distinct course_id) as courses_with_assignments_due,\n        avg(weight_percentage) as avg_weight_this_week\n    from assignment_workload\n    where due_week is not null\n    group by semester_id, semester_name, due_week\n),\n\nworkload_intensity as (\n    select\n        swa.*,\n        cwa.assignments_per_course,\n        cwa.assignments_per_credit,\n        cwa.points_per_credit,\n        www.max_weekly_assignments,\n        www.max_weekly_points,\n        www.avg_weekly_assignments,\n        case\n            when swa.total_assignments >= 100 then 'Very High Workload'\n            when swa.total_assignments >= 75 then 'High Workload'\n            when swa.total_assignments >= 50 then 'Moderate Workload'\n            when swa.total_assignments >= 25 then 'Light Workload'\n            else 'Very Light Workload'\n        end as semester_workload_category,\n        case\n            when www.max_weekly_assignments >= 15 then 'Overwhelming Weeks'\n            when www.max_weekly_assignments >= 10 then 'Heavy Weeks'\n            when www.max_weekly_assignments >= 7 then 'Busy Weeks'\n            else 'Manageable Weeks'\n        end as peak_week_intensity,\n        round(swa.total_assignments::numeric / 16, 2) as avg_assignments_per_week,  -- Assuming 16-week semester\n        case\n            when swa.semester_late_rate >= 25 then 'High Stress Semester'\n            when swa.semester_late_rate >= 15 then 'Moderate Stress Semester'\n            when swa.semester_late_rate >= 10 then 'Low Stress Semester'\n            else 'Well-Managed Semester'\n        end as stress_indicator\n    from semester_workload_analysis swa\n    left join (\n        select\n            course_id,\n            avg(assignments_per_course) as assignments_per_course,\n            avg(assignments_per_credit) as assignments_per_credit,\n            avg(points_per_credit) as points_per_credit\n        from course_workload_analysis\n        group by course_id\n    ) cwa on 1=1  -- Cross join for semester-level aggregation\n    left join (\n        select\n            semester_id,\n            max(assignments_due_this_week) as max_weekly_assignments,\n            max(total_points_due_this_week) as max_weekly_points,\n            avg(assignments_due_this_week) as avg_weekly_assignments\n        from weekly_workload_distribution\n        group by semester_id\n    ) www on swa.semester_id = www.semester_id\n)\n\nselect * from workload_intensity", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.student_retention_analysis": {"database": "postgres", "schema": "edu_dbt", "name": "student_retention_analysis", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/academic/student_retention_analysis.sql", "original_file_path": "models/marts/academic/student_retention_analysis.sql", "unique_id": "model.DbtEducationalDataProject.student_retention_analysis", "fqn": ["DbtEducationalDataProject", "marts", "academic", "student_retention_analysis"], "alias": "student_retention_analysis", "checksum": {"name": "sha256", "checksum": "8ea07babe87ee82c11e39cf93d984764921ec157ba78034b6542f2b80103b271"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2218142, "relation_name": "\"postgres\".\"edu_dbt\".\"student_retention_analysis\"", "raw_code": "{{ config(materialized='table') }}\n\nwith student_progression as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.enrollment_date,\n        s.graduation_date,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        s.years_enrolled,\n        s.age,\n        d.department_name,\n        d.department_code,\n        eh.total_enrollments,\n        eh.total_credits_attempted,\n        eh.total_credits_earned,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        eh.avg_grade_points,\n        eh.avg_attendance,\n        case\n            when s.graduation_date is not null then 'Graduated'\n            when s.student_status = 'dropped' then 'Dropped Out'\n            when s.student_status = 'suspended' then 'Suspended'\n            when s.student_status = 'active' then 'Currently Enrolled'\n            else 'Other Status'\n        end as retention_status,\n        case\n            when s.graduation_date is not null then \n                extract(year from s.graduation_date) - extract(year from s.enrollment_date)\n            else \n                extract(year from current_date) - extract(year from s.enrollment_date)\n        end as years_in_program,\n        round(eh.total_credits_earned::numeric / nullif(eh.total_credits_attempted, 0) * 100, 2) as completion_rate\n    from {{ ref('stg_students') }} s\n    left join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_enrollments) as total_enrollments,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(total_credits_earned) as total_credits_earned,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count,\n            max(avg_grade_points) as avg_grade_points,\n            max(avg_attendance) as avg_attendance\n        from {{ ref('int_student_enrollment_history') }}\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n),\n\nrisk_analysis as (\n    select\n        *,\n        case\n            when retention_status = 'Graduated' then 0\n            when gpa >= 3.5 and avg_attendance >= 90 and failed_courses_count = 0 then 1\n            when gpa >= 3.0 and avg_attendance >= 80 and failed_courses_count <= 1 then 2\n            when gpa >= 2.5 and avg_attendance >= 70 and failed_courses_count <= 2 then 3\n            when gpa >= 2.0 and avg_attendance >= 60 and failed_courses_count <= 3 then 4\n            else 5\n        end as retention_risk_score,\n        case\n            when retention_status = 'Graduated' then 'Successful Completion'\n            when gpa >= 3.5 and avg_attendance >= 90 and failed_courses_count = 0 then 'Excellent - No Risk'\n            when gpa >= 3.0 and avg_attendance >= 80 and failed_courses_count <= 1 then 'Good - Low Risk'\n            when gpa >= 2.5 and avg_attendance >= 70 and failed_courses_count <= 2 then 'Fair - Moderate Risk'\n            when gpa >= 2.0 and avg_attendance >= 60 and failed_courses_count <= 3 then 'Poor - High Risk'\n            else 'Critical - Very High Risk'\n        end as risk_category,\n        case\n            when years_in_program <= 4 and retention_status in ('Currently Enrolled', 'Graduated') then 'On Track'\n            when years_in_program between 5 and 6 and retention_status in ('Currently Enrolled', 'Graduated') then 'Extended Timeline'\n            when years_in_program > 6 and retention_status = 'Currently Enrolled' then 'Significantly Delayed'\n            when retention_status in ('Dropped Out', 'Suspended') then 'Did Not Complete'\n            else 'Unknown'\n        end as completion_timeline_status,\n        case\n            when completion_rate >= 95 then 'Excellent Progress'\n            when completion_rate >= 85 then 'Good Progress'\n            when completion_rate >= 75 then 'Fair Progress'\n            when completion_rate >= 60 then 'Slow Progress'\n            else 'Very Slow Progress'\n        end as progress_category,\n        case\n            when withdrawn_courses_count = 0 then 'No Withdrawals'\n            when withdrawn_courses_count = 1 then 'Minimal Withdrawals'\n            when withdrawn_courses_count <= 3 then 'Some Withdrawals'\n            else 'Many Withdrawals'\n        end as withdrawal_pattern\n    from student_progression\n),\n\ndepartmental_retention as (\n    select\n        department_name,\n        count(*) as total_students,\n        count(case when retention_status = 'Graduated' then 1 end) as graduated_students,\n        count(case when retention_status = 'Currently Enrolled' then 1 end) as currently_enrolled,\n        count(case when retention_status = 'Dropped Out' then 1 end) as dropped_students,\n        count(case when retention_status = 'Suspended' then 1 end) as suspended_students,\n        avg(case when retention_status = 'Graduated' then years_in_program end) as avg_graduation_time,\n        avg(gpa) as dept_avg_gpa,\n        avg(completion_rate) as dept_avg_completion_rate,\n        round(\n            count(case when retention_status = 'Graduated' then 1 end) * 100.0 / \n            nullif(count(case when retention_status in ('Graduated', 'Dropped Out', 'Suspended') then 1 end), 0), 2\n        ) as graduation_rate,\n        round(\n            count(case when retention_status = 'Dropped Out' then 1 end) * 100.0 / \n            nullif(count(*), 0), 2\n        ) as dropout_rate,\n        round(\n            count(case when risk_category like '%High Risk%' or risk_category like '%Critical%' then 1 end) * 100.0 / \n            nullif(count(case when retention_status = 'Currently Enrolled' then 1 end), 0), 2\n        ) as at_risk_percentage\n    from risk_analysis\n    group by department_name\n)\n\nselect \n    ra.*,\n    dr.graduated_students as dept_graduated_students,\n    dr.currently_enrolled as dept_currently_enrolled,\n    dr.graduation_rate as dept_graduation_rate,\n    dr.dropout_rate as dept_dropout_rate,\n    dr.at_risk_percentage as dept_at_risk_percentage,\n    dr.avg_graduation_time as dept_avg_graduation_time,\n    dr.dept_avg_gpa,\n    dr.dept_avg_completion_rate\nfrom risk_analysis ra\nleft join departmental_retention dr on ra.department_name = dr.department_name", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_student_enrollment_history", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_student_enrollment_history"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/academic/student_retention_analysis.sql", "compiled": true, "compiled_code": "\n\nwith student_progression as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.enrollment_date,\n        s.graduation_date,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        s.years_enrolled,\n        s.age,\n        d.department_name,\n        d.department_code,\n        eh.total_enrollments,\n        eh.total_credits_attempted,\n        eh.total_credits_earned,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        eh.avg_grade_points,\n        eh.avg_attendance,\n        case\n            when s.graduation_date is not null then 'Graduated'\n            when s.student_status = 'dropped' then 'Dropped Out'\n            when s.student_status = 'suspended' then 'Suspended'\n            when s.student_status = 'active' then 'Currently Enrolled'\n            else 'Other Status'\n        end as retention_status,\n        case\n            when s.graduation_date is not null then \n                extract(year from s.graduation_date) - extract(year from s.enrollment_date)\n            else \n                extract(year from current_date) - extract(year from s.enrollment_date)\n        end as years_in_program,\n        round(eh.total_credits_earned::numeric / nullif(eh.total_credits_attempted, 0) * 100, 2) as completion_rate\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_enrollments) as total_enrollments,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(total_credits_earned) as total_credits_earned,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count,\n            max(avg_grade_points) as avg_grade_points,\n            max(avg_attendance) as avg_attendance\n        from \"postgres\".\"edu_dbt\".\"int_student_enrollment_history\"\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n),\n\nrisk_analysis as (\n    select\n        *,\n        case\n            when retention_status = 'Graduated' then 0\n            when gpa >= 3.5 and avg_attendance >= 90 and failed_courses_count = 0 then 1\n            when gpa >= 3.0 and avg_attendance >= 80 and failed_courses_count <= 1 then 2\n            when gpa >= 2.5 and avg_attendance >= 70 and failed_courses_count <= 2 then 3\n            when gpa >= 2.0 and avg_attendance >= 60 and failed_courses_count <= 3 then 4\n            else 5\n        end as retention_risk_score,\n        case\n            when retention_status = 'Graduated' then 'Successful Completion'\n            when gpa >= 3.5 and avg_attendance >= 90 and failed_courses_count = 0 then 'Excellent - No Risk'\n            when gpa >= 3.0 and avg_attendance >= 80 and failed_courses_count <= 1 then 'Good - Low Risk'\n            when gpa >= 2.5 and avg_attendance >= 70 and failed_courses_count <= 2 then 'Fair - Moderate Risk'\n            when gpa >= 2.0 and avg_attendance >= 60 and failed_courses_count <= 3 then 'Poor - High Risk'\n            else 'Critical - Very High Risk'\n        end as risk_category,\n        case\n            when years_in_program <= 4 and retention_status in ('Currently Enrolled', 'Graduated') then 'On Track'\n            when years_in_program between 5 and 6 and retention_status in ('Currently Enrolled', 'Graduated') then 'Extended Timeline'\n            when years_in_program > 6 and retention_status = 'Currently Enrolled' then 'Significantly Delayed'\n            when retention_status in ('Dropped Out', 'Suspended') then 'Did Not Complete'\n            else 'Unknown'\n        end as completion_timeline_status,\n        case\n            when completion_rate >= 95 then 'Excellent Progress'\n            when completion_rate >= 85 then 'Good Progress'\n            when completion_rate >= 75 then 'Fair Progress'\n            when completion_rate >= 60 then 'Slow Progress'\n            else 'Very Slow Progress'\n        end as progress_category,\n        case\n            when withdrawn_courses_count = 0 then 'No Withdrawals'\n            when withdrawn_courses_count = 1 then 'Minimal Withdrawals'\n            when withdrawn_courses_count <= 3 then 'Some Withdrawals'\n            else 'Many Withdrawals'\n        end as withdrawal_pattern\n    from student_progression\n),\n\ndepartmental_retention as (\n    select\n        department_name,\n        count(*) as total_students,\n        count(case when retention_status = 'Graduated' then 1 end) as graduated_students,\n        count(case when retention_status = 'Currently Enrolled' then 1 end) as currently_enrolled,\n        count(case when retention_status = 'Dropped Out' then 1 end) as dropped_students,\n        count(case when retention_status = 'Suspended' then 1 end) as suspended_students,\n        avg(case when retention_status = 'Graduated' then years_in_program end) as avg_graduation_time,\n        avg(gpa) as dept_avg_gpa,\n        avg(completion_rate) as dept_avg_completion_rate,\n        round(\n            count(case when retention_status = 'Graduated' then 1 end) * 100.0 / \n            nullif(count(case when retention_status in ('Graduated', 'Dropped Out', 'Suspended') then 1 end), 0), 2\n        ) as graduation_rate,\n        round(\n            count(case when retention_status = 'Dropped Out' then 1 end) * 100.0 / \n            nullif(count(*), 0), 2\n        ) as dropout_rate,\n        round(\n            count(case when risk_category like '%High Risk%' or risk_category like '%Critical%' then 1 end) * 100.0 / \n            nullif(count(case when retention_status = 'Currently Enrolled' then 1 end), 0), 2\n        ) as at_risk_percentage\n    from risk_analysis\n    group by department_name\n)\n\nselect \n    ra.*,\n    dr.graduated_students as dept_graduated_students,\n    dr.currently_enrolled as dept_currently_enrolled,\n    dr.graduation_rate as dept_graduation_rate,\n    dr.dropout_rate as dept_dropout_rate,\n    dr.at_risk_percentage as dept_at_risk_percentage,\n    dr.avg_graduation_time as dept_avg_graduation_time,\n    dr.dept_avg_gpa,\n    dr.dept_avg_completion_rate\nfrom risk_analysis ra\nleft join departmental_retention dr on ra.department_name = dr.department_name", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.student_financial_profile": {"database": "postgres", "schema": "edu_dbt", "name": "student_financial_profile", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/finance/student_financial_profile.sql", "original_file_path": "models/marts/finance/student_financial_profile.sql", "unique_id": "model.DbtEducationalDataProject.student_financial_profile", "fqn": ["DbtEducationalDataProject", "marts", "finance", "student_financial_profile"], "alias": "student_financial_profile", "checksum": {"name": "sha256", "checksum": "415975dc3b677a0b9090d90c86948d1aeb7a0bfcab03a6e21902ec321f909ae9"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.225719, "relation_name": "\"postgres\".\"edu_dbt\".\"student_financial_profile\"", "raw_code": "{{ config(materialized='table') }}\n\nwith student_finances as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        s.years_enrolled,\n        d.department_name as major_department,\n        fa.aid_id,\n        fa.aid_type,\n        fa.aid_category,\n        fa.amount as aid_amount,\n        fa.academic_year as aid_academic_year,\n        fa.support_level,\n        fa.disbursement_period,\n        tp.payment_id,\n        tp.semester_id,\n        tp.amount as payment_amount,\n        tp.payment_date,\n        tp.payment_method_category,\n        tp.late_fee,\n        tp.total_payment,\n        tp.payment_timeliness,\n        tp.payment_size_category,\n        sem.semester_name,\n        sem.academic_year as payment_academic_year\n    from {{ ref('stg_students') }} s\n    left join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join {{ ref('stg_financial_aid') }} fa on s.student_id = fa.student_id\n    left join {{ ref('stg_tuition_payments') }} tp on s.student_id = tp.student_id\n    left join {{ ref('stg_semesters') }} sem on tp.semester_id = sem.semester_id\n),\n\nfinancial_summary as (\n    select\n        student_id,\n        full_name,\n        email,\n        student_status,\n        gpa,\n        academic_standing,\n        years_enrolled,\n        major_department,\n        count(distinct aid_id) as total_aid_awards,\n        sum(aid_amount) as total_aid_received,\n        avg(aid_amount) as avg_aid_amount,\n        count(distinct payment_id) as total_payments_made,\n        sum(payment_amount) as total_tuition_paid,\n        sum(late_fee) as total_late_fees,\n        sum(total_payment) as total_amount_paid,\n        avg(payment_amount) as avg_payment_amount,\n        count(case when payment_timeliness = 'Late Payment' then 1 end) as late_payments_count,\n        round(\n            count(case when payment_timeliness = 'Late Payment' then 1 end) * 100.0 / \n            nullif(count(payment_id), 0), 2\n        ) as late_payment_rate,\n        max(case when aid_category = 'Merit-Based' then aid_amount else 0 end) as max_merit_aid,\n        max(case when aid_category = 'Need-Based' then aid_amount else 0 end) as max_need_aid,\n        max(case when aid_category = 'Loan' then aid_amount else 0 end) as max_loan_amount,\n        count(distinct aid_academic_year) as aid_years_count,\n        count(distinct payment_academic_year) as payment_years_count\n    from student_finances\n    where student_id is not null\n    group by \n        student_id, full_name, email, student_status, gpa, \n        academic_standing, years_enrolled, major_department\n),\n\nfinancial_analysis as (\n    select\n        *,\n        case\n            when total_aid_received >= 20000 then 'High Aid Recipient'\n            when total_aid_received >= 10000 then 'Moderate Aid Recipient'\n            when total_aid_received >= 5000 then 'Low Aid Recipient'\n            when total_aid_received > 0 then 'Minimal Aid Recipient'\n            else 'No Aid Received'\n        end as aid_recipient_category,\n        case\n            when late_payment_rate = 0 then 'Excellent Payment History'\n            when late_payment_rate <= 10 then 'Good Payment History'\n            when late_payment_rate <= 25 then 'Fair Payment History'\n            else 'Poor Payment History'\n        end as payment_reliability,\n        case\n            when total_late_fees = 0 then 'No Late Fees'\n            when total_late_fees <= 100 then 'Minimal Late Fees'\n            when total_late_fees <= 500 then 'Moderate Late Fees'\n            else 'High Late Fees'\n        end as late_fee_category,\n        round(total_aid_received / nullif(years_enrolled, 0), 2) as avg_aid_per_year,\n        round(total_tuition_paid / nullif(years_enrolled, 0), 2) as avg_tuition_per_year,\n        case\n            when max_merit_aid > max_need_aid and max_merit_aid > max_loan_amount then 'Merit-Based Primary'\n            when max_need_aid > max_loan_amount then 'Need-Based Primary'\n            when max_loan_amount > 0 then 'Loan-Based Primary'\n            else 'No Primary Aid Type'\n        end as primary_aid_type\n    from financial_summary\n)\n\nselect * from financial_analysis", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_financial_aid", "package": null, "version": null}, {"name": "stg_tuition_payments", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_tuition_payments", "model.DbtEducationalDataProject.stg_semesters"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/finance/student_financial_profile.sql", "compiled": true, "compiled_code": "\n\nwith student_finances as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        s.years_enrolled,\n        d.department_name as major_department,\n        fa.aid_id,\n        fa.aid_type,\n        fa.aid_category,\n        fa.amount as aid_amount,\n        fa.academic_year as aid_academic_year,\n        fa.support_level,\n        fa.disbursement_period,\n        tp.payment_id,\n        tp.semester_id,\n        tp.amount as payment_amount,\n        tp.payment_date,\n        tp.payment_method_category,\n        tp.late_fee,\n        tp.total_payment,\n        tp.payment_timeliness,\n        tp.payment_size_category,\n        sem.semester_name,\n        sem.academic_year as payment_academic_year\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_financial_aid\" fa on s.student_id = fa.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_tuition_payments\" tp on s.student_id = tp.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on tp.semester_id = sem.semester_id\n),\n\nfinancial_summary as (\n    select\n        student_id,\n        full_name,\n        email,\n        student_status,\n        gpa,\n        academic_standing,\n        years_enrolled,\n        major_department,\n        count(distinct aid_id) as total_aid_awards,\n        sum(aid_amount) as total_aid_received,\n        avg(aid_amount) as avg_aid_amount,\n        count(distinct payment_id) as total_payments_made,\n        sum(payment_amount) as total_tuition_paid,\n        sum(late_fee) as total_late_fees,\n        sum(total_payment) as total_amount_paid,\n        avg(payment_amount) as avg_payment_amount,\n        count(case when payment_timeliness = 'Late Payment' then 1 end) as late_payments_count,\n        round(\n            count(case when payment_timeliness = 'Late Payment' then 1 end) * 100.0 / \n            nullif(count(payment_id), 0), 2\n        ) as late_payment_rate,\n        max(case when aid_category = 'Merit-Based' then aid_amount else 0 end) as max_merit_aid,\n        max(case when aid_category = 'Need-Based' then aid_amount else 0 end) as max_need_aid,\n        max(case when aid_category = 'Loan' then aid_amount else 0 end) as max_loan_amount,\n        count(distinct aid_academic_year) as aid_years_count,\n        count(distinct payment_academic_year) as payment_years_count\n    from student_finances\n    where student_id is not null\n    group by \n        student_id, full_name, email, student_status, gpa, \n        academic_standing, years_enrolled, major_department\n),\n\nfinancial_analysis as (\n    select\n        *,\n        case\n            when total_aid_received >= 20000 then 'High Aid Recipient'\n            when total_aid_received >= 10000 then 'Moderate Aid Recipient'\n            when total_aid_received >= 5000 then 'Low Aid Recipient'\n            when total_aid_received > 0 then 'Minimal Aid Recipient'\n            else 'No Aid Received'\n        end as aid_recipient_category,\n        case\n            when late_payment_rate = 0 then 'Excellent Payment History'\n            when late_payment_rate <= 10 then 'Good Payment History'\n            when late_payment_rate <= 25 then 'Fair Payment History'\n            else 'Poor Payment History'\n        end as payment_reliability,\n        case\n            when total_late_fees = 0 then 'No Late Fees'\n            when total_late_fees <= 100 then 'Minimal Late Fees'\n            when total_late_fees <= 500 then 'Moderate Late Fees'\n            else 'High Late Fees'\n        end as late_fee_category,\n        round(total_aid_received / nullif(years_enrolled, 0), 2) as avg_aid_per_year,\n        round(total_tuition_paid / nullif(years_enrolled, 0), 2) as avg_tuition_per_year,\n        case\n            when max_merit_aid > max_need_aid and max_merit_aid > max_loan_amount then 'Merit-Based Primary'\n            when max_need_aid > max_loan_amount then 'Need-Based Primary'\n            when max_loan_amount > 0 then 'Loan-Based Primary'\n            else 'No Primary Aid Type'\n        end as primary_aid_type\n    from financial_summary\n)\n\nselect * from financial_analysis", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.financial_aid_impact_analysis": {"database": "postgres", "schema": "edu_dbt", "name": "financial_aid_impact_analysis", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/finance/financial_aid_impact_analysis.sql", "original_file_path": "models/marts/finance/financial_aid_impact_analysis.sql", "unique_id": "model.DbtEducationalDataProject.financial_aid_impact_analysis", "fqn": ["DbtEducationalDataProject", "marts", "finance", "financial_aid_impact_analysis"], "alias": "financial_aid_impact_analysis", "checksum": {"name": "sha256", "checksum": "9583571009fe1d1deb655337e887926f90f630bdbad4392fef8b62b481a90618"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2267907, "relation_name": "\"postgres\".\"edu_dbt\".\"financial_aid_impact_analysis\"", "raw_code": "{{ config(materialized='table') }}\n\nwith aid_impact as (\n    select\n        fa.student_id,\n        s.full_name,\n        s.gpa,\n        s.academic_standing,\n        s.student_status,\n        s.years_enrolled,\n        d.department_name,\n        d.department_code,\n        fa.aid_type,\n        fa.aid_category,\n        fa.amount as aid_amount,\n        fa.academic_year,\n        fa.support_level,\n        fa.disbursement_period,\n        eh.total_enrollments,\n        eh.total_credits_earned,\n        eh.avg_grade_points,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        case when fa.student_id is not null then 1 else 0 end as receives_aid\n    from {{ ref('stg_financial_aid') }} fa\n    right join {{ ref('stg_students') }} s on fa.student_id = s.student_id\n    left join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_enrollments) as total_enrollments,\n            max(total_credits_earned) as total_credits_earned,\n            max(avg_grade_points) as avg_grade_points,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count\n        from {{ ref('int_student_enrollment_history') }}\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n),\n\naid_summary as (\n    select\n        student_id,\n        full_name,\n        gpa,\n        academic_standing,\n        student_status,\n        years_enrolled,\n        department_name,\n        department_code,\n        total_enrollments,\n        total_credits_earned,\n        avg_grade_points,\n        failed_courses_count,\n        withdrawn_courses_count,\n        sum(case when receives_aid = 1 then aid_amount else 0 end) as total_aid_received,\n        count(case when receives_aid = 1 then 1 end) as aid_awards_count,\n        max(case when aid_category = 'Merit-Based' then aid_amount else 0 end) as merit_aid,\n        max(case when aid_category = 'Need-Based' then aid_amount else 0 end) as need_based_aid,\n        max(case when aid_category = 'Loan' then aid_amount else 0 end) as loan_aid,\n        max(case when aid_category = 'Work-Study' then aid_amount else 0 end) as work_study_aid,\n        max(receives_aid) as receives_any_aid\n    from aid_impact\n    group by \n        student_id, full_name, gpa, academic_standing, student_status, \n        years_enrolled, department_name, department_code, total_enrollments, \n        total_credits_earned, avg_grade_points, failed_courses_count, withdrawn_courses_count\n),\n\nimpact_analysis as (\n    select\n        *,\n        case\n            when receives_any_aid = 1 then 'Aid Recipient'\n            else 'No Aid'\n        end as aid_status,\n        case\n            when total_aid_received >= 15000 then 'High Aid'\n            when total_aid_received >= 8000 then 'Moderate Aid'\n            when total_aid_received >= 3000 then 'Low Aid'\n            when total_aid_received > 0 then 'Minimal Aid'\n            else 'No Aid'\n        end as aid_level,\n        case\n            when merit_aid > need_based_aid and merit_aid > loan_aid then 'Merit Primary'\n            when need_based_aid > loan_aid then 'Need Primary'\n            when loan_aid > 0 then 'Loan Primary'\n            else 'No Primary Type'\n        end as primary_aid_type,\n        round(total_aid_received / nullif(years_enrolled, 0), 2) as aid_per_year,\n        case\n            when gpa >= 3.5 and receives_any_aid = 1 then 'High Performing Aid Recipient'\n            when gpa >= 3.0 and receives_any_aid = 1 then 'Good Performing Aid Recipient'\n            when gpa < 3.0 and receives_any_aid = 1 then 'At-Risk Aid Recipient'\n            when gpa >= 3.5 and receives_any_aid = 0 then 'High Performing No Aid'\n            when gpa >= 3.0 and receives_any_aid = 0 then 'Good Performing No Aid'\n            else 'At-Risk No Aid'\n        end as performance_aid_category\n    from aid_summary\n),\n\ndepartmental_aid_stats as (\n    select\n        department_name,\n        count(*) as total_students_in_dept,\n        count(case when receives_any_aid = 1 then 1 end) as aid_recipients_in_dept,\n        avg(case when receives_any_aid = 1 then gpa end) as avg_gpa_aid_recipients,\n        avg(case when receives_any_aid = 0 then gpa end) as avg_gpa_no_aid,\n        avg(case when receives_any_aid = 1 then total_aid_received end) as avg_aid_amount,\n        round(\n            count(case when receives_any_aid = 1 then 1 end) * 100.0 / \n            nullif(count(*), 0), 2\n        ) as aid_recipient_percentage\n    from impact_analysis\n    group by department_name\n)\n\nselect \n    ia.*,\n    das.aid_recipients_in_dept,\n    das.avg_gpa_aid_recipients as dept_avg_gpa_aid_recipients,\n    das.avg_gpa_no_aid as dept_avg_gpa_no_aid,\n    das.avg_aid_amount as dept_avg_aid_amount,\n    das.aid_recipient_percentage as dept_aid_percentage,\n    case\n        when das.avg_gpa_aid_recipients > das.avg_gpa_no_aid then 'Aid Recipients Outperform'\n        when das.avg_gpa_aid_recipients < das.avg_gpa_no_aid then 'Non-Aid Recipients Outperform'\n        else 'Similar Performance'\n    end as dept_aid_performance_comparison\nfrom impact_analysis ia\nleft join departmental_aid_stats das on ia.department_name = das.department_name", "language": "sql", "refs": [{"name": "stg_financial_aid", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_student_enrollment_history", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_student_enrollment_history"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/finance/financial_aid_impact_analysis.sql", "compiled": true, "compiled_code": "\n\nwith aid_impact as (\n    select\n        fa.student_id,\n        s.full_name,\n        s.gpa,\n        s.academic_standing,\n        s.student_status,\n        s.years_enrolled,\n        d.department_name,\n        d.department_code,\n        fa.aid_type,\n        fa.aid_category,\n        fa.amount as aid_amount,\n        fa.academic_year,\n        fa.support_level,\n        fa.disbursement_period,\n        eh.total_enrollments,\n        eh.total_credits_earned,\n        eh.avg_grade_points,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        case when fa.student_id is not null then 1 else 0 end as receives_aid\n    from \"postgres\".\"edu_dbt\".\"stg_financial_aid\" fa\n    right join \"postgres\".\"edu_dbt\".\"stg_students\" s on fa.student_id = s.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_enrollments) as total_enrollments,\n            max(total_credits_earned) as total_credits_earned,\n            max(avg_grade_points) as avg_grade_points,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count\n        from \"postgres\".\"edu_dbt\".\"int_student_enrollment_history\"\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n),\n\naid_summary as (\n    select\n        student_id,\n        full_name,\n        gpa,\n        academic_standing,\n        student_status,\n        years_enrolled,\n        department_name,\n        department_code,\n        total_enrollments,\n        total_credits_earned,\n        avg_grade_points,\n        failed_courses_count,\n        withdrawn_courses_count,\n        sum(case when receives_aid = 1 then aid_amount else 0 end) as total_aid_received,\n        count(case when receives_aid = 1 then 1 end) as aid_awards_count,\n        max(case when aid_category = 'Merit-Based' then aid_amount else 0 end) as merit_aid,\n        max(case when aid_category = 'Need-Based' then aid_amount else 0 end) as need_based_aid,\n        max(case when aid_category = 'Loan' then aid_amount else 0 end) as loan_aid,\n        max(case when aid_category = 'Work-Study' then aid_amount else 0 end) as work_study_aid,\n        max(receives_aid) as receives_any_aid\n    from aid_impact\n    group by \n        student_id, full_name, gpa, academic_standing, student_status, \n        years_enrolled, department_name, department_code, total_enrollments, \n        total_credits_earned, avg_grade_points, failed_courses_count, withdrawn_courses_count\n),\n\nimpact_analysis as (\n    select\n        *,\n        case\n            when receives_any_aid = 1 then 'Aid Recipient'\n            else 'No Aid'\n        end as aid_status,\n        case\n            when total_aid_received >= 15000 then 'High Aid'\n            when total_aid_received >= 8000 then 'Moderate Aid'\n            when total_aid_received >= 3000 then 'Low Aid'\n            when total_aid_received > 0 then 'Minimal Aid'\n            else 'No Aid'\n        end as aid_level,\n        case\n            when merit_aid > need_based_aid and merit_aid > loan_aid then 'Merit Primary'\n            when need_based_aid > loan_aid then 'Need Primary'\n            when loan_aid > 0 then 'Loan Primary'\n            else 'No Primary Type'\n        end as primary_aid_type,\n        round(total_aid_received / nullif(years_enrolled, 0), 2) as aid_per_year,\n        case\n            when gpa >= 3.5 and receives_any_aid = 1 then 'High Performing Aid Recipient'\n            when gpa >= 3.0 and receives_any_aid = 1 then 'Good Performing Aid Recipient'\n            when gpa < 3.0 and receives_any_aid = 1 then 'At-Risk Aid Recipient'\n            when gpa >= 3.5 and receives_any_aid = 0 then 'High Performing No Aid'\n            when gpa >= 3.0 and receives_any_aid = 0 then 'Good Performing No Aid'\n            else 'At-Risk No Aid'\n        end as performance_aid_category\n    from aid_summary\n),\n\ndepartmental_aid_stats as (\n    select\n        department_name,\n        count(*) as total_students_in_dept,\n        count(case when receives_any_aid = 1 then 1 end) as aid_recipients_in_dept,\n        avg(case when receives_any_aid = 1 then gpa end) as avg_gpa_aid_recipients,\n        avg(case when receives_any_aid = 0 then gpa end) as avg_gpa_no_aid,\n        avg(case when receives_any_aid = 1 then total_aid_received end) as avg_aid_amount,\n        round(\n            count(case when receives_any_aid = 1 then 1 end) * 100.0 / \n            nullif(count(*), 0), 2\n        ) as aid_recipient_percentage\n    from impact_analysis\n    group by department_name\n)\n\nselect \n    ia.*,\n    das.aid_recipients_in_dept,\n    das.avg_gpa_aid_recipients as dept_avg_gpa_aid_recipients,\n    das.avg_gpa_no_aid as dept_avg_gpa_no_aid,\n    das.avg_aid_amount as dept_avg_aid_amount,\n    das.aid_recipient_percentage as dept_aid_percentage,\n    case\n        when das.avg_gpa_aid_recipients > das.avg_gpa_no_aid then 'Aid Recipients Outperform'\n        when das.avg_gpa_aid_recipients < das.avg_gpa_no_aid then 'Non-Aid Recipients Outperform'\n        else 'Similar Performance'\n    end as dept_aid_performance_comparison\nfrom impact_analysis ia\nleft join departmental_aid_stats das on ia.department_name = das.department_name", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.institutional_revenue_optimization": {"database": "postgres", "schema": "edu_dbt", "name": "institutional_revenue_optimization", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/finance/institutional_revenue_optimization.sql", "original_file_path": "models/marts/finance/institutional_revenue_optimization.sql", "unique_id": "model.DbtEducationalDataProject.institutional_revenue_optimization", "fqn": ["DbtEducationalDataProject", "marts", "finance", "institutional_revenue_optimization"], "alias": "institutional_revenue_optimization", "checksum": {"name": "sha256", "checksum": "b0d67766b3d61c67163cbe84f3804c5fa2ee06b6efd22cf3ebe442aacf306515"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2277672, "relation_name": "\"postgres\".\"edu_dbt\".\"institutional_revenue_optimization\"", "raw_code": "{{ config(materialized='table') }}\n\nwith revenue_streams as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        d.department_id,\n        d.department_name,\n        d.budget as department_budget,\n        count(distinct tp.student_id) as paying_students,\n        count(distinct e.enrollment_id) as total_enrollments,\n        sum(tp.amount) as tuition_revenue,\n        sum(tp.late_fee) as late_fee_revenue,\n        sum(tp.total_payment) as total_payment_revenue,\n        sum(fa.amount) as financial_aid_disbursed,\n        sum(c.credits * 500) as potential_tuition_at_standard_rate,  -- $500 per credit hour\n        avg(tp.amount) as avg_tuition_per_student,\n        sum(f.salary) as faculty_salary_costs,\n        count(distinct f.faculty_id) as faculty_count\n    from {{ ref('stg_semesters') }} sem\n    left join {{ ref('stg_enrollments') }} e on sem.semester_id = e.semester_id\n    left join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    left join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    left join {{ ref('stg_tuition_payments') }} tp on sem.semester_id = tp.semester_id and e.student_id = tp.student_id\n    left join {{ ref('stg_financial_aid') }} fa on e.student_id = fa.student_id\n    left join {{ ref('stg_class_sessions') }} cs on c.course_id = cs.course_id and sem.semester_id = cs.semester_id\n    left join {{ ref('stg_faculty') }} f on cs.faculty_id = f.faculty_id\n    group by \n        sem.semester_id, sem.semester_name, sem.academic_year, sem.semester_type,\n        d.department_id, d.department_name, d.budget\n),\n\ncost_analysis as (\n    select\n        rs.*,\n        -- Revenue metrics\n        tuition_revenue - financial_aid_disbursed as net_tuition_revenue,\n        potential_tuition_at_standard_rate - tuition_revenue as tuition_revenue_gap,\n        round(tuition_revenue / nullif(potential_tuition_at_standard_rate, 0) * 100, 2) as tuition_collection_rate,\n        \n        -- Cost metrics\n        faculty_salary_costs + (department_budget * 0.3) as estimated_total_costs,  -- Assuming 30% of budget for operations\n        round(faculty_salary_costs / nullif(total_enrollments, 0), 2) as cost_per_enrollment,\n        round(tuition_revenue / nullif(faculty_salary_costs, 0), 2) as revenue_to_faculty_cost_ratio,\n        \n        -- Efficiency metrics\n        round(total_enrollments::numeric / nullif(faculty_count, 0), 2) as student_faculty_ratio,\n        round(tuition_revenue / nullif(paying_students, 0), 2) as revenue_per_paying_student,\n        round(total_enrollments::numeric / nullif(paying_students, 0), 2) as enrollment_to_payment_ratio,\n        \n        -- Aid impact\n        round(financial_aid_disbursed / nullif(tuition_revenue + financial_aid_disbursed, 0) * 100, 2) as aid_percentage_of_gross_tuition\n    from revenue_streams rs\n),\n\noptimization_opportunities as (\n    select\n        ca.*,\n        -- Profitability analysis\n        tuition_revenue - (faculty_salary_costs + (department_budget * 0.3)) as estimated_profit_loss,\n        case\n            when tuition_revenue - (faculty_salary_costs + (department_budget * 0.3)) > 0 then 'Profitable'\n            when tuition_revenue - (faculty_salary_costs + (department_budget * 0.3)) > -50000 then 'Break Even'\n            when tuition_revenue - (faculty_salary_costs + (department_budget * 0.3)) > -100000 then 'Minor Loss'\n            else 'Major Loss'\n        end as profitability_status,\n        \n        -- Optimization categories\n        case\n            when tuition_collection_rate < 80 then 'High Collection Risk'\n            when tuition_collection_rate < 90 then 'Moderate Collection Risk'\n            else 'Good Collection'\n        end as collection_risk_category,\n        \n        case\n            when student_faculty_ratio > 25 then 'Potential Faculty Shortage'\n            when student_faculty_ratio < 10 then 'Potential Over-Staffing'\n            else 'Optimal Staffing'\n        end as staffing_optimization,\n        \n        case\n            when aid_percentage_of_gross_tuition > 40 then 'High Aid Dependency'\n            when aid_percentage_of_gross_tuition > 25 then 'Moderate Aid Dependency'\n            else 'Low Aid Dependency'\n        end as aid_dependency_level,\n        \n        -- Revenue optimization opportunities\n        case\n            when tuition_revenue_gap > 100000 then 'High Revenue Opportunity'\n            when tuition_revenue_gap > 50000 then 'Moderate Revenue Opportunity'\n            when tuition_revenue_gap > 0 then 'Small Revenue Opportunity'\n            else 'Revenue Maximized'\n        end as revenue_opportunity_level,\n        \n        -- Cost optimization recommendations\n        case\n            when cost_per_enrollment > 2000 then 'Review Cost Structure'\n            when revenue_to_faculty_cost_ratio < 1.5 then 'Faculty Cost Efficiency Concern'\n            when student_faculty_ratio < 12 then 'Consider Course Consolidation'\n            when enrollment_to_payment_ratio > 1.2 then 'Payment Collection Issues'\n            else 'Cost Structure Acceptable'\n        end as cost_optimization_recommendation\n    from cost_analysis ca\n),\n\nstrategic_insights as (\n    select\n        oo.*,\n        -- Strategic recommendations\n        case\n            when profitability_status in ('Minor Loss', 'Major Loss') and revenue_opportunity_level like '%High%' then \n                'Focus on enrollment growth and tuition collection'\n            when profitability_status in ('Minor Loss', 'Major Loss') and staffing_optimization = 'Potential Over-Staffing' then\n                'Consider faculty optimization or course load increase'\n            when collection_risk_category != 'Good Collection' then\n                'Implement enhanced payment collection strategies'\n            when aid_dependency_level = 'High Aid Dependency' then\n                'Diversify revenue streams and review aid policies'\n            when revenue_opportunity_level like '%High%' then\n                'Expand program capacity and marketing'\n            else 'Maintain current operations with minor optimizations'\n        end as primary_strategic_recommendation,\n        \n        -- Financial health score (0-100)\n        round(\n            (case when profitability_status = 'Profitable' then 30\n                  when profitability_status = 'Break Even' then 20\n                  when profitability_status = 'Minor Loss' then 10\n                  else 0 end) +\n            (case when tuition_collection_rate >= 95 then 25\n                  when tuition_collection_rate >= 85 then 20\n                  when tuition_collection_rate >= 75 then 15\n                  else 10 end) +\n            (case when student_faculty_ratio between 15 and 25 then 25\n                  when student_faculty_ratio between 10 and 30 then 20\n                  when student_faculty_ratio between 8 and 35 then 15\n                  else 10 end) +\n            (case when aid_dependency_level = 'Low Aid Dependency' then 20\n                  when aid_dependency_level = 'Moderate Aid Dependency' then 15\n                  else 10 end), 0\n        ) as financial_health_score,\n        \n        -- Risk level\n        case\n            when estimated_profit_loss < -100000 and tuition_collection_rate < 75 then 'High Risk'\n            when estimated_profit_loss < -50000 or tuition_collection_rate < 80 then 'Moderate Risk'\n            when estimated_profit_loss < 0 or tuition_collection_rate < 90 then 'Low Risk'\n            else 'Low Risk'\n        end as financial_risk_level\n    from optimization_opportunities oo\n)\n\nselect * from strategic_insights\norder by financial_health_score desc, department_name", "language": "sql", "refs": [{"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_tuition_payments", "package": null, "version": null}, {"name": "stg_financial_aid", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_tuition_payments", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_faculty"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/finance/institutional_revenue_optimization.sql", "compiled": true, "compiled_code": "\n\nwith revenue_streams as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        d.department_id,\n        d.department_name,\n        d.budget as department_budget,\n        count(distinct tp.student_id) as paying_students,\n        count(distinct e.enrollment_id) as total_enrollments,\n        sum(tp.amount) as tuition_revenue,\n        sum(tp.late_fee) as late_fee_revenue,\n        sum(tp.total_payment) as total_payment_revenue,\n        sum(fa.amount) as financial_aid_disbursed,\n        sum(c.credits * 500) as potential_tuition_at_standard_rate,  -- $500 per credit hour\n        avg(tp.amount) as avg_tuition_per_student,\n        sum(f.salary) as faculty_salary_costs,\n        count(distinct f.faculty_id) as faculty_count\n    from \"postgres\".\"edu_dbt\".\"stg_semesters\" sem\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on sem.semester_id = e.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_tuition_payments\" tp on sem.semester_id = tp.semester_id and e.student_id = tp.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_financial_aid\" fa on e.student_id = fa.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on c.course_id = cs.course_id and sem.semester_id = cs.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on cs.faculty_id = f.faculty_id\n    group by \n        sem.semester_id, sem.semester_name, sem.academic_year, sem.semester_type,\n        d.department_id, d.department_name, d.budget\n),\n\ncost_analysis as (\n    select\n        rs.*,\n        -- Revenue metrics\n        tuition_revenue - financial_aid_disbursed as net_tuition_revenue,\n        potential_tuition_at_standard_rate - tuition_revenue as tuition_revenue_gap,\n        round(tuition_revenue / nullif(potential_tuition_at_standard_rate, 0) * 100, 2) as tuition_collection_rate,\n        \n        -- Cost metrics\n        faculty_salary_costs + (department_budget * 0.3) as estimated_total_costs,  -- Assuming 30% of budget for operations\n        round(faculty_salary_costs / nullif(total_enrollments, 0), 2) as cost_per_enrollment,\n        round(tuition_revenue / nullif(faculty_salary_costs, 0), 2) as revenue_to_faculty_cost_ratio,\n        \n        -- Efficiency metrics\n        round(total_enrollments::numeric / nullif(faculty_count, 0), 2) as student_faculty_ratio,\n        round(tuition_revenue / nullif(paying_students, 0), 2) as revenue_per_paying_student,\n        round(total_enrollments::numeric / nullif(paying_students, 0), 2) as enrollment_to_payment_ratio,\n        \n        -- Aid impact\n        round(financial_aid_disbursed / nullif(tuition_revenue + financial_aid_disbursed, 0) * 100, 2) as aid_percentage_of_gross_tuition\n    from revenue_streams rs\n),\n\noptimization_opportunities as (\n    select\n        ca.*,\n        -- Profitability analysis\n        tuition_revenue - (faculty_salary_costs + (department_budget * 0.3)) as estimated_profit_loss,\n        case\n            when tuition_revenue - (faculty_salary_costs + (department_budget * 0.3)) > 0 then 'Profitable'\n            when tuition_revenue - (faculty_salary_costs + (department_budget * 0.3)) > -50000 then 'Break Even'\n            when tuition_revenue - (faculty_salary_costs + (department_budget * 0.3)) > -100000 then 'Minor Loss'\n            else 'Major Loss'\n        end as profitability_status,\n        \n        -- Optimization categories\n        case\n            when tuition_collection_rate < 80 then 'High Collection Risk'\n            when tuition_collection_rate < 90 then 'Moderate Collection Risk'\n            else 'Good Collection'\n        end as collection_risk_category,\n        \n        case\n            when student_faculty_ratio > 25 then 'Potential Faculty Shortage'\n            when student_faculty_ratio < 10 then 'Potential Over-Staffing'\n            else 'Optimal Staffing'\n        end as staffing_optimization,\n        \n        case\n            when aid_percentage_of_gross_tuition > 40 then 'High Aid Dependency'\n            when aid_percentage_of_gross_tuition > 25 then 'Moderate Aid Dependency'\n            else 'Low Aid Dependency'\n        end as aid_dependency_level,\n        \n        -- Revenue optimization opportunities\n        case\n            when tuition_revenue_gap > 100000 then 'High Revenue Opportunity'\n            when tuition_revenue_gap > 50000 then 'Moderate Revenue Opportunity'\n            when tuition_revenue_gap > 0 then 'Small Revenue Opportunity'\n            else 'Revenue Maximized'\n        end as revenue_opportunity_level,\n        \n        -- Cost optimization recommendations\n        case\n            when cost_per_enrollment > 2000 then 'Review Cost Structure'\n            when revenue_to_faculty_cost_ratio < 1.5 then 'Faculty Cost Efficiency Concern'\n            when student_faculty_ratio < 12 then 'Consider Course Consolidation'\n            when enrollment_to_payment_ratio > 1.2 then 'Payment Collection Issues'\n            else 'Cost Structure Acceptable'\n        end as cost_optimization_recommendation\n    from cost_analysis ca\n),\n\nstrategic_insights as (\n    select\n        oo.*,\n        -- Strategic recommendations\n        case\n            when profitability_status in ('Minor Loss', 'Major Loss') and revenue_opportunity_level like '%High%' then \n                'Focus on enrollment growth and tuition collection'\n            when profitability_status in ('Minor Loss', 'Major Loss') and staffing_optimization = 'Potential Over-Staffing' then\n                'Consider faculty optimization or course load increase'\n            when collection_risk_category != 'Good Collection' then\n                'Implement enhanced payment collection strategies'\n            when aid_dependency_level = 'High Aid Dependency' then\n                'Diversify revenue streams and review aid policies'\n            when revenue_opportunity_level like '%High%' then\n                'Expand program capacity and marketing'\n            else 'Maintain current operations with minor optimizations'\n        end as primary_strategic_recommendation,\n        \n        -- Financial health score (0-100)\n        round(\n            (case when profitability_status = 'Profitable' then 30\n                  when profitability_status = 'Break Even' then 20\n                  when profitability_status = 'Minor Loss' then 10\n                  else 0 end) +\n            (case when tuition_collection_rate >= 95 then 25\n                  when tuition_collection_rate >= 85 then 20\n                  when tuition_collection_rate >= 75 then 15\n                  else 10 end) +\n            (case when student_faculty_ratio between 15 and 25 then 25\n                  when student_faculty_ratio between 10 and 30 then 20\n                  when student_faculty_ratio between 8 and 35 then 15\n                  else 10 end) +\n            (case when aid_dependency_level = 'Low Aid Dependency' then 20\n                  when aid_dependency_level = 'Moderate Aid Dependency' then 15\n                  else 10 end), 0\n        ) as financial_health_score,\n        \n        -- Risk level\n        case\n            when estimated_profit_loss < -100000 and tuition_collection_rate < 75 then 'High Risk'\n            when estimated_profit_loss < -50000 or tuition_collection_rate < 80 then 'Moderate Risk'\n            when estimated_profit_loss < 0 or tuition_collection_rate < 90 then 'Low Risk'\n            else 'Low Risk'\n        end as financial_risk_level\n    from optimization_opportunities oo\n)\n\nselect * from strategic_insights\norder by financial_health_score desc, department_name", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.tuition_revenue_analysis": {"database": "postgres", "schema": "edu_dbt", "name": "tuition_revenue_analysis", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/finance/tuition_revenue_analysis.sql", "original_file_path": "models/marts/finance/tuition_revenue_analysis.sql", "unique_id": "model.DbtEducationalDataProject.tuition_revenue_analysis", "fqn": ["DbtEducationalDataProject", "marts", "finance", "tuition_revenue_analysis"], "alias": "tuition_revenue_analysis", "checksum": {"name": "sha256", "checksum": "bec1f48b37a1f152a449516894ec9f4a22572304b72f42d278757f5ad99023fa"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764371903.2291434, "relation_name": "\"postgres\".\"edu_dbt\".\"tuition_revenue_analysis\"", "raw_code": "{{ config(materialized='table') }}\n\nwith tuition_data as (\n    select\n        tp.payment_id,\n        tp.student_id,\n        tp.semester_id,\n        tp.amount,\n        tp.payment_date,\n        tp.payment_method_category,\n        tp.late_fee,\n        tp.total_payment,\n        tp.payment_timeliness,\n        tp.payment_year,\n        tp.payment_month,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        sem.start_date as semester_start,\n        sem.end_date as semester_end,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        s.major_id,\n        d.department_name,\n        d.department_code,\n        d.budget as department_budget,\n        extract(quarter from tp.payment_date) as payment_quarter\n    from {{ ref('stg_tuition_payments') }} tp\n    left join {{ ref('stg_semesters') }} sem on tp.semester_id = sem.semester_id\n    left join {{ ref('stg_students') }} s on tp.student_id = s.student_id\n    left join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n),\n\nrevenue_metrics as (\n    select\n        semester_id,\n        semester_name,\n        academic_year,\n        semester_type,\n        semester_start,\n        semester_end,\n        department_name,\n        department_code,\n        payment_year,\n        payment_quarter,\n        count(distinct payment_id) as total_payments,\n        count(distinct student_id) as paying_students,\n        sum(amount) as total_tuition_revenue,\n        sum(late_fee) as total_late_fees,\n        sum(total_payment) as total_revenue_with_fees,\n        avg(amount) as avg_tuition_payment,\n        min(amount) as min_payment,\n        max(amount) as max_payment,\n        count(case when payment_timeliness = 'Late Payment' then 1 end) as late_payments,\n        count(case when payment_method_category = 'Credit Card' then 1 end) as credit_card_payments,\n        count(case when payment_method_category = 'Bank Transfer' then 1 end) as bank_transfer_payments,\n        count(case when payment_method_category = 'Check' then 1 end) as check_payments,\n        round(\n            count(case when payment_timeliness = 'Late Payment' then 1 end) * 100.0 / \n            nullif(count(payment_id), 0), 2\n        ) as late_payment_percentage,\n        round(\n            sum(late_fee) * 100.0 / nullif(sum(total_payment), 0), 2\n        ) as late_fee_percentage_of_revenue\n    from tuition_data\n    group by \n        semester_id, semester_name, academic_year, semester_type, semester_start, \n        semester_end, department_name, department_code, payment_year, payment_quarter\n),\n\ncomparative_analysis as (\n    select\n        *,\n        lag(total_tuition_revenue) over (\n            partition by department_name \n            order by payment_year, payment_quarter\n        ) as prev_period_revenue,\n        round(\n            (total_tuition_revenue - lag(total_tuition_revenue) over (\n                partition by department_name \n                order by payment_year, payment_quarter\n            )) * 100.0 / nullif(lag(total_tuition_revenue) over (\n                partition by department_name \n                order by payment_year, payment_quarter\n            ), 0), 2\n        ) as revenue_growth_rate,\n        case\n            when total_tuition_revenue >= 100000 then 'High Revenue'\n            when total_tuition_revenue >= 50000 then 'Moderate Revenue'\n            when total_tuition_revenue >= 25000 then 'Low Revenue'\n            else 'Minimal Revenue'\n        end as revenue_category,\n        case\n            when late_payment_percentage >= 20 then 'High Collection Risk'\n            when late_payment_percentage >= 10 then 'Moderate Collection Risk'\n            when late_payment_percentage >= 5 then 'Low Collection Risk'\n            else 'Minimal Collection Risk'\n        end as collection_risk_category,\n        round(total_tuition_revenue / nullif(paying_students, 0), 2) as revenue_per_student,\n        round(total_late_fees / nullif(late_payments, 0), 2) as avg_late_fee_per_late_payment\n    from revenue_metrics\n)\n\nselect * from comparative_analysis", "language": "sql", "refs": [{"name": "stg_tuition_payments", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_tuition_payments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/finance/tuition_revenue_analysis.sql", "compiled": true, "compiled_code": "\n\nwith tuition_data as (\n    select\n        tp.payment_id,\n        tp.student_id,\n        tp.semester_id,\n        tp.amount,\n        tp.payment_date,\n        tp.payment_method_category,\n        tp.late_fee,\n        tp.total_payment,\n        tp.payment_timeliness,\n        tp.payment_year,\n        tp.payment_month,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        sem.start_date as semester_start,\n        sem.end_date as semester_end,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        s.major_id,\n        d.department_name,\n        d.department_code,\n        d.budget as department_budget,\n        extract(quarter from tp.payment_date) as payment_quarter\n    from \"postgres\".\"edu_dbt\".\"stg_tuition_payments\" tp\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on tp.semester_id = sem.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on tp.student_id = s.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n),\n\nrevenue_metrics as (\n    select\n        semester_id,\n        semester_name,\n        academic_year,\n        semester_type,\n        semester_start,\n        semester_end,\n        department_name,\n        department_code,\n        payment_year,\n        payment_quarter,\n        count(distinct payment_id) as total_payments,\n        count(distinct student_id) as paying_students,\n        sum(amount) as total_tuition_revenue,\n        sum(late_fee) as total_late_fees,\n        sum(total_payment) as total_revenue_with_fees,\n        avg(amount) as avg_tuition_payment,\n        min(amount) as min_payment,\n        max(amount) as max_payment,\n        count(case when payment_timeliness = 'Late Payment' then 1 end) as late_payments,\n        count(case when payment_method_category = 'Credit Card' then 1 end) as credit_card_payments,\n        count(case when payment_method_category = 'Bank Transfer' then 1 end) as bank_transfer_payments,\n        count(case when payment_method_category = 'Check' then 1 end) as check_payments,\n        round(\n            count(case when payment_timeliness = 'Late Payment' then 1 end) * 100.0 / \n            nullif(count(payment_id), 0), 2\n        ) as late_payment_percentage,\n        round(\n            sum(late_fee) * 100.0 / nullif(sum(total_payment), 0), 2\n        ) as late_fee_percentage_of_revenue\n    from tuition_data\n    group by \n        semester_id, semester_name, academic_year, semester_type, semester_start, \n        semester_end, department_name, department_code, payment_year, payment_quarter\n),\n\ncomparative_analysis as (\n    select\n        *,\n        lag(total_tuition_revenue) over (\n            partition by department_name \n            order by payment_year, payment_quarter\n        ) as prev_period_revenue,\n        round(\n            (total_tuition_revenue - lag(total_tuition_revenue) over (\n                partition by department_name \n                order by payment_year, payment_quarter\n            )) * 100.0 / nullif(lag(total_tuition_revenue) over (\n                partition by department_name \n                order by payment_year, payment_quarter\n            ), 0), 2\n        ) as revenue_growth_rate,\n        case\n            when total_tuition_revenue >= 100000 then 'High Revenue'\n            when total_tuition_revenue >= 50000 then 'Moderate Revenue'\n            when total_tuition_revenue >= 25000 then 'Low Revenue'\n            else 'Minimal Revenue'\n        end as revenue_category,\n        case\n            when late_payment_percentage >= 20 then 'High Collection Risk'\n            when late_payment_percentage >= 10 then 'Moderate Collection Risk'\n            when late_payment_percentage >= 5 then 'Low Collection Risk'\n            else 'Minimal Collection Risk'\n        end as collection_risk_category,\n        round(total_tuition_revenue / nullif(paying_students, 0), 2) as revenue_per_student,\n        round(total_late_fees / nullif(late_payments, 0), 2) as avg_late_fee_per_late_payment\n    from revenue_metrics\n)\n\nselect * from comparative_analysis", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_faculty_teaching_load": {"database": "postgres", "schema": "edu_dbt", "name": "int_faculty_teaching_load", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_faculty_teaching_load.sql", "original_file_path": "models/intermediate/int_faculty_teaching_load.sql", "unique_id": "model.DbtEducationalDataProject.int_faculty_teaching_load", "fqn": ["DbtEducationalDataProject", "intermediate", "int_faculty_teaching_load"], "alias": "int_faculty_teaching_load", "checksum": {"name": "sha256", "checksum": "d74ca72164c9075e3049f9ddd01421ad8d145f76e98234fc152ebf8bd67ab690"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.233333, "relation_name": "\"postgres\".\"edu_dbt\".\"int_faculty_teaching_load\"", "raw_code": "{{ config(materialized='view') }}\n\nwith faculty_courses as (\n    select\n        f.faculty_id,\n        f.full_name as faculty_name,\n        f.position,\n        f.salary,\n        f.department_id,\n        f.years_of_service,\n        f.salary_band,\n        d.department_name,\n        d.department_code,\n        cs.course_id,\n        cs.semester_id,\n        cs.session_date,\n        cs.session_time,\n        cs.time_block,\n        cs.attendance_count,\n        c.course_code,\n        c.course_name,\n        c.credits,\n        c.difficulty_level,\n        sem.semester_name,\n        sem.academic_year,\n        e.enrollment_id,\n        e.student_id\n    from {{ ref('stg_faculty') }} f\n    left join {{ ref('stg_departments') }} d on f.department_id = d.department_id\n    left join {{ ref('stg_class_sessions') }} cs on f.faculty_id = cs.faculty_id\n    left join {{ ref('stg_courses') }} c on cs.course_id = c.course_id\n    left join {{ ref('stg_semesters') }} sem on cs.semester_id = sem.semester_id\n    left join {{ ref('stg_enrollments') }} e on c.course_id = e.course_id and sem.semester_id = e.semester_id\n),\n\nfaculty_metrics as (\n    select\n        faculty_id,\n        faculty_name,\n        position,\n        salary,\n        department_id,\n        years_of_service,\n        salary_band,\n        department_name,\n        department_code,\n        count(distinct course_id) as unique_courses_taught,\n        count(distinct semester_id) as semesters_active,\n        count(distinct session_date) as total_class_sessions,\n        count(distinct enrollment_id) as total_students_taught,\n        avg(attendance_count) as avg_class_attendance,\n        sum(credits) as total_credit_hours_taught,\n        avg(difficulty_level) as avg_course_difficulty,\n        count(case when time_block = 'Morning' then 1 end) as morning_sessions,\n        count(case when time_block = 'Afternoon' then 1 end) as afternoon_sessions,\n        count(case when time_block = 'Evening' then 1 end) as evening_sessions,\n        round(salary / nullif(count(distinct course_id), 0), 2) as salary_per_course,\n        round(salary / nullif(sum(credits), 0), 2) as salary_per_credit_hour\n    from faculty_courses\n    group by \n        faculty_id, faculty_name, position, salary, department_id, \n        years_of_service, salary_band, department_name, department_code\n),\n\nworkload_analysis as (\n    select\n        *,\n        case\n            when unique_courses_taught >= 6 then 'Heavy Load'\n            when unique_courses_taught >= 4 then 'Standard Load'\n            when unique_courses_taught >= 2 then 'Light Load'\n            when unique_courses_taught = 1 then 'Minimal Load'\n            else 'No Teaching Load'\n        end as teaching_load_category,\n        case\n            when total_credit_hours_taught >= 18 then 'Overloaded'\n            when total_credit_hours_taught >= 12 then 'Full Load'\n            when total_credit_hours_taught >= 6 then 'Part Load'\n            else 'Minimal Load'\n        end as credit_hour_load_category\n    from faculty_metrics\n)\n\nselect * from workload_analysis", "language": "sql", "refs": [{"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_enrollments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_faculty_teaching_load.sql", "compiled": true, "compiled_code": "\n\nwith faculty_courses as (\n    select\n        f.faculty_id,\n        f.full_name as faculty_name,\n        f.position,\n        f.salary,\n        f.department_id,\n        f.years_of_service,\n        f.salary_band,\n        d.department_name,\n        d.department_code,\n        cs.course_id,\n        cs.semester_id,\n        cs.session_date,\n        cs.session_time,\n        cs.time_block,\n        cs.attendance_count,\n        c.course_code,\n        c.course_name,\n        c.credits,\n        c.difficulty_level,\n        sem.semester_name,\n        sem.academic_year,\n        e.enrollment_id,\n        e.student_id\n    from \"postgres\".\"edu_dbt\".\"stg_faculty\" f\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on f.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on f.faculty_id = cs.faculty_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on cs.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on cs.semester_id = sem.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on c.course_id = e.course_id and sem.semester_id = e.semester_id\n),\n\nfaculty_metrics as (\n    select\n        faculty_id,\n        faculty_name,\n        position,\n        salary,\n        department_id,\n        years_of_service,\n        salary_band,\n        department_name,\n        department_code,\n        count(distinct course_id) as unique_courses_taught,\n        count(distinct semester_id) as semesters_active,\n        count(distinct session_date) as total_class_sessions,\n        count(distinct enrollment_id) as total_students_taught,\n        avg(attendance_count) as avg_class_attendance,\n        sum(credits) as total_credit_hours_taught,\n        avg(difficulty_level) as avg_course_difficulty,\n        count(case when time_block = 'Morning' then 1 end) as morning_sessions,\n        count(case when time_block = 'Afternoon' then 1 end) as afternoon_sessions,\n        count(case when time_block = 'Evening' then 1 end) as evening_sessions,\n        round(salary / nullif(count(distinct course_id), 0), 2) as salary_per_course,\n        round(salary / nullif(sum(credits), 0), 2) as salary_per_credit_hour\n    from faculty_courses\n    group by \n        faculty_id, faculty_name, position, salary, department_id, \n        years_of_service, salary_band, department_name, department_code\n),\n\nworkload_analysis as (\n    select\n        *,\n        case\n            when unique_courses_taught >= 6 then 'Heavy Load'\n            when unique_courses_taught >= 4 then 'Standard Load'\n            when unique_courses_taught >= 2 then 'Light Load'\n            when unique_courses_taught = 1 then 'Minimal Load'\n            else 'No Teaching Load'\n        end as teaching_load_category,\n        case\n            when total_credit_hours_taught >= 18 then 'Overloaded'\n            when total_credit_hours_taught >= 12 then 'Full Load'\n            when total_credit_hours_taught >= 6 then 'Part Load'\n            else 'Minimal Load'\n        end as credit_hour_load_category\n    from faculty_metrics\n)\n\nselect * from workload_analysis", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_course_prerequisite_chains": {"database": "postgres", "schema": "edu_dbt", "name": "int_course_prerequisite_chains", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_course_prerequisite_chains.sql", "original_file_path": "models/intermediate/int_course_prerequisite_chains.sql", "unique_id": "model.DbtEducationalDataProject.int_course_prerequisite_chains", "fqn": ["DbtEducationalDataProject", "intermediate", "int_course_prerequisite_chains"], "alias": "int_course_prerequisite_chains", "checksum": {"name": "sha256", "checksum": "9fde8d2056ee7984910ef7de4459c4151e037f33295e8ae928fa0f24e96530b5"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.2373025, "relation_name": "\"postgres\".\"edu_dbt\".\"int_course_prerequisite_chains\"", "raw_code": "{{ config(materialized='view') }}\n\nwith recursive course_hierarchy as (\n    -- Base case: courses with no prerequisites\n    select\n        course_id,\n        course_code,\n        course_name,\n        prerequisite_course_id,\n        department_id,\n        difficulty_level,\n        credits,\n        0 as prerequisite_depth,\n        course_code as prerequisite_chain,\n        cast(null as int) as root_course_id\n    from {{ ref('stg_courses') }}\n    where prerequisite_course_id is null\n\n    union all\n\n    -- Recursive case: courses with prerequisites\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.prerequisite_course_id,\n        c.department_id,\n        c.difficulty_level,\n        c.credits,\n        ch.prerequisite_depth + 1,\n        ch.prerequisite_chain || ' -> ' || c.course_code as prerequisite_chain,\n        coalesce(ch.root_course_id, ch.course_id) as root_course_id\n    from {{ ref('stg_courses') }} c\n    join course_hierarchy ch on c.prerequisite_course_id = ch.course_id\n    where ch.prerequisite_depth < 10  -- Prevent infinite recursion\n),\n\nprerequisite_analysis as (\n    select\n        ch.*,\n        d.department_name,\n        d.department_code,\n        prereq.course_code as prerequisite_code,\n        prereq.course_name as prerequisite_name,\n        prereq.difficulty_level as prerequisite_difficulty,\n        case\n            when ch.prerequisite_depth = 0 then 'Entry Level'\n            when ch.prerequisite_depth = 1 then 'Second Level'\n            when ch.prerequisite_depth = 2 then 'Intermediate'\n            when ch.prerequisite_depth = 3 then 'Advanced'\n            when ch.prerequisite_depth >= 4 then 'Expert Level'\n        end as course_level_category,\n        case\n            when ch.prerequisite_depth = 0 then 'No Prerequisites'\n            when ch.prerequisite_depth = 1 then 'Single Prerequisite'\n            when ch.prerequisite_depth between 2 and 3 then 'Multiple Prerequisites'\n            else 'Complex Prerequisite Chain'\n        end as prerequisite_complexity,\n        ch.difficulty_level - coalesce(prereq.difficulty_level, 0) as difficulty_progression\n    from course_hierarchy ch\n    left join {{ ref('stg_departments') }} d on ch.department_id = d.department_id\n    left join {{ ref('stg_courses') }} prereq on ch.prerequisite_course_id = prereq.course_id\n),\n\ncourse_sequence_metrics as (\n    select\n        root_course_id,\n        count(*) as total_courses_in_sequence,\n        max(prerequisite_depth) as max_sequence_depth,\n        min(difficulty_level) as min_difficulty_in_sequence,\n        max(difficulty_level) as max_difficulty_in_sequence,\n        avg(difficulty_level) as avg_difficulty_in_sequence,\n        sum(credits) as total_credits_in_sequence,\n        string_agg(course_code, ' -> ' order by prerequisite_depth) as full_sequence\n    from prerequisite_analysis\n    where root_course_id is not null\n    group by root_course_id\n),\n\nfinal_analysis as (\n    select\n        pa.*,\n        csm.total_courses_in_sequence,\n        csm.max_sequence_depth,\n        csm.min_difficulty_in_sequence,\n        csm.max_difficulty_in_sequence,\n        csm.avg_difficulty_in_sequence,\n        csm.total_credits_in_sequence,\n        csm.full_sequence,\n        case\n            when csm.max_sequence_depth >= 4 then 'Long Sequence'\n            when csm.max_sequence_depth >= 2 then 'Moderate Sequence'\n            when csm.max_sequence_depth = 1 then 'Short Sequence'\n            else 'No Sequence'\n        end as sequence_length_category,\n        case\n            when pa.difficulty_progression > 2 then 'Steep Difficulty Increase'\n            when pa.difficulty_progression > 0 then 'Moderate Difficulty Increase'\n            when pa.difficulty_progression = 0 then 'Same Difficulty Level'\n            else 'Difficulty Decrease'\n        end as difficulty_progression_category\n    from prerequisite_analysis pa\n    left join course_sequence_metrics csm on pa.root_course_id = csm.root_course_id\n)\n\nselect * from final_analysis", "language": "sql", "refs": [{"name": "stg_courses", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_course_prerequisite_chains.sql", "compiled": true, "compiled_code": "\n\nwith recursive course_hierarchy as (\n    -- Base case: courses with no prerequisites\n    select\n        course_id,\n        course_code,\n        course_name,\n        prerequisite_course_id,\n        department_id,\n        difficulty_level,\n        credits,\n        0 as prerequisite_depth,\n        course_code as prerequisite_chain,\n        cast(null as int) as root_course_id\n    from \"postgres\".\"edu_dbt\".\"stg_courses\"\n    where prerequisite_course_id is null\n\n    union all\n\n    -- Recursive case: courses with prerequisites\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.prerequisite_course_id,\n        c.department_id,\n        c.difficulty_level,\n        c.credits,\n        ch.prerequisite_depth + 1,\n        ch.prerequisite_chain || ' -> ' || c.course_code as prerequisite_chain,\n        coalesce(ch.root_course_id, ch.course_id) as root_course_id\n    from \"postgres\".\"edu_dbt\".\"stg_courses\" c\n    join course_hierarchy ch on c.prerequisite_course_id = ch.course_id\n    where ch.prerequisite_depth < 10  -- Prevent infinite recursion\n),\n\nprerequisite_analysis as (\n    select\n        ch.*,\n        d.department_name,\n        d.department_code,\n        prereq.course_code as prerequisite_code,\n        prereq.course_name as prerequisite_name,\n        prereq.difficulty_level as prerequisite_difficulty,\n        case\n            when ch.prerequisite_depth = 0 then 'Entry Level'\n            when ch.prerequisite_depth = 1 then 'Second Level'\n            when ch.prerequisite_depth = 2 then 'Intermediate'\n            when ch.prerequisite_depth = 3 then 'Advanced'\n            when ch.prerequisite_depth >= 4 then 'Expert Level'\n        end as course_level_category,\n        case\n            when ch.prerequisite_depth = 0 then 'No Prerequisites'\n            when ch.prerequisite_depth = 1 then 'Single Prerequisite'\n            when ch.prerequisite_depth between 2 and 3 then 'Multiple Prerequisites'\n            else 'Complex Prerequisite Chain'\n        end as prerequisite_complexity,\n        ch.difficulty_level - coalesce(prereq.difficulty_level, 0) as difficulty_progression\n    from course_hierarchy ch\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on ch.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" prereq on ch.prerequisite_course_id = prereq.course_id\n),\n\ncourse_sequence_metrics as (\n    select\n        root_course_id,\n        count(*) as total_courses_in_sequence,\n        max(prerequisite_depth) as max_sequence_depth,\n        min(difficulty_level) as min_difficulty_in_sequence,\n        max(difficulty_level) as max_difficulty_in_sequence,\n        avg(difficulty_level) as avg_difficulty_in_sequence,\n        sum(credits) as total_credits_in_sequence,\n        string_agg(course_code, ' -> ' order by prerequisite_depth) as full_sequence\n    from prerequisite_analysis\n    where root_course_id is not null\n    group by root_course_id\n),\n\nfinal_analysis as (\n    select\n        pa.*,\n        csm.total_courses_in_sequence,\n        csm.max_sequence_depth,\n        csm.min_difficulty_in_sequence,\n        csm.max_difficulty_in_sequence,\n        csm.avg_difficulty_in_sequence,\n        csm.total_credits_in_sequence,\n        csm.full_sequence,\n        case\n            when csm.max_sequence_depth >= 4 then 'Long Sequence'\n            when csm.max_sequence_depth >= 2 then 'Moderate Sequence'\n            when csm.max_sequence_depth = 1 then 'Short Sequence'\n            else 'No Sequence'\n        end as sequence_length_category,\n        case\n            when pa.difficulty_progression > 2 then 'Steep Difficulty Increase'\n            when pa.difficulty_progression > 0 then 'Moderate Difficulty Increase'\n            when pa.difficulty_progression = 0 then 'Same Difficulty Level'\n            else 'Difficulty Decrease'\n        end as difficulty_progression_category\n    from prerequisite_analysis pa\n    left join course_sequence_metrics csm on pa.root_course_id = csm.root_course_id\n)\n\nselect * from final_analysis", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_department_analytics": {"database": "postgres", "schema": "edu_dbt", "name": "int_department_analytics", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_department_analytics.sql", "original_file_path": "models/intermediate/int_department_analytics.sql", "unique_id": "model.DbtEducationalDataProject.int_department_analytics", "fqn": ["DbtEducationalDataProject", "intermediate", "int_department_analytics"], "alias": "int_department_analytics", "checksum": {"name": "sha256", "checksum": "850d615424721411da37b4733a20a8cdb93a70f5ce539463600594283ec7fec7"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.2384045, "relation_name": "\"postgres\".\"edu_dbt\".\"int_department_analytics\"", "raw_code": "{{ config(materialized='view') }}\n\nwith department_data as (\n    select\n        d.department_id,\n        d.department_name,\n        d.department_code,\n        d.budget,\n        d.budget_millions,\n        d.department_size,\n        d.building_location,\n        count(distinct f.faculty_id) as faculty_count,\n        count(distinct c.course_id) as course_count,\n        count(distinct s.student_id) as student_count,\n        count(distinct e.enrollment_id) as total_enrollments,\n        avg(f.salary) as avg_faculty_salary,\n        sum(f.salary) as total_faculty_salary_cost,\n        avg(s.gpa) as avg_student_gpa,\n        sum(c.credits) as total_credit_hours_offered,\n        count(case when f.position = 'Professor' then 1 end) as professor_count,\n        count(case when f.position = 'Associate Professor' then 1 end) as associate_professor_count,\n        count(case when f.position = 'Assistant Professor' then 1 end) as assistant_professor_count,\n        avg(c.difficulty_level) as avg_course_difficulty\n    from {{ ref('stg_departments') }} d\n    left join {{ ref('stg_faculty') }} f on d.department_id = f.department_id\n    left join {{ ref('stg_courses') }} c on d.department_id = c.department_id\n    left join {{ ref('stg_students') }} s on d.department_id = s.major_id\n    left join {{ ref('stg_enrollments') }} e on c.course_id = e.course_id\n    group by \n        d.department_id, d.department_name, d.department_code, d.budget, \n        d.budget_millions, d.department_size, d.building_location\n),\n\ndepartment_metrics as (\n    select\n        *,\n        round(budget / nullif(faculty_count, 0), 2) as budget_per_faculty,\n        round(budget / nullif(student_count, 0), 2) as budget_per_student,\n        round(total_faculty_salary_cost / nullif(budget, 0) * 100, 2) as salary_cost_percentage,\n        round(student_count::numeric / nullif(faculty_count, 0), 2) as student_faculty_ratio,\n        round(course_count::numeric / nullif(faculty_count, 0), 2) as courses_per_faculty,\n        round(total_enrollments::numeric / nullif(course_count, 0), 2) as avg_enrollment_per_course,\n        case\n            when student_count > 500 then 'Large Department'\n            when student_count > 200 then 'Medium Department'\n            when student_count > 50 then 'Small Department'\n            else 'Very Small Department'\n        end as department_scale,\n        case\n            when student_count::numeric / nullif(faculty_count, 0) > 30 then 'High Student-Faculty Ratio'\n            when student_count::numeric / nullif(faculty_count, 0) > 20 then 'Moderate Student-Faculty Ratio'\n            when student_count::numeric / nullif(faculty_count, 0) > 10 then 'Low Student-Faculty Ratio'\n            else 'Very Low Student-Faculty Ratio'\n        end as ratio_category\n    from department_data\n)\n\nselect * from department_metrics", "language": "sql", "refs": [{"name": "stg_departments", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_enrollments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_department_analytics.sql", "compiled": true, "compiled_code": "\n\nwith department_data as (\n    select\n        d.department_id,\n        d.department_name,\n        d.department_code,\n        d.budget,\n        d.budget_millions,\n        d.department_size,\n        d.building_location,\n        count(distinct f.faculty_id) as faculty_count,\n        count(distinct c.course_id) as course_count,\n        count(distinct s.student_id) as student_count,\n        count(distinct e.enrollment_id) as total_enrollments,\n        avg(f.salary) as avg_faculty_salary,\n        sum(f.salary) as total_faculty_salary_cost,\n        avg(s.gpa) as avg_student_gpa,\n        sum(c.credits) as total_credit_hours_offered,\n        count(case when f.position = 'Professor' then 1 end) as professor_count,\n        count(case when f.position = 'Associate Professor' then 1 end) as associate_professor_count,\n        count(case when f.position = 'Assistant Professor' then 1 end) as assistant_professor_count,\n        avg(c.difficulty_level) as avg_course_difficulty\n    from \"postgres\".\"edu_dbt\".\"stg_departments\" d\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on d.department_id = f.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on d.department_id = c.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on d.department_id = s.major_id\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on c.course_id = e.course_id\n    group by \n        d.department_id, d.department_name, d.department_code, d.budget, \n        d.budget_millions, d.department_size, d.building_location\n),\n\ndepartment_metrics as (\n    select\n        *,\n        round(budget / nullif(faculty_count, 0), 2) as budget_per_faculty,\n        round(budget / nullif(student_count, 0), 2) as budget_per_student,\n        round(total_faculty_salary_cost / nullif(budget, 0) * 100, 2) as salary_cost_percentage,\n        round(student_count::numeric / nullif(faculty_count, 0), 2) as student_faculty_ratio,\n        round(course_count::numeric / nullif(faculty_count, 0), 2) as courses_per_faculty,\n        round(total_enrollments::numeric / nullif(course_count, 0), 2) as avg_enrollment_per_course,\n        case\n            when student_count > 500 then 'Large Department'\n            when student_count > 200 then 'Medium Department'\n            when student_count > 50 then 'Small Department'\n            else 'Very Small Department'\n        end as department_scale,\n        case\n            when student_count::numeric / nullif(faculty_count, 0) > 30 then 'High Student-Faculty Ratio'\n            when student_count::numeric / nullif(faculty_count, 0) > 20 then 'Moderate Student-Faculty Ratio'\n            when student_count::numeric / nullif(faculty_count, 0) > 10 then 'Low Student-Faculty Ratio'\n            else 'Very Low Student-Faculty Ratio'\n        end as ratio_category\n    from department_data\n)\n\nselect * from department_metrics", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_student_at_risk_indicators": {"database": "postgres", "schema": "edu_dbt", "name": "int_student_at_risk_indicators", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_student_at_risk_indicators.sql", "original_file_path": "models/intermediate/int_student_at_risk_indicators.sql", "unique_id": "model.DbtEducationalDataProject.int_student_at_risk_indicators", "fqn": ["DbtEducationalDataProject", "intermediate", "int_student_at_risk_indicators"], "alias": "int_student_at_risk_indicators", "checksum": {"name": "sha256", "checksum": "19cdce0ca1857e2deb3979594c1efbcc07ee26a1742aa535635c88f6445bbe7c"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.2413235, "relation_name": "\"postgres\".\"edu_dbt\".\"int_student_at_risk_indicators\"", "raw_code": "{{ config(materialized='view') }}\n\nwith risk_indicators as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.gpa,\n        s.academic_standing,\n        s.student_status,\n        s.years_enrolled,\n        d.department_name,\n        eh.total_enrollments,\n        eh.total_credits_attempted,\n        eh.total_credits_earned,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        eh.avg_grade_points,\n        eh.avg_attendance,\n        sfp.total_aid_received,\n        sfp.late_payment_rate,\n        sfp.payment_reliability,\n        case when eh.avg_attendance < 75 then 1 else 0 end as low_attendance_flag,\n        case when s.gpa < 2.0 then 1 else 0 end as academic_probation_flag,\n        case when eh.failed_courses_count >= 2 then 1 else 0 end as multiple_failures_flag,\n        case when eh.withdrawn_courses_count >= 3 then 1 else 0 end as excessive_withdrawals_flag,\n        case when sfp.late_payment_rate > 25 then 1 else 0 end as payment_issues_flag,\n        case when s.years_enrolled > 5 and s.student_status = 'active' then 1 else 0 end as extended_timeline_flag,\n        case when eh.total_credits_earned < (s.years_enrolled * 12) then 1 else 0 end as slow_progress_flag,\n        case when sfp.total_aid_received = 0 and sfp.late_payment_rate > 10 then 1 else 0 end as financial_stress_flag\n    from {{ ref('stg_students') }} s\n    left join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_enrollments) as total_enrollments,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(total_credits_earned) as total_credits_earned,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count,\n            max(avg_grade_points) as avg_grade_points,\n            max(avg_attendance) as avg_attendance\n        from {{ ref('int_student_enrollment_history') }}\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n    left join {{ ref('student_financial_profile') }} sfp on s.student_id = sfp.student_id\n),\n\nrisk_scoring as (\n    select\n        *,\n        low_attendance_flag + academic_probation_flag + multiple_failures_flag + \n        excessive_withdrawals_flag + payment_issues_flag + extended_timeline_flag + \n        slow_progress_flag + financial_stress_flag as total_risk_score,\n        case\n            when (low_attendance_flag + academic_probation_flag + multiple_failures_flag + \n                  excessive_withdrawals_flag + payment_issues_flag + extended_timeline_flag + \n                  slow_progress_flag + financial_stress_flag) >= 5 then 'Critical Risk'\n            when (low_attendance_flag + academic_probation_flag + multiple_failures_flag + \n                  excessive_withdrawals_flag + payment_issues_flag + extended_timeline_flag + \n                  slow_progress_flag + financial_stress_flag) >= 3 then 'High Risk'\n            when (low_attendance_flag + academic_probation_flag + multiple_failures_flag + \n                  excessive_withdrawals_flag + payment_issues_flag + extended_timeline_flag + \n                  slow_progress_flag + financial_stress_flag) >= 1 then 'Moderate Risk'\n            else 'Low Risk'\n        end as risk_level,\n        case\n            when academic_probation_flag = 1 and multiple_failures_flag = 1 then 'Academic Crisis'\n            when low_attendance_flag = 1 and slow_progress_flag = 1 then 'Engagement Issues'\n            when payment_issues_flag = 1 and financial_stress_flag = 1 then 'Financial Crisis'\n            when excessive_withdrawals_flag = 1 and extended_timeline_flag = 1 then 'Completion Risk'\n            else 'General Risk'\n        end as primary_risk_category\n    from risk_indicators\n),\n\nintervention_recommendations as (\n    select\n        *,\n        case\n            when risk_level = 'Critical Risk' then 'Immediate intervention required - Academic advisor meeting, counseling referral, financial aid review'\n            when risk_level = 'High Risk' and primary_risk_category = 'Academic Crisis' then 'Academic support - Tutoring, study skills workshop, course load reduction'\n            when risk_level = 'High Risk' and primary_risk_category = 'Financial Crisis' then 'Financial counseling - Payment plan setup, additional aid application assistance'\n            when risk_level = 'High Risk' and primary_risk_category = 'Engagement Issues' then 'Engagement support - Attendance monitoring, study group placement, mentor assignment'\n            when risk_level = 'Moderate Risk' then 'Preventive support - Regular check-ins, academic planning session'\n            else 'Standard support - Routine academic advising'\n        end as recommended_intervention,\n        case\n            when low_attendance_flag = 1 then 'Monitor attendance closely'\n            else ''\n        end || case\n            when academic_probation_flag = 1 then ' | Academic probation follow-up'\n            else ''\n        end || case\n            when payment_issues_flag = 1 then ' | Financial aid counseling'\n            else ''\n        end || case\n            when slow_progress_flag = 1 then ' | Degree planning review'\n            else ''\n        end as specific_action_items\n    from risk_scoring\n)\n\nselect * from intervention_recommendations", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_student_enrollment_history", "package": null, "version": null}, {"name": "student_financial_profile", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.student_financial_profile"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_student_at_risk_indicators.sql", "compiled": true, "compiled_code": "\n\nwith risk_indicators as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.gpa,\n        s.academic_standing,\n        s.student_status,\n        s.years_enrolled,\n        d.department_name,\n        eh.total_enrollments,\n        eh.total_credits_attempted,\n        eh.total_credits_earned,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        eh.avg_grade_points,\n        eh.avg_attendance,\n        sfp.total_aid_received,\n        sfp.late_payment_rate,\n        sfp.payment_reliability,\n        case when eh.avg_attendance < 75 then 1 else 0 end as low_attendance_flag,\n        case when s.gpa < 2.0 then 1 else 0 end as academic_probation_flag,\n        case when eh.failed_courses_count >= 2 then 1 else 0 end as multiple_failures_flag,\n        case when eh.withdrawn_courses_count >= 3 then 1 else 0 end as excessive_withdrawals_flag,\n        case when sfp.late_payment_rate > 25 then 1 else 0 end as payment_issues_flag,\n        case when s.years_enrolled > 5 and s.student_status = 'active' then 1 else 0 end as extended_timeline_flag,\n        case when eh.total_credits_earned < (s.years_enrolled * 12) then 1 else 0 end as slow_progress_flag,\n        case when sfp.total_aid_received = 0 and sfp.late_payment_rate > 10 then 1 else 0 end as financial_stress_flag\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_enrollments) as total_enrollments,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(total_credits_earned) as total_credits_earned,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count,\n            max(avg_grade_points) as avg_grade_points,\n            max(avg_attendance) as avg_attendance\n        from \"postgres\".\"edu_dbt\".\"int_student_enrollment_history\"\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n    left join \"postgres\".\"edu_dbt\".\"student_financial_profile\" sfp on s.student_id = sfp.student_id\n),\n\nrisk_scoring as (\n    select\n        *,\n        low_attendance_flag + academic_probation_flag + multiple_failures_flag + \n        excessive_withdrawals_flag + payment_issues_flag + extended_timeline_flag + \n        slow_progress_flag + financial_stress_flag as total_risk_score,\n        case\n            when (low_attendance_flag + academic_probation_flag + multiple_failures_flag + \n                  excessive_withdrawals_flag + payment_issues_flag + extended_timeline_flag + \n                  slow_progress_flag + financial_stress_flag) >= 5 then 'Critical Risk'\n            when (low_attendance_flag + academic_probation_flag + multiple_failures_flag + \n                  excessive_withdrawals_flag + payment_issues_flag + extended_timeline_flag + \n                  slow_progress_flag + financial_stress_flag) >= 3 then 'High Risk'\n            when (low_attendance_flag + academic_probation_flag + multiple_failures_flag + \n                  excessive_withdrawals_flag + payment_issues_flag + extended_timeline_flag + \n                  slow_progress_flag + financial_stress_flag) >= 1 then 'Moderate Risk'\n            else 'Low Risk'\n        end as risk_level,\n        case\n            when academic_probation_flag = 1 and multiple_failures_flag = 1 then 'Academic Crisis'\n            when low_attendance_flag = 1 and slow_progress_flag = 1 then 'Engagement Issues'\n            when payment_issues_flag = 1 and financial_stress_flag = 1 then 'Financial Crisis'\n            when excessive_withdrawals_flag = 1 and extended_timeline_flag = 1 then 'Completion Risk'\n            else 'General Risk'\n        end as primary_risk_category\n    from risk_indicators\n),\n\nintervention_recommendations as (\n    select\n        *,\n        case\n            when risk_level = 'Critical Risk' then 'Immediate intervention required - Academic advisor meeting, counseling referral, financial aid review'\n            when risk_level = 'High Risk' and primary_risk_category = 'Academic Crisis' then 'Academic support - Tutoring, study skills workshop, course load reduction'\n            when risk_level = 'High Risk' and primary_risk_category = 'Financial Crisis' then 'Financial counseling - Payment plan setup, additional aid application assistance'\n            when risk_level = 'High Risk' and primary_risk_category = 'Engagement Issues' then 'Engagement support - Attendance monitoring, study group placement, mentor assignment'\n            when risk_level = 'Moderate Risk' then 'Preventive support - Regular check-ins, academic planning session'\n            else 'Standard support - Routine academic advising'\n        end as recommended_intervention,\n        case\n            when low_attendance_flag = 1 then 'Monitor attendance closely'\n            else ''\n        end || case\n            when academic_probation_flag = 1 then ' | Academic probation follow-up'\n            else ''\n        end || case\n            when payment_issues_flag = 1 then ' | Financial aid counseling'\n            else ''\n        end || case\n            when slow_progress_flag = 1 then ' | Degree planning review'\n            else ''\n        end as specific_action_items\n    from risk_scoring\n)\n\nselect * from intervention_recommendations", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_assignment_performance": {"database": "postgres", "schema": "edu_dbt", "name": "int_assignment_performance", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_assignment_performance.sql", "original_file_path": "models/intermediate/int_assignment_performance.sql", "unique_id": "model.DbtEducationalDataProject.int_assignment_performance", "fqn": ["DbtEducationalDataProject", "intermediate", "int_assignment_performance"], "alias": "int_assignment_performance", "checksum": {"name": "sha256", "checksum": "22e1fbf867db39617c605848e1a4ffc35cb4cbc73aea61edbbda363965d6875a"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.2423043, "relation_name": "\"postgres\".\"edu_dbt\".\"int_assignment_performance\"", "raw_code": "{{ config(materialized='view') }}\n\nwith assignment_data as (\n    select\n        a.assignment_id,\n        a.course_id,\n        a.semester_id,\n        a.assignment_name,\n        a.assignment_type,\n        a.assignment_category,\n        a.due_date,\n        a.due_status,\n        a.max_points,\n        a.weight_percentage,\n        a.weight_category,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        sem.semester_name,\n        sem.academic_year,\n        sub.submission_id,\n        sub.student_id,\n        sub.submission_date,\n        sub.score,\n        sub.late_submission,\n        sub.grading_status,\n        sub.submission_timeliness,\n        sub.feedback_status,\n        s.full_name as student_name,\n        s.gpa as student_gpa,\n        s.academic_standing\n    from {{ ref('stg_assignments') }} a\n    left join {{ ref('stg_courses') }} c on a.course_id = c.course_id\n    left join {{ ref('stg_semesters') }} sem on a.semester_id = sem.semester_id\n    left join {{ ref('stg_assignment_submissions') }} sub on a.assignment_id = sub.assignment_id\n    left join {{ ref('stg_students') }} s on sub.student_id = s.student_id\n),\n\nassignment_metrics as (\n    select\n        assignment_id,\n        course_id,\n        semester_id,\n        assignment_name,\n        assignment_type,\n        assignment_category,\n        due_date,\n        due_status,\n        max_points,\n        weight_percentage,\n        weight_category,\n        course_code,\n        course_name,\n        difficulty_level,\n        semester_name,\n        academic_year,\n        count(distinct submission_id) as total_submissions,\n        count(distinct student_id) as unique_students_submitted,\n        avg(score) as avg_score,\n        min(score) as min_score,\n        max(score) as max_score,\n        stddev(score) as score_standard_deviation,\n        avg(case when score is not null then score / max_points * 100 end) as avg_percentage_score,\n        count(case when late_submission then 1 end) as late_submissions,\n        count(case when grading_status = 'Graded' then 1 end) as graded_submissions,\n        count(case when feedback_status = 'Has Feedback' then 1 end) as submissions_with_feedback,\n        round(\n            count(case when late_submission then 1 end) * 100.0 / \n            nullif(count(submission_id), 0), 2\n        ) as late_submission_rate,\n        round(\n            count(case when grading_status = 'Graded' then 1 end) * 100.0 / \n            nullif(count(submission_id), 0), 2\n        ) as grading_completion_rate,\n        round(\n            count(case when score >= max_points * 0.9 then 1 end) * 100.0 / \n            nullif(count(case when score is not null then 1 end), 0), 2\n        ) as excellent_performance_rate,\n        round(\n            count(case when score < max_points * 0.6 then 1 end) * 100.0 / \n            nullif(count(case when score is not null then 1 end), 0), 2\n        ) as poor_performance_rate\n    from assignment_data\n    where assignment_id is not null\n    group by \n        assignment_id, course_id, semester_id, assignment_name, assignment_type, \n        assignment_category, due_date, due_status, max_points, weight_percentage, \n        weight_category, course_code, course_name, difficulty_level, semester_name, academic_year\n)\n\nselect * from assignment_metrics", "language": "sql", "refs": [{"name": "stg_assignments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_assignment_submissions", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_assignment_submissions", "model.DbtEducationalDataProject.stg_students"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_assignment_performance.sql", "compiled": true, "compiled_code": "\n\nwith assignment_data as (\n    select\n        a.assignment_id,\n        a.course_id,\n        a.semester_id,\n        a.assignment_name,\n        a.assignment_type,\n        a.assignment_category,\n        a.due_date,\n        a.due_status,\n        a.max_points,\n        a.weight_percentage,\n        a.weight_category,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        sem.semester_name,\n        sem.academic_year,\n        sub.submission_id,\n        sub.student_id,\n        sub.submission_date,\n        sub.score,\n        sub.late_submission,\n        sub.grading_status,\n        sub.submission_timeliness,\n        sub.feedback_status,\n        s.full_name as student_name,\n        s.gpa as student_gpa,\n        s.academic_standing\n    from \"postgres\".\"edu_dbt\".\"stg_assignments\" a\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on a.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on a.semester_id = sem.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_assignment_submissions\" sub on a.assignment_id = sub.assignment_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on sub.student_id = s.student_id\n),\n\nassignment_metrics as (\n    select\n        assignment_id,\n        course_id,\n        semester_id,\n        assignment_name,\n        assignment_type,\n        assignment_category,\n        due_date,\n        due_status,\n        max_points,\n        weight_percentage,\n        weight_category,\n        course_code,\n        course_name,\n        difficulty_level,\n        semester_name,\n        academic_year,\n        count(distinct submission_id) as total_submissions,\n        count(distinct student_id) as unique_students_submitted,\n        avg(score) as avg_score,\n        min(score) as min_score,\n        max(score) as max_score,\n        stddev(score) as score_standard_deviation,\n        avg(case when score is not null then score / max_points * 100 end) as avg_percentage_score,\n        count(case when late_submission then 1 end) as late_submissions,\n        count(case when grading_status = 'Graded' then 1 end) as graded_submissions,\n        count(case when feedback_status = 'Has Feedback' then 1 end) as submissions_with_feedback,\n        round(\n            count(case when late_submission then 1 end) * 100.0 / \n            nullif(count(submission_id), 0), 2\n        ) as late_submission_rate,\n        round(\n            count(case when grading_status = 'Graded' then 1 end) * 100.0 / \n            nullif(count(submission_id), 0), 2\n        ) as grading_completion_rate,\n        round(\n            count(case when score >= max_points * 0.9 then 1 end) * 100.0 / \n            nullif(count(case when score is not null then 1 end), 0), 2\n        ) as excellent_performance_rate,\n        round(\n            count(case when score < max_points * 0.6 then 1 end) * 100.0 / \n            nullif(count(case when score is not null then 1 end), 0), 2\n        ) as poor_performance_rate\n    from assignment_data\n    where assignment_id is not null\n    group by \n        assignment_id, course_id, semester_id, assignment_name, assignment_type, \n        assignment_category, due_date, due_status, max_points, weight_percentage, \n        weight_category, course_code, course_name, difficulty_level, semester_name, academic_year\n)\n\nselect * from assignment_metrics", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_student_enrollment_history": {"database": "postgres", "schema": "edu_dbt", "name": "int_student_enrollment_history", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_student_enrollment_history.sql", "original_file_path": "models/intermediate/int_student_enrollment_history.sql", "unique_id": "model.DbtEducationalDataProject.int_student_enrollment_history", "fqn": ["DbtEducationalDataProject", "intermediate", "int_student_enrollment_history"], "alias": "int_student_enrollment_history", "checksum": {"name": "sha256", "checksum": "70d6b590fda9b5ebdadff21d5c8986277b74188df12ccd401c4de2d1fdbeed92"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.244913, "relation_name": "\"postgres\".\"edu_dbt\".\"int_student_enrollment_history\"", "raw_code": "{{ config(materialized='view') }}\n\nwith student_enrollments as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        e.enrollment_id,\n        e.course_id,\n        e.semester_id,\n        e.grade,\n        e.grade_points,\n        e.attendance_percentage,\n        e.grade_category,\n        e.enrollment_status,\n        c.course_code,\n        c.course_name,\n        c.credits,\n        c.difficulty_level,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        d.department_name,\n        d.department_code\n    from {{ ref('stg_students') }} s\n    left join {{ ref('stg_enrollments') }} e on s.student_id = e.student_id\n    left join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    left join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    left join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n),\n\nenrollment_metrics as (\n    select\n        *,\n        row_number() over (partition by student_id order by semester_name) as enrollment_sequence,\n        count(*) over (partition by student_id) as total_enrollments,\n        avg(grade_points) over (partition by student_id) as avg_grade_points,\n        avg(attendance_percentage) over (partition by student_id) as avg_attendance,\n        sum(credits) over (partition by student_id) as total_credits_attempted,\n        sum(case when grade_category in ('Excellent', 'Good', 'Satisfactory') then credits else 0 end) \n            over (partition by student_id) as total_credits_earned,\n        count(case when grade_category = 'Failing' then 1 end) \n            over (partition by student_id) as failed_courses_count,\n        count(case when enrollment_status = 'Withdrawn' then 1 end) \n            over (partition by student_id) as withdrawn_courses_count\n    from student_enrollments\n)\n\nselect * from enrollment_metrics", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_departments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_student_enrollment_history.sql", "compiled": true, "compiled_code": "\n\nwith student_enrollments as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.student_status,\n        s.gpa,\n        s.academic_standing,\n        e.enrollment_id,\n        e.course_id,\n        e.semester_id,\n        e.grade,\n        e.grade_points,\n        e.attendance_percentage,\n        e.grade_category,\n        e.enrollment_status,\n        c.course_code,\n        c.course_name,\n        c.credits,\n        c.difficulty_level,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        d.department_name,\n        d.department_code\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on s.student_id = e.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n),\n\nenrollment_metrics as (\n    select\n        *,\n        row_number() over (partition by student_id order by semester_name) as enrollment_sequence,\n        count(*) over (partition by student_id) as total_enrollments,\n        avg(grade_points) over (partition by student_id) as avg_grade_points,\n        avg(attendance_percentage) over (partition by student_id) as avg_attendance,\n        sum(credits) over (partition by student_id) as total_credits_attempted,\n        sum(case when grade_category in ('Excellent', 'Good', 'Satisfactory') then credits else 0 end) \n            over (partition by student_id) as total_credits_earned,\n        count(case when grade_category = 'Failing' then 1 end) \n            over (partition by student_id) as failed_courses_count,\n        count(case when enrollment_status = 'Withdrawn' then 1 end) \n            over (partition by student_id) as withdrawn_courses_count\n    from student_enrollments\n)\n\nselect * from enrollment_metrics", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_course_performance_metrics": {"database": "postgres", "schema": "edu_dbt", "name": "int_course_performance_metrics", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_course_performance_metrics.sql", "original_file_path": "models/intermediate/int_course_performance_metrics.sql", "unique_id": "model.DbtEducationalDataProject.int_course_performance_metrics", "fqn": ["DbtEducationalDataProject", "intermediate", "int_course_performance_metrics"], "alias": "int_course_performance_metrics", "checksum": {"name": "sha256", "checksum": "4ba4adf8cd4890e82727ec68cbebc103f5029516d079a50504eb7065e5f6bfae"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764371903.247213, "relation_name": "\"postgres\".\"edu_dbt\".\"int_course_performance_metrics\"", "raw_code": "{{ config(materialized='view') }}\n\nwith course_enrollments as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.credits,\n        c.difficulty_level,\n        c.difficulty_description,\n        d.department_name,\n        d.department_code,\n        e.enrollment_id,\n        e.student_id,\n        e.semester_id,\n        e.grade,\n        e.grade_points,\n        e.attendance_percentage,\n        e.grade_category,\n        e.enrollment_status,\n        sem.semester_name,\n        sem.academic_year,\n        f.full_name as instructor_name,\n        f.position as instructor_position\n    from {{ ref('stg_courses') }} c\n    left join {{ ref('stg_enrollments') }} e on c.course_id = e.course_id\n    left join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    left join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    left join {{ ref('stg_class_sessions') }} cs on c.course_id = cs.course_id and sem.semester_id = cs.semester_id\n    left join {{ ref('stg_faculty') }} f on cs.faculty_id = f.faculty_id\n),\n\ncourse_metrics as (\n    select\n        course_id,\n        course_code,\n        course_name,\n        credits,\n        difficulty_level,\n        difficulty_description,\n        department_name,\n        department_code,\n        count(distinct enrollment_id) as total_enrollments,\n        count(distinct student_id) as unique_students,\n        count(distinct semester_id) as semesters_offered,\n        avg(grade_points) as avg_grade_points,\n        avg(attendance_percentage) as avg_attendance,\n        count(case when grade_category = 'Excellent' then 1 end) as excellent_grades,\n        count(case when grade_category = 'Good' then 1 end) as good_grades,\n        count(case when grade_category = 'Satisfactory' then 1 end) as satisfactory_grades,\n        count(case when grade_category = 'Poor' then 1 end) as poor_grades,\n        count(case when grade_category = 'Failing' then 1 end) as failing_grades,\n        count(case when enrollment_status = 'Withdrawn' then 1 end) as withdrawals,\n        round(\n            count(case when grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) * 100.0 / \n            nullif(count(case when grade_category != 'Unknown' then 1 end), 0), 2\n        ) as pass_rate,\n        round(\n            count(case when enrollment_status = 'Withdrawn' then 1 end) * 100.0 / \n            nullif(count(enrollment_id), 0), 2\n        ) as withdrawal_rate\n    from course_enrollments\n    where course_id is not null\n    group by \n        course_id, course_code, course_name, credits, difficulty_level, \n        difficulty_description, department_name, department_code\n)\n\nselect * from course_metrics", "language": "sql", "refs": [{"name": "stg_courses", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_faculty"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_course_performance_metrics.sql", "compiled": true, "compiled_code": "\n\nwith course_enrollments as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.credits,\n        c.difficulty_level,\n        c.difficulty_description,\n        d.department_name,\n        d.department_code,\n        e.enrollment_id,\n        e.student_id,\n        e.semester_id,\n        e.grade,\n        e.grade_points,\n        e.attendance_percentage,\n        e.grade_category,\n        e.enrollment_status,\n        sem.semester_name,\n        sem.academic_year,\n        f.full_name as instructor_name,\n        f.position as instructor_position\n    from \"postgres\".\"edu_dbt\".\"stg_courses\" c\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on c.course_id = e.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on c.course_id = cs.course_id and sem.semester_id = cs.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on cs.faculty_id = f.faculty_id\n),\n\ncourse_metrics as (\n    select\n        course_id,\n        course_code,\n        course_name,\n        credits,\n        difficulty_level,\n        difficulty_description,\n        department_name,\n        department_code,\n        count(distinct enrollment_id) as total_enrollments,\n        count(distinct student_id) as unique_students,\n        count(distinct semester_id) as semesters_offered,\n        avg(grade_points) as avg_grade_points,\n        avg(attendance_percentage) as avg_attendance,\n        count(case when grade_category = 'Excellent' then 1 end) as excellent_grades,\n        count(case when grade_category = 'Good' then 1 end) as good_grades,\n        count(case when grade_category = 'Satisfactory' then 1 end) as satisfactory_grades,\n        count(case when grade_category = 'Poor' then 1 end) as poor_grades,\n        count(case when grade_category = 'Failing' then 1 end) as failing_grades,\n        count(case when enrollment_status = 'Withdrawn' then 1 end) as withdrawals,\n        round(\n            count(case when grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) * 100.0 / \n            nullif(count(case when grade_category != 'Unknown' then 1 end), 0), 2\n        ) as pass_rate,\n        round(\n            count(case when enrollment_status = 'Withdrawn' then 1 end) * 100.0 / \n            nullif(count(enrollment_id), 0), 2\n        ) as withdrawal_rate\n    from course_enrollments\n    where course_id is not null\n    group by \n        course_id, course_code, course_name, credits, difficulty_level, \n        difficulty_description, department_name, department_code\n)\n\nselect * from course_metrics", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "test.DbtEducationalDataProject.test_data_quality_checks": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "test_data_quality_checks", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "test_data_quality_checks.sql", "original_file_path": "tests/test_data_quality_checks.sql", "unique_id": "test.DbtEducationalDataProject.test_data_quality_checks", "fqn": ["DbtEducationalDataProject", "test_data_quality_checks"], "alias": "test_data_quality_checks", "checksum": {"name": "sha256", "checksum": "86b48ccef3e4624bb10f25f54f59038544fcf5483b43a99ebc9537ceb4f8fc60"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.2863703, "relation_name": null, "raw_code": "-- Test to ensure no student has impossible GPA values\nselect *\nfrom {{ ref('stg_students') }}\nwhere gpa < 0.0 or gpa > 4.0", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/tests/test_data_quality_checks.sql", "compiled": true, "compiled_code": "-- Test to ensure no student has impossible GPA values\nselect *\nfrom \"postgres\".\"edu_dbt\".\"stg_students\"\nwhere gpa < 0.0 or gpa > 4.0", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.DbtEducationalDataProject.test_financial_consistency": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "test_financial_consistency", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "test_financial_consistency.sql", "original_file_path": "tests/test_financial_consistency.sql", "unique_id": "test.DbtEducationalDataProject.test_financial_consistency", "fqn": ["DbtEducationalDataProject", "test_financial_consistency"], "alias": "test_financial_consistency", "checksum": {"name": "sha256", "checksum": "9d9e9403159d4c418a8f0340514a2eecf4d259cbe77b67ad6034ec85c1bb96d6"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.2917953, "relation_name": null, "raw_code": "-- Test to ensure financial aid doesn't exceed reasonable limits\nselect *\nfrom {{ ref('stg_financial_aid') }}\nwhere amount > 50000  -- Unreasonably high aid amount\n   or amount < 0      -- Negative aid amount", "language": "sql", "refs": [{"name": "stg_financial_aid", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_financial_aid"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/tests/test_financial_consistency.sql", "compiled": true, "compiled_code": "-- Test to ensure financial aid doesn't exceed reasonable limits\nselect *\nfrom \"postgres\".\"edu_dbt\".\"stg_financial_aid\"\nwhere amount > 50000  -- Unreasonably high aid amount\n   or amount < 0      -- Negative aid amount", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "test.DbtEducationalDataProject.test_enrollment_integrity": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "test_enrollment_integrity", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "test_enrollment_integrity.sql", "original_file_path": "tests/test_enrollment_integrity.sql", "unique_id": "test.DbtEducationalDataProject.test_enrollment_integrity", "fqn": ["DbtEducationalDataProject", "test_enrollment_integrity"], "alias": "test_enrollment_integrity", "checksum": {"name": "sha256", "checksum": "b004e23f1abd5aaf4d3548c5eb995b09f8ceeefa8114653271dd8210db2df361"}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.2934964, "relation_name": null, "raw_code": "-- Test to ensure enrollment dates are logical\nselect *\nfrom {{ ref('stg_enrollments') }} e\njoin {{ ref('stg_semesters') }} s on e.semester_id = s.semester_id\nwhere e.enrollment_date > s.end_date \n   or (e.completion_date is not null and e.completion_date < e.enrollment_date)", "language": "sql", "refs": [{"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_semesters"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/tests/test_enrollment_integrity.sql", "compiled": true, "compiled_code": "-- Test to ensure enrollment dates are logical\nselect *\nfrom \"postgres\".\"edu_dbt\".\"stg_enrollments\" e\njoin \"postgres\".\"edu_dbt\".\"stg_semesters\" s on e.semester_id = s.semester_id\nwhere e.enrollment_date > s.end_date \n   or (e.completion_date is not null and e.completion_date < e.enrollment_date)", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}}, "seed.DbtEducationalDataProject.grade_scale_reference": {"database": "postgres", "schema": "edu_dbt", "name": "grade_scale_reference", "resource_type": "seed", "package_name": "DbtEducationalDataProject", "path": "grade_scale_reference.csv", "original_file_path": "seeds/grade_scale_reference.csv", "unique_id": "seed.DbtEducationalDataProject.grade_scale_reference", "fqn": ["DbtEducationalDataProject", "grade_scale_reference"], "alias": "grade_scale_reference", "checksum": {"name": "sha256", "checksum": "b2bd83f7d22de32011ca2472584e8b86ecada5954613ba3ff58552669ad68ff7"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.3560662, "relation_name": "\"postgres\".\"edu_dbt\".\"grade_scale_reference\"", "raw_code": "", "root_path": "/usr/app/dbt", "depends_on": {"macros": []}}, "seed.DbtEducationalDataProject.academic_calendar_holidays": {"database": "postgres", "schema": "edu_dbt", "name": "academic_calendar_holidays", "resource_type": "seed", "package_name": "DbtEducationalDataProject", "path": "academic_calendar_holidays.csv", "original_file_path": "seeds/academic_calendar_holidays.csv", "unique_id": "seed.DbtEducationalDataProject.academic_calendar_holidays", "fqn": ["DbtEducationalDataProject", "academic_calendar_holidays"], "alias": "academic_calendar_holidays", "checksum": {"name": "sha256", "checksum": "122718b19832069ab8c8d367277316fd52dc8a77b387ab50e447d83274d267ee"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.3571234, "relation_name": "\"postgres\".\"edu_dbt\".\"academic_calendar_holidays\"", "raw_code": "", "root_path": "/usr/app/dbt", "depends_on": {"macros": []}}, "seed.DbtEducationalDataProject.semester_calendar": {"database": "postgres", "schema": "edu_dbt", "name": "semester_calendar", "resource_type": "seed", "package_name": "DbtEducationalDataProject", "path": "semester_calendar.csv", "original_file_path": "seeds/semester_calendar.csv", "unique_id": "seed.DbtEducationalDataProject.semester_calendar", "fqn": ["DbtEducationalDataProject", "semester_calendar"], "alias": "semester_calendar", "checksum": {"name": "sha256", "checksum": "a678a810120efa5661379a647c1c6c58bd738e318079fc3214460437b0ca3ef5"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "seed", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "delimiter": ",", "quote_columns": null}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.358054, "relation_name": "\"postgres\".\"edu_dbt\".\"semester_calendar\"", "raw_code": "", "root_path": "/usr/app/dbt", "depends_on": {"macros": []}}, "operation.DbtEducationalDataProject.DbtEducationalDataProject-on-run-start-0": {"database": "postgres", "schema": "edu_dbt", "name": "DbtEducationalDataProject-on-run-start-0", "resource_type": "operation", "package_name": "DbtEducationalDataProject", "path": "hooks/DbtEducationalDataProject-on-run-start-0.sql", "original_file_path": "./dbt_project.yml", "unique_id": "operation.DbtEducationalDataProject.DbtEducationalDataProject-on-run-start-0", "fqn": ["DbtEducationalDataProject", "hooks", "DbtEducationalDataProject-on-run-start-0"], "alias": "DbtEducationalDataProject-on-run-start-0", "checksum": {"name": "sha256", "checksum": "8bfb65aa4868c97806464800e661f9ec492788ebd2386e8e14128af183bee68f"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}}, "tags": ["on-run-start"], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.4358196, "relation_name": null, "raw_code": "{% set creation_query_str %}\n  -- Creating educational data schema and source tables\n  CREATE SCHEMA IF NOT EXISTS raw_edu;\n\n  -- 1. Students table\n  CREATE TABLE if not exists raw_edu.students (\n      student_id SERIAL PRIMARY KEY,\n      first_name TEXT NOT NULL,\n      last_name TEXT NOT NULL,\n      email TEXT UNIQUE,\n      date_of_birth DATE,\n      enrollment_date DATE,\n      graduation_date DATE,\n      student_status TEXT CHECK (student_status IN ('active', 'graduated', 'dropped', 'suspended')),\n      gpa DECIMAL(3,2),\n      major_id INT,\n      advisor_id INT,\n      address_id INT,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 2. Courses table\n  CREATE TABLE if not exists raw_edu.courses (\n      course_id SERIAL PRIMARY KEY,\n      course_code TEXT UNIQUE NOT NULL,\n      course_name TEXT NOT NULL,\n      description TEXT,\n      credits INT NOT NULL,\n      department_id INT,\n      prerequisite_course_id INT,\n      difficulty_level INT CHECK (difficulty_level BETWEEN 1 AND 5),\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 3. Departments table\n  CREATE TABLE if not exists raw_edu.departments (\n      department_id SERIAL PRIMARY KEY,\n      department_name TEXT NOT NULL,\n      department_code TEXT UNIQUE,\n      head_faculty_id INT,\n      budget DECIMAL(12,2),\n      building_location TEXT,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 4. Faculty table\n  CREATE TABLE if not exists raw_edu.faculty (\n      faculty_id SERIAL PRIMARY KEY,\n      first_name TEXT NOT NULL,\n      last_name TEXT NOT NULL,\n      email TEXT UNIQUE,\n      department_id INT,\n      position TEXT,\n      salary DECIMAL(10,2),\n      hire_date DATE,\n      office_number TEXT,\n      research_interests TEXT[],\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 5. Enrollments table (junction table)\n  CREATE TABLE if not exists raw_edu.enrollments (\n      enrollment_id SERIAL PRIMARY KEY,\n      student_id INT,\n      course_id INT,\n      semester_id INT,\n      enrollment_date DATE,\n      completion_date DATE,\n      grade TEXT,\n      grade_points DECIMAL(3,2),\n      attendance_percentage DECIMAL(5,2),\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 6. Semesters table\n  CREATE TABLE if not exists raw_edu.semesters (\n      semester_id SERIAL PRIMARY KEY,\n      semester_name TEXT NOT NULL,\n      academic_year TEXT,\n      start_date DATE,\n      end_date DATE,\n      is_current BOOLEAN DEFAULT false,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 7. Class sessions table\n  CREATE TABLE if not exists raw_edu.class_sessions (\n      session_id SERIAL PRIMARY KEY,\n      course_id INT,\n      faculty_id INT,\n      semester_id INT,\n      session_time TIME,\n      session_date DATE,\n      room_id INT,\n      attendance_count INT,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 8. Assignments table\n  CREATE TABLE if not exists raw_edu.assignments (\n      assignment_id SERIAL PRIMARY KEY,\n      course_id INT,\n      semester_id INT,\n      assignment_name TEXT NOT NULL,\n      assignment_type TEXT,\n      due_date DATE,\n      max_points DECIMAL(6,2),\n      weight_percentage DECIMAL(5,2),\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 9. Assignment submissions table\n  CREATE TABLE if not exists raw_edu.assignment_submissions (\n      submission_id SERIAL PRIMARY KEY,\n      assignment_id INT,\n      student_id INT,\n      submission_date TIMESTAMP,\n      score DECIMAL(6,2),\n      late_submission BOOLEAN DEFAULT false,\n      feedback TEXT,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 10. Financial aid table\n  CREATE TABLE if not exists raw_edu.financial_aid (\n      aid_id SERIAL PRIMARY KEY,\n      student_id INT,\n      aid_type TEXT,\n      amount DECIMAL(10,2),\n      academic_year TEXT,\n      disbursement_date DATE,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 11. Tuition payments table\n  CREATE TABLE if not exists raw_edu.tuition_payments (\n      payment_id SERIAL PRIMARY KEY,\n      student_id INT,\n      semester_id INT,\n      amount DECIMAL(10,2),\n      payment_date DATE,\n      payment_method TEXT,\n      late_fee DECIMAL(8,2) DEFAULT 0,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- Clear existing data\n  TRUNCATE TABLE raw_edu.students, raw_edu.courses, raw_edu.departments, raw_edu.faculty, \n                raw_edu.enrollments, raw_edu.semesters, raw_edu.class_sessions, \n                raw_edu.assignments, raw_edu.assignment_submissions, raw_edu.financial_aid, \n                raw_edu.tuition_payments CASCADE;\n\n  -- Insert sample data\n  INSERT INTO raw_edu.departments (department_name, department_code, budget, building_location) VALUES\n      ('Computer Science', 'CS', 2500000.00, 'Tech Building A'),\n      ('Mathematics', 'MATH', 1800000.00, 'Science Hall'),\n      ('Business Administration', 'BUS', 3200000.00, 'Business Center'),\n      ('Psychology', 'PSYC', 1500000.00, 'Liberal Arts Building'),\n      ('Engineering', 'ENG', 4000000.00, 'Engineering Complex');\n\n  INSERT INTO raw_edu.faculty (first_name, last_name, email, department_id, position, salary, hire_date, office_number) VALUES\n      ('John', 'Smith', 'j.smith@edu.edu', 1, 'Professor', 95000.00, '2015-08-15', 'TA-201'),\n      ('Sarah', 'Johnson', 's.johnson@edu.edu', 1, 'Associate Professor', 78000.00, '2018-01-10', 'TA-205'),\n      ('Michael', 'Brown', 'm.brown@edu.edu', 2, 'Professor', 89000.00, '2012-09-01', 'SH-301'),\n      ('Emily', 'Davis', 'e.davis@edu.edu', 3, 'Assistant Professor', 72000.00, '2020-08-20', 'BC-401'),\n      ('Robert', 'Wilson', 'r.wilson@edu.edu', 5, 'Professor', 105000.00, '2010-01-15', 'EC-101');\n\n  INSERT INTO raw_edu.semesters (semester_name, academic_year, start_date, end_date, is_current) VALUES\n      ('Fall 2023', '2023-2024', '2023-08-28', '2023-12-15', false),\n      ('Spring 2024', '2023-2024', '2024-01-15', '2024-05-10', false),\n      ('Fall 2024', '2024-2025', '2024-08-26', '2024-12-13', true),\n      ('Spring 2025', '2024-2025', '2025-01-13', '2025-05-08', false);\n\n  INSERT INTO raw_edu.courses (course_code, course_name, credits, department_id, difficulty_level) VALUES\n      ('CS101', 'Introduction to Computer Science', 3, 1, 1),\n      ('CS201', 'Data Structures and Algorithms', 4, 1, 3),\n      ('CS301', 'Database Systems', 3, 1, 3),\n      ('CS401', 'Machine Learning', 4, 1, 4),\n      ('MATH101', 'Calculus I', 4, 2, 2),\n      ('MATH201', 'Linear Algebra', 3, 2, 3),\n      ('MATH301', 'Statistics', 3, 2, 2),\n      ('BUS101', 'Introduction to Business', 3, 3, 1),\n      ('BUS201', 'Marketing Principles', 3, 3, 2),\n      ('BUS301', 'Financial Management', 4, 3, 3),\n      ('PSYC101', 'General Psychology', 3, 4, 1),\n      ('ENG101', 'Engineering Fundamentals', 4, 5, 2);\n\n  INSERT INTO raw_edu.students (first_name, last_name, email, date_of_birth, enrollment_date, student_status, gpa, major_id, address_id) VALUES\n      ('Alice', 'Anderson', 'alice.anderson@student.edu', '2002-03-15', '2022-08-28', 'active', 3.75, 1, 1),\n      ('Bob', 'Baker', 'bob.baker@student.edu', '2001-11-22', '2021-08-30', 'active', 3.20, 1, 2),\n      ('Charlie', 'Chen', 'charlie.chen@student.edu', '2003-07-08', '2023-08-28', 'active', 3.90, 2, 3),\n      ('Diana', 'Davis', 'diana.davis@student.edu', '2002-01-12', '2022-08-28', 'active', 3.45, 3, 4),\n      ('Edward', 'Evans', 'edward.evans@student.edu', '2000-09-18', '2020-08-31', 'graduated', 3.60, 1, 5),\n      ('Fiona', 'Foster', 'fiona.foster@student.edu', '2002-05-25', '2022-08-28', 'active', 3.85, 5, 6),\n      ('George', 'Garcia', 'george.garcia@student.edu', '2003-12-03', '2023-08-28', 'active', 2.95, 4, 7),\n      ('Hannah', 'Harris', 'hannah.harris@student.edu', '2001-06-14', '2021-08-30', 'active', 3.70, 2, 8);\n\n{% endset %}\n{{ creation_query_str }}", "language": "sql", "refs": [], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": []}, "compiled_path": "target/compiled/DbtEducationalDataProject/./dbt_project.yml/hooks/DbtEducationalDataProject-on-run-start-0.sql", "compiled": true, "compiled_code": "\n\n  -- Creating educational data schema and source tables\n  CREATE SCHEMA IF NOT EXISTS raw_edu;\n\n  -- 1. Students table\n  CREATE TABLE if not exists raw_edu.students (\n      student_id SERIAL PRIMARY KEY,\n      first_name TEXT NOT NULL,\n      last_name TEXT NOT NULL,\n      email TEXT UNIQUE,\n      date_of_birth DATE,\n      enrollment_date DATE,\n      graduation_date DATE,\n      student_status TEXT CHECK (student_status IN ('active', 'graduated', 'dropped', 'suspended')),\n      gpa DECIMAL(3,2),\n      major_id INT,\n      advisor_id INT,\n      address_id INT,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 2. Courses table\n  CREATE TABLE if not exists raw_edu.courses (\n      course_id SERIAL PRIMARY KEY,\n      course_code TEXT UNIQUE NOT NULL,\n      course_name TEXT NOT NULL,\n      description TEXT,\n      credits INT NOT NULL,\n      department_id INT,\n      prerequisite_course_id INT,\n      difficulty_level INT CHECK (difficulty_level BETWEEN 1 AND 5),\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 3. Departments table\n  CREATE TABLE if not exists raw_edu.departments (\n      department_id SERIAL PRIMARY KEY,\n      department_name TEXT NOT NULL,\n      department_code TEXT UNIQUE,\n      head_faculty_id INT,\n      budget DECIMAL(12,2),\n      building_location TEXT,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 4. Faculty table\n  CREATE TABLE if not exists raw_edu.faculty (\n      faculty_id SERIAL PRIMARY KEY,\n      first_name TEXT NOT NULL,\n      last_name TEXT NOT NULL,\n      email TEXT UNIQUE,\n      department_id INT,\n      position TEXT,\n      salary DECIMAL(10,2),\n      hire_date DATE,\n      office_number TEXT,\n      research_interests TEXT[],\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 5. Enrollments table (junction table)\n  CREATE TABLE if not exists raw_edu.enrollments (\n      enrollment_id SERIAL PRIMARY KEY,\n      student_id INT,\n      course_id INT,\n      semester_id INT,\n      enrollment_date DATE,\n      completion_date DATE,\n      grade TEXT,\n      grade_points DECIMAL(3,2),\n      attendance_percentage DECIMAL(5,2),\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 6. Semesters table\n  CREATE TABLE if not exists raw_edu.semesters (\n      semester_id SERIAL PRIMARY KEY,\n      semester_name TEXT NOT NULL,\n      academic_year TEXT,\n      start_date DATE,\n      end_date DATE,\n      is_current BOOLEAN DEFAULT false,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 7. Class sessions table\n  CREATE TABLE if not exists raw_edu.class_sessions (\n      session_id SERIAL PRIMARY KEY,\n      course_id INT,\n      faculty_id INT,\n      semester_id INT,\n      session_time TIME,\n      session_date DATE,\n      room_id INT,\n      attendance_count INT,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 8. Assignments table\n  CREATE TABLE if not exists raw_edu.assignments (\n      assignment_id SERIAL PRIMARY KEY,\n      course_id INT,\n      semester_id INT,\n      assignment_name TEXT NOT NULL,\n      assignment_type TEXT,\n      due_date DATE,\n      max_points DECIMAL(6,2),\n      weight_percentage DECIMAL(5,2),\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 9. Assignment submissions table\n  CREATE TABLE if not exists raw_edu.assignment_submissions (\n      submission_id SERIAL PRIMARY KEY,\n      assignment_id INT,\n      student_id INT,\n      submission_date TIMESTAMP,\n      score DECIMAL(6,2),\n      late_submission BOOLEAN DEFAULT false,\n      feedback TEXT,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 10. Financial aid table\n  CREATE TABLE if not exists raw_edu.financial_aid (\n      aid_id SERIAL PRIMARY KEY,\n      student_id INT,\n      aid_type TEXT,\n      amount DECIMAL(10,2),\n      academic_year TEXT,\n      disbursement_date DATE,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- 11. Tuition payments table\n  CREATE TABLE if not exists raw_edu.tuition_payments (\n      payment_id SERIAL PRIMARY KEY,\n      student_id INT,\n      semester_id INT,\n      amount DECIMAL(10,2),\n      payment_date DATE,\n      payment_method TEXT,\n      late_fee DECIMAL(8,2) DEFAULT 0,\n      created_at TIMESTAMP DEFAULT now()\n  );\n\n  -- Clear existing data\n  TRUNCATE TABLE raw_edu.students, raw_edu.courses, raw_edu.departments, raw_edu.faculty, \n                raw_edu.enrollments, raw_edu.semesters, raw_edu.class_sessions, \n                raw_edu.assignments, raw_edu.assignment_submissions, raw_edu.financial_aid, \n                raw_edu.tuition_payments CASCADE;\n\n  -- Insert sample data\n  INSERT INTO raw_edu.departments (department_name, department_code, budget, building_location) VALUES\n      ('Computer Science', 'CS', 2500000.00, 'Tech Building A'),\n      ('Mathematics', 'MATH', 1800000.00, 'Science Hall'),\n      ('Business Administration', 'BUS', 3200000.00, 'Business Center'),\n      ('Psychology', 'PSYC', 1500000.00, 'Liberal Arts Building'),\n      ('Engineering', 'ENG', 4000000.00, 'Engineering Complex');\n\n  INSERT INTO raw_edu.faculty (first_name, last_name, email, department_id, position, salary, hire_date, office_number) VALUES\n      ('John', 'Smith', 'j.smith@edu.edu', 1, 'Professor', 95000.00, '2015-08-15', 'TA-201'),\n      ('Sarah', 'Johnson', 's.johnson@edu.edu', 1, 'Associate Professor', 78000.00, '2018-01-10', 'TA-205'),\n      ('Michael', 'Brown', 'm.brown@edu.edu', 2, 'Professor', 89000.00, '2012-09-01', 'SH-301'),\n      ('Emily', 'Davis', 'e.davis@edu.edu', 3, 'Assistant Professor', 72000.00, '2020-08-20', 'BC-401'),\n      ('Robert', 'Wilson', 'r.wilson@edu.edu', 5, 'Professor', 105000.00, '2010-01-15', 'EC-101');\n\n  INSERT INTO raw_edu.semesters (semester_name, academic_year, start_date, end_date, is_current) VALUES\n      ('Fall 2023', '2023-2024', '2023-08-28', '2023-12-15', false),\n      ('Spring 2024', '2023-2024', '2024-01-15', '2024-05-10', false),\n      ('Fall 2024', '2024-2025', '2024-08-26', '2024-12-13', true),\n      ('Spring 2025', '2024-2025', '2025-01-13', '2025-05-08', false);\n\n  INSERT INTO raw_edu.courses (course_code, course_name, credits, department_id, difficulty_level) VALUES\n      ('CS101', 'Introduction to Computer Science', 3, 1, 1),\n      ('CS201', 'Data Structures and Algorithms', 4, 1, 3),\n      ('CS301', 'Database Systems', 3, 1, 3),\n      ('CS401', 'Machine Learning', 4, 1, 4),\n      ('MATH101', 'Calculus I', 4, 2, 2),\n      ('MATH201', 'Linear Algebra', 3, 2, 3),\n      ('MATH301', 'Statistics', 3, 2, 2),\n      ('BUS101', 'Introduction to Business', 3, 3, 1),\n      ('BUS201', 'Marketing Principles', 3, 3, 2),\n      ('BUS301', 'Financial Management', 4, 3, 3),\n      ('PSYC101', 'General Psychology', 3, 4, 1),\n      ('ENG101', 'Engineering Fundamentals', 4, 5, 2);\n\n  INSERT INTO raw_edu.students (first_name, last_name, email, date_of_birth, enrollment_date, student_status, gpa, major_id, address_id) VALUES\n      ('Alice', 'Anderson', 'alice.anderson@student.edu', '2002-03-15', '2022-08-28', 'active', 3.75, 1, 1),\n      ('Bob', 'Baker', 'bob.baker@student.edu', '2001-11-22', '2021-08-30', 'active', 3.20, 1, 2),\n      ('Charlie', 'Chen', 'charlie.chen@student.edu', '2003-07-08', '2023-08-28', 'active', 3.90, 2, 3),\n      ('Diana', 'Davis', 'diana.davis@student.edu', '2002-01-12', '2022-08-28', 'active', 3.45, 3, 4),\n      ('Edward', 'Evans', 'edward.evans@student.edu', '2000-09-18', '2020-08-31', 'graduated', 3.60, 1, 5),\n      ('Fiona', 'Foster', 'fiona.foster@student.edu', '2002-05-25', '2022-08-28', 'active', 3.85, 5, 6),\n      ('George', 'Garcia', 'george.garcia@student.edu', '2003-12-03', '2023-08-28', 'active', 2.95, 4, 7),\n      ('Hannah', 'Harris', 'hannah.harris@student.edu', '2001-06-14', '2021-08-30', 'active', 3.70, 2, 8);\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "index": 0}, "test.DbtEducationalDataProject.source_unique_raw_edu_students_student_id.273b9e80b8": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_unique_raw_edu_students_student_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_unique_raw_edu_students_student_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_unique_raw_edu_students_student_id.273b9e80b8", "fqn": ["DbtEducationalDataProject", "staging", "source_unique_raw_edu_students_student_id"], "alias": "source_unique_raw_edu_students_student_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5232801, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "students"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.students"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_unique_raw_edu_students_student_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    student_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"raw_edu\".\"students\"\nwhere student_id is not null\ngroup by student_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "student_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "unique", "kwargs": {"column_name": "student_id", "model": "{{ get_where_subquery(source('raw_edu', 'students')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_not_null_raw_edu_students_student_id.68c346ddce": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_not_null_raw_edu_students_student_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_not_null_raw_edu_students_student_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_not_null_raw_edu_students_student_id.68c346ddce", "fqn": ["DbtEducationalDataProject", "staging", "source_not_null_raw_edu_students_student_id"], "alias": "source_not_null_raw_edu_students_student_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5241566, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "students"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.students"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_not_null_raw_edu_students_student_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect student_id\nfrom \"postgres\".\"raw_edu\".\"students\"\nwhere student_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "student_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "not_null", "kwargs": {"column_name": "student_id", "model": "{{ get_where_subquery(source('raw_edu', 'students')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_unique_raw_edu_students_email.8e5aa3c149": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_unique_raw_edu_students_email", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_unique_raw_edu_students_email.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_unique_raw_edu_students_email.8e5aa3c149", "fqn": ["DbtEducationalDataProject", "staging", "source_unique_raw_edu_students_email"], "alias": "source_unique_raw_edu_students_email", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.52481, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "students"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.students"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_unique_raw_edu_students_email.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"raw_edu\".\"students\"\nwhere email is not null\ngroup by email\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "email", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "unique", "kwargs": {"column_name": "email", "model": "{{ get_where_subquery(source('raw_edu', 'students')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_id.49ad13d893": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_unique_raw_edu_courses_course_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_unique_raw_edu_courses_course_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_id.49ad13d893", "fqn": ["DbtEducationalDataProject", "staging", "source_unique_raw_edu_courses_course_id"], "alias": "source_unique_raw_edu_courses_course_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.527926, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "courses"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.courses"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_unique_raw_edu_courses_course_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    course_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"raw_edu\".\"courses\"\nwhere course_id is not null\ngroup by course_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "course_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "unique", "kwargs": {"column_name": "course_id", "model": "{{ get_where_subquery(source('raw_edu', 'courses')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_not_null_raw_edu_courses_course_id.5edcac83bf": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_not_null_raw_edu_courses_course_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_not_null_raw_edu_courses_course_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_not_null_raw_edu_courses_course_id.5edcac83bf", "fqn": ["DbtEducationalDataProject", "staging", "source_not_null_raw_edu_courses_course_id"], "alias": "source_not_null_raw_edu_courses_course_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5286057, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "courses"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.courses"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_not_null_raw_edu_courses_course_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect course_id\nfrom \"postgres\".\"raw_edu\".\"courses\"\nwhere course_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "course_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "not_null", "kwargs": {"column_name": "course_id", "model": "{{ get_where_subquery(source('raw_edu', 'courses')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_code.f3f1b74b67": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_unique_raw_edu_courses_course_code", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_unique_raw_edu_courses_course_code.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_code.f3f1b74b67", "fqn": ["DbtEducationalDataProject", "staging", "source_unique_raw_edu_courses_course_code"], "alias": "source_unique_raw_edu_courses_course_code", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.529378, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "courses"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.courses"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_unique_raw_edu_courses_course_code.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    course_code as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"raw_edu\".\"courses\"\nwhere course_code is not null\ngroup by course_code\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "course_code", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "unique", "kwargs": {"column_name": "course_code", "model": "{{ get_where_subquery(source('raw_edu', 'courses')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_unique_raw_edu_departments_department_id.914559752d": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_unique_raw_edu_departments_department_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_unique_raw_edu_departments_department_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_unique_raw_edu_departments_department_id.914559752d", "fqn": ["DbtEducationalDataProject", "staging", "source_unique_raw_edu_departments_department_id"], "alias": "source_unique_raw_edu_departments_department_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5304408, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "departments"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.departments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_unique_raw_edu_departments_department_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    department_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"raw_edu\".\"departments\"\nwhere department_id is not null\ngroup by department_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "department_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "unique", "kwargs": {"column_name": "department_id", "model": "{{ get_where_subquery(source('raw_edu', 'departments')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_not_null_raw_edu_departments_department_id.8898c54eb5": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_not_null_raw_edu_departments_department_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_not_null_raw_edu_departments_department_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_not_null_raw_edu_departments_department_id.8898c54eb5", "fqn": ["DbtEducationalDataProject", "staging", "source_not_null_raw_edu_departments_department_id"], "alias": "source_not_null_raw_edu_departments_department_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5310848, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "departments"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.departments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_not_null_raw_edu_departments_department_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect department_id\nfrom \"postgres\".\"raw_edu\".\"departments\"\nwhere department_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "department_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "not_null", "kwargs": {"column_name": "department_id", "model": "{{ get_where_subquery(source('raw_edu', 'departments')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_unique_raw_edu_faculty_faculty_id.21f766bfcb": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_unique_raw_edu_faculty_faculty_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_unique_raw_edu_faculty_faculty_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_unique_raw_edu_faculty_faculty_id.21f766bfcb", "fqn": ["DbtEducationalDataProject", "staging", "source_unique_raw_edu_faculty_faculty_id"], "alias": "source_unique_raw_edu_faculty_faculty_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5318277, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "faculty"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.faculty"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_unique_raw_edu_faculty_faculty_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    faculty_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"raw_edu\".\"faculty\"\nwhere faculty_id is not null\ngroup by faculty_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "faculty_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "unique", "kwargs": {"column_name": "faculty_id", "model": "{{ get_where_subquery(source('raw_edu', 'faculty')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_not_null_raw_edu_faculty_faculty_id.5f1ce05a5f": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_not_null_raw_edu_faculty_faculty_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_not_null_raw_edu_faculty_faculty_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_not_null_raw_edu_faculty_faculty_id.5f1ce05a5f", "fqn": ["DbtEducationalDataProject", "staging", "source_not_null_raw_edu_faculty_faculty_id"], "alias": "source_not_null_raw_edu_faculty_faculty_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.532473, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "faculty"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.faculty"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_not_null_raw_edu_faculty_faculty_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect faculty_id\nfrom \"postgres\".\"raw_edu\".\"faculty\"\nwhere faculty_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "faculty_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "not_null", "kwargs": {"column_name": "faculty_id", "model": "{{ get_where_subquery(source('raw_edu', 'faculty')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_unique_raw_edu_enrollments_enrollment_id.4ac0dbbc65": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_unique_raw_edu_enrollments_enrollment_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_unique_raw_edu_enrollments_enrollment_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_unique_raw_edu_enrollments_enrollment_id.4ac0dbbc65", "fqn": ["DbtEducationalDataProject", "staging", "source_unique_raw_edu_enrollments_enrollment_id"], "alias": "source_unique_raw_edu_enrollments_enrollment_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5332394, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "enrollments"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.enrollments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_unique_raw_edu_enrollments_enrollment_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    enrollment_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"raw_edu\".\"enrollments\"\nwhere enrollment_id is not null\ngroup by enrollment_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "enrollment_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "unique", "kwargs": {"column_name": "enrollment_id", "model": "{{ get_where_subquery(source('raw_edu', 'enrollments')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_not_null_raw_edu_enrollments_enrollment_id.e39474af5f": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_not_null_raw_edu_enrollments_enrollment_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_not_null_raw_edu_enrollments_enrollment_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_not_null_raw_edu_enrollments_enrollment_id.e39474af5f", "fqn": ["DbtEducationalDataProject", "staging", "source_not_null_raw_edu_enrollments_enrollment_id"], "alias": "source_not_null_raw_edu_enrollments_enrollment_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5339253, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "enrollments"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.enrollments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_not_null_raw_edu_enrollments_enrollment_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect enrollment_id\nfrom \"postgres\".\"raw_edu\".\"enrollments\"\nwhere enrollment_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "enrollment_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "not_null", "kwargs": {"column_name": "enrollment_id", "model": "{{ get_where_subquery(source('raw_edu', 'enrollments')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_unique_raw_edu_semesters_semester_id.075a1856be": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_unique_raw_edu_semesters_semester_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_unique_raw_edu_semesters_semester_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_unique_raw_edu_semesters_semester_id.075a1856be", "fqn": ["DbtEducationalDataProject", "staging", "source_unique_raw_edu_semesters_semester_id"], "alias": "source_unique_raw_edu_semesters_semester_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5346026, "relation_name": null, "raw_code": "{{ test_unique(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "semesters"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_unique", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.semesters"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_unique_raw_edu_semesters_semester_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    semester_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"raw_edu\".\"semesters\"\nwhere semester_id is not null\ngroup by semester_id\nhaving count(*) > 1\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "semester_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "unique", "kwargs": {"column_name": "semester_id", "model": "{{ get_where_subquery(source('raw_edu', 'semesters')) }}"}, "namespace": null}}, "test.DbtEducationalDataProject.source_not_null_raw_edu_semesters_semester_id.b32a2d2cfd": {"database": "postgres", "schema": "edu_dbt_dbt_test__audit", "name": "source_not_null_raw_edu_semesters_semester_id", "resource_type": "test", "package_name": "DbtEducationalDataProject", "path": "source_not_null_raw_edu_semesters_semester_id.sql", "original_file_path": "models/staging/sources.yml", "unique_id": "test.DbtEducationalDataProject.source_not_null_raw_edu_semesters_semester_id.b32a2d2cfd", "fqn": ["DbtEducationalDataProject", "staging", "source_not_null_raw_edu_semesters_semester_id"], "alias": "source_not_null_raw_edu_semesters_semester_id", "checksum": {"name": "none", "checksum": ""}, "config": {"enabled": true, "alias": null, "schema": "dbt_test__audit", "database": null, "tags": [], "meta": {}, "group": null, "materialized": "test", "severity": "ERROR", "store_failures": null, "store_failures_as": null, "where": null, "limit": null, "fail_calc": "count(*)", "warn_if": "!= 0", "error_if": "!= 0"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {}, "created_at": 1764371903.5352051, "relation_name": null, "raw_code": "{{ test_not_null(**_dbt_generic_test_kwargs) }}", "language": "sql", "refs": [], "sources": [["raw_edu", "semesters"]], "metrics": [], "depends_on": {"macros": ["macro.dbt.test_not_null", "macro.dbt.get_where_subquery"], "nodes": ["source.DbtEducationalDataProject.raw_edu.semesters"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/sources.yml/source_not_null_raw_edu_semesters_semester_id.sql", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect semester_id\nfrom \"postgres\".\"raw_edu\".\"semesters\"\nwhere semester_id is null\n\n\n", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "column_name": "semester_id", "file_key_name": "sources.raw_edu", "attached_node": null, "test_metadata": {"name": "not_null", "kwargs": {"column_name": "semester_id", "model": "{{ get_where_subquery(source('raw_edu', 'semesters')) }}"}, "namespace": null}}, "model.DbtEducationalDataProject.stg_students": {"database": "postgres", "schema": "edu_dbt", "name": "stg_students", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "staging/stg_students.sql", "original_file_path": "models/staging/stg_students.sql", "unique_id": "model.DbtEducationalDataProject.stg_students", "fqn": ["DbtEducationalDataProject", "staging", "stg_students"], "alias": "stg_students", "checksum": {"name": "sha256", "checksum": "add7509b0371f65a8e3782a250574d45239438bddd13d0232f0293c6290fc078"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764373011.903746, "relation_name": "\"postgres\".\"edu_dbt\".\"stg_students\"", "raw_code": "{{ config(materialized='view') }}\n\nwith source_data as (\n    select\n        student_id,\n        first_name,\n        last_name,\n        first_name || ' ' || last_name as full_name,\n        email,\n        date_of_birth,\n        enrollment_date,\n        graduation_date,\n        student_status,\n        gpa,\n        major_id,\n        advisor_id,\n        address_id,\n        extract(year from age(current_date, date_of_birth)) as age,\n        extract(year from age(current_date, enrollment_date)) as years_enrolled,\n        case \n            when gpa >= 3.5 then 'Deans List'\n            when gpa >= 3.0 then 'Good Standing'\n            when gpa >= 2.0 then 'Academic Warning'\n            else 'Academic Probation'\n        end as academic_standing,\n        case\n            when graduation_date is not null then 'Graduated'\n            when student_status = 'active' and gpa >= 2.0 then 'Active'\n            when student_status = 'active' and gpa < 2.0 then 'At Risk'\n            else initcap(student_status)\n        end as current_status,\n        created_at\n    from {{ source('raw_edu', 'students') }}\n)\n\nselect * from source_data", "language": "sql", "refs": [], "sources": [["raw_edu", "students"]], "metrics": [], "depends_on": {"macros": [], "nodes": ["source.DbtEducationalDataProject.raw_edu.students"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/staging/stg_students.sql", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        student_id,\n        first_name,\n        last_name,\n        first_name || ' ' || last_name as full_name,\n        email,\n        date_of_birth,\n        enrollment_date,\n        graduation_date,\n        student_status,\n        gpa,\n        major_id,\n        advisor_id,\n        address_id,\n        extract(year from age(current_date, date_of_birth)) as age,\n        extract(year from age(current_date, enrollment_date)) as years_enrolled,\n        case \n            when gpa >= 3.5 then 'Deans List'\n            when gpa >= 3.0 then 'Good Standing'\n            when gpa >= 2.0 then 'Academic Warning'\n            else 'Academic Probation'\n        end as academic_standing,\n        case\n            when graduation_date is not null then 'Graduated'\n            when student_status = 'active' and gpa >= 2.0 then 'Active'\n            when student_status = 'active' and gpa < 2.0 then 'At Risk'\n            else initcap(student_status)\n        end as current_status,\n        created_at\n    from \"postgres\".\"raw_edu\".\"students\"\n)\n\nselect * from source_data", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.semester_enrollment_trends": {"database": "postgres", "schema": "edu_dbt", "name": "semester_enrollment_trends", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/academic/semester_enrollment_trends.sql", "original_file_path": "models/marts/academic/semester_enrollment_trends.sql", "unique_id": "model.DbtEducationalDataProject.semester_enrollment_trends", "fqn": ["DbtEducationalDataProject", "marts", "academic", "semester_enrollment_trends"], "alias": "semester_enrollment_trends", "checksum": {"name": "sha256", "checksum": "c23929b066c9a4dd4c7c978d3e34455cc59a47d70f0b033d2404be281ab4fd62"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764373663.657088, "relation_name": "\"postgres\".\"edu_dbt\".\"semester_enrollment_trends\"", "raw_code": "{{ config(materialized='table') }}\n\nwith semester_data as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        sem.start_date,\n        sem.end_date,\n        sem.semester_duration_days,\n        sem.semester_status,\n        count(distinct e.enrollment_id) as total_enrollments,\n        count(distinct e.student_id) as unique_students,\n        count(distinct e.course_id) as unique_courses,\n        count(distinct d.department_id) as departments_with_enrollments,\n        avg(e.grade_points) as avg_semester_grade_points,\n        avg(e.attendance_percentage) as avg_semester_attendance,\n        sum(c.credits) as total_credit_hours_enrolled,\n        count(case when e.grade_category = 'Excellent' then 1 end) as excellent_grades,\n        count(case when e.grade_category = 'Good' then 1 end) as good_grades,\n        count(case when e.grade_category = 'Satisfactory' then 1 end) as satisfactory_grades,\n        count(case when e.grade_category = 'Poor' then 1 end) as poor_grades,\n        count(case when e.grade_category = 'Failing' then 1 end) as failing_grades,\n        count(case when e.enrollment_status = 'Withdrawn' then 1 end) as withdrawals,\n        count(case when s.academic_standing = 'Deans List' then 1 end) as deans_list_students,\n        count(case when s.academic_standing = 'Academic Probation' then 1 end) as probation_students,\n        avg(c.difficulty_level) as avg_course_difficulty\n    from {{ ref('stg_semesters') }} sem\n    left join {{ ref('stg_enrollments') }} e on sem.semester_id = e.semester_id\n    left join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    left join {{ ref('stg_students') }} s on e.student_id = s.student_id\n    left join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    group by \n        sem.semester_id, sem.semester_name, sem.academic_year, sem.semester_type,\n        sem.start_date, sem.end_date, sem.semester_duration_days, sem.semester_status\n),\n\ntrend_analysis as (\n    select\n        *,\n        lag(total_enrollments) over (order by start_date) as prev_semester_enrollments,\n        lag(unique_students) over (order by start_date) as prev_semester_students,\n        lag(avg_semester_grade_points) over (order by start_date) as prev_semester_gpa,\n        round(\n            (total_enrollments - lag(total_enrollments) over (order by start_date)) * 100.0 / \n            nullif(lag(total_enrollments) over (order by start_date), 0), 2\n        ) as enrollment_growth_rate,\n        round(\n            (unique_students - lag(unique_students) over (order by start_date)) * 100.0 / \n            nullif(lag(unique_students) over (order by start_date), 0), 2\n        ) as student_growth_rate,\n        round(\n            (excellent_grades + good_grades + satisfactory_grades) * 100.0 / \n            nullif(total_enrollments, 0), 2\n        ) as success_rate,\n        round(withdrawals * 100.0 / nullif(total_enrollments, 0), 2) as withdrawal_rate,\n        round(total_credit_hours_enrolled::numeric / nullif(unique_students, 0), 2) as avg_credit_load_per_student,\n        round(deans_list_students * 100.0 / nullif(unique_students, 0), 2) as deans_list_percentage,\n        round(probation_students * 100.0 / nullif(unique_students, 0), 2) as probation_percentage\n    from semester_data\n),\n\nseasonal_patterns as (\n    select\n        semester_type,\n        count(*) as semester_count,\n        avg(total_enrollments) as avg_enrollments_by_season,\n        avg(unique_students) as avg_students_by_season,\n        avg(success_rate) as avg_success_rate_by_season,\n        avg(withdrawal_rate) as avg_withdrawal_rate_by_season,\n        avg(avg_semester_grade_points) as avg_gpa_by_season,\n        avg(avg_credit_load_per_student) as avg_credit_load_by_season\n    from trend_analysis\n    group by semester_type\n),\n\nperformance_categories as (\n    select\n        ta.*,\n        sp.avg_enrollments_by_season,\n        sp.avg_success_rate_by_season,\n        sp.avg_withdrawal_rate_by_season,\n        sp.avg_gpa_by_season,\n        case\n            when success_rate >= 85 then 'High Performing Semester'\n            when success_rate >= 70 then 'Good Performing Semester'\n            when success_rate >= 60 then 'Average Performing Semester'\n            else 'Low Performing Semester'\n        end as semester_performance_category,\n        case\n            when withdrawal_rate <= 5 then 'Low Attrition'\n            when withdrawal_rate <= 10 then 'Moderate Attrition'\n            when withdrawal_rate <= 15 then 'High Attrition'\n            else 'Very High Attrition'\n        end as attrition_category,\n        case\n            when enrollment_growth_rate > 10 then 'High Growth'\n            when enrollment_growth_rate > 0 then 'Positive Growth'\n            when enrollment_growth_rate = 0 then 'No Growth'\n            when enrollment_growth_rate > -10 then 'Decline'\n            else 'Significant Decline'\n        end as growth_category,\n        case\n            when avg_credit_load_per_student >= 15 then 'Heavy Course Load'\n            when avg_credit_load_per_student >= 12 then 'Standard Course Load'\n            when avg_credit_load_per_student >= 9 then 'Light Course Load'\n            else 'Very Light Course Load'\n        end as course_load_category\n    from trend_analysis ta\n    left join seasonal_patterns sp on ta.semester_type = sp.semester_type\n)\n\nselect * from performance_categories\norder by start_date", "language": "sql", "refs": [{"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/academic/semester_enrollment_trends.sql", "compiled": true, "compiled_code": "\n\nwith semester_data as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        sem.start_date,\n        sem.end_date,\n        sem.semester_duration_days,\n        sem.semester_status,\n        count(distinct e.enrollment_id) as total_enrollments,\n        count(distinct e.student_id) as unique_students,\n        count(distinct e.course_id) as unique_courses,\n        count(distinct d.department_id) as departments_with_enrollments,\n        avg(e.grade_points) as avg_semester_grade_points,\n        avg(e.attendance_percentage) as avg_semester_attendance,\n        sum(c.credits) as total_credit_hours_enrolled,\n        count(case when e.grade_category = 'Excellent' then 1 end) as excellent_grades,\n        count(case when e.grade_category = 'Good' then 1 end) as good_grades,\n        count(case when e.grade_category = 'Satisfactory' then 1 end) as satisfactory_grades,\n        count(case when e.grade_category = 'Poor' then 1 end) as poor_grades,\n        count(case when e.grade_category = 'Failing' then 1 end) as failing_grades,\n        count(case when e.enrollment_status = 'Withdrawn' then 1 end) as withdrawals,\n        count(case when s.academic_standing = 'Deans List' then 1 end) as deans_list_students,\n        count(case when s.academic_standing = 'Academic Probation' then 1 end) as probation_students,\n        avg(c.difficulty_level) as avg_course_difficulty\n    from \"postgres\".\"edu_dbt\".\"stg_semesters\" sem\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on sem.semester_id = e.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on e.student_id = s.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    group by \n        sem.semester_id, sem.semester_name, sem.academic_year, sem.semester_type,\n        sem.start_date, sem.end_date, sem.semester_duration_days, sem.semester_status\n),\n\ntrend_analysis as (\n    select\n        *,\n        lag(total_enrollments) over (order by start_date) as prev_semester_enrollments,\n        lag(unique_students) over (order by start_date) as prev_semester_students,\n        lag(avg_semester_grade_points) over (order by start_date) as prev_semester_gpa,\n        round(\n            (total_enrollments - lag(total_enrollments) over (order by start_date)) * 100.0 / \n            nullif(lag(total_enrollments) over (order by start_date), 0), 2\n        ) as enrollment_growth_rate,\n        round(\n            (unique_students - lag(unique_students) over (order by start_date)) * 100.0 / \n            nullif(lag(unique_students) over (order by start_date), 0), 2\n        ) as student_growth_rate,\n        round(\n            (excellent_grades + good_grades + satisfactory_grades) * 100.0 / \n            nullif(total_enrollments, 0), 2\n        ) as success_rate,\n        round(withdrawals * 100.0 / nullif(total_enrollments, 0), 2) as withdrawal_rate,\n        round(total_credit_hours_enrolled::numeric / nullif(unique_students, 0), 2) as avg_credit_load_per_student,\n        round(deans_list_students * 100.0 / nullif(unique_students, 0), 2) as deans_list_percentage,\n        round(probation_students * 100.0 / nullif(unique_students, 0), 2) as probation_percentage\n    from semester_data\n),\n\nseasonal_patterns as (\n    select\n        semester_type,\n        count(*) as semester_count,\n        avg(total_enrollments) as avg_enrollments_by_season,\n        avg(unique_students) as avg_students_by_season,\n        avg(success_rate) as avg_success_rate_by_season,\n        avg(withdrawal_rate) as avg_withdrawal_rate_by_season,\n        avg(avg_semester_grade_points) as avg_gpa_by_season,\n        avg(avg_credit_load_per_student) as avg_credit_load_by_season\n    from trend_analysis\n    group by semester_type\n),\n\nperformance_categories as (\n    select\n        ta.*,\n        sp.avg_enrollments_by_season,\n        sp.avg_success_rate_by_season,\n        sp.avg_withdrawal_rate_by_season,\n        sp.avg_gpa_by_season,\n        case\n            when success_rate >= 85 then 'High Performing Semester'\n            when success_rate >= 70 then 'Good Performing Semester'\n            when success_rate >= 60 then 'Average Performing Semester'\n            else 'Low Performing Semester'\n        end as semester_performance_category,\n        case\n            when withdrawal_rate <= 5 then 'Low Attrition'\n            when withdrawal_rate <= 10 then 'Moderate Attrition'\n            when withdrawal_rate <= 15 then 'High Attrition'\n            else 'Very High Attrition'\n        end as attrition_category,\n        case\n            when enrollment_growth_rate > 10 then 'High Growth'\n            when enrollment_growth_rate > 0 then 'Positive Growth'\n            when enrollment_growth_rate = 0 then 'No Growth'\n            when enrollment_growth_rate > -10 then 'Decline'\n            else 'Significant Decline'\n        end as growth_category,\n        case\n            when avg_credit_load_per_student >= 15 then 'Heavy Course Load'\n            when avg_credit_load_per_student >= 12 then 'Standard Course Load'\n            when avg_credit_load_per_student >= 9 then 'Light Course Load'\n            else 'Very Light Course Load'\n        end as course_load_category\n    from trend_analysis ta\n    left join seasonal_patterns sp on ta.semester_type = sp.semester_type\n)\n\nselect * from performance_categories\norder by start_date", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_faculty_student_interactions": {"database": "postgres", "schema": "edu_dbt", "name": "int_faculty_student_interactions", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_faculty_student_interactions.sql", "original_file_path": "models/intermediate/int_faculty_student_interactions.sql", "unique_id": "model.DbtEducationalDataProject.int_faculty_student_interactions", "fqn": ["DbtEducationalDataProject", "intermediate", "int_faculty_student_interactions"], "alias": "int_faculty_student_interactions", "checksum": {"name": "sha256", "checksum": "d6aec088663866d8b1d860c49bf24f856444461f756eba335c6966fe1c48d23d"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764373663.667845, "relation_name": "\"postgres\".\"edu_dbt\".\"int_faculty_student_interactions\"", "raw_code": "{{ config(materialized='view') }}\n\nwith faculty_student_connections as (\n    select\n        f.faculty_id,\n        f.full_name as faculty_name,\n        f.position,\n        f.department_id,\n        f.years_of_service,\n        cs.course_id,\n        cs.semester_id,\n        e.student_id,\n        e.grade,\n        e.grade_points,\n        e.attendance_percentage,\n        e.grade_category,\n        s.full_name as student_name,\n        s.gpa as student_cumulative_gpa,\n        s.academic_standing,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.credits,\n        sem.semester_name,\n        sem.academic_year,\n        d.department_name\n    from {{ ref('stg_faculty') }} f\n    inner join {{ ref('stg_class_sessions') }} cs on f.faculty_id = cs.faculty_id\n    inner join {{ ref('stg_courses') }} c on cs.course_id = c.course_id\n    inner join {{ ref('stg_enrollments') }} e on c.course_id = e.course_id and cs.semester_id = e.semester_id\n    inner join {{ ref('stg_students') }} s on e.student_id = s.student_id\n    inner join {{ ref('stg_semesters') }} sem on cs.semester_id = sem.semester_id\n    inner join {{ ref('stg_departments') }} d on f.department_id = d.department_id\n),\n\nfaculty_teaching_effectiveness as (\n    select\n        faculty_id,\n        faculty_name,\n        position,\n        department_name,\n        years_of_service,\n        count(distinct student_id) as total_unique_students_taught,\n        count(distinct course_id) as unique_courses_taught,\n        count(distinct semester_id) as semesters_taught,\n        avg(grade_points) as avg_grade_given,\n        avg(attendance_percentage) as avg_student_attendance,\n        stddev(grade_points) as grade_consistency,\n        count(case when grade_category = 'Excellent' then 1 end) as excellent_grades_given,\n        count(case when grade_category = 'Good' then 1 end) as good_grades_given,\n        count(case when grade_category = 'Satisfactory' then 1 end) as satisfactory_grades_given,\n        count(case when grade_category = 'Poor' then 1 end) as poor_grades_given,\n        count(case when grade_category = 'Failing' then 1 end) as failing_grades_given,\n        round(\n            count(case when grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) * 100.0 / \n            nullif(count(case when grade_category != 'Unknown' then 1 end), 0), 2\n        ) as student_success_rate,\n        avg(student_cumulative_gpa) as avg_incoming_student_gpa,\n        corr(student_cumulative_gpa, grade_points) as gpa_correlation_with_performance,\n        avg(difficulty_level) as avg_course_difficulty_taught,\n        sum(credits) as total_credit_hours_taught\n    from faculty_student_connections\n    group by faculty_id, faculty_name, position, department_name, years_of_service\n),\n\nstudent_faculty_exposure as (\n    select\n        student_id,\n        student_name,\n        student_cumulative_gpa,\n        academic_standing,\n        count(distinct faculty_id) as unique_faculty_encountered,\n        count(distinct department_id) as departments_studied_in,\n        avg(grade_points) as avg_grade_received,\n        string_agg(distinct faculty_name, ', ' order by faculty_name) as faculty_list,\n        count(case when position = 'Professor' then 1 end) as courses_with_professors,\n        count(case when position = 'Associate Professor' then 1 end) as courses_with_assoc_professors,\n        count(case when position = 'Assistant Professor' then 1 end) as courses_with_asst_professors,\n        avg(years_of_service) as avg_faculty_experience,\n        count(distinct course_id) as total_courses_taken\n    from faculty_student_connections\n    group by student_id, student_name, student_cumulative_gpa, academic_standing\n),\n\ninteraction_quality_metrics as (\n    select\n        fte.*,\n        case\n            when fte.student_success_rate >= 90 then 'Exceptional Educator'\n            when fte.student_success_rate >= 80 then 'Highly Effective Educator'\n            when fte.student_success_rate >= 70 then 'Effective Educator'\n            when fte.student_success_rate >= 60 then 'Adequate Educator'\n            else 'Needs Improvement'\n        end as teaching_effectiveness_category,\n        case\n            when fte.avg_student_attendance >= 95 then 'Highly Engaging'\n            when fte.avg_student_attendance >= 85 then 'Engaging'\n            when fte.avg_student_attendance >= 75 then 'Moderately Engaging'\n            else 'Low Engagement'\n        end as student_engagement_level,\n        case\n            when abs(fte.gpa_correlation_with_performance) >= 0.7 then 'Strong Predictor'\n            when abs(fte.gpa_correlation_with_performance) >= 0.4 then 'Moderate Predictor'\n            when abs(fte.gpa_correlation_with_performance) >= 0.2 then 'Weak Predictor'\n            else 'No Predictive Value'\n        end as prior_gpa_predictive_power,\n        case\n            when fte.grade_consistency <= 0.5 then 'Very Consistent Grading'\n            when fte.grade_consistency <= 1.0 then 'Consistent Grading'\n            when fte.grade_consistency <= 1.5 then 'Somewhat Inconsistent'\n            else 'Inconsistent Grading'\n        end as grading_consistency_level,\n        round(fte.total_unique_students_taught::numeric / fte.semesters_taught, 2) as avg_students_per_semester\n    from faculty_teaching_effectiveness fte\n)\n\nselect \n    iqm.*,\n    sfe.unique_faculty_encountered,\n    sfe.avg_faculty_experience,\n    sfe.courses_with_professors,\n    sfe.courses_with_assoc_professors,\n    sfe.courses_with_asst_professors\nfrom interaction_quality_metrics iqm\nleft join student_faculty_exposure sfe on 1=1  -- This creates a cartesian product for analysis", "language": "sql", "refs": [{"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_departments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_faculty_student_interactions.sql", "compiled": true, "compiled_code": "\n\nwith faculty_student_connections as (\n    select\n        f.faculty_id,\n        f.full_name as faculty_name,\n        f.position,\n        f.department_id,\n        f.years_of_service,\n        cs.course_id,\n        cs.semester_id,\n        e.student_id,\n        e.grade,\n        e.grade_points,\n        e.attendance_percentage,\n        e.grade_category,\n        s.full_name as student_name,\n        s.gpa as student_cumulative_gpa,\n        s.academic_standing,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.credits,\n        sem.semester_name,\n        sem.academic_year,\n        d.department_name\n    from \"postgres\".\"edu_dbt\".\"stg_faculty\" f\n    inner join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on f.faculty_id = cs.faculty_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on cs.course_id = c.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on c.course_id = e.course_id and cs.semester_id = e.semester_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_students\" s on e.student_id = s.student_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on cs.semester_id = sem.semester_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on f.department_id = d.department_id\n),\n\nfaculty_teaching_effectiveness as (\n    select\n        faculty_id,\n        faculty_name,\n        position,\n        department_name,\n        years_of_service,\n        count(distinct student_id) as total_unique_students_taught,\n        count(distinct course_id) as unique_courses_taught,\n        count(distinct semester_id) as semesters_taught,\n        avg(grade_points) as avg_grade_given,\n        avg(attendance_percentage) as avg_student_attendance,\n        stddev(grade_points) as grade_consistency,\n        count(case when grade_category = 'Excellent' then 1 end) as excellent_grades_given,\n        count(case when grade_category = 'Good' then 1 end) as good_grades_given,\n        count(case when grade_category = 'Satisfactory' then 1 end) as satisfactory_grades_given,\n        count(case when grade_category = 'Poor' then 1 end) as poor_grades_given,\n        count(case when grade_category = 'Failing' then 1 end) as failing_grades_given,\n        round(\n            count(case when grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) * 100.0 / \n            nullif(count(case when grade_category != 'Unknown' then 1 end), 0), 2\n        ) as student_success_rate,\n        avg(student_cumulative_gpa) as avg_incoming_student_gpa,\n        corr(student_cumulative_gpa, grade_points) as gpa_correlation_with_performance,\n        avg(difficulty_level) as avg_course_difficulty_taught,\n        sum(credits) as total_credit_hours_taught\n    from faculty_student_connections\n    group by faculty_id, faculty_name, position, department_name, years_of_service\n),\n\nstudent_faculty_exposure as (\n    select\n        student_id,\n        student_name,\n        student_cumulative_gpa,\n        academic_standing,\n        count(distinct faculty_id) as unique_faculty_encountered,\n        count(distinct department_id) as departments_studied_in,\n        avg(grade_points) as avg_grade_received,\n        string_agg(distinct faculty_name, ', ' order by faculty_name) as faculty_list,\n        count(case when position = 'Professor' then 1 end) as courses_with_professors,\n        count(case when position = 'Associate Professor' then 1 end) as courses_with_assoc_professors,\n        count(case when position = 'Assistant Professor' then 1 end) as courses_with_asst_professors,\n        avg(years_of_service) as avg_faculty_experience,\n        count(distinct course_id) as total_courses_taken\n    from faculty_student_connections\n    group by student_id, student_name, student_cumulative_gpa, academic_standing\n),\n\ninteraction_quality_metrics as (\n    select\n        fte.*,\n        case\n            when fte.student_success_rate >= 90 then 'Exceptional Educator'\n            when fte.student_success_rate >= 80 then 'Highly Effective Educator'\n            when fte.student_success_rate >= 70 then 'Effective Educator'\n            when fte.student_success_rate >= 60 then 'Adequate Educator'\n            else 'Needs Improvement'\n        end as teaching_effectiveness_category,\n        case\n            when fte.avg_student_attendance >= 95 then 'Highly Engaging'\n            when fte.avg_student_attendance >= 85 then 'Engaging'\n            when fte.avg_student_attendance >= 75 then 'Moderately Engaging'\n            else 'Low Engagement'\n        end as student_engagement_level,\n        case\n            when abs(fte.gpa_correlation_with_performance) >= 0.7 then 'Strong Predictor'\n            when abs(fte.gpa_correlation_with_performance) >= 0.4 then 'Moderate Predictor'\n            when abs(fte.gpa_correlation_with_performance) >= 0.2 then 'Weak Predictor'\n            else 'No Predictive Value'\n        end as prior_gpa_predictive_power,\n        case\n            when fte.grade_consistency <= 0.5 then 'Very Consistent Grading'\n            when fte.grade_consistency <= 1.0 then 'Consistent Grading'\n            when fte.grade_consistency <= 1.5 then 'Somewhat Inconsistent'\n            else 'Inconsistent Grading'\n        end as grading_consistency_level,\n        round(fte.total_unique_students_taught::numeric / fte.semesters_taught, 2) as avg_students_per_semester\n    from faculty_teaching_effectiveness fte\n)\n\nselect \n    iqm.*,\n    sfe.unique_faculty_encountered,\n    sfe.avg_faculty_experience,\n    sfe.courses_with_professors,\n    sfe.courses_with_assoc_professors,\n    sfe.courses_with_asst_professors\nfrom interaction_quality_metrics iqm\nleft join student_faculty_exposure sfe on 1=1  -- This creates a cartesian product for analysis", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.institutional_effectiveness_dashboard": {"database": "postgres", "schema": "edu_dbt", "name": "institutional_effectiveness_dashboard", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/core/institutional_effectiveness_dashboard.sql", "original_file_path": "models/marts/core/institutional_effectiveness_dashboard.sql", "unique_id": "model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "fqn": ["DbtEducationalDataProject", "marts", "core", "institutional_effectiveness_dashboard"], "alias": "institutional_effectiveness_dashboard", "checksum": {"name": "sha256", "checksum": "ce9af6f3e32ab101619fc0f556ac49b23833c9fc24ccb56dc8d0b78eb0c0de38"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764373663.6713314, "relation_name": "\"postgres\".\"edu_dbt\".\"institutional_effectiveness_dashboard\"", "raw_code": "{{ config(materialized='table') }}\n\nwith institutional_metrics as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        -- Enrollment metrics\n        count(distinct e.student_id) as unique_students_enrolled,\n        count(distinct e.enrollment_id) as total_course_enrollments,\n        count(distinct e.course_id) as unique_courses_offered,\n        count(distinct c.department_id) as departments_active,\n        count(distinct f.faculty_id) as faculty_teaching,\n        \n        -- Academic performance metrics\n        avg(e.grade_points) as institutional_avg_gpa,\n        avg(e.attendance_percentage) as institutional_avg_attendance,\n        count(case when e.grade_category = 'Excellent' then 1 end) as excellent_grades,\n        count(case when e.grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) as passing_grades,\n        round(\n            count(case when e.grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) * 100.0 / \n            nullif(count(case when e.grade_category != 'Unknown' then 1 end), 0), 2\n        ) as institutional_pass_rate,\n        \n        -- Student success indicators\n        count(case when s.academic_standing = 'Deans List' then 1 end) as deans_list_students,\n        count(case when s.academic_standing = 'Academic Probation' then 1 end) as students_on_probation,\n        count(case when s.student_status = 'graduated' then 1 end) as graduates_this_period,\n        \n        -- Financial health\n        sum(tp.amount) as total_tuition_revenue,\n        sum(fa.amount) as total_financial_aid_disbursed,\n        sum(f.salary) as total_faculty_compensation,\n        \n        -- Operational efficiency\n        round(count(distinct e.enrollment_id)::numeric / nullif(count(distinct f.faculty_id), 0), 2) as enrollments_per_faculty,\n        round(count(distinct e.student_id)::numeric / nullif(count(distinct f.faculty_id), 0), 2) as students_per_faculty,\n        round(sum(tp.amount) / nullif(count(distinct e.student_id), 0), 2) as revenue_per_student\n    from {{ ref('stg_semesters') }} sem\n    left join {{ ref('stg_enrollments') }} e on sem.semester_id = e.semester_id\n    left join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    left join {{ ref('stg_students') }} s on e.student_id = s.student_id\n    left join {{ ref('stg_class_sessions') }} cs on c.course_id = cs.course_id and sem.semester_id = cs.semester_id\n    left join {{ ref('stg_faculty') }} f on cs.faculty_id = f.faculty_id\n    left join {{ ref('stg_tuition_payments') }} tp on s.student_id = tp.student_id and sem.semester_id = tp.semester_id\n    left join {{ ref('stg_financial_aid') }} fa on s.student_id = fa.student_id\n    group by sem.semester_id, sem.semester_name, sem.academic_year, sem.semester_type\n),\n\nperformance_trends as (\n    select\n        im.*,\n        lag(institutional_avg_gpa) over (order by semester_id) as prev_semester_gpa,\n        lag(institutional_pass_rate) over (order by semester_id) as prev_semester_pass_rate,\n        lag(unique_students_enrolled) over (order by semester_id) as prev_semester_enrollment,\n        lag(total_tuition_revenue) over (order by semester_id) as prev_semester_revenue,\n        \n        -- Calculate trends\n        institutional_avg_gpa - lag(institutional_avg_gpa) over (order by semester_id) as gpa_trend,\n        institutional_pass_rate - lag(institutional_pass_rate) over (order by semester_id) as pass_rate_trend,\n        unique_students_enrolled - lag(unique_students_enrolled) over (order by semester_id) as enrollment_trend,\n        total_tuition_revenue - lag(total_tuition_revenue) over (order by semester_id) as revenue_trend,\n        \n        -- Calculate percentile rankings\n        percent_rank() over (order by institutional_avg_gpa) as gpa_percentile,\n        percent_rank() over (order by institutional_pass_rate) as pass_rate_percentile,\n        percent_rank() over (order by unique_students_enrolled) as enrollment_percentile,\n        percent_rank() over (order by revenue_per_student) as revenue_efficiency_percentile\n    from institutional_metrics im\n),\n\neffectiveness_scoring as (\n    select\n        pt.*,\n        -- Academic effectiveness score (0-100)\n        round(\n            (case when institutional_avg_gpa >= 3.0 then 25\n                  when institutional_avg_gpa >= 2.5 then 20\n                  when institutional_avg_gpa >= 2.0 then 15\n                  else 10 end) +\n            (case when institutional_pass_rate >= 85 then 25\n                  when institutional_pass_rate >= 75 then 20\n                  when institutional_pass_rate >= 65 then 15\n                  else 10 end) +\n            (case when institutional_avg_attendance >= 90 then 25\n                  when institutional_avg_attendance >= 80 then 20\n                  when institutional_avg_attendance >= 70 then 15\n                  else 10 end) +\n            (case when (deans_list_students::numeric / nullif(unique_students_enrolled, 0)) >= 0.15 then 25\n                  when (deans_list_students::numeric / nullif(unique_students_enrolled, 0)) >= 0.10 then 20\n                  when (deans_list_students::numeric / nullif(unique_students_enrolled, 0)) >= 0.05 then 15\n                  else 10 end), 0\n        ) as academic_effectiveness_score,\n        \n        -- Operational efficiency score (0-100)\n        round(\n            (case when students_per_faculty between 15 and 25 then 30\n                  when students_per_faculty between 10 and 30 then 25\n                  when students_per_faculty between 8 and 35 then 20\n                  else 15 end) +\n            (case when revenue_per_student >= 8000 then 25\n                  when revenue_per_student >= 6000 then 20\n                  when revenue_per_student >= 4000 then 15\n                  else 10 end) +\n            (case when (total_financial_aid_disbursed / nullif(total_tuition_revenue + total_financial_aid_disbursed, 0)) <= 0.3 then 25\n                  when (total_financial_aid_disbursed / nullif(total_tuition_revenue + total_financial_aid_disbursed, 0)) <= 0.4 then 20\n                  when (total_financial_aid_disbursed / nullif(total_tuition_revenue + total_financial_aid_disbursed, 0)) <= 0.5 then 15\n                  else 10 end) +\n            (case when (students_on_probation::numeric / nullif(unique_students_enrolled, 0)) <= 0.05 then 20\n                  when (students_on_probation::numeric / nullif(unique_students_enrolled, 0)) <= 0.10 then 15\n                  when (students_on_probation::numeric / nullif(unique_students_enrolled, 0)) <= 0.15 then 10\n                  else 5 end), 0\n        ) as operational_efficiency_score,\n        \n        -- Financial health score (0-100)\n        round(\n            (case when total_tuition_revenue > total_faculty_compensation * 1.5 then 40\n                  when total_tuition_revenue > total_faculty_compensation * 1.2 then 30\n                  when total_tuition_revenue > total_faculty_compensation then 20\n                  else 10 end) +\n            (case when revenue_trend > 0 then 30\n                  when revenue_trend = 0 then 20\n                  else 10 end) +\n            (case when (total_financial_aid_disbursed / nullif(total_tuition_revenue, 0)) <= 0.4 then 30\n                  when (total_financial_aid_disbursed / nullif(total_tuition_revenue, 0)) <= 0.6 then 20\n                  else 10 end), 0\n        ) as financial_health_score\n    from performance_trends pt\n),\n\ncomparative_analysis as (\n    select\n        es.*,\n        -- Overall institutional effectiveness (weighted average)\n        round(\n            (academic_effectiveness_score * 0.4) + \n            (operational_efficiency_score * 0.3) + \n            (financial_health_score * 0.3), 1\n        ) as overall_effectiveness_score,\n        \n        -- Trend categories\n        case\n            when gpa_trend > 0.1 then 'Improving Academic Performance'\n            when gpa_trend < -0.1 then 'Declining Academic Performance'\n            else 'Stable Academic Performance'\n        end as academic_trend_category,\n        \n        case\n            when enrollment_trend > 50 then 'Growing Enrollment'\n            when enrollment_trend < -50 then 'Declining Enrollment'\n            else 'Stable Enrollment'\n        end as enrollment_trend_category,\n        \n        case\n            when revenue_trend > 10000 then 'Growing Revenue'\n            when revenue_trend < -10000 then 'Declining Revenue'\n            else 'Stable Revenue'\n        end as financial_trend_category,\n        \n        -- Performance categories\n        case\n            when academic_effectiveness_score >= 80 then 'High Academic Performance'\n            when academic_effectiveness_score >= 65 then 'Good Academic Performance'\n            when academic_effectiveness_score >= 50 then 'Fair Academic Performance'\n            else 'Poor Academic Performance'\n        end as academic_performance_category,\n        \n        case\n            when operational_efficiency_score >= 80 then 'Highly Efficient'\n            when operational_efficiency_score >= 65 then 'Efficient'\n            when operational_efficiency_score >= 50 then 'Moderately Efficient'\n            else 'Inefficient'\n        end as operational_efficiency_category,\n        \n        case\n            when financial_health_score >= 80 then 'Excellent Financial Health'\n            when financial_health_score >= 65 then 'Good Financial Health'\n            when financial_health_score >= 50 then 'Fair Financial Health'\n            else 'Poor Financial Health'\n        end as financial_health_category\n    from effectiveness_scoring es\n),\n\nstrategic_recommendations as (\n    select\n        ca.*,\n        case\n            when overall_effectiveness_score >= 80 then 'Maintain excellence and consider expansion opportunities'\n            when academic_effectiveness_score < 50 then 'Focus on academic support and faculty development'\n            when operational_efficiency_score < 50 then 'Review operational processes and resource allocation'\n            when financial_health_score < 50 then 'Address financial sustainability and revenue diversification'\n            when enrollment_trend_category = 'Declining Enrollment' then 'Implement enrollment growth strategies'\n            else 'Continue current strategies with minor improvements'\n        end as primary_strategic_recommendation,\n        \n        case\n            when academic_trend_category = 'Declining Academic Performance' and \n                 operational_efficiency_category = 'Inefficient' then 'High Priority Action Required'\n            when financial_health_category = 'Poor Financial Health' and\n                 enrollment_trend_category = 'Declining Enrollment' then 'Critical Intervention Needed'\n            when overall_effectiveness_score < 60 then 'Moderate Intervention Required'\n            else 'Standard Monitoring'\n        end as intervention_priority,\n        \n        -- Key performance indicators status\n        case\n            when institutional_pass_rate >= 80 and \n                 students_per_faculty between 15 and 25 and\n                 revenue_per_student >= 6000 then 'All KPIs Met'\n            when institutional_pass_rate < 70 or students_per_faculty > 30 or revenue_per_student < 4000 then 'Critical KPIs Not Met'\n            else 'Some KPIs Need Attention'\n        end as kpi_status\n    from comparative_analysis ca\n)\n\nselect * from strategic_recommendations\norder by semester_id desc", "language": "sql", "refs": [{"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_tuition_payments", "package": null, "version": null}, {"name": "stg_financial_aid", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_tuition_payments", "model.DbtEducationalDataProject.stg_financial_aid"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/core/institutional_effectiveness_dashboard.sql", "compiled": true, "compiled_code": "\n\nwith institutional_metrics as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.academic_year,\n        sem.semester_type,\n        -- Enrollment metrics\n        count(distinct e.student_id) as unique_students_enrolled,\n        count(distinct e.enrollment_id) as total_course_enrollments,\n        count(distinct e.course_id) as unique_courses_offered,\n        count(distinct c.department_id) as departments_active,\n        count(distinct f.faculty_id) as faculty_teaching,\n        \n        -- Academic performance metrics\n        avg(e.grade_points) as institutional_avg_gpa,\n        avg(e.attendance_percentage) as institutional_avg_attendance,\n        count(case when e.grade_category = 'Excellent' then 1 end) as excellent_grades,\n        count(case when e.grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) as passing_grades,\n        round(\n            count(case when e.grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) * 100.0 / \n            nullif(count(case when e.grade_category != 'Unknown' then 1 end), 0), 2\n        ) as institutional_pass_rate,\n        \n        -- Student success indicators\n        count(case when s.academic_standing = 'Deans List' then 1 end) as deans_list_students,\n        count(case when s.academic_standing = 'Academic Probation' then 1 end) as students_on_probation,\n        count(case when s.student_status = 'graduated' then 1 end) as graduates_this_period,\n        \n        -- Financial health\n        sum(tp.amount) as total_tuition_revenue,\n        sum(fa.amount) as total_financial_aid_disbursed,\n        sum(f.salary) as total_faculty_compensation,\n        \n        -- Operational efficiency\n        round(count(distinct e.enrollment_id)::numeric / nullif(count(distinct f.faculty_id), 0), 2) as enrollments_per_faculty,\n        round(count(distinct e.student_id)::numeric / nullif(count(distinct f.faculty_id), 0), 2) as students_per_faculty,\n        round(sum(tp.amount) / nullif(count(distinct e.student_id), 0), 2) as revenue_per_student\n    from \"postgres\".\"edu_dbt\".\"stg_semesters\" sem\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on sem.semester_id = e.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on e.student_id = s.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on c.course_id = cs.course_id and sem.semester_id = cs.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on cs.faculty_id = f.faculty_id\n    left join \"postgres\".\"edu_dbt\".\"stg_tuition_payments\" tp on s.student_id = tp.student_id and sem.semester_id = tp.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_financial_aid\" fa on s.student_id = fa.student_id\n    group by sem.semester_id, sem.semester_name, sem.academic_year, sem.semester_type\n),\n\nperformance_trends as (\n    select\n        im.*,\n        lag(institutional_avg_gpa) over (order by semester_id) as prev_semester_gpa,\n        lag(institutional_pass_rate) over (order by semester_id) as prev_semester_pass_rate,\n        lag(unique_students_enrolled) over (order by semester_id) as prev_semester_enrollment,\n        lag(total_tuition_revenue) over (order by semester_id) as prev_semester_revenue,\n        \n        -- Calculate trends\n        institutional_avg_gpa - lag(institutional_avg_gpa) over (order by semester_id) as gpa_trend,\n        institutional_pass_rate - lag(institutional_pass_rate) over (order by semester_id) as pass_rate_trend,\n        unique_students_enrolled - lag(unique_students_enrolled) over (order by semester_id) as enrollment_trend,\n        total_tuition_revenue - lag(total_tuition_revenue) over (order by semester_id) as revenue_trend,\n        \n        -- Calculate percentile rankings\n        percent_rank() over (order by institutional_avg_gpa) as gpa_percentile,\n        percent_rank() over (order by institutional_pass_rate) as pass_rate_percentile,\n        percent_rank() over (order by unique_students_enrolled) as enrollment_percentile,\n        percent_rank() over (order by revenue_per_student) as revenue_efficiency_percentile\n    from institutional_metrics im\n),\n\neffectiveness_scoring as (\n    select\n        pt.*,\n        -- Academic effectiveness score (0-100)\n        round(\n            (case when institutional_avg_gpa >= 3.0 then 25\n                  when institutional_avg_gpa >= 2.5 then 20\n                  when institutional_avg_gpa >= 2.0 then 15\n                  else 10 end) +\n            (case when institutional_pass_rate >= 85 then 25\n                  when institutional_pass_rate >= 75 then 20\n                  when institutional_pass_rate >= 65 then 15\n                  else 10 end) +\n            (case when institutional_avg_attendance >= 90 then 25\n                  when institutional_avg_attendance >= 80 then 20\n                  when institutional_avg_attendance >= 70 then 15\n                  else 10 end) +\n            (case when (deans_list_students::numeric / nullif(unique_students_enrolled, 0)) >= 0.15 then 25\n                  when (deans_list_students::numeric / nullif(unique_students_enrolled, 0)) >= 0.10 then 20\n                  when (deans_list_students::numeric / nullif(unique_students_enrolled, 0)) >= 0.05 then 15\n                  else 10 end), 0\n        ) as academic_effectiveness_score,\n        \n        -- Operational efficiency score (0-100)\n        round(\n            (case when students_per_faculty between 15 and 25 then 30\n                  when students_per_faculty between 10 and 30 then 25\n                  when students_per_faculty between 8 and 35 then 20\n                  else 15 end) +\n            (case when revenue_per_student >= 8000 then 25\n                  when revenue_per_student >= 6000 then 20\n                  when revenue_per_student >= 4000 then 15\n                  else 10 end) +\n            (case when (total_financial_aid_disbursed / nullif(total_tuition_revenue + total_financial_aid_disbursed, 0)) <= 0.3 then 25\n                  when (total_financial_aid_disbursed / nullif(total_tuition_revenue + total_financial_aid_disbursed, 0)) <= 0.4 then 20\n                  when (total_financial_aid_disbursed / nullif(total_tuition_revenue + total_financial_aid_disbursed, 0)) <= 0.5 then 15\n                  else 10 end) +\n            (case when (students_on_probation::numeric / nullif(unique_students_enrolled, 0)) <= 0.05 then 20\n                  when (students_on_probation::numeric / nullif(unique_students_enrolled, 0)) <= 0.10 then 15\n                  when (students_on_probation::numeric / nullif(unique_students_enrolled, 0)) <= 0.15 then 10\n                  else 5 end), 0\n        ) as operational_efficiency_score,\n        \n        -- Financial health score (0-100)\n        round(\n            (case when total_tuition_revenue > total_faculty_compensation * 1.5 then 40\n                  when total_tuition_revenue > total_faculty_compensation * 1.2 then 30\n                  when total_tuition_revenue > total_faculty_compensation then 20\n                  else 10 end) +\n            (case when revenue_trend > 0 then 30\n                  when revenue_trend = 0 then 20\n                  else 10 end) +\n            (case when (total_financial_aid_disbursed / nullif(total_tuition_revenue, 0)) <= 0.4 then 30\n                  when (total_financial_aid_disbursed / nullif(total_tuition_revenue, 0)) <= 0.6 then 20\n                  else 10 end), 0\n        ) as financial_health_score\n    from performance_trends pt\n),\n\ncomparative_analysis as (\n    select\n        es.*,\n        -- Overall institutional effectiveness (weighted average)\n        round(\n            (academic_effectiveness_score * 0.4) + \n            (operational_efficiency_score * 0.3) + \n            (financial_health_score * 0.3), 1\n        ) as overall_effectiveness_score,\n        \n        -- Trend categories\n        case\n            when gpa_trend > 0.1 then 'Improving Academic Performance'\n            when gpa_trend < -0.1 then 'Declining Academic Performance'\n            else 'Stable Academic Performance'\n        end as academic_trend_category,\n        \n        case\n            when enrollment_trend > 50 then 'Growing Enrollment'\n            when enrollment_trend < -50 then 'Declining Enrollment'\n            else 'Stable Enrollment'\n        end as enrollment_trend_category,\n        \n        case\n            when revenue_trend > 10000 then 'Growing Revenue'\n            when revenue_trend < -10000 then 'Declining Revenue'\n            else 'Stable Revenue'\n        end as financial_trend_category,\n        \n        -- Performance categories\n        case\n            when academic_effectiveness_score >= 80 then 'High Academic Performance'\n            when academic_effectiveness_score >= 65 then 'Good Academic Performance'\n            when academic_effectiveness_score >= 50 then 'Fair Academic Performance'\n            else 'Poor Academic Performance'\n        end as academic_performance_category,\n        \n        case\n            when operational_efficiency_score >= 80 then 'Highly Efficient'\n            when operational_efficiency_score >= 65 then 'Efficient'\n            when operational_efficiency_score >= 50 then 'Moderately Efficient'\n            else 'Inefficient'\n        end as operational_efficiency_category,\n        \n        case\n            when financial_health_score >= 80 then 'Excellent Financial Health'\n            when financial_health_score >= 65 then 'Good Financial Health'\n            when financial_health_score >= 50 then 'Fair Financial Health'\n            else 'Poor Financial Health'\n        end as financial_health_category\n    from effectiveness_scoring es\n),\n\nstrategic_recommendations as (\n    select\n        ca.*,\n        case\n            when overall_effectiveness_score >= 80 then 'Maintain excellence and consider expansion opportunities'\n            when academic_effectiveness_score < 50 then 'Focus on academic support and faculty development'\n            when operational_efficiency_score < 50 then 'Review operational processes and resource allocation'\n            when financial_health_score < 50 then 'Address financial sustainability and revenue diversification'\n            when enrollment_trend_category = 'Declining Enrollment' then 'Implement enrollment growth strategies'\n            else 'Continue current strategies with minor improvements'\n        end as primary_strategic_recommendation,\n        \n        case\n            when academic_trend_category = 'Declining Academic Performance' and \n                 operational_efficiency_category = 'Inefficient' then 'High Priority Action Required'\n            when financial_health_category = 'Poor Financial Health' and\n                 enrollment_trend_category = 'Declining Enrollment' then 'Critical Intervention Needed'\n            when overall_effectiveness_score < 60 then 'Moderate Intervention Required'\n            else 'Standard Monitoring'\n        end as intervention_priority,\n        \n        -- Key performance indicators status\n        case\n            when institutional_pass_rate >= 80 and \n                 students_per_faculty between 15 and 25 and\n                 revenue_per_student >= 6000 then 'All KPIs Met'\n            when institutional_pass_rate < 70 or students_per_faculty > 30 or revenue_per_student < 4000 then 'Critical KPIs Not Met'\n            else 'Some KPIs Need Attention'\n        end as kpi_status\n    from comparative_analysis ca\n)\n\nselect * from strategic_recommendations\norder by semester_id desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_resource_utilization_analysis": {"database": "postgres", "schema": "edu_dbt", "name": "int_resource_utilization_analysis", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_resource_utilization_analysis.sql", "original_file_path": "models/intermediate/int_resource_utilization_analysis.sql", "unique_id": "model.DbtEducationalDataProject.int_resource_utilization_analysis", "fqn": ["DbtEducationalDataProject", "intermediate", "int_resource_utilization_analysis"], "alias": "int_resource_utilization_analysis", "checksum": {"name": "sha256", "checksum": "8a2df0e8381a872234cb8d0999a099aa6e3cfddceb95937f9f234f9735844cf3"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764373663.673116, "relation_name": "\"postgres\".\"edu_dbt\".\"int_resource_utilization_analysis\"", "raw_code": "{{ config(materialized='view') }}\n\nwith classroom_utilization as (\n    select\n        cs.room_id,\n        cs.course_id,\n        cs.semester_id,\n        c.course_code,\n        c.credits,\n        sem.semester_name,\n        sem.academic_year,\n        count(distinct cs.session_date) as sessions_held,\n        avg(cs.attendance_count) as avg_session_attendance,\n        max(cs.attendance_count) as max_session_attendance,\n        sum(cs.attendance_count) as total_student_sessions,\n        extract(hour from cs.session_time) as session_hour,\n        extract(dow from cs.session_date) as day_of_week\n    from {{ ref('stg_class_sessions') }} cs\n    inner join {{ ref('stg_courses') }} c on cs.course_id = c.course_id\n    inner join {{ ref('stg_semesters') }} sem on cs.semester_id = sem.semester_id\n    group by \n        cs.room_id, cs.course_id, cs.semester_id, c.course_code, c.credits,\n        sem.semester_name, sem.academic_year, cs.session_time, cs.session_date\n),\n\nroom_efficiency_metrics as (\n    select\n        room_id,\n        semester_id,\n        semester_name,\n        count(distinct course_id) as courses_using_room,\n        sum(sessions_held) as total_sessions_in_room,\n        avg(avg_session_attendance) as room_avg_attendance,\n        sum(total_student_sessions) as total_student_hours,\n        count(distinct session_hour) as unique_time_slots_used,\n        count(distinct day_of_week) as days_per_week_used,\n        round(avg(avg_session_attendance / nullif(max_session_attendance, 0)) * 100, 2) as avg_capacity_utilization\n    from classroom_utilization\n    group by room_id, semester_id, semester_name\n),\n\nfaculty_resource_allocation as (\n    select\n        f.faculty_id,\n        f.full_name as faculty_name,\n        f.position,\n        f.salary,\n        f.years_of_service,\n        d.department_name,\n        d.budget as department_budget,\n        count(distinct cs.course_id) as courses_taught,\n        count(distinct cs.semester_id) as semesters_active,\n        sum(c.credits) as total_credit_hours_taught,\n        count(distinct cs.session_date) as total_class_sessions,\n        avg(cs.attendance_count) as avg_class_size,\n        sum(cs.attendance_count) as total_student_contact_hours,\n        round(f.salary / nullif(sum(cs.attendance_count), 0), 2) as cost_per_student_contact_hour,\n        round(f.salary / nullif(sum(c.credits), 0), 2) as cost_per_credit_hour_taught\n    from {{ ref('stg_faculty') }} f\n    inner join {{ ref('stg_departments') }} d on f.department_id = d.department_id\n    left join {{ ref('stg_class_sessions') }} cs on f.faculty_id = cs.faculty_id\n    left join {{ ref('stg_courses') }} c on cs.course_id = c.course_id\n    group by\n        f.faculty_id, f.full_name, f.position, f.salary, f.years_of_service,\n        d.department_name, d.budget\n),\n\ntechnology_assignment_utilization as (\n    select\n        a.course_id,\n        c.course_code,\n        c.course_name,\n        d.department_name,\n        count(distinct a.assignment_id) as total_assignments,\n        avg(ap.total_submissions) as avg_submissions_per_assignment,\n        avg(ap.avg_percentage_score) as avg_assignment_performance,\n        avg(ap.grading_completion_rate) as avg_grading_completion_rate,\n        sum(ap.total_submissions) as total_submission_volume,\n        count(case when a.assignment_category = 'Assessment' then 1 end) as assessment_assignments,\n        count(case when a.assignment_category = 'Project' then 1 end) as project_assignments,\n        count(case when a.assignment_category = 'Homework' then 1 end) as homework_assignments\n    from {{ ref('stg_assignments') }} a\n    inner join {{ ref('stg_courses') }} c on a.course_id = c.course_id\n    inner join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    left join {{ ref('int_assignment_performance') }} ap on a.assignment_id = ap.assignment_id\n    group by a.course_id, c.course_code, c.course_name, d.department_name\n),\n\nfinancial_resource_efficiency as (\n    select\n        d.department_id,\n        d.department_name,\n        d.budget,\n        d.department_size,\n        count(distinct f.faculty_id) as faculty_count,\n        count(distinct s.student_id) as student_count,\n        count(distinct c.course_id) as course_count,\n        sum(f.salary) as total_faculty_costs,\n        sum(tp.amount) as department_tuition_revenue,\n        sum(fa.amount) as department_aid_disbursed,\n        round(d.budget / nullif(count(distinct s.student_id), 0), 2) as budget_per_student,\n        round(d.budget / nullif(count(distinct f.faculty_id), 0), 2) as budget_per_faculty,\n        round(sum(tp.amount) / nullif(d.budget, 0), 2) as revenue_to_budget_ratio,\n        round(sum(f.salary) / nullif(d.budget, 0) * 100, 2) as faculty_cost_percentage\n    from {{ ref('stg_departments') }} d\n    left join {{ ref('stg_faculty') }} f on d.department_id = f.department_id\n    left join {{ ref('stg_students') }} s on d.department_id = s.major_id\n    left join {{ ref('stg_courses') }} c on d.department_id = c.department_id\n    left join {{ ref('stg_tuition_payments') }} tp on s.student_id = tp.student_id\n    left join {{ ref('stg_financial_aid') }} fa on s.student_id = fa.student_id\n    group by d.department_id, d.department_name, d.budget, d.department_size\n),\n\nresource_optimization_analysis as (\n    select\n        rem.room_id,\n        rem.semester_name,\n        rem.room_avg_attendance,\n        rem.avg_capacity_utilization,\n        rem.unique_time_slots_used,\n        rem.days_per_week_used,\n        case\n            when rem.avg_capacity_utilization >= 85 then 'High Utilization'\n            when rem.avg_capacity_utilization >= 65 then 'Good Utilization'\n            when rem.avg_capacity_utilization >= 45 then 'Moderate Utilization'\n            else 'Low Utilization'\n        end as room_utilization_category,\n        \n        fra.faculty_id,\n        fra.faculty_name,\n        fra.department_name,\n        fra.cost_per_student_contact_hour,\n        fra.cost_per_credit_hour_taught,\n        fra.total_credit_hours_taught,\n        fra.total_student_contact_hours,\n        case\n            when fra.cost_per_student_contact_hour <= 50 then 'Highly Efficient'\n            when fra.cost_per_student_contact_hour <= 100 then 'Efficient'\n            when fra.cost_per_student_contact_hour <= 200 then 'Moderately Efficient'\n            else 'Inefficient'\n        end as faculty_efficiency_category,\n        \n        tau.course_id as tech_course_id,\n        tau.total_submission_volume,\n        tau.avg_grading_completion_rate,\n        case\n            when tau.avg_grading_completion_rate >= 95 then 'Excellent Assignment Management'\n            when tau.avg_grading_completion_rate >= 85 then 'Good Assignment Management'\n            when tau.avg_grading_completion_rate >= 70 then 'Fair Assignment Management'\n            else 'Poor Assignment Management'\n        end as assignment_management_category,\n        \n        fre.department_id as finance_dept_id,\n        fre.revenue_to_budget_ratio,\n        fre.faculty_cost_percentage,\n        fre.budget_per_student,\n        case\n            when fre.revenue_to_budget_ratio >= 1.2 then 'Highly Profitable'\n            when fre.revenue_to_budget_ratio >= 1.0 then 'Profitable'\n            when fre.revenue_to_budget_ratio >= 0.8 then 'Break Even'\n            else 'Loss Making'\n        end as financial_efficiency_category\n    from room_efficiency_metrics rem\n    full outer join faculty_resource_allocation fra on 1=1  -- Cross join for analysis\n    full outer join technology_assignment_utilization tau on 1=1\n    full outer join financial_resource_efficiency fre on 1=1\n),\n\ncomprehensive_utilization_score as (\n    select\n        coalesce(room_id, faculty_id, tech_course_id, finance_dept_id) as resource_identifier,\n        'Multi-Resource Analysis' as resource_type,\n        -- Room utilization score (0-25)\n        case\n            when avg_capacity_utilization >= 85 then 25\n            when avg_capacity_utilization >= 65 then 20\n            when avg_capacity_utilization >= 45 then 15\n            else 10\n        end as room_score,\n        -- Faculty efficiency score (0-25)\n        case\n            when faculty_efficiency_category = 'Highly Efficient' then 25\n            when faculty_efficiency_category = 'Efficient' then 20\n            when faculty_efficiency_category = 'Moderately Efficient' then 15\n            else 10\n        end as faculty_score,\n        -- Technology utilization score (0-25)\n        case\n            when assignment_management_category = 'Excellent Assignment Management' then 25\n            when assignment_management_category = 'Good Assignment Management' then 20\n            when assignment_management_category = 'Fair Assignment Management' then 15\n            else 10\n        end as technology_score,\n        -- Financial efficiency score (0-25)\n        case\n            when financial_efficiency_category = 'Highly Profitable' then 25\n            when financial_efficiency_category = 'Profitable' then 20\n            when financial_efficiency_category = 'Break Even' then 15\n            else 10\n        end as financial_score,\n        \n        -- Overall utilization recommendations\n        case\n            when avg_capacity_utilization < 45 then 'Optimize room scheduling and capacity'\n            when faculty_efficiency_category = 'Inefficient' then 'Review faculty workload and compensation'\n            when assignment_management_category = 'Poor Assignment Management' then 'Improve assignment workflow processes'\n            when financial_efficiency_category = 'Loss Making' then 'Critical financial restructuring needed'\n            else 'Continue monitoring and minor optimizations'\n        end as utilization_recommendation\n    from resource_optimization_analysis\n    where room_id is not null or faculty_id is not null or \n          tech_course_id is not null or finance_dept_id is not null\n)\n\nselect \n    *,\n    room_score + faculty_score + technology_score + financial_score as total_utilization_score\nfrom comprehensive_utilization_score\norder by total_utilization_score desc", "language": "sql", "refs": [{"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_assignments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_assignment_performance", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_tuition_payments", "package": null, "version": null}, {"name": "stg_financial_aid", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_tuition_payments", "model.DbtEducationalDataProject.stg_financial_aid"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_resource_utilization_analysis.sql", "compiled": true, "compiled_code": "\n\nwith classroom_utilization as (\n    select\n        cs.room_id,\n        cs.course_id,\n        cs.semester_id,\n        c.course_code,\n        c.credits,\n        sem.semester_name,\n        sem.academic_year,\n        count(distinct cs.session_date) as sessions_held,\n        avg(cs.attendance_count) as avg_session_attendance,\n        max(cs.attendance_count) as max_session_attendance,\n        sum(cs.attendance_count) as total_student_sessions,\n        extract(hour from cs.session_time) as session_hour,\n        extract(dow from cs.session_date) as day_of_week\n    from \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on cs.course_id = c.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on cs.semester_id = sem.semester_id\n    group by \n        cs.room_id, cs.course_id, cs.semester_id, c.course_code, c.credits,\n        sem.semester_name, sem.academic_year, cs.session_time, cs.session_date\n),\n\nroom_efficiency_metrics as (\n    select\n        room_id,\n        semester_id,\n        semester_name,\n        count(distinct course_id) as courses_using_room,\n        sum(sessions_held) as total_sessions_in_room,\n        avg(avg_session_attendance) as room_avg_attendance,\n        sum(total_student_sessions) as total_student_hours,\n        count(distinct session_hour) as unique_time_slots_used,\n        count(distinct day_of_week) as days_per_week_used,\n        round(avg(avg_session_attendance / nullif(max_session_attendance, 0)) * 100, 2) as avg_capacity_utilization\n    from classroom_utilization\n    group by room_id, semester_id, semester_name\n),\n\nfaculty_resource_allocation as (\n    select\n        f.faculty_id,\n        f.full_name as faculty_name,\n        f.position,\n        f.salary,\n        f.years_of_service,\n        d.department_name,\n        d.budget as department_budget,\n        count(distinct cs.course_id) as courses_taught,\n        count(distinct cs.semester_id) as semesters_active,\n        sum(c.credits) as total_credit_hours_taught,\n        count(distinct cs.session_date) as total_class_sessions,\n        avg(cs.attendance_count) as avg_class_size,\n        sum(cs.attendance_count) as total_student_contact_hours,\n        round(f.salary / nullif(sum(cs.attendance_count), 0), 2) as cost_per_student_contact_hour,\n        round(f.salary / nullif(sum(c.credits), 0), 2) as cost_per_credit_hour_taught\n    from \"postgres\".\"edu_dbt\".\"stg_faculty\" f\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on f.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on f.faculty_id = cs.faculty_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on cs.course_id = c.course_id\n    group by\n        f.faculty_id, f.full_name, f.position, f.salary, f.years_of_service,\n        d.department_name, d.budget\n),\n\ntechnology_assignment_utilization as (\n    select\n        a.course_id,\n        c.course_code,\n        c.course_name,\n        d.department_name,\n        count(distinct a.assignment_id) as total_assignments,\n        avg(ap.total_submissions) as avg_submissions_per_assignment,\n        avg(ap.avg_percentage_score) as avg_assignment_performance,\n        avg(ap.grading_completion_rate) as avg_grading_completion_rate,\n        sum(ap.total_submissions) as total_submission_volume,\n        count(case when a.assignment_category = 'Assessment' then 1 end) as assessment_assignments,\n        count(case when a.assignment_category = 'Project' then 1 end) as project_assignments,\n        count(case when a.assignment_category = 'Homework' then 1 end) as homework_assignments\n    from \"postgres\".\"edu_dbt\".\"stg_assignments\" a\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on a.course_id = c.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"int_assignment_performance\" ap on a.assignment_id = ap.assignment_id\n    group by a.course_id, c.course_code, c.course_name, d.department_name\n),\n\nfinancial_resource_efficiency as (\n    select\n        d.department_id,\n        d.department_name,\n        d.budget,\n        d.department_size,\n        count(distinct f.faculty_id) as faculty_count,\n        count(distinct s.student_id) as student_count,\n        count(distinct c.course_id) as course_count,\n        sum(f.salary) as total_faculty_costs,\n        sum(tp.amount) as department_tuition_revenue,\n        sum(fa.amount) as department_aid_disbursed,\n        round(d.budget / nullif(count(distinct s.student_id), 0), 2) as budget_per_student,\n        round(d.budget / nullif(count(distinct f.faculty_id), 0), 2) as budget_per_faculty,\n        round(sum(tp.amount) / nullif(d.budget, 0), 2) as revenue_to_budget_ratio,\n        round(sum(f.salary) / nullif(d.budget, 0) * 100, 2) as faculty_cost_percentage\n    from \"postgres\".\"edu_dbt\".\"stg_departments\" d\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on d.department_id = f.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on d.department_id = s.major_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on d.department_id = c.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_tuition_payments\" tp on s.student_id = tp.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_financial_aid\" fa on s.student_id = fa.student_id\n    group by d.department_id, d.department_name, d.budget, d.department_size\n),\n\nresource_optimization_analysis as (\n    select\n        rem.room_id,\n        rem.semester_name,\n        rem.room_avg_attendance,\n        rem.avg_capacity_utilization,\n        rem.unique_time_slots_used,\n        rem.days_per_week_used,\n        case\n            when rem.avg_capacity_utilization >= 85 then 'High Utilization'\n            when rem.avg_capacity_utilization >= 65 then 'Good Utilization'\n            when rem.avg_capacity_utilization >= 45 then 'Moderate Utilization'\n            else 'Low Utilization'\n        end as room_utilization_category,\n        \n        fra.faculty_id,\n        fra.faculty_name,\n        fra.department_name,\n        fra.cost_per_student_contact_hour,\n        fra.cost_per_credit_hour_taught,\n        fra.total_credit_hours_taught,\n        fra.total_student_contact_hours,\n        case\n            when fra.cost_per_student_contact_hour <= 50 then 'Highly Efficient'\n            when fra.cost_per_student_contact_hour <= 100 then 'Efficient'\n            when fra.cost_per_student_contact_hour <= 200 then 'Moderately Efficient'\n            else 'Inefficient'\n        end as faculty_efficiency_category,\n        \n        tau.course_id as tech_course_id,\n        tau.total_submission_volume,\n        tau.avg_grading_completion_rate,\n        case\n            when tau.avg_grading_completion_rate >= 95 then 'Excellent Assignment Management'\n            when tau.avg_grading_completion_rate >= 85 then 'Good Assignment Management'\n            when tau.avg_grading_completion_rate >= 70 then 'Fair Assignment Management'\n            else 'Poor Assignment Management'\n        end as assignment_management_category,\n        \n        fre.department_id as finance_dept_id,\n        fre.revenue_to_budget_ratio,\n        fre.faculty_cost_percentage,\n        fre.budget_per_student,\n        case\n            when fre.revenue_to_budget_ratio >= 1.2 then 'Highly Profitable'\n            when fre.revenue_to_budget_ratio >= 1.0 then 'Profitable'\n            when fre.revenue_to_budget_ratio >= 0.8 then 'Break Even'\n            else 'Loss Making'\n        end as financial_efficiency_category\n    from room_efficiency_metrics rem\n    full outer join faculty_resource_allocation fra on 1=1  -- Cross join for analysis\n    full outer join technology_assignment_utilization tau on 1=1\n    full outer join financial_resource_efficiency fre on 1=1\n),\n\ncomprehensive_utilization_score as (\n    select\n        coalesce(room_id, faculty_id, tech_course_id, finance_dept_id) as resource_identifier,\n        'Multi-Resource Analysis' as resource_type,\n        -- Room utilization score (0-25)\n        case\n            when avg_capacity_utilization >= 85 then 25\n            when avg_capacity_utilization >= 65 then 20\n            when avg_capacity_utilization >= 45 then 15\n            else 10\n        end as room_score,\n        -- Faculty efficiency score (0-25)\n        case\n            when faculty_efficiency_category = 'Highly Efficient' then 25\n            when faculty_efficiency_category = 'Efficient' then 20\n            when faculty_efficiency_category = 'Moderately Efficient' then 15\n            else 10\n        end as faculty_score,\n        -- Technology utilization score (0-25)\n        case\n            when assignment_management_category = 'Excellent Assignment Management' then 25\n            when assignment_management_category = 'Good Assignment Management' then 20\n            when assignment_management_category = 'Fair Assignment Management' then 15\n            else 10\n        end as technology_score,\n        -- Financial efficiency score (0-25)\n        case\n            when financial_efficiency_category = 'Highly Profitable' then 25\n            when financial_efficiency_category = 'Profitable' then 20\n            when financial_efficiency_category = 'Break Even' then 15\n            else 10\n        end as financial_score,\n        \n        -- Overall utilization recommendations\n        case\n            when avg_capacity_utilization < 45 then 'Optimize room scheduling and capacity'\n            when faculty_efficiency_category = 'Inefficient' then 'Review faculty workload and compensation'\n            when assignment_management_category = 'Poor Assignment Management' then 'Improve assignment workflow processes'\n            when financial_efficiency_category = 'Loss Making' then 'Critical financial restructuring needed'\n            else 'Continue monitoring and minor optimizations'\n        end as utilization_recommendation\n    from resource_optimization_analysis\n    where room_id is not null or faculty_id is not null or \n          tech_course_id is not null or finance_dept_id is not null\n)\n\nselect \n    *,\n    room_score + faculty_score + technology_score + financial_score as total_utilization_score\nfrom comprehensive_utilization_score\norder by total_utilization_score desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_grade_inflation_analysis": {"database": "postgres", "schema": "edu_dbt", "name": "int_grade_inflation_analysis", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_grade_inflation_analysis.sql", "original_file_path": "models/intermediate/int_grade_inflation_analysis.sql", "unique_id": "model.DbtEducationalDataProject.int_grade_inflation_analysis", "fqn": ["DbtEducationalDataProject", "intermediate", "int_grade_inflation_analysis"], "alias": "int_grade_inflation_analysis", "checksum": {"name": "sha256", "checksum": "de1225e4257c40590955c1aab0f6d7067ce7fa7fd9fd9a9f93d854c45293f7e3"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764373663.6752079, "relation_name": "\"postgres\".\"edu_dbt\".\"int_grade_inflation_analysis\"", "raw_code": "{{ config(materialized='view') }}\n\nwith historical_grades as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.department_id,\n        c.difficulty_level,\n        d.department_name,\n        e.semester_id,\n        e.grade,\n        e.grade_points,\n        sem.academic_year,\n        sem.semester_type,\n        extract(year from sem.start_date) as year,\n        f.faculty_id,\n        f.full_name as faculty_name,\n        f.years_of_service,\n        case\n            when e.grade in ('A+', 'A', 'A-') then 'A Range'\n            when e.grade in ('B+', 'B', 'B-') then 'B Range'\n            when e.grade in ('C+', 'C', 'C-') then 'C Range'\n            when e.grade in ('D+', 'D', 'D-') then 'D Range'\n            when e.grade = 'F' then 'F'\n            else 'Other'\n        end as grade_range\n    from {{ ref('stg_enrollments') }} e\n    inner join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    inner join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    inner join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    left join {{ ref('stg_class_sessions') }} cs on c.course_id = cs.course_id and e.semester_id = cs.semester_id\n    left join {{ ref('stg_faculty') }} f on cs.faculty_id = f.faculty_id\n    where e.grade is not null and e.grade != 'W'\n),\n\nyearly_grade_trends as (\n    select\n        year,\n        course_id,\n        course_code,\n        course_name,\n        department_name,\n        difficulty_level,\n        count(*) as total_grades,\n        avg(grade_points) as avg_gpa,\n        count(case when grade_range = 'A Range' then 1 end) as a_grades,\n        count(case when grade_range = 'B Range' then 1 end) as b_grades,\n        count(case when grade_range = 'C Range' then 1 end) as c_grades,\n        count(case when grade_range = 'D Range' then 1 end) as d_grades,\n        count(case when grade_range = 'F' then 1 end) as f_grades,\n        round(count(case when grade_range = 'A Range' then 1 end) * 100.0 / count(*), 2) as a_percentage,\n        round(count(case when grade_range = 'B Range' then 1 end) * 100.0 / count(*), 2) as b_percentage,\n        round(count(case when grade_range = 'C Range' then 1 end) * 100.0 / count(*), 2) as c_percentage,\n        round(count(case when grade_range in ('A Range', 'B Range') then 1 end) * 100.0 / count(*), 2) as ab_percentage\n    from historical_grades\n    group by year, course_id, course_code, course_name, department_name, difficulty_level\n    having count(*) >= 10  -- Only courses with sufficient enrollment\n),\n\ninflation_analysis as (\n    select\n        ygt.*,\n        lag(avg_gpa, 1) over (partition by course_id order by year) as prev_year_gpa,\n        lag(a_percentage, 1) over (partition by course_id order by year) as prev_year_a_percentage,\n        lag(ab_percentage, 1) over (partition by course_id order by year) as prev_year_ab_percentage,\n        avg_gpa - lag(avg_gpa, 1) over (partition by course_id order by year) as gpa_change,\n        a_percentage - lag(a_percentage, 1) over (partition by course_id order by year) as a_percentage_change,\n        ab_percentage - lag(ab_percentage, 1) over (partition by course_id order by year) as ab_percentage_change,\n        first_value(avg_gpa) over (partition by course_id order by year) as baseline_gpa,\n        first_value(a_percentage) over (partition by course_id order by year) as baseline_a_percentage,\n        avg_gpa - first_value(avg_gpa) over (partition by course_id order by year) as cumulative_gpa_change,\n        a_percentage - first_value(a_percentage) over (partition by course_id order by year) as cumulative_a_change\n    from yearly_grade_trends ygt\n),\n\ndepartment_trends as (\n    select\n        department_name,\n        year,\n        avg(avg_gpa) as dept_avg_gpa,\n        avg(a_percentage) as dept_avg_a_percentage,\n        avg(ab_percentage) as dept_avg_ab_percentage,\n        count(distinct course_id) as courses_analyzed\n    from yearly_grade_trends\n    group by department_name, year\n),\n\nfaculty_grade_patterns as (\n    select\n        faculty_id,\n        faculty_name,\n        years_of_service,\n        department_name,\n        count(distinct course_id) as courses_taught,\n        avg(grade_points) as faculty_avg_grade,\n        round(count(case when grade_range = 'A Range' then 1 end) * 100.0 / count(*), 2) as faculty_a_percentage,\n        round(count(case when grade_range = 'F' then 1 end) * 100.0 / count(*), 2) as faculty_f_percentage,\n        stddev(grade_points) as faculty_grade_variance\n    from historical_grades\n    where faculty_id is not null\n    group by faculty_id, faculty_name, years_of_service, department_name\n    having count(*) >= 20  -- Only faculty with sufficient grading history\n),\n\ninflation_indicators as (\n    select\n        ia.*,\n        dt.dept_avg_gpa,\n        dt.dept_avg_a_percentage,\n        case\n            when cumulative_gpa_change >= 0.5 then 'Significant Grade Inflation'\n            when cumulative_gpa_change >= 0.3 then 'Moderate Grade Inflation'\n            when cumulative_gpa_change >= 0.1 then 'Mild Grade Inflation'\n            when cumulative_gpa_change >= -0.1 then 'Stable Grading'\n            when cumulative_gpa_change >= -0.3 then 'Mild Grade Deflation'\n            else 'Significant Grade Deflation'\n        end as inflation_category,\n        case\n            when cumulative_a_change >= 20 then 'High A Grade Inflation'\n            when cumulative_a_change >= 10 then 'Moderate A Grade Inflation'\n            when cumulative_a_change >= 5 then 'Mild A Grade Inflation'\n            when cumulative_a_change >= -5 then 'Stable A Grading'\n            else 'A Grade Deflation'\n        end as a_grade_inflation_category,\n        case\n            when gpa_change >= 0.2 then 'Significant Year-over-Year Increase'\n            when gpa_change >= 0.1 then 'Moderate Year-over-Year Increase'\n            when gpa_change >= 0.05 then 'Slight Year-over-Year Increase'\n            when gpa_change >= -0.05 then 'Stable Year-over-Year'\n            when gpa_change >= -0.1 then 'Slight Year-over-Year Decrease'\n            else 'Significant Year-over-Year Decrease'\n        end as annual_trend_category\n    from inflation_analysis ia\n    left join department_trends dt on ia.department_name = dt.department_name and ia.year = dt.year\n)\n\nselect \n    ii.*,\n    fgp.faculty_avg_grade,\n    fgp.faculty_a_percentage,\n    fgp.faculty_grade_variance,\n    case\n        when ii.avg_gpa > ii.dept_avg_gpa * 1.1 then 'Above Department Average'\n        when ii.avg_gpa < ii.dept_avg_gpa * 0.9 then 'Below Department Average'\n        else 'Near Department Average'\n    end as course_vs_department_grading\nfrom inflation_indicators ii\nleft join faculty_grade_patterns fgp on ii.course_id = fgp.faculty_id  -- Simplified join for this example", "language": "sql", "refs": [{"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_faculty"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_grade_inflation_analysis.sql", "compiled": true, "compiled_code": "\n\nwith historical_grades as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.department_id,\n        c.difficulty_level,\n        d.department_name,\n        e.semester_id,\n        e.grade,\n        e.grade_points,\n        sem.academic_year,\n        sem.semester_type,\n        extract(year from sem.start_date) as year,\n        f.faculty_id,\n        f.full_name as faculty_name,\n        f.years_of_service,\n        case\n            when e.grade in ('A+', 'A', 'A-') then 'A Range'\n            when e.grade in ('B+', 'B', 'B-') then 'B Range'\n            when e.grade in ('C+', 'C', 'C-') then 'C Range'\n            when e.grade in ('D+', 'D', 'D-') then 'D Range'\n            when e.grade = 'F' then 'F'\n            else 'Other'\n        end as grade_range\n    from \"postgres\".\"edu_dbt\".\"stg_enrollments\" e\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on c.course_id = cs.course_id and e.semester_id = cs.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on cs.faculty_id = f.faculty_id\n    where e.grade is not null and e.grade != 'W'\n),\n\nyearly_grade_trends as (\n    select\n        year,\n        course_id,\n        course_code,\n        course_name,\n        department_name,\n        difficulty_level,\n        count(*) as total_grades,\n        avg(grade_points) as avg_gpa,\n        count(case when grade_range = 'A Range' then 1 end) as a_grades,\n        count(case when grade_range = 'B Range' then 1 end) as b_grades,\n        count(case when grade_range = 'C Range' then 1 end) as c_grades,\n        count(case when grade_range = 'D Range' then 1 end) as d_grades,\n        count(case when grade_range = 'F' then 1 end) as f_grades,\n        round(count(case when grade_range = 'A Range' then 1 end) * 100.0 / count(*), 2) as a_percentage,\n        round(count(case when grade_range = 'B Range' then 1 end) * 100.0 / count(*), 2) as b_percentage,\n        round(count(case when grade_range = 'C Range' then 1 end) * 100.0 / count(*), 2) as c_percentage,\n        round(count(case when grade_range in ('A Range', 'B Range') then 1 end) * 100.0 / count(*), 2) as ab_percentage\n    from historical_grades\n    group by year, course_id, course_code, course_name, department_name, difficulty_level\n    having count(*) >= 10  -- Only courses with sufficient enrollment\n),\n\ninflation_analysis as (\n    select\n        ygt.*,\n        lag(avg_gpa, 1) over (partition by course_id order by year) as prev_year_gpa,\n        lag(a_percentage, 1) over (partition by course_id order by year) as prev_year_a_percentage,\n        lag(ab_percentage, 1) over (partition by course_id order by year) as prev_year_ab_percentage,\n        avg_gpa - lag(avg_gpa, 1) over (partition by course_id order by year) as gpa_change,\n        a_percentage - lag(a_percentage, 1) over (partition by course_id order by year) as a_percentage_change,\n        ab_percentage - lag(ab_percentage, 1) over (partition by course_id order by year) as ab_percentage_change,\n        first_value(avg_gpa) over (partition by course_id order by year) as baseline_gpa,\n        first_value(a_percentage) over (partition by course_id order by year) as baseline_a_percentage,\n        avg_gpa - first_value(avg_gpa) over (partition by course_id order by year) as cumulative_gpa_change,\n        a_percentage - first_value(a_percentage) over (partition by course_id order by year) as cumulative_a_change\n    from yearly_grade_trends ygt\n),\n\ndepartment_trends as (\n    select\n        department_name,\n        year,\n        avg(avg_gpa) as dept_avg_gpa,\n        avg(a_percentage) as dept_avg_a_percentage,\n        avg(ab_percentage) as dept_avg_ab_percentage,\n        count(distinct course_id) as courses_analyzed\n    from yearly_grade_trends\n    group by department_name, year\n),\n\nfaculty_grade_patterns as (\n    select\n        faculty_id,\n        faculty_name,\n        years_of_service,\n        department_name,\n        count(distinct course_id) as courses_taught,\n        avg(grade_points) as faculty_avg_grade,\n        round(count(case when grade_range = 'A Range' then 1 end) * 100.0 / count(*), 2) as faculty_a_percentage,\n        round(count(case when grade_range = 'F' then 1 end) * 100.0 / count(*), 2) as faculty_f_percentage,\n        stddev(grade_points) as faculty_grade_variance\n    from historical_grades\n    where faculty_id is not null\n    group by faculty_id, faculty_name, years_of_service, department_name\n    having count(*) >= 20  -- Only faculty with sufficient grading history\n),\n\ninflation_indicators as (\n    select\n        ia.*,\n        dt.dept_avg_gpa,\n        dt.dept_avg_a_percentage,\n        case\n            when cumulative_gpa_change >= 0.5 then 'Significant Grade Inflation'\n            when cumulative_gpa_change >= 0.3 then 'Moderate Grade Inflation'\n            when cumulative_gpa_change >= 0.1 then 'Mild Grade Inflation'\n            when cumulative_gpa_change >= -0.1 then 'Stable Grading'\n            when cumulative_gpa_change >= -0.3 then 'Mild Grade Deflation'\n            else 'Significant Grade Deflation'\n        end as inflation_category,\n        case\n            when cumulative_a_change >= 20 then 'High A Grade Inflation'\n            when cumulative_a_change >= 10 then 'Moderate A Grade Inflation'\n            when cumulative_a_change >= 5 then 'Mild A Grade Inflation'\n            when cumulative_a_change >= -5 then 'Stable A Grading'\n            else 'A Grade Deflation'\n        end as a_grade_inflation_category,\n        case\n            when gpa_change >= 0.2 then 'Significant Year-over-Year Increase'\n            when gpa_change >= 0.1 then 'Moderate Year-over-Year Increase'\n            when gpa_change >= 0.05 then 'Slight Year-over-Year Increase'\n            when gpa_change >= -0.05 then 'Stable Year-over-Year'\n            when gpa_change >= -0.1 then 'Slight Year-over-Year Decrease'\n            else 'Significant Year-over-Year Decrease'\n        end as annual_trend_category\n    from inflation_analysis ia\n    left join department_trends dt on ia.department_name = dt.department_name and ia.year = dt.year\n)\n\nselect \n    ii.*,\n    fgp.faculty_avg_grade,\n    fgp.faculty_a_percentage,\n    fgp.faculty_grade_variance,\n    case\n        when ii.avg_gpa > ii.dept_avg_gpa * 1.1 then 'Above Department Average'\n        when ii.avg_gpa < ii.dept_avg_gpa * 0.9 then 'Below Department Average'\n        else 'Near Department Average'\n    end as course_vs_department_grading\nfrom inflation_indicators ii\nleft join faculty_grade_patterns fgp on ii.course_id = fgp.faculty_id  -- Simplified join for this example", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.academic_early_warning_system": {"database": "postgres", "schema": "edu_dbt", "name": "academic_early_warning_system", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/core/academic_early_warning_system.sql", "original_file_path": "models/marts/core/academic_early_warning_system.sql", "unique_id": "model.DbtEducationalDataProject.academic_early_warning_system", "fqn": ["DbtEducationalDataProject", "marts", "core", "academic_early_warning_system"], "alias": "academic_early_warning_system", "checksum": {"name": "sha256", "checksum": "959d9bcc38ad2432c9f505ab5d3d481e739e1b4dad650caf3a6e8663ada199ef"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764373663.6766975, "relation_name": "\"postgres\".\"edu_dbt\".\"academic_early_warning_system\"", "raw_code": "{{ config(materialized='table') }}\n\nwith current_semester_performance as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.gpa as cumulative_gpa,\n        s.academic_standing,\n        s.years_enrolled,\n        d.department_name,\n        count(distinct e.enrollment_id) as current_enrollments,\n        avg(e.grade_points) as current_semester_gpa,\n        avg(e.attendance_percentage) as current_attendance,\n        count(case when e.grade_points < 2.0 then 1 end) as failing_courses,\n        count(case when e.attendance_percentage < 70 then 1 end) as low_attendance_courses,\n        min(e.grade_points) as lowest_current_grade,\n        min(e.attendance_percentage) as lowest_attendance,\n        string_agg(c.course_code, ', ' order by e.grade_points asc) as struggling_courses\n    from {{ ref('stg_students') }} s\n    inner join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join {{ ref('stg_enrollments') }} e on s.student_id = e.student_id\n    left join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    left join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    where sem.is_current = true \n      and s.student_status = 'active'\n      and e.enrollment_status in ('In Progress', 'Completed')\n    group by \n        s.student_id, s.full_name, s.email, s.gpa, s.academic_standing, \n        s.years_enrolled, d.department_name\n),\n\nhistorical_patterns as (\n    select\n        e.student_id,\n        count(distinct e.semester_id) as total_semesters,\n        avg(e.grade_points) as historical_avg_gpa,\n        count(case when e.grade_points < 2.0 then 1 end) as total_failed_courses,\n        count(case when e.enrollment_status = 'Withdrawn' then 1 end) as total_withdrawals,\n        min(e.grade_points) as worst_historical_grade,\n        stddev(e.grade_points) as grade_consistency,\n        lag(avg(e.grade_points)) over (partition by e.student_id order by e.semester_id desc) as previous_semester_gpa\n    from {{ ref('stg_enrollments') }} e\n    inner join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    where sem.is_current = false\n    group by e.student_id, e.semester_id\n),\n\nassignment_performance_indicators as (\n    select\n        e.student_id,\n        count(distinct asub.assignment_id) as assignments_completed,\n        avg(asub.score / nullif(a.max_points, 0) * 100) as avg_assignment_percentage,\n        count(case when asub.late_submission then 1 end) as late_submissions,\n        count(case when asub.score / nullif(a.max_points, 0) < 0.6 then 1 end) as poor_assignment_scores,\n        round(\n            count(case when asub.late_submission then 1 end) * 100.0 / \n            nullif(count(distinct asub.assignment_id), 0), 2\n        ) as late_submission_rate\n    from {{ ref('stg_enrollments') }} e\n    inner join {{ ref('stg_assignments') }} a on e.course_id = a.course_id and e.semester_id = a.semester_id\n    inner join {{ ref('stg_assignment_submissions') }} asub on a.assignment_id = asub.assignment_id and e.student_id = asub.student_id\n    inner join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    where sem.is_current = true\n    group by e.student_id\n),\n\nfinancial_stress_indicators as (\n    select\n        student_id,\n        max(case when late_payment_rate > 25 then 1 else 0 end) as has_payment_issues,\n        max(case when total_aid_received = 0 then 1 else 0 end) as no_financial_aid,\n        max(case when payment_reliability = 'Poor Payment History' then 1 else 0 end) as poor_payment_history\n    from {{ ref('student_financial_profile') }}\n    group by student_id\n),\n\nearly_warning_indicators as (\n    select\n        csp.student_id,\n        csp.full_name,\n        csp.email,\n        csp.department_name,\n        csp.cumulative_gpa,\n        csp.current_semester_gpa,\n        csp.current_attendance,\n        csp.failing_courses,\n        csp.low_attendance_courses,\n        csp.struggling_courses,\n        hp.historical_avg_gpa,\n        hp.total_failed_courses,\n        hp.total_withdrawals,\n        hp.grade_consistency,\n        hp.previous_semester_gpa,\n        api.avg_assignment_percentage,\n        api.late_submission_rate,\n        api.poor_assignment_scores,\n        fsi.has_payment_issues,\n        fsi.no_financial_aid,\n        fsi.poor_payment_history,\n        \n        -- Academic warning flags\n        case when csp.current_semester_gpa < 2.0 then 1 else 0 end as academic_failure_flag,\n        case when csp.current_attendance < 75 then 1 else 0 end as attendance_warning_flag,\n        case when csp.failing_courses >= 2 then 1 else 0 end as multiple_failures_flag,\n        case when csp.current_semester_gpa < csp.cumulative_gpa - 0.5 then 1 else 0 end as declining_performance_flag,\n        case when api.late_submission_rate > 30 then 1 else 0 end as assignment_issues_flag,\n        \n        -- Engagement warning flags\n        case when csp.low_attendance_courses >= 3 then 1 else 0 end as disengagement_flag,\n        case when api.avg_assignment_percentage < 65 then 1 else 0 end as poor_assignment_flag,\n        case when hp.grade_consistency > 1.5 then 1 else 0 end as inconsistent_performance_flag,\n        \n        -- Financial warning flags\n        case when fsi.has_payment_issues = 1 then 1 else 0 end as financial_stress_flag,\n        \n        -- Historical pattern flags\n        case when hp.total_failed_courses >= 3 then 1 else 0 end as chronic_failure_flag,\n        case when hp.total_withdrawals >= 2 then 1 else 0 end as withdrawal_pattern_flag\n    from current_semester_performance csp\n    left join (\n        select \n            student_id,\n            avg(historical_avg_gpa) as historical_avg_gpa,\n            sum(total_failed_courses) as total_failed_courses,\n            sum(total_withdrawals) as total_withdrawals,\n            avg(grade_consistency) as grade_consistency,\n            max(previous_semester_gpa) as previous_semester_gpa\n        from historical_patterns\n        group by student_id\n    ) hp on csp.student_id = hp.student_id\n    left join assignment_performance_indicators api on csp.student_id = api.student_id\n    left join financial_stress_indicators fsi on csp.student_id = fsi.student_id\n),\n\nrisk_scoring as (\n    select\n        ewi.*,\n        -- Calculate overall risk score\n        academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n        declining_performance_flag + assignment_issues_flag + disengagement_flag + \n        poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n        chronic_failure_flag + withdrawal_pattern_flag as total_warning_flags,\n        \n        -- Risk level classification\n        case\n            when (academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n                  declining_performance_flag + assignment_issues_flag + disengagement_flag + \n                  poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n                  chronic_failure_flag + withdrawal_pattern_flag) >= 7 then 'Critical Risk'\n            when (academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n                  declining_performance_flag + assignment_issues_flag + disengagement_flag + \n                  poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n                  chronic_failure_flag + withdrawal_pattern_flag) >= 5 then 'High Risk'\n            when (academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n                  declining_performance_flag + assignment_issues_flag + disengagement_flag + \n                  poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n                  chronic_failure_flag + withdrawal_pattern_flag) >= 3 then 'Moderate Risk'\n            when (academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n                  declining_performance_flag + assignment_issues_flag + disengagement_flag + \n                  poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n                  chronic_failure_flag + withdrawal_pattern_flag) >= 1 then 'Low Risk'\n            else 'No Risk'\n        end as risk_level,\n        \n        -- Primary risk category\n        case\n            when academic_failure_flag = 1 or multiple_failures_flag = 1 then 'Academic Crisis'\n            when attendance_warning_flag = 1 or disengagement_flag = 1 then 'Engagement Issues'\n            when financial_stress_flag = 1 then 'Financial Difficulties'\n            when declining_performance_flag = 1 or inconsistent_performance_flag = 1 then 'Performance Decline'\n            when chronic_failure_flag = 1 or withdrawal_pattern_flag = 1 then 'Chronic Issues'\n            else 'General Risk'\n        end as primary_risk_category\n    from early_warning_indicators ewi\n),\n\nintervention_planning as (\n    select\n        rs.*,\n        -- Immediate interventions\n        case\n            when risk_level = 'Critical Risk' then 'URGENT: Schedule immediate meeting with academic advisor, dean, and counselor'\n            when risk_level = 'High Risk' and primary_risk_category = 'Academic Crisis' then 'Schedule tutoring, reduce course load, academic probation review'\n            when risk_level = 'High Risk' and primary_risk_category = 'Engagement Issues' then 'Mandatory attendance tracking, peer mentorship program'\n            when risk_level = 'High Risk' and primary_risk_category = 'Financial Difficulties' then 'Financial aid counseling, emergency assistance application'\n            when risk_level = 'Moderate Risk' then 'Proactive check-in with advisor, study skills workshop'\n            when risk_level = 'Low Risk' then 'Monitor progress, optional support services'\n            else 'Standard academic support'\n        end as recommended_immediate_intervention,\n        \n        -- Follow-up timeline\n        case\n            when risk_level = 'Critical Risk' then 'Daily check-ins for 2 weeks, then weekly'\n            when risk_level = 'High Risk' then 'Weekly check-ins for 1 month'\n            when risk_level = 'Moderate Risk' then 'Bi-weekly check-ins'\n            when risk_level = 'Low Risk' then 'Monthly check-ins'\n            else 'Semester check-ins'\n        end as follow_up_schedule,\n        \n        -- Success probability\n        case\n            when risk_level = 'Critical Risk' then 'Low - Requires intensive intervention'\n            when risk_level = 'High Risk' and chronic_failure_flag = 0 then 'Moderate - Good chance with proper support'\n            when risk_level = 'High Risk' then 'Low-Moderate - Pattern of difficulties'\n            when risk_level = 'Moderate Risk' then 'Good - Early intervention effective'\n            else 'Excellent - Minor adjustments needed'\n        end as success_probability_with_intervention,\n        \n        -- Alert priority for staff\n        case\n            when risk_level = 'Critical Risk' then 1\n            when risk_level = 'High Risk' then 2\n            when risk_level = 'Moderate Risk' then 3\n            else 4\n        end as alert_priority,\n        \n        current_timestamp as alert_generated_timestamp\n    from risk_scoring rs\n)\n\nselect * from intervention_planning\nwhere risk_level != 'No Risk'\norder by alert_priority asc, total_warning_flags desc, current_semester_gpa asc", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_assignments", "package": null, "version": null}, {"name": "stg_assignment_submissions", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "student_financial_profile", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.stg_assignment_submissions", "model.DbtEducationalDataProject.student_financial_profile"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/core/academic_early_warning_system.sql", "compiled": true, "compiled_code": "\n\nwith current_semester_performance as (\n    select\n        s.student_id,\n        s.full_name,\n        s.email,\n        s.gpa as cumulative_gpa,\n        s.academic_standing,\n        s.years_enrolled,\n        d.department_name,\n        count(distinct e.enrollment_id) as current_enrollments,\n        avg(e.grade_points) as current_semester_gpa,\n        avg(e.attendance_percentage) as current_attendance,\n        count(case when e.grade_points < 2.0 then 1 end) as failing_courses,\n        count(case when e.attendance_percentage < 70 then 1 end) as low_attendance_courses,\n        min(e.grade_points) as lowest_current_grade,\n        min(e.attendance_percentage) as lowest_attendance,\n        string_agg(c.course_code, ', ' order by e.grade_points asc) as struggling_courses\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on s.student_id = e.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    where sem.is_current = true \n      and s.student_status = 'active'\n      and e.enrollment_status in ('In Progress', 'Completed')\n    group by \n        s.student_id, s.full_name, s.email, s.gpa, s.academic_standing, \n        s.years_enrolled, d.department_name\n),\n\nhistorical_patterns as (\n    select\n        e.student_id,\n        count(distinct e.semester_id) as total_semesters,\n        avg(e.grade_points) as historical_avg_gpa,\n        count(case when e.grade_points < 2.0 then 1 end) as total_failed_courses,\n        count(case when e.enrollment_status = 'Withdrawn' then 1 end) as total_withdrawals,\n        min(e.grade_points) as worst_historical_grade,\n        stddev(e.grade_points) as grade_consistency,\n        lag(avg(e.grade_points)) over (partition by e.student_id order by e.semester_id desc) as previous_semester_gpa\n    from \"postgres\".\"edu_dbt\".\"stg_enrollments\" e\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    where sem.is_current = false\n    group by e.student_id, e.semester_id\n),\n\nassignment_performance_indicators as (\n    select\n        e.student_id,\n        count(distinct asub.assignment_id) as assignments_completed,\n        avg(asub.score / nullif(a.max_points, 0) * 100) as avg_assignment_percentage,\n        count(case when asub.late_submission then 1 end) as late_submissions,\n        count(case when asub.score / nullif(a.max_points, 0) < 0.6 then 1 end) as poor_assignment_scores,\n        round(\n            count(case when asub.late_submission then 1 end) * 100.0 / \n            nullif(count(distinct asub.assignment_id), 0), 2\n        ) as late_submission_rate\n    from \"postgres\".\"edu_dbt\".\"stg_enrollments\" e\n    inner join \"postgres\".\"edu_dbt\".\"stg_assignments\" a on e.course_id = a.course_id and e.semester_id = a.semester_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_assignment_submissions\" asub on a.assignment_id = asub.assignment_id and e.student_id = asub.student_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    where sem.is_current = true\n    group by e.student_id\n),\n\nfinancial_stress_indicators as (\n    select\n        student_id,\n        max(case when late_payment_rate > 25 then 1 else 0 end) as has_payment_issues,\n        max(case when total_aid_received = 0 then 1 else 0 end) as no_financial_aid,\n        max(case when payment_reliability = 'Poor Payment History' then 1 else 0 end) as poor_payment_history\n    from \"postgres\".\"edu_dbt\".\"student_financial_profile\"\n    group by student_id\n),\n\nearly_warning_indicators as (\n    select\n        csp.student_id,\n        csp.full_name,\n        csp.email,\n        csp.department_name,\n        csp.cumulative_gpa,\n        csp.current_semester_gpa,\n        csp.current_attendance,\n        csp.failing_courses,\n        csp.low_attendance_courses,\n        csp.struggling_courses,\n        hp.historical_avg_gpa,\n        hp.total_failed_courses,\n        hp.total_withdrawals,\n        hp.grade_consistency,\n        hp.previous_semester_gpa,\n        api.avg_assignment_percentage,\n        api.late_submission_rate,\n        api.poor_assignment_scores,\n        fsi.has_payment_issues,\n        fsi.no_financial_aid,\n        fsi.poor_payment_history,\n        \n        -- Academic warning flags\n        case when csp.current_semester_gpa < 2.0 then 1 else 0 end as academic_failure_flag,\n        case when csp.current_attendance < 75 then 1 else 0 end as attendance_warning_flag,\n        case when csp.failing_courses >= 2 then 1 else 0 end as multiple_failures_flag,\n        case when csp.current_semester_gpa < csp.cumulative_gpa - 0.5 then 1 else 0 end as declining_performance_flag,\n        case when api.late_submission_rate > 30 then 1 else 0 end as assignment_issues_flag,\n        \n        -- Engagement warning flags\n        case when csp.low_attendance_courses >= 3 then 1 else 0 end as disengagement_flag,\n        case when api.avg_assignment_percentage < 65 then 1 else 0 end as poor_assignment_flag,\n        case when hp.grade_consistency > 1.5 then 1 else 0 end as inconsistent_performance_flag,\n        \n        -- Financial warning flags\n        case when fsi.has_payment_issues = 1 then 1 else 0 end as financial_stress_flag,\n        \n        -- Historical pattern flags\n        case when hp.total_failed_courses >= 3 then 1 else 0 end as chronic_failure_flag,\n        case when hp.total_withdrawals >= 2 then 1 else 0 end as withdrawal_pattern_flag\n    from current_semester_performance csp\n    left join (\n        select \n            student_id,\n            avg(historical_avg_gpa) as historical_avg_gpa,\n            sum(total_failed_courses) as total_failed_courses,\n            sum(total_withdrawals) as total_withdrawals,\n            avg(grade_consistency) as grade_consistency,\n            max(previous_semester_gpa) as previous_semester_gpa\n        from historical_patterns\n        group by student_id\n    ) hp on csp.student_id = hp.student_id\n    left join assignment_performance_indicators api on csp.student_id = api.student_id\n    left join financial_stress_indicators fsi on csp.student_id = fsi.student_id\n),\n\nrisk_scoring as (\n    select\n        ewi.*,\n        -- Calculate overall risk score\n        academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n        declining_performance_flag + assignment_issues_flag + disengagement_flag + \n        poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n        chronic_failure_flag + withdrawal_pattern_flag as total_warning_flags,\n        \n        -- Risk level classification\n        case\n            when (academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n                  declining_performance_flag + assignment_issues_flag + disengagement_flag + \n                  poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n                  chronic_failure_flag + withdrawal_pattern_flag) >= 7 then 'Critical Risk'\n            when (academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n                  declining_performance_flag + assignment_issues_flag + disengagement_flag + \n                  poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n                  chronic_failure_flag + withdrawal_pattern_flag) >= 5 then 'High Risk'\n            when (academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n                  declining_performance_flag + assignment_issues_flag + disengagement_flag + \n                  poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n                  chronic_failure_flag + withdrawal_pattern_flag) >= 3 then 'Moderate Risk'\n            when (academic_failure_flag + attendance_warning_flag + multiple_failures_flag + \n                  declining_performance_flag + assignment_issues_flag + disengagement_flag + \n                  poor_assignment_flag + inconsistent_performance_flag + financial_stress_flag + \n                  chronic_failure_flag + withdrawal_pattern_flag) >= 1 then 'Low Risk'\n            else 'No Risk'\n        end as risk_level,\n        \n        -- Primary risk category\n        case\n            when academic_failure_flag = 1 or multiple_failures_flag = 1 then 'Academic Crisis'\n            when attendance_warning_flag = 1 or disengagement_flag = 1 then 'Engagement Issues'\n            when financial_stress_flag = 1 then 'Financial Difficulties'\n            when declining_performance_flag = 1 or inconsistent_performance_flag = 1 then 'Performance Decline'\n            when chronic_failure_flag = 1 or withdrawal_pattern_flag = 1 then 'Chronic Issues'\n            else 'General Risk'\n        end as primary_risk_category\n    from early_warning_indicators ewi\n),\n\nintervention_planning as (\n    select\n        rs.*,\n        -- Immediate interventions\n        case\n            when risk_level = 'Critical Risk' then 'URGENT: Schedule immediate meeting with academic advisor, dean, and counselor'\n            when risk_level = 'High Risk' and primary_risk_category = 'Academic Crisis' then 'Schedule tutoring, reduce course load, academic probation review'\n            when risk_level = 'High Risk' and primary_risk_category = 'Engagement Issues' then 'Mandatory attendance tracking, peer mentorship program'\n            when risk_level = 'High Risk' and primary_risk_category = 'Financial Difficulties' then 'Financial aid counseling, emergency assistance application'\n            when risk_level = 'Moderate Risk' then 'Proactive check-in with advisor, study skills workshop'\n            when risk_level = 'Low Risk' then 'Monitor progress, optional support services'\n            else 'Standard academic support'\n        end as recommended_immediate_intervention,\n        \n        -- Follow-up timeline\n        case\n            when risk_level = 'Critical Risk' then 'Daily check-ins for 2 weeks, then weekly'\n            when risk_level = 'High Risk' then 'Weekly check-ins for 1 month'\n            when risk_level = 'Moderate Risk' then 'Bi-weekly check-ins'\n            when risk_level = 'Low Risk' then 'Monthly check-ins'\n            else 'Semester check-ins'\n        end as follow_up_schedule,\n        \n        -- Success probability\n        case\n            when risk_level = 'Critical Risk' then 'Low - Requires intensive intervention'\n            when risk_level = 'High Risk' and chronic_failure_flag = 0 then 'Moderate - Good chance with proper support'\n            when risk_level = 'High Risk' then 'Low-Moderate - Pattern of difficulties'\n            when risk_level = 'Moderate Risk' then 'Good - Early intervention effective'\n            else 'Excellent - Minor adjustments needed'\n        end as success_probability_with_intervention,\n        \n        -- Alert priority for staff\n        case\n            when risk_level = 'Critical Risk' then 1\n            when risk_level = 'High Risk' then 2\n            when risk_level = 'Moderate Risk' then 3\n            else 4\n        end as alert_priority,\n        \n        current_timestamp as alert_generated_timestamp\n    from risk_scoring rs\n)\n\nselect * from intervention_planning\nwhere risk_level != 'No Risk'\norder by alert_priority asc, total_warning_flags desc, current_semester_gpa asc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_curriculum_flow_analysis": {"database": "postgres", "schema": "edu_dbt", "name": "int_curriculum_flow_analysis", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_curriculum_flow_analysis.sql", "original_file_path": "models/intermediate/int_curriculum_flow_analysis.sql", "unique_id": "model.DbtEducationalDataProject.int_curriculum_flow_analysis", "fqn": ["DbtEducationalDataProject", "intermediate", "int_curriculum_flow_analysis"], "alias": "int_curriculum_flow_analysis", "checksum": {"name": "sha256", "checksum": "768fb25a0a3bad95769a1d5082e3796b37f2c93fea002c5bd8cf16e7bafc6dec"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764373663.6802897, "relation_name": "\"postgres\".\"edu_dbt\".\"int_curriculum_flow_analysis\"", "raw_code": "{{ config(materialized='view') }}\n\nwith course_sequence_data as (\n    select\n        e.student_id,\n        e.course_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.prerequisite_course_id,\n        prereq.course_code as prerequisite_code,\n        e.semester_id,\n        sem.start_date,\n        e.grade_points,\n        e.grade_category,\n        row_number() over (partition by e.student_id order by sem.start_date) as sequence_order\n    from {{ ref('stg_enrollments') }} e\n    inner join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    left join {{ ref('stg_courses') }} prereq on c.prerequisite_course_id = prereq.course_id\n    inner join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    where e.enrollment_status = 'Completed'\n),\n\nprerequisite_compliance as (\n    select\n        csd.student_id,\n        csd.course_id,\n        csd.course_code,\n        csd.prerequisite_course_id,\n        csd.prerequisite_code,\n        csd.sequence_order,\n        case \n            when csd.prerequisite_course_id is null then 'No Prerequisite Required'\n            when prereq_taken.course_id is not null then 'Prerequisite Completed'\n            else 'Prerequisite Not Completed'\n        end as prerequisite_status,\n        case\n            when csd.prerequisite_course_id is not null and prereq_taken.course_id is not null then\n                csd.sequence_order - prereq_taken.sequence_order\n            else null\n        end as courses_between_prerequisite\n    from course_sequence_data csd\n    left join course_sequence_data prereq_taken\n        on csd.student_id = prereq_taken.student_id\n        and csd.prerequisite_course_id = prereq_taken.course_id\n        and prereq_taken.sequence_order < csd.sequence_order\n),\n\ncurriculum_pathways as (\n    select\n        pc.student_id,\n        string_agg(csd.course_code, ' -> ' order by pc.sequence_order) as learning_pathway,\n        count(*) as total_courses_taken,\n        count(case when pc.prerequisite_status = 'Prerequisite Not Completed' then 1 end) as prerequisite_violations,\n        avg(case when pc.prerequisite_course_id is not null then pc.courses_between_prerequisite end) as avg_gap_from_prerequisite,\n        count(case when csd.difficulty_level = 1 then 1 end) as beginner_courses,\n        count(case when csd.difficulty_level = 2 then 1 end) as intermediate_courses,\n        count(case when csd.difficulty_level >= 3 then 1 end) as advanced_courses\n    from prerequisite_compliance pc\n    inner join course_sequence_data csd on pc.student_id = csd.student_id and pc.course_id = csd.course_id\n    group by pc.student_id\n),\n\ndifficulty_progression_analysis as (\n    select\n        student_id,\n        difficulty_level,\n        sequence_order,\n        lag(difficulty_level) over (partition by student_id order by sequence_order) as prev_difficulty,\n        difficulty_level - lag(difficulty_level) over (partition by student_id order by sequence_order) as difficulty_jump,\n        grade_points,\n        lag(grade_points) over (partition by student_id order by sequence_order) as prev_grade_points,\n        grade_points - lag(grade_points) over (partition by student_id order by sequence_order) as grade_change\n    from course_sequence_data\n),\n\nprogression_patterns as (\n    select\n        student_id,\n        count(case when difficulty_jump > 2 then 1 end) as large_difficulty_jumps,\n        count(case when difficulty_jump < 0 then 1 end) as difficulty_reversions,\n        avg(case when difficulty_jump > 0 then grade_change end) as avg_grade_change_on_difficulty_increase,\n        count(case when difficulty_jump > 0 and grade_change < -0.5 then 1 end) as struggled_with_difficulty_increase,\n        max(difficulty_level) as highest_difficulty_attempted,\n        count(case when prev_difficulty is not null then 1 end) as total_transitions\n    from difficulty_progression_analysis\n    where prev_difficulty is not null\n    group by student_id\n),\n\ncurriculum_effectiveness as (\n    select\n        cp.student_id,\n        cp.learning_pathway,\n        cp.total_courses_taken,\n        cp.prerequisite_violations,\n        cp.avg_gap_from_prerequisite,\n        cp.beginner_courses,\n        cp.intermediate_courses,\n        cp.advanced_courses,\n        pp.large_difficulty_jumps,\n        pp.difficulty_reversions,\n        pp.avg_grade_change_on_difficulty_increase,\n        pp.struggled_with_difficulty_increase,\n        pp.highest_difficulty_attempted,\n        s.gpa as final_gpa,\n        s.academic_standing,\n        s.student_status,\n        case\n            when cp.prerequisite_violations = 0 then 'Perfect Compliance'\n            when cp.prerequisite_violations <= 2 then 'Minor Violations'\n            when cp.prerequisite_violations <= 5 then 'Moderate Violations'\n            else 'Major Violations'\n        end as prerequisite_compliance_category,\n        case\n            when pp.large_difficulty_jumps = 0 and pp.difficulty_reversions = 0 then 'Smooth Progression'\n            when pp.large_difficulty_jumps <= 2 then 'Minor Progression Issues'\n            when pp.large_difficulty_jumps <= 5 then 'Moderate Progression Issues'\n            else 'Major Progression Issues'\n        end as difficulty_progression_category,\n        case\n            when cp.beginner_courses > cp.advanced_courses * 2 then 'Beginner Heavy'\n            when cp.advanced_courses > cp.beginner_courses then 'Advanced Heavy'\n            else 'Balanced Curriculum'\n        end as curriculum_balance,\n        round(\n            (case when prerequisite_violations = 0 then 30\n                  when prerequisite_violations <= 2 then 25\n                  when prerequisite_violations <= 5 then 15\n                  else 5 end) +\n            (case when large_difficulty_jumps = 0 then 25\n                  when large_difficulty_jumps <= 2 then 20\n                  when large_difficulty_jumps <= 4 then 15\n                  else 10 end) +\n            (case when avg_grade_change_on_difficulty_increase >= 0 then 25\n                  when avg_grade_change_on_difficulty_increase >= -0.3 then 20\n                  when avg_grade_change_on_difficulty_increase >= -0.7 then 15\n                  else 10 end) +\n            (case when highest_difficulty_attempted >= 4 then 20\n                  when highest_difficulty_attempted >= 3 then 15\n                  when highest_difficulty_attempted >= 2 then 10\n                  else 5 end), 0\n        ) as curriculum_pathway_score\n    from curriculum_pathways cp\n    left join progression_patterns pp on cp.student_id = pp.student_id\n    left join {{ ref('stg_students') }} s on cp.student_id = s.student_id\n),\n\npathway_recommendations as (\n    select\n        ce.*,\n        case\n            when prerequisite_violations > 3 then 'Implement stricter prerequisite enforcement'\n            when large_difficulty_jumps > 3 then 'Add intermediate difficulty courses'\n            when struggled_with_difficulty_increase > total_courses_taken * 0.3 then 'Provide additional academic support'\n            when curriculum_balance = 'Beginner Heavy' then 'Encourage more challenging coursework'\n            when difficulty_reversions > 2 then 'Review course sequencing recommendations'\n            else 'Pathway appears appropriate'\n        end as pathway_improvement_recommendation,\n        case\n            when curriculum_pathway_score >= 80 then 'Optimal Pathway'\n            when curriculum_pathway_score >= 65 then 'Good Pathway'\n            when curriculum_pathway_score >= 50 then 'Adequate Pathway'\n            else 'Problematic Pathway'\n        end as pathway_quality_assessment,\n        case\n            when prerequisite_compliance_category = 'Perfect Compliance' and \n                 difficulty_progression_category = 'Smooth Progression' and\n                 final_gpa >= 3.0 then 'Exemplary Academic Journey'\n            when prerequisite_violations <= 2 and large_difficulty_jumps <= 2 and final_gpa >= 2.5 then 'Successful Academic Journey'\n            when prerequisite_violations > 5 or large_difficulty_jumps > 5 or final_gpa < 2.0 then 'Challenging Academic Journey'\n            else 'Standard Academic Journey'\n        end as overall_journey_assessment\n    from curriculum_effectiveness ce\n)\n\nselect * from pathway_recommendations\norder by curriculum_pathway_score desc", "language": "sql", "refs": [{"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_curriculum_flow_analysis.sql", "compiled": true, "compiled_code": "\n\nwith course_sequence_data as (\n    select\n        e.student_id,\n        e.course_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.prerequisite_course_id,\n        prereq.course_code as prerequisite_code,\n        e.semester_id,\n        sem.start_date,\n        e.grade_points,\n        e.grade_category,\n        row_number() over (partition by e.student_id order by sem.start_date) as sequence_order\n    from \"postgres\".\"edu_dbt\".\"stg_enrollments\" e\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" prereq on c.prerequisite_course_id = prereq.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    where e.enrollment_status = 'Completed'\n),\n\nprerequisite_compliance as (\n    select\n        csd.student_id,\n        csd.course_id,\n        csd.course_code,\n        csd.prerequisite_course_id,\n        csd.prerequisite_code,\n        csd.sequence_order,\n        case \n            when csd.prerequisite_course_id is null then 'No Prerequisite Required'\n            when prereq_taken.course_id is not null then 'Prerequisite Completed'\n            else 'Prerequisite Not Completed'\n        end as prerequisite_status,\n        case\n            when csd.prerequisite_course_id is not null and prereq_taken.course_id is not null then\n                csd.sequence_order - prereq_taken.sequence_order\n            else null\n        end as courses_between_prerequisite\n    from course_sequence_data csd\n    left join course_sequence_data prereq_taken\n        on csd.student_id = prereq_taken.student_id\n        and csd.prerequisite_course_id = prereq_taken.course_id\n        and prereq_taken.sequence_order < csd.sequence_order\n),\n\ncurriculum_pathways as (\n    select\n        pc.student_id,\n        string_agg(csd.course_code, ' -> ' order by pc.sequence_order) as learning_pathway,\n        count(*) as total_courses_taken,\n        count(case when pc.prerequisite_status = 'Prerequisite Not Completed' then 1 end) as prerequisite_violations,\n        avg(case when pc.prerequisite_course_id is not null then pc.courses_between_prerequisite end) as avg_gap_from_prerequisite,\n        count(case when csd.difficulty_level = 1 then 1 end) as beginner_courses,\n        count(case when csd.difficulty_level = 2 then 1 end) as intermediate_courses,\n        count(case when csd.difficulty_level >= 3 then 1 end) as advanced_courses\n    from prerequisite_compliance pc\n    inner join course_sequence_data csd on pc.student_id = csd.student_id and pc.course_id = csd.course_id\n    group by pc.student_id\n),\n\ndifficulty_progression_analysis as (\n    select\n        student_id,\n        difficulty_level,\n        sequence_order,\n        lag(difficulty_level) over (partition by student_id order by sequence_order) as prev_difficulty,\n        difficulty_level - lag(difficulty_level) over (partition by student_id order by sequence_order) as difficulty_jump,\n        grade_points,\n        lag(grade_points) over (partition by student_id order by sequence_order) as prev_grade_points,\n        grade_points - lag(grade_points) over (partition by student_id order by sequence_order) as grade_change\n    from course_sequence_data\n),\n\nprogression_patterns as (\n    select\n        student_id,\n        count(case when difficulty_jump > 2 then 1 end) as large_difficulty_jumps,\n        count(case when difficulty_jump < 0 then 1 end) as difficulty_reversions,\n        avg(case when difficulty_jump > 0 then grade_change end) as avg_grade_change_on_difficulty_increase,\n        count(case when difficulty_jump > 0 and grade_change < -0.5 then 1 end) as struggled_with_difficulty_increase,\n        max(difficulty_level) as highest_difficulty_attempted,\n        count(case when prev_difficulty is not null then 1 end) as total_transitions\n    from difficulty_progression_analysis\n    where prev_difficulty is not null\n    group by student_id\n),\n\ncurriculum_effectiveness as (\n    select\n        cp.student_id,\n        cp.learning_pathway,\n        cp.total_courses_taken,\n        cp.prerequisite_violations,\n        cp.avg_gap_from_prerequisite,\n        cp.beginner_courses,\n        cp.intermediate_courses,\n        cp.advanced_courses,\n        pp.large_difficulty_jumps,\n        pp.difficulty_reversions,\n        pp.avg_grade_change_on_difficulty_increase,\n        pp.struggled_with_difficulty_increase,\n        pp.highest_difficulty_attempted,\n        s.gpa as final_gpa,\n        s.academic_standing,\n        s.student_status,\n        case\n            when cp.prerequisite_violations = 0 then 'Perfect Compliance'\n            when cp.prerequisite_violations <= 2 then 'Minor Violations'\n            when cp.prerequisite_violations <= 5 then 'Moderate Violations'\n            else 'Major Violations'\n        end as prerequisite_compliance_category,\n        case\n            when pp.large_difficulty_jumps = 0 and pp.difficulty_reversions = 0 then 'Smooth Progression'\n            when pp.large_difficulty_jumps <= 2 then 'Minor Progression Issues'\n            when pp.large_difficulty_jumps <= 5 then 'Moderate Progression Issues'\n            else 'Major Progression Issues'\n        end as difficulty_progression_category,\n        case\n            when cp.beginner_courses > cp.advanced_courses * 2 then 'Beginner Heavy'\n            when cp.advanced_courses > cp.beginner_courses then 'Advanced Heavy'\n            else 'Balanced Curriculum'\n        end as curriculum_balance,\n        round(\n            (case when prerequisite_violations = 0 then 30\n                  when prerequisite_violations <= 2 then 25\n                  when prerequisite_violations <= 5 then 15\n                  else 5 end) +\n            (case when large_difficulty_jumps = 0 then 25\n                  when large_difficulty_jumps <= 2 then 20\n                  when large_difficulty_jumps <= 4 then 15\n                  else 10 end) +\n            (case when avg_grade_change_on_difficulty_increase >= 0 then 25\n                  when avg_grade_change_on_difficulty_increase >= -0.3 then 20\n                  when avg_grade_change_on_difficulty_increase >= -0.7 then 15\n                  else 10 end) +\n            (case when highest_difficulty_attempted >= 4 then 20\n                  when highest_difficulty_attempted >= 3 then 15\n                  when highest_difficulty_attempted >= 2 then 10\n                  else 5 end), 0\n        ) as curriculum_pathway_score\n    from curriculum_pathways cp\n    left join progression_patterns pp on cp.student_id = pp.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on cp.student_id = s.student_id\n),\n\npathway_recommendations as (\n    select\n        ce.*,\n        case\n            when prerequisite_violations > 3 then 'Implement stricter prerequisite enforcement'\n            when large_difficulty_jumps > 3 then 'Add intermediate difficulty courses'\n            when struggled_with_difficulty_increase > total_courses_taken * 0.3 then 'Provide additional academic support'\n            when curriculum_balance = 'Beginner Heavy' then 'Encourage more challenging coursework'\n            when difficulty_reversions > 2 then 'Review course sequencing recommendations'\n            else 'Pathway appears appropriate'\n        end as pathway_improvement_recommendation,\n        case\n            when curriculum_pathway_score >= 80 then 'Optimal Pathway'\n            when curriculum_pathway_score >= 65 then 'Good Pathway'\n            when curriculum_pathway_score >= 50 then 'Adequate Pathway'\n            else 'Problematic Pathway'\n        end as pathway_quality_assessment,\n        case\n            when prerequisite_compliance_category = 'Perfect Compliance' and \n                 difficulty_progression_category = 'Smooth Progression' and\n                 final_gpa >= 3.0 then 'Exemplary Academic Journey'\n            when prerequisite_violations <= 2 and large_difficulty_jumps <= 2 and final_gpa >= 2.5 then 'Successful Academic Journey'\n            when prerequisite_violations > 5 or large_difficulty_jumps > 5 or final_gpa < 2.0 then 'Challenging Academic Journey'\n            else 'Standard Academic Journey'\n        end as overall_journey_assessment\n    from curriculum_effectiveness ce\n)\n\nselect * from pathway_recommendations\norder by curriculum_pathway_score desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_student_success_predictors": {"database": "postgres", "schema": "edu_dbt", "name": "int_student_success_predictors", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_student_success_predictors.sql", "original_file_path": "models/intermediate/int_student_success_predictors.sql", "unique_id": "model.DbtEducationalDataProject.int_student_success_predictors", "fqn": ["DbtEducationalDataProject", "intermediate", "int_student_success_predictors"], "alias": "int_student_success_predictors", "checksum": {"name": "sha256", "checksum": "db45210813809b44379f3ebbc8fa23c45ba14134173ad6c65b93c6574fcb47a6"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764373828.2350621, "relation_name": "\"postgres\".\"edu_dbt\".\"int_student_success_predictors\"", "raw_code": "{{ config(materialized='view') }}\n\nwith student_baseline_metrics as (\n    select\n        s.student_id,\n        s.full_name,\n        s.age,\n        s.gpa,\n        s.student_status,\n        s.years_enrolled,\n        s.academic_standing,\n        d.department_name,\n        -- Early academic indicators (first semester performance)\n        first_value(e.grade_points) over (partition by s.student_id order by sem.start_date) as first_semester_gpa,\n        first_value(e.attendance_percentage) over (partition by s.student_id order by sem.start_date) as first_semester_attendance,\n        first_value(c.difficulty_level) over (partition by s.student_id order by sem.start_date) as first_course_difficulty,\n        -- Financial indicators\n        fa.total_aid_received,\n        fa.aid_recipient_category,\n        tp.late_payment_rate,\n        tp.payment_reliability,\n        -- Engagement indicators\n        eh.avg_attendance,\n        eh.total_enrollments,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        eh.total_credits_attempted,\n        eh.total_credits_earned\n    from {{ ref('stg_students') }} s\n    left join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join {{ ref('stg_enrollments') }} e on s.student_id = e.student_id\n    left join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    left join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n    left join (\n        select \n            student_id,\n            sum(total_aid_received) as total_aid_received,\n            max(aid_recipient_category) as aid_recipient_category\n        from {{ ref('student_financial_profile') }}\n        group by student_id\n    ) fa on s.student_id = fa.student_id\n    left join (\n        select \n            student_id,\n            max(late_payment_rate) as late_payment_rate,\n            max(payment_reliability) as payment_reliability\n        from {{ ref('student_financial_profile') }}\n        group by student_id\n    ) tp on s.student_id = tp.student_id\n    left join (\n        select \n            student_id,\n            max(avg_attendance) as avg_attendance,\n            max(total_enrollments) as total_enrollments,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(total_credits_earned) as total_credits_earned\n        from {{ ref('int_student_enrollment_history') }}\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n),\n\npredictive_features as (\n    select\n        sbm.*,\n        -- Academic readiness indicators\n        case when first_semester_gpa >= 3.5 then 1 else 0 end as strong_academic_start,\n        case when first_semester_attendance >= 90 then 1 else 0 end as strong_engagement_start,\n        case when first_course_difficulty <= 2 then 1 else 0 end as appropriate_starting_difficulty,\n        \n        -- Risk factors\n        case when age > 25 then 1 else 0 end as non_traditional_age,\n        case when total_aid_received > 15000 then 1 else 0 end as high_financial_need,\n        case when late_payment_rate > 15 then 1 else 0 end as payment_issues,\n        case when avg_attendance < 80 then 1 else 0 end as attendance_concern,\n        case when failed_courses_count > 0 then 1 else 0 end as has_failed_courses,\n        case when withdrawn_courses_count > 2 then 1 else 0 end as excessive_withdrawals,\n        \n        -- Protective factors\n        case when aid_recipient_category like '%Merit%' then 1 else 0 end as merit_based_aid,\n        case when payment_reliability = 'Excellent Payment History' then 1 else 0 end as reliable_payments,\n        case when total_credits_earned >= years_enrolled * 15 then 1 else 0 end as on_track_credits,\n        \n        -- Calculated metrics\n        round(total_credits_earned::numeric / nullif(total_credits_attempted, 0) * 100, 2) as completion_rate,\n        round(total_credits_earned::numeric / nullif(years_enrolled, 0), 2) as credits_per_year,\n        gpa - first_semester_gpa as gpa_trajectory,\n        case\n            when student_status = 'graduated' then 1\n            when student_status = 'active' and gpa >= 2.0 then null  -- Still in progress\n            else 0\n        end as successful_outcome\n    from student_baseline_metrics sbm\n),\n\nsuccess_scoring as (\n    select\n        pf.*,\n        -- Success probability score (0-100)\n        round(\n            (strong_academic_start * 15) +\n            (strong_engagement_start * 10) +\n            (appropriate_starting_difficulty * 5) +\n            (merit_based_aid * 10) +\n            (reliable_payments * 10) +\n            (on_track_credits * 15) +\n            (case when gpa >= 3.5 then 15\n                  when gpa >= 3.0 then 12\n                  when gpa >= 2.5 then 8\n                  when gpa >= 2.0 then 5\n                  else 0 end) +\n            (case when completion_rate >= 95 then 10\n                  when completion_rate >= 85 then 8\n                  when completion_rate >= 75 then 6\n                  else 3 end) -\n            (non_traditional_age * 3) -\n            (high_financial_need * 5) -\n            (payment_issues * 8) -\n            (attendance_concern * 12) -\n            (has_failed_courses * 10) -\n            (excessive_withdrawals * 15), 0\n        ) as success_probability_score,\n        \n        -- Risk categories\n        case\n            when (non_traditional_age + high_financial_need + payment_issues + \n                  attendance_concern + has_failed_courses + excessive_withdrawals) >= 4 then 'Very High Risk'\n            when (non_traditional_age + high_financial_need + payment_issues + \n                  attendance_concern + has_failed_courses + excessive_withdrawals) >= 3 then 'High Risk'\n            when (non_traditional_age + high_financial_need + payment_issues + \n                  attendance_concern + has_failed_courses + excessive_withdrawals) >= 2 then 'Moderate Risk'\n            when (non_traditional_age + high_financial_need + payment_issues + \n                  attendance_concern + has_failed_courses + excessive_withdrawals) = 1 then 'Low Risk'\n            else 'Very Low Risk'\n        end as overall_risk_category,\n        \n        -- Primary success factors\n        case\n            when strong_academic_start = 1 and strong_engagement_start = 1 then 'Strong Foundation'\n            when reliable_payments = 1 and on_track_credits = 1 then 'Financial Stability'\n            when merit_based_aid = 1 and gpa >= 3.5 then 'Academic Excellence'\n            when completion_rate >= 90 and avg_attendance >= 85 then 'Consistent Performance'\n            else 'Mixed Indicators'\n        end as primary_success_factor,\n        \n        -- Primary risk factors\n        case\n            when attendance_concern = 1 and has_failed_courses = 1 then 'Academic Disengagement'\n            when payment_issues = 1 and high_financial_need = 1 then 'Financial Stress'\n            when excessive_withdrawals = 1 then 'Course Completion Issues'\n            when non_traditional_age = 1 then 'Non-Traditional Challenges'\n            else 'Standard Risk Profile'\n        end as primary_risk_factor\n    from predictive_features pf\n),\n\nintervention_recommendations as (\n    select\n        ss.*,\n        -- Specific intervention recommendations\n        case\n            when overall_risk_category in ('Very High Risk', 'High Risk') and primary_risk_factor = 'Academic Disengagement' then\n                'Immediate academic coaching, mandatory study sessions, attendance monitoring'\n            when overall_risk_category in ('Very High Risk', 'High Risk') and primary_risk_factor = 'Financial Stress' then\n                'Emergency financial aid, payment plan restructuring, financial literacy counseling'\n            when overall_risk_category in ('Very High Risk', 'High Risk') and primary_risk_factor = 'Course Completion Issues' then\n                'Academic planning review, prerequisite assessment, course load reduction'\n            when overall_risk_category = 'Moderate Risk' then\n                'Regular check-ins with advisor, peer tutoring, study skill workshops'\n            when overall_risk_category = 'Low Risk' and primary_success_factor = 'Academic Excellence' then\n                'Honors program recruitment, research opportunities, leadership roles'\n            else 'Standard academic support services'\n        end as recommended_interventions,\n        \n        -- Success prediction confidence\n        case\n            when years_enrolled >= 2 and total_enrollments >= 8 then 'High Confidence'\n            when years_enrolled >= 1 and total_enrollments >= 4 then 'Moderate Confidence'\n            else 'Low Confidence - Insufficient Data'\n        end as prediction_confidence,\n        \n        -- Timeline for graduation prediction\n        case\n            when successful_outcome = 1 then 'Already Graduated'\n            when success_probability_score >= 80 then \n                case\n                    when credits_per_year >= 15 then 'Expected 4-year graduation'\n                    when credits_per_year >= 12 then 'Expected 5-year graduation'\n                    else 'Extended timeline likely'\n                end\n            when success_probability_score >= 60 then 'Likely to graduate with support'\n            when success_probability_score >= 40 then 'At risk - intensive intervention needed'\n            else 'Unlikely to graduate without major intervention'\n        end as graduation_prediction\n    from success_scoring ss\n)\n\nselect * from intervention_recommendations\norder by success_probability_score asc, overall_risk_category desc", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "student_financial_profile", "package": null, "version": null}, {"name": "student_financial_profile", "package": null, "version": null}, {"name": "int_student_enrollment_history", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.student_financial_profile", "model.DbtEducationalDataProject.int_student_enrollment_history"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_student_success_predictors.sql", "compiled": true, "compiled_code": "\n\nwith student_baseline_metrics as (\n    select\n        s.student_id,\n        s.full_name,\n        s.age,\n        s.gpa,\n        s.student_status,\n        s.years_enrolled,\n        s.academic_standing,\n        d.department_name,\n        -- Early academic indicators (first semester performance)\n        first_value(e.grade_points) over (partition by s.student_id order by sem.start_date) as first_semester_gpa,\n        first_value(e.attendance_percentage) over (partition by s.student_id order by sem.start_date) as first_semester_attendance,\n        first_value(c.difficulty_level) over (partition by s.student_id order by sem.start_date) as first_course_difficulty,\n        -- Financial indicators\n        fa.total_aid_received,\n        fa.aid_recipient_category,\n        tp.late_payment_rate,\n        tp.payment_reliability,\n        -- Engagement indicators\n        eh.avg_attendance,\n        eh.total_enrollments,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        eh.total_credits_attempted,\n        eh.total_credits_earned\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on s.student_id = e.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n    left join (\n        select \n            student_id,\n            sum(total_aid_received) as total_aid_received,\n            max(aid_recipient_category) as aid_recipient_category\n        from \"postgres\".\"edu_dbt\".\"student_financial_profile\"\n        group by student_id\n    ) fa on s.student_id = fa.student_id\n    left join (\n        select \n            student_id,\n            max(late_payment_rate) as late_payment_rate,\n            max(payment_reliability) as payment_reliability\n        from \"postgres\".\"edu_dbt\".\"student_financial_profile\"\n        group by student_id\n    ) tp on s.student_id = tp.student_id\n    left join (\n        select \n            student_id,\n            max(avg_attendance) as avg_attendance,\n            max(total_enrollments) as total_enrollments,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(total_credits_earned) as total_credits_earned\n        from \"postgres\".\"edu_dbt\".\"int_student_enrollment_history\"\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n),\n\npredictive_features as (\n    select\n        sbm.*,\n        -- Academic readiness indicators\n        case when first_semester_gpa >= 3.5 then 1 else 0 end as strong_academic_start,\n        case when first_semester_attendance >= 90 then 1 else 0 end as strong_engagement_start,\n        case when first_course_difficulty <= 2 then 1 else 0 end as appropriate_starting_difficulty,\n        \n        -- Risk factors\n        case when age > 25 then 1 else 0 end as non_traditional_age,\n        case when total_aid_received > 15000 then 1 else 0 end as high_financial_need,\n        case when late_payment_rate > 15 then 1 else 0 end as payment_issues,\n        case when avg_attendance < 80 then 1 else 0 end as attendance_concern,\n        case when failed_courses_count > 0 then 1 else 0 end as has_failed_courses,\n        case when withdrawn_courses_count > 2 then 1 else 0 end as excessive_withdrawals,\n        \n        -- Protective factors\n        case when aid_recipient_category like '%Merit%' then 1 else 0 end as merit_based_aid,\n        case when payment_reliability = 'Excellent Payment History' then 1 else 0 end as reliable_payments,\n        case when total_credits_earned >= years_enrolled * 15 then 1 else 0 end as on_track_credits,\n        \n        -- Calculated metrics\n        round(total_credits_earned::numeric / nullif(total_credits_attempted, 0) * 100, 2) as completion_rate,\n        round(total_credits_earned::numeric / nullif(years_enrolled, 0), 2) as credits_per_year,\n        gpa - first_semester_gpa as gpa_trajectory,\n        case\n            when student_status = 'graduated' then 1\n            when student_status = 'active' and gpa >= 2.0 then null  -- Still in progress\n            else 0\n        end as successful_outcome\n    from student_baseline_metrics sbm\n),\n\nsuccess_scoring as (\n    select\n        pf.*,\n        -- Success probability score (0-100)\n        round(\n            (strong_academic_start * 15) +\n            (strong_engagement_start * 10) +\n            (appropriate_starting_difficulty * 5) +\n            (merit_based_aid * 10) +\n            (reliable_payments * 10) +\n            (on_track_credits * 15) +\n            (case when gpa >= 3.5 then 15\n                  when gpa >= 3.0 then 12\n                  when gpa >= 2.5 then 8\n                  when gpa >= 2.0 then 5\n                  else 0 end) +\n            (case when completion_rate >= 95 then 10\n                  when completion_rate >= 85 then 8\n                  when completion_rate >= 75 then 6\n                  else 3 end) -\n            (non_traditional_age * 3) -\n            (high_financial_need * 5) -\n            (payment_issues * 8) -\n            (attendance_concern * 12) -\n            (has_failed_courses * 10) -\n            (excessive_withdrawals * 15), 0\n        ) as success_probability_score,\n        \n        -- Risk categories\n        case\n            when (non_traditional_age + high_financial_need + payment_issues + \n                  attendance_concern + has_failed_courses + excessive_withdrawals) >= 4 then 'Very High Risk'\n            when (non_traditional_age + high_financial_need + payment_issues + \n                  attendance_concern + has_failed_courses + excessive_withdrawals) >= 3 then 'High Risk'\n            when (non_traditional_age + high_financial_need + payment_issues + \n                  attendance_concern + has_failed_courses + excessive_withdrawals) >= 2 then 'Moderate Risk'\n            when (non_traditional_age + high_financial_need + payment_issues + \n                  attendance_concern + has_failed_courses + excessive_withdrawals) = 1 then 'Low Risk'\n            else 'Very Low Risk'\n        end as overall_risk_category,\n        \n        -- Primary success factors\n        case\n            when strong_academic_start = 1 and strong_engagement_start = 1 then 'Strong Foundation'\n            when reliable_payments = 1 and on_track_credits = 1 then 'Financial Stability'\n            when merit_based_aid = 1 and gpa >= 3.5 then 'Academic Excellence'\n            when completion_rate >= 90 and avg_attendance >= 85 then 'Consistent Performance'\n            else 'Mixed Indicators'\n        end as primary_success_factor,\n        \n        -- Primary risk factors\n        case\n            when attendance_concern = 1 and has_failed_courses = 1 then 'Academic Disengagement'\n            when payment_issues = 1 and high_financial_need = 1 then 'Financial Stress'\n            when excessive_withdrawals = 1 then 'Course Completion Issues'\n            when non_traditional_age = 1 then 'Non-Traditional Challenges'\n            else 'Standard Risk Profile'\n        end as primary_risk_factor\n    from predictive_features pf\n),\n\nintervention_recommendations as (\n    select\n        ss.*,\n        -- Specific intervention recommendations\n        case\n            when overall_risk_category in ('Very High Risk', 'High Risk') and primary_risk_factor = 'Academic Disengagement' then\n                'Immediate academic coaching, mandatory study sessions, attendance monitoring'\n            when overall_risk_category in ('Very High Risk', 'High Risk') and primary_risk_factor = 'Financial Stress' then\n                'Emergency financial aid, payment plan restructuring, financial literacy counseling'\n            when overall_risk_category in ('Very High Risk', 'High Risk') and primary_risk_factor = 'Course Completion Issues' then\n                'Academic planning review, prerequisite assessment, course load reduction'\n            when overall_risk_category = 'Moderate Risk' then\n                'Regular check-ins with advisor, peer tutoring, study skill workshops'\n            when overall_risk_category = 'Low Risk' and primary_success_factor = 'Academic Excellence' then\n                'Honors program recruitment, research opportunities, leadership roles'\n            else 'Standard academic support services'\n        end as recommended_interventions,\n        \n        -- Success prediction confidence\n        case\n            when years_enrolled >= 2 and total_enrollments >= 8 then 'High Confidence'\n            when years_enrolled >= 1 and total_enrollments >= 4 then 'Moderate Confidence'\n            else 'Low Confidence - Insufficient Data'\n        end as prediction_confidence,\n        \n        -- Timeline for graduation prediction\n        case\n            when successful_outcome = 1 then 'Already Graduated'\n            when success_probability_score >= 80 then \n                case\n                    when credits_per_year >= 15 then 'Expected 4-year graduation'\n                    when credits_per_year >= 12 then 'Expected 5-year graduation'\n                    else 'Extended timeline likely'\n                end\n            when success_probability_score >= 60 then 'Likely to graduate with support'\n            when success_probability_score >= 40 then 'At risk - intensive intervention needed'\n            else 'Unlikely to graduate without major intervention'\n        end as graduation_prediction\n    from success_scoring ss\n)\n\nselect * from intervention_recommendations\norder by success_probability_score asc, overall_risk_category desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.graduation_pathway_analysis": {"database": "postgres", "schema": "edu_dbt", "name": "graduation_pathway_analysis", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/core/graduation_pathway_analysis.sql", "original_file_path": "models/marts/core/graduation_pathway_analysis.sql", "unique_id": "model.DbtEducationalDataProject.graduation_pathway_analysis", "fqn": ["DbtEducationalDataProject", "marts", "core", "graduation_pathway_analysis"], "alias": "graduation_pathway_analysis", "checksum": {"name": "sha256", "checksum": "4e7e73818d580f46314f8adadcf95851bbdab1d7ae53d8e2b6413fac509b8bee"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764373828.2457488, "relation_name": "\"postgres\".\"edu_dbt\".\"graduation_pathway_analysis\"", "raw_code": "{{ config(materialized='table') }}\n\nwith student_degree_progress as (\n    select\n        s.student_id,\n        s.full_name,\n        s.enrollment_date,\n        s.graduation_date,\n        s.student_status,\n        s.gpa,\n        s.years_enrolled,\n        d.department_name as major,\n        d.department_code,\n        eh.total_credits_earned,\n        eh.total_credits_attempted,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        case\n            when s.graduation_date is not null then \n                extract(year from s.graduation_date) - extract(year from s.enrollment_date)\n            else \n                extract(year from current_date) - extract(year from s.enrollment_date)\n        end as actual_years_to_degree,\n        case when s.graduation_date is not null then 1 else 0 end as has_graduated,\n        120 as required_credits_for_graduation,  -- Standard bachelor's degree\n        120 - eh.total_credits_earned as credits_remaining\n    from {{ ref('stg_students') }} s\n    left join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_credits_earned) as total_credits_earned,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count\n        from {{ ref('int_student_enrollment_history') }}\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n),\n\ncourse_sequencing as (\n    select\n        eh.student_id,\n        c.department_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.prerequisite_course_id,\n        prereq.course_code as prerequisite_code,\n        eh.semester_id,\n        sem.semester_name,\n        sem.start_date,\n        row_number() over (partition by eh.student_id order by sem.start_date) as course_sequence_number,\n        case when c.prerequisite_course_id is not null then 1 else 0 end as has_prerequisite,\n        eh.grade_points,\n        eh.grade_category\n    from {{ ref('int_student_enrollment_history') }} eh\n    inner join {{ ref('stg_courses') }} c on eh.course_id = c.course_id\n    left join {{ ref('stg_courses') }} prereq on c.prerequisite_course_id = prereq.course_id\n    inner join {{ ref('stg_semesters') }} sem on eh.semester_id = sem.semester_id\n),\n\npathway_efficiency as (\n    select\n        sdp.student_id,\n        sdp.full_name,\n        sdp.major,\n        sdp.department_code,\n        sdp.enrollment_date,\n        sdp.graduation_date,\n        sdp.student_status,\n        sdp.gpa,\n        sdp.years_enrolled,\n        sdp.actual_years_to_degree,\n        sdp.total_credits_earned,\n        sdp.total_credits_attempted,\n        sdp.credits_remaining,\n        sdp.has_graduated,\n        sdp.failed_courses_count,\n        sdp.withdrawn_courses_count,\n        round(sdp.total_credits_earned::numeric / sdp.total_credits_attempted * 100, 2) as credit_efficiency,\n        case\n            when sdp.has_graduated = 1 and sdp.actual_years_to_degree <= 4 then 'On-Time Graduate'\n            when sdp.has_graduated = 1 and sdp.actual_years_to_degree between 4 and 5 then 'Extended Graduate'\n            when sdp.has_graduated = 1 and sdp.actual_years_to_degree > 5 then 'Significantly Delayed Graduate'\n            when sdp.student_status = 'active' and sdp.years_enrolled <= 4 then 'On Track'\n            when sdp.student_status = 'active' and sdp.years_enrolled between 4 and 6 then 'Extended Timeline'\n            when sdp.student_status = 'active' and sdp.years_enrolled > 6 then 'Significantly Delayed'\n            else 'Did Not Complete'\n        end as degree_completion_status,\n        case\n            when sdp.total_credits_earned >= 120 then 'Graduation Eligible'\n            when sdp.total_credits_earned >= 90 then 'Senior Status'\n            when sdp.total_credits_earned >= 60 then 'Junior Status'\n            when sdp.total_credits_earned >= 30 then 'Sophomore Status'\n            else 'Freshman Status'\n        end as academic_classification,\n        round(sdp.total_credits_earned::numeric / greatest(sdp.years_enrolled, 1), 2) as avg_credits_per_year,\n        cs.avg_course_difficulty,\n        cs.prerequisite_courses_taken,\n        cs.advanced_courses_taken\n    from student_degree_progress sdp\n    left join (\n        select\n            student_id,\n            avg(difficulty_level) as avg_course_difficulty,\n            count(case when has_prerequisite = 1 then 1 end) as prerequisite_courses_taken,\n            count(case when difficulty_level >= 4 then 1 end) as advanced_courses_taken,\n            max(course_sequence_number) as total_courses_in_sequence\n        from course_sequencing\n        group by student_id\n    ) cs on sdp.student_id = cs.student_id\n),\n\ndegree_pathway_patterns as (\n    select\n        major,\n        department_code,\n        count(*) as total_students_in_major,\n        count(case when has_graduated = 1 then 1 end) as graduates_count,\n        count(case when student_status = 'active' then 1 end) as active_students_count,\n        round(\n            count(case when has_graduated = 1 then 1 end) * 100.0 / \n            nullif(count(case when student_status in ('active', 'graduated', 'dropped') then 1 end), 0), 2\n        ) as graduation_rate,\n        avg(case when has_graduated = 1 then actual_years_to_degree end) as avg_years_to_graduate,\n        avg(case when has_graduated = 1 then total_credits_attempted end) as avg_credits_attempted,\n        avg(case when has_graduated = 1 then credit_efficiency end) as avg_graduation_efficiency,\n        count(case when degree_completion_status = 'On-Time Graduate' then 1 end) as on_time_graduates,\n        count(case when degree_completion_status like '%Delayed%' then 1 end) as delayed_graduates,\n        round(\n            count(case when degree_completion_status = 'On-Time Graduate' then 1 end) * 100.0 / \n            nullif(count(case when has_graduated = 1 then 1 end), 0), 2\n        ) as on_time_graduation_rate\n    from pathway_efficiency\n    group by major, department_code\n),\n\nfinal_pathway_analysis as (\n    select\n        pe.*,\n        dpp.graduation_rate as major_graduation_rate,\n        dpp.avg_years_to_graduate as major_avg_years,\n        dpp.avg_graduation_efficiency as major_avg_efficiency,\n        dpp.on_time_graduation_rate as major_on_time_rate,\n        case\n            when pe.credit_efficiency >= 95 then 'Highly Efficient'\n            when pe.credit_efficiency >= 85 then 'Efficient'\n            when pe.credit_efficiency >= 75 then 'Moderately Efficient'\n            else 'Inefficient'\n        end as individual_efficiency_category,\n        case\n            when pe.avg_credits_per_year >= 15 then 'Fast Track'\n            when pe.avg_credits_per_year >= 12 then 'Standard Pace'\n            when pe.avg_credits_per_year >= 9 then 'Slow Pace'\n            else 'Very Slow Pace'\n        end as progression_pace,\n        case\n            when pe.has_graduated = 0 and pe.credits_remaining <= 30 and pe.gpa >= 2.0 then 'Expected to Graduate Soon'\n            when pe.has_graduated = 0 and pe.credits_remaining <= 60 and pe.gpa >= 2.0 then 'On Track to Graduate'\n            when pe.has_graduated = 0 and pe.gpa < 2.0 then 'At Risk'\n            when pe.has_graduated = 0 and pe.years_enrolled > 6 then 'Extended Timeline Risk'\n            else 'Standard Progress'\n        end as completion_risk_assessment\n    from pathway_efficiency pe\n    left join degree_pathway_patterns dpp on pe.major = dpp.major\n)\n\nselect * from final_pathway_analysis\norder by student_id", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_student_enrollment_history", "package": null, "version": null}, {"name": "int_student_enrollment_history", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/core/graduation_pathway_analysis.sql", "compiled": true, "compiled_code": "\n\nwith student_degree_progress as (\n    select\n        s.student_id,\n        s.full_name,\n        s.enrollment_date,\n        s.graduation_date,\n        s.student_status,\n        s.gpa,\n        s.years_enrolled,\n        d.department_name as major,\n        d.department_code,\n        eh.total_credits_earned,\n        eh.total_credits_attempted,\n        eh.failed_courses_count,\n        eh.withdrawn_courses_count,\n        case\n            when s.graduation_date is not null then \n                extract(year from s.graduation_date) - extract(year from s.enrollment_date)\n            else \n                extract(year from current_date) - extract(year from s.enrollment_date)\n        end as actual_years_to_degree,\n        case when s.graduation_date is not null then 1 else 0 end as has_graduated,\n        120 as required_credits_for_graduation,  -- Standard bachelor's degree\n        120 - eh.total_credits_earned as credits_remaining\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_credits_earned) as total_credits_earned,\n            max(total_credits_attempted) as total_credits_attempted,\n            max(failed_courses_count) as failed_courses_count,\n            max(withdrawn_courses_count) as withdrawn_courses_count\n        from \"postgres\".\"edu_dbt\".\"int_student_enrollment_history\"\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n),\n\ncourse_sequencing as (\n    select\n        eh.student_id,\n        c.department_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.prerequisite_course_id,\n        prereq.course_code as prerequisite_code,\n        eh.semester_id,\n        sem.semester_name,\n        sem.start_date,\n        row_number() over (partition by eh.student_id order by sem.start_date) as course_sequence_number,\n        case when c.prerequisite_course_id is not null then 1 else 0 end as has_prerequisite,\n        eh.grade_points,\n        eh.grade_category\n    from \"postgres\".\"edu_dbt\".\"int_student_enrollment_history\" eh\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on eh.course_id = c.course_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" prereq on c.prerequisite_course_id = prereq.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on eh.semester_id = sem.semester_id\n),\n\npathway_efficiency as (\n    select\n        sdp.student_id,\n        sdp.full_name,\n        sdp.major,\n        sdp.department_code,\n        sdp.enrollment_date,\n        sdp.graduation_date,\n        sdp.student_status,\n        sdp.gpa,\n        sdp.years_enrolled,\n        sdp.actual_years_to_degree,\n        sdp.total_credits_earned,\n        sdp.total_credits_attempted,\n        sdp.credits_remaining,\n        sdp.has_graduated,\n        sdp.failed_courses_count,\n        sdp.withdrawn_courses_count,\n        round(sdp.total_credits_earned::numeric / sdp.total_credits_attempted * 100, 2) as credit_efficiency,\n        case\n            when sdp.has_graduated = 1 and sdp.actual_years_to_degree <= 4 then 'On-Time Graduate'\n            when sdp.has_graduated = 1 and sdp.actual_years_to_degree between 4 and 5 then 'Extended Graduate'\n            when sdp.has_graduated = 1 and sdp.actual_years_to_degree > 5 then 'Significantly Delayed Graduate'\n            when sdp.student_status = 'active' and sdp.years_enrolled <= 4 then 'On Track'\n            when sdp.student_status = 'active' and sdp.years_enrolled between 4 and 6 then 'Extended Timeline'\n            when sdp.student_status = 'active' and sdp.years_enrolled > 6 then 'Significantly Delayed'\n            else 'Did Not Complete'\n        end as degree_completion_status,\n        case\n            when sdp.total_credits_earned >= 120 then 'Graduation Eligible'\n            when sdp.total_credits_earned >= 90 then 'Senior Status'\n            when sdp.total_credits_earned >= 60 then 'Junior Status'\n            when sdp.total_credits_earned >= 30 then 'Sophomore Status'\n            else 'Freshman Status'\n        end as academic_classification,\n        round(sdp.total_credits_earned::numeric / greatest(sdp.years_enrolled, 1), 2) as avg_credits_per_year,\n        cs.avg_course_difficulty,\n        cs.prerequisite_courses_taken,\n        cs.advanced_courses_taken\n    from student_degree_progress sdp\n    left join (\n        select\n            student_id,\n            avg(difficulty_level) as avg_course_difficulty,\n            count(case when has_prerequisite = 1 then 1 end) as prerequisite_courses_taken,\n            count(case when difficulty_level >= 4 then 1 end) as advanced_courses_taken,\n            max(course_sequence_number) as total_courses_in_sequence\n        from course_sequencing\n        group by student_id\n    ) cs on sdp.student_id = cs.student_id\n),\n\ndegree_pathway_patterns as (\n    select\n        major,\n        department_code,\n        count(*) as total_students_in_major,\n        count(case when has_graduated = 1 then 1 end) as graduates_count,\n        count(case when student_status = 'active' then 1 end) as active_students_count,\n        round(\n            count(case when has_graduated = 1 then 1 end) * 100.0 / \n            nullif(count(case when student_status in ('active', 'graduated', 'dropped') then 1 end), 0), 2\n        ) as graduation_rate,\n        avg(case when has_graduated = 1 then actual_years_to_degree end) as avg_years_to_graduate,\n        avg(case when has_graduated = 1 then total_credits_attempted end) as avg_credits_attempted,\n        avg(case when has_graduated = 1 then credit_efficiency end) as avg_graduation_efficiency,\n        count(case when degree_completion_status = 'On-Time Graduate' then 1 end) as on_time_graduates,\n        count(case when degree_completion_status like '%Delayed%' then 1 end) as delayed_graduates,\n        round(\n            count(case when degree_completion_status = 'On-Time Graduate' then 1 end) * 100.0 / \n            nullif(count(case when has_graduated = 1 then 1 end), 0), 2\n        ) as on_time_graduation_rate\n    from pathway_efficiency\n    group by major, department_code\n),\n\nfinal_pathway_analysis as (\n    select\n        pe.*,\n        dpp.graduation_rate as major_graduation_rate,\n        dpp.avg_years_to_graduate as major_avg_years,\n        dpp.avg_graduation_efficiency as major_avg_efficiency,\n        dpp.on_time_graduation_rate as major_on_time_rate,\n        case\n            when pe.credit_efficiency >= 95 then 'Highly Efficient'\n            when pe.credit_efficiency >= 85 then 'Efficient'\n            when pe.credit_efficiency >= 75 then 'Moderately Efficient'\n            else 'Inefficient'\n        end as individual_efficiency_category,\n        case\n            when pe.avg_credits_per_year >= 15 then 'Fast Track'\n            when pe.avg_credits_per_year >= 12 then 'Standard Pace'\n            when pe.avg_credits_per_year >= 9 then 'Slow Pace'\n            else 'Very Slow Pace'\n        end as progression_pace,\n        case\n            when pe.has_graduated = 0 and pe.credits_remaining <= 30 and pe.gpa >= 2.0 then 'Expected to Graduate Soon'\n            when pe.has_graduated = 0 and pe.credits_remaining <= 60 and pe.gpa >= 2.0 then 'On Track to Graduate'\n            when pe.has_graduated = 0 and pe.gpa < 2.0 then 'At Risk'\n            when pe.has_graduated = 0 and pe.years_enrolled > 6 then 'Extended Timeline Risk'\n            else 'Standard Progress'\n        end as completion_risk_assessment\n    from pathway_efficiency pe\n    left join degree_pathway_patterns dpp on pe.major = dpp.major\n)\n\nselect * from final_pathway_analysis\norder by student_id", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.learning_outcome_assessment": {"database": "postgres", "schema": "edu_dbt", "name": "learning_outcome_assessment", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/academic/learning_outcome_assessment.sql", "original_file_path": "models/marts/academic/learning_outcome_assessment.sql", "unique_id": "model.DbtEducationalDataProject.learning_outcome_assessment", "fqn": ["DbtEducationalDataProject", "marts", "academic", "learning_outcome_assessment"], "alias": "learning_outcome_assessment", "checksum": {"name": "sha256", "checksum": "e37020addab98ee47ac5372e6f195a1e32a93217ddf5b1327a80d6bbdeb7ac00"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764373889.5091674, "relation_name": "\"postgres\".\"edu_dbt\".\"learning_outcome_assessment\"", "raw_code": "{{ config(materialized='table') }}\n\nwith course_learning_outcomes as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.credits,\n        d.department_name,\n        cpm.avg_grade_points,\n        cpm.pass_rate,\n        cpm.withdrawal_rate,\n        cpm.avg_attendance,\n        ap.avg_percentage_score as assignment_performance,\n        ap.late_submission_rate,\n        csp.gpa_correlation,\n        csp.attendance_correlation,\n        csp.assignment_correlation,\n        case\n            when cpm.avg_grade_points >= 3.5 then 'Exceeds Expectations'\n            when cpm.avg_grade_points >= 3.0 then 'Meets Expectations'\n            when cpm.avg_grade_points >= 2.5 then 'Approaching Expectations'\n            else 'Below Expectations'\n        end as grade_performance_level,\n        case\n            when cpm.pass_rate >= 90 then 'Excellent Mastery'\n            when cpm.pass_rate >= 80 then 'Good Mastery'\n            when cpm.pass_rate >= 70 then 'Acceptable Mastery'\n            when cpm.pass_rate >= 60 then 'Poor Mastery'\n            else 'Very Poor Mastery'\n        end as content_mastery_level\n    from {{ ref('stg_courses') }} c\n    inner join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    left join {{ ref('int_course_performance_metrics') }} cpm on c.course_id = cpm.course_id\n    left join (\n        select \n            course_id,\n            avg(avg_percentage_score) as avg_percentage_score,\n            avg(late_submission_rate) as late_submission_rate\n        from {{ ref('int_assignment_performance') }}\n        group by course_id\n    ) ap on c.course_id = ap.course_id\n    left join {{ ref('course_success_predictors') }} csp on c.course_id = csp.course_id\n),\n\nstudent_learning_progression as (\n    select\n        s.student_id,\n        s.full_name,\n        s.gpa,\n        s.academic_standing,\n        d.department_name as major,\n        eh.total_credits_earned,\n        eh.avg_grade_points,\n        count(distinct e.course_id) as courses_completed,\n        avg(c.difficulty_level) as avg_course_difficulty,\n        count(case when clo.content_mastery_level in ('Excellent Mastery', 'Good Mastery') then 1 end) as well_mastered_courses,\n        count(case when clo.content_mastery_level in ('Poor Mastery', 'Very Poor Mastery') then 1 end) as poorly_mastered_courses,\n        avg(case when c.difficulty_level = 1 then e.grade_points end) as avg_beginner_performance,\n        avg(case when c.difficulty_level = 2 then e.grade_points end) as avg_intermediate_performance,\n        avg(case when c.difficulty_level >= 3 then e.grade_points end) as avg_advanced_performance,\n        stddev(e.grade_points) as performance_consistency\n    from {{ ref('stg_students') }} s\n    inner join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_credits_earned) as total_credits_earned,\n            max(avg_grade_points) as avg_grade_points\n        from {{ ref('int_student_enrollment_history') }}\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n    left join {{ ref('stg_enrollments') }} e on s.student_id = e.student_id\n    left join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    left join course_learning_outcomes clo on c.course_id = clo.course_id\n    where e.enrollment_status = 'Completed'\n    group by \n        s.student_id, s.full_name, s.gpa, s.academic_standing, \n        d.department_name, eh.total_credits_earned, eh.avg_grade_points\n),\n\nlearning_outcome_analysis as (\n    select\n        slp.*,\n        case\n            when avg_beginner_performance is not null and avg_intermediate_performance is not null then\n                avg_intermediate_performance - avg_beginner_performance\n            else null\n        end as beginner_to_intermediate_growth,\n        case\n            when avg_intermediate_performance is not null and avg_advanced_performance is not null then\n                avg_advanced_performance - avg_intermediate_performance\n            else null\n        end as intermediate_to_advanced_growth,\n        case\n            when avg_beginner_performance is not null and avg_advanced_performance is not null then\n                avg_advanced_performance - avg_beginner_performance\n            else null\n        end as overall_learning_growth,\n        round(\n            well_mastered_courses * 100.0 / nullif(courses_completed, 0), 2\n        ) as mastery_success_rate,\n        case\n            when performance_consistency <= 0.5 then 'Very Consistent'\n            when performance_consistency <= 1.0 then 'Consistent'\n            when performance_consistency <= 1.5 then 'Moderately Consistent'\n            else 'Inconsistent'\n        end as performance_consistency_level,\n        case\n            when avg_advanced_performance >= avg_beginner_performance + 0.5 then 'Strong Learning Growth'\n            when avg_advanced_performance >= avg_beginner_performance + 0.2 then 'Moderate Learning Growth'\n            when avg_advanced_performance >= avg_beginner_performance - 0.2 then 'Stable Performance'\n            else 'Declining Performance'\n        end as learning_trajectory\n    from student_learning_progression slp\n),\n\ndepartmental_outcomes as (\n    select\n        major,\n        count(*) as students_in_major,\n        avg(gpa) as major_avg_gpa,\n        avg(mastery_success_rate) as avg_mastery_rate,\n        avg(overall_learning_growth) as avg_learning_growth,\n        count(case when learning_trajectory = 'Strong Learning Growth' then 1 end) as strong_learners,\n        count(case when learning_trajectory = 'Declining Performance' then 1 end) as declining_learners,\n        round(\n            count(case when learning_trajectory = 'Strong Learning Growth' then 1 end) * 100.0 / count(*), 2\n        ) as strong_learner_percentage,\n        avg(avg_course_difficulty) as major_avg_difficulty\n    from learning_outcome_analysis\n    group by major\n),\n\ncourse_outcome_effectiveness as (\n    select\n        clo.*,\n        dept_out.avg_mastery_rate as dept_avg_mastery_rate,\n        dept_out.avg_learning_growth as dept_avg_learning_growth,\n        case\n            when clo.pass_rate > dept_out.avg_mastery_rate * 1.1 then 'Above Department Average'\n            when clo.pass_rate < dept_out.avg_mastery_rate * 0.9 then 'Below Department Average'\n            else 'Near Department Average'\n        end as relative_effectiveness,\n        -- Learning outcome achievement score\n        round(\n            (case when grade_performance_level = 'Exceeds Expectations' then 30\n                  when grade_performance_level = 'Meets Expectations' then 25\n                  when grade_performance_level = 'Approaching Expectations' then 15\n                  else 5 end) +\n            (case when content_mastery_level = 'Excellent Mastery' then 25\n                  when content_mastery_level = 'Good Mastery' then 20\n                  when content_mastery_level = 'Acceptable Mastery' then 15\n                  else 5 end) +\n            (case when withdrawal_rate <= 5 then 20\n                  when withdrawal_rate <= 10 then 15\n                  when withdrawal_rate <= 15 then 10\n                  else 5 end) +\n            (case when avg_attendance >= 90 then 15\n                  when avg_attendance >= 80 then 12\n                  when avg_attendance >= 70 then 8\n                  else 3 end) +\n            (case when assignment_performance >= 85 then 10\n                  when assignment_performance >= 75 then 8\n                  when assignment_performance >= 65 then 5\n                  else 2 end), 0\n        ) as learning_outcome_score\n    from course_learning_outcomes clo\n    left join departmental_outcomes dept_out on clo.department_name = dept_out.major\n),\n\nfinal_assessment as (\n    select\n        loa.*,\n        dept_out2.major_avg_gpa,\n        dept_out2.strong_learner_percentage as dept_strong_learner_rate,\n        dept_out2.major_avg_difficulty as dept_avg_difficulty,\n        case\n            when overall_learning_growth > 0.5 and mastery_success_rate > 80 then 'Exceptional Learning Outcomes'\n            when overall_learning_growth > 0.2 and mastery_success_rate > 70 then 'Strong Learning Outcomes'\n            when overall_learning_growth > 0 and mastery_success_rate > 60 then 'Adequate Learning Outcomes'\n            when overall_learning_growth <= 0 or mastery_success_rate <= 50 then 'Poor Learning Outcomes'\n            else 'Mixed Learning Outcomes'\n        end as overall_learning_outcome_assessment,\n        case\n            when learning_trajectory = 'Strong Learning Growth' and performance_consistency_level in ('Very Consistent', 'Consistent') then\n                'Ready for advanced coursework and independent study'\n            when learning_trajectory = 'Moderate Learning Growth' and mastery_success_rate >= 70 then\n                'Progressing well, continue current academic plan'\n            when learning_trajectory = 'Stable Performance' and mastery_success_rate >= 60 then\n                'Consider academic enrichment activities'\n            when learning_trajectory = 'Declining Performance' or mastery_success_rate < 50 then\n                'Requires academic intervention and support'\n            else 'Monitor progress and provide targeted support'\n        end as learning_outcome_recommendation,\n        -- Student readiness for next level\n        case\n            when avg_advanced_performance >= 3.0 and mastery_success_rate >= 80 then 'Ready for Graduate Studies'\n            when avg_advanced_performance >= 2.5 and mastery_success_rate >= 70 then 'Ready for Senior Capstone'\n            when avg_intermediate_performance >= 2.5 and total_credits_earned >= 60 then 'Ready for Advanced Courses'\n            when avg_beginner_performance >= 2.0 and total_credits_earned >= 30 then 'Ready for Intermediate Courses'\n            else 'Continue Foundation Building'\n        end as academic_readiness_level\n    from learning_outcome_analysis loa\n    left join departmental_outcomes dept_out2 on loa.major = dept_out2.major\n)\n\nselect * from final_assessment\norder by overall_learning_growth desc, mastery_success_rate desc", "language": "sql", "refs": [{"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_course_performance_metrics", "package": null, "version": null}, {"name": "int_assignment_performance", "package": null, "version": null}, {"name": "course_success_predictors", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "int_student_enrollment_history", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.course_success_predictors", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_enrollments"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/academic/learning_outcome_assessment.sql", "compiled": true, "compiled_code": "\n\nwith course_learning_outcomes as (\n    select\n        c.course_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        c.credits,\n        d.department_name,\n        cpm.avg_grade_points,\n        cpm.pass_rate,\n        cpm.withdrawal_rate,\n        cpm.avg_attendance,\n        ap.avg_percentage_score as assignment_performance,\n        ap.late_submission_rate,\n        csp.gpa_correlation,\n        csp.attendance_correlation,\n        csp.assignment_correlation,\n        case\n            when cpm.avg_grade_points >= 3.5 then 'Exceeds Expectations'\n            when cpm.avg_grade_points >= 3.0 then 'Meets Expectations'\n            when cpm.avg_grade_points >= 2.5 then 'Approaching Expectations'\n            else 'Below Expectations'\n        end as grade_performance_level,\n        case\n            when cpm.pass_rate >= 90 then 'Excellent Mastery'\n            when cpm.pass_rate >= 80 then 'Good Mastery'\n            when cpm.pass_rate >= 70 then 'Acceptable Mastery'\n            when cpm.pass_rate >= 60 then 'Poor Mastery'\n            else 'Very Poor Mastery'\n        end as content_mastery_level\n    from \"postgres\".\"edu_dbt\".\"stg_courses\" c\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    left join \"postgres\".\"edu_dbt\".\"int_course_performance_metrics\" cpm on c.course_id = cpm.course_id\n    left join (\n        select \n            course_id,\n            avg(avg_percentage_score) as avg_percentage_score,\n            avg(late_submission_rate) as late_submission_rate\n        from \"postgres\".\"edu_dbt\".\"int_assignment_performance\"\n        group by course_id\n    ) ap on c.course_id = ap.course_id\n    left join \"postgres\".\"edu_dbt\".\"course_success_predictors\" csp on c.course_id = csp.course_id\n),\n\nstudent_learning_progression as (\n    select\n        s.student_id,\n        s.full_name,\n        s.gpa,\n        s.academic_standing,\n        d.department_name as major,\n        eh.total_credits_earned,\n        eh.avg_grade_points,\n        count(distinct e.course_id) as courses_completed,\n        avg(c.difficulty_level) as avg_course_difficulty,\n        count(case when clo.content_mastery_level in ('Excellent Mastery', 'Good Mastery') then 1 end) as well_mastered_courses,\n        count(case when clo.content_mastery_level in ('Poor Mastery', 'Very Poor Mastery') then 1 end) as poorly_mastered_courses,\n        avg(case when c.difficulty_level = 1 then e.grade_points end) as avg_beginner_performance,\n        avg(case when c.difficulty_level = 2 then e.grade_points end) as avg_intermediate_performance,\n        avg(case when c.difficulty_level >= 3 then e.grade_points end) as avg_advanced_performance,\n        stddev(e.grade_points) as performance_consistency\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    left join (\n        select \n            student_id,\n            max(total_credits_earned) as total_credits_earned,\n            max(avg_grade_points) as avg_grade_points\n        from \"postgres\".\"edu_dbt\".\"int_student_enrollment_history\"\n        group by student_id\n    ) eh on s.student_id = eh.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on s.student_id = e.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    left join course_learning_outcomes clo on c.course_id = clo.course_id\n    where e.enrollment_status = 'Completed'\n    group by \n        s.student_id, s.full_name, s.gpa, s.academic_standing, \n        d.department_name, eh.total_credits_earned, eh.avg_grade_points\n),\n\nlearning_outcome_analysis as (\n    select\n        slp.*,\n        case\n            when avg_beginner_performance is not null and avg_intermediate_performance is not null then\n                avg_intermediate_performance - avg_beginner_performance\n            else null\n        end as beginner_to_intermediate_growth,\n        case\n            when avg_intermediate_performance is not null and avg_advanced_performance is not null then\n                avg_advanced_performance - avg_intermediate_performance\n            else null\n        end as intermediate_to_advanced_growth,\n        case\n            when avg_beginner_performance is not null and avg_advanced_performance is not null then\n                avg_advanced_performance - avg_beginner_performance\n            else null\n        end as overall_learning_growth,\n        round(\n            well_mastered_courses * 100.0 / nullif(courses_completed, 0), 2\n        ) as mastery_success_rate,\n        case\n            when performance_consistency <= 0.5 then 'Very Consistent'\n            when performance_consistency <= 1.0 then 'Consistent'\n            when performance_consistency <= 1.5 then 'Moderately Consistent'\n            else 'Inconsistent'\n        end as performance_consistency_level,\n        case\n            when avg_advanced_performance >= avg_beginner_performance + 0.5 then 'Strong Learning Growth'\n            when avg_advanced_performance >= avg_beginner_performance + 0.2 then 'Moderate Learning Growth'\n            when avg_advanced_performance >= avg_beginner_performance - 0.2 then 'Stable Performance'\n            else 'Declining Performance'\n        end as learning_trajectory\n    from student_learning_progression slp\n),\n\ndepartmental_outcomes as (\n    select\n        major,\n        count(*) as students_in_major,\n        avg(gpa) as major_avg_gpa,\n        avg(mastery_success_rate) as avg_mastery_rate,\n        avg(overall_learning_growth) as avg_learning_growth,\n        count(case when learning_trajectory = 'Strong Learning Growth' then 1 end) as strong_learners,\n        count(case when learning_trajectory = 'Declining Performance' then 1 end) as declining_learners,\n        round(\n            count(case when learning_trajectory = 'Strong Learning Growth' then 1 end) * 100.0 / count(*), 2\n        ) as strong_learner_percentage,\n        avg(avg_course_difficulty) as major_avg_difficulty\n    from learning_outcome_analysis\n    group by major\n),\n\ncourse_outcome_effectiveness as (\n    select\n        clo.*,\n        dept_out.avg_mastery_rate as dept_avg_mastery_rate,\n        dept_out.avg_learning_growth as dept_avg_learning_growth,\n        case\n            when clo.pass_rate > dept_out.avg_mastery_rate * 1.1 then 'Above Department Average'\n            when clo.pass_rate < dept_out.avg_mastery_rate * 0.9 then 'Below Department Average'\n            else 'Near Department Average'\n        end as relative_effectiveness,\n        -- Learning outcome achievement score\n        round(\n            (case when grade_performance_level = 'Exceeds Expectations' then 30\n                  when grade_performance_level = 'Meets Expectations' then 25\n                  when grade_performance_level = 'Approaching Expectations' then 15\n                  else 5 end) +\n            (case when content_mastery_level = 'Excellent Mastery' then 25\n                  when content_mastery_level = 'Good Mastery' then 20\n                  when content_mastery_level = 'Acceptable Mastery' then 15\n                  else 5 end) +\n            (case when withdrawal_rate <= 5 then 20\n                  when withdrawal_rate <= 10 then 15\n                  when withdrawal_rate <= 15 then 10\n                  else 5 end) +\n            (case when avg_attendance >= 90 then 15\n                  when avg_attendance >= 80 then 12\n                  when avg_attendance >= 70 then 8\n                  else 3 end) +\n            (case when assignment_performance >= 85 then 10\n                  when assignment_performance >= 75 then 8\n                  when assignment_performance >= 65 then 5\n                  else 2 end), 0\n        ) as learning_outcome_score\n    from course_learning_outcomes clo\n    left join departmental_outcomes dept_out on clo.department_name = dept_out.major\n),\n\nfinal_assessment as (\n    select\n        loa.*,\n        dept_out2.major_avg_gpa,\n        dept_out2.strong_learner_percentage as dept_strong_learner_rate,\n        dept_out2.major_avg_difficulty as dept_avg_difficulty,\n        case\n            when overall_learning_growth > 0.5 and mastery_success_rate > 80 then 'Exceptional Learning Outcomes'\n            when overall_learning_growth > 0.2 and mastery_success_rate > 70 then 'Strong Learning Outcomes'\n            when overall_learning_growth > 0 and mastery_success_rate > 60 then 'Adequate Learning Outcomes'\n            when overall_learning_growth <= 0 or mastery_success_rate <= 50 then 'Poor Learning Outcomes'\n            else 'Mixed Learning Outcomes'\n        end as overall_learning_outcome_assessment,\n        case\n            when learning_trajectory = 'Strong Learning Growth' and performance_consistency_level in ('Very Consistent', 'Consistent') then\n                'Ready for advanced coursework and independent study'\n            when learning_trajectory = 'Moderate Learning Growth' and mastery_success_rate >= 70 then\n                'Progressing well, continue current academic plan'\n            when learning_trajectory = 'Stable Performance' and mastery_success_rate >= 60 then\n                'Consider academic enrichment activities'\n            when learning_trajectory = 'Declining Performance' or mastery_success_rate < 50 then\n                'Requires academic intervention and support'\n            else 'Monitor progress and provide targeted support'\n        end as learning_outcome_recommendation,\n        -- Student readiness for next level\n        case\n            when avg_advanced_performance >= 3.0 and mastery_success_rate >= 80 then 'Ready for Graduate Studies'\n            when avg_advanced_performance >= 2.5 and mastery_success_rate >= 70 then 'Ready for Senior Capstone'\n            when avg_intermediate_performance >= 2.5 and total_credits_earned >= 60 then 'Ready for Advanced Courses'\n            when avg_beginner_performance >= 2.0 and total_credits_earned >= 30 then 'Ready for Intermediate Courses'\n            else 'Continue Foundation Building'\n        end as academic_readiness_level\n    from learning_outcome_analysis loa\n    left join departmental_outcomes dept_out2 on loa.major = dept_out2.major\n)\n\nselect * from final_assessment\norder by overall_learning_growth desc, mastery_success_rate desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.budget_allocation_optimization": {"database": "postgres", "schema": "edu_dbt", "name": "budget_allocation_optimization", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/finance/budget_allocation_optimization.sql", "original_file_path": "models/marts/finance/budget_allocation_optimization.sql", "unique_id": "model.DbtEducationalDataProject.budget_allocation_optimization", "fqn": ["DbtEducationalDataProject", "marts", "finance", "budget_allocation_optimization"], "alias": "budget_allocation_optimization", "checksum": {"name": "sha256", "checksum": "b4e8fc1e61aeac966437bd9769e245d878ad6fe7ff81eab87a8c825e74375afe"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764373972.050409, "relation_name": "\"postgres\".\"edu_dbt\".\"budget_allocation_optimization\"", "raw_code": "{{ config(materialized='table') }}\n\nwith departmental_financial_data as (\n    select\n        d.department_id,\n        d.department_name,\n        d.department_code,\n        d.budget as allocated_budget,\n        d.budget_millions,\n        d.department_size,\n        count(distinct f.faculty_id) as faculty_count,\n        count(distinct s.student_id) as student_count,\n        count(distinct c.course_id) as course_offerings,\n        sum(f.salary) as total_faculty_salaries,\n        avg(f.salary) as avg_faculty_salary,\n        sum(tp.amount) as total_tuition_revenue,\n        sum(fa.amount) as total_aid_disbursed,\n        count(distinct e.enrollment_id) as total_enrollments,\n        avg(e.grade_points) as dept_avg_gpa,\n        count(case when s.student_status = 'graduated' then 1 end) as graduates_produced,\n        round(avg(e.attendance_percentage), 2) as dept_avg_attendance\n    from {{ ref('stg_departments') }} d\n    left join {{ ref('stg_faculty') }} f on d.department_id = f.department_id\n    left join {{ ref('stg_courses') }} c on d.department_id = c.department_id\n    left join {{ ref('stg_students') }} s on d.department_id = s.major_id\n    left join {{ ref('stg_enrollments') }} e on c.course_id = e.course_id and s.student_id = e.student_id\n    left join {{ ref('stg_tuition_payments') }} tp on s.student_id = tp.student_id\n    left join {{ ref('stg_financial_aid') }} fa on s.student_id = fa.student_id\n    group by \n        d.department_id, d.department_name, d.department_code, d.budget, \n        d.budget_millions, d.department_size\n),\n\ncost_benefit_analysis as (\n    select\n        dfd.*,\n        -- Cost efficiency metrics\n        round(allocated_budget / nullif(student_count, 0), 2) as cost_per_student,\n        round(allocated_budget / nullif(faculty_count, 0), 2) as cost_per_faculty,\n        round(allocated_budget / nullif(graduates_produced, 0), 2) as cost_per_graduate,\n        round(allocated_budget / nullif(total_enrollments, 0), 2) as cost_per_enrollment,\n        \n        -- Revenue efficiency metrics\n        round(total_tuition_revenue / nullif(allocated_budget, 0), 2) as revenue_to_budget_ratio,\n        round(total_tuition_revenue / nullif(student_count, 0), 2) as revenue_per_student,\n        round((total_tuition_revenue - total_aid_disbursed) / nullif(allocated_budget, 0), 2) as net_revenue_ratio,\n        \n        -- Academic output metrics\n        round(graduates_produced / nullif(allocated_budget, 0) * 100000, 2) as graduates_per_100k_budget,\n        round(dept_avg_gpa * total_enrollments / nullif(allocated_budget, 0) * 10000, 2) as quality_weighted_output,\n        \n        -- Resource utilization metrics\n        round(total_faculty_salaries / nullif(allocated_budget, 0) * 100, 2) as faculty_cost_percentage,\n        round(student_count / nullif(faculty_count, 0), 2) as student_faculty_ratio,\n        round(total_enrollments / nullif(course_offerings, 0), 2) as avg_class_size\n    from departmental_financial_data dfd\n),\n\nperformance_benchmarking as (\n    select\n        cba.*,\n        -- Percentile rankings for benchmarking\n        percent_rank() over (order by revenue_to_budget_ratio) as revenue_efficiency_percentile,\n        percent_rank() over (order by cost_per_graduate) as cost_effectiveness_percentile,\n        percent_rank() over (order by quality_weighted_output desc) as quality_output_percentile,\n        percent_rank() over (order by graduates_per_100k_budget desc) as graduate_productivity_percentile,\n        \n        -- Comparative analysis\n        avg(cost_per_student) over () as institutional_avg_cost_per_student,\n        avg(revenue_to_budget_ratio) over () as institutional_avg_revenue_ratio,\n        avg(dept_avg_gpa) over () as institutional_avg_gpa,\n        avg(student_faculty_ratio) over () as institutional_avg_ratio,\n        \n        -- Performance categories\n        case\n            when revenue_to_budget_ratio >= 1.5 then 'High Revenue Generator'\n            when revenue_to_budget_ratio >= 1.2 then 'Good Revenue Generator'\n            when revenue_to_budget_ratio >= 1.0 then 'Break-Even'\n            when revenue_to_budget_ratio >= 0.8 then 'Moderate Loss'\n            else 'High Loss'\n        end as revenue_performance_category,\n        \n        case\n            when cost_per_graduate <= 50000 then 'Highly Cost Effective'\n            when cost_per_graduate <= 100000 then 'Cost Effective'\n            when cost_per_graduate <= 200000 then 'Moderately Cost Effective'\n            else 'Costly'\n        end as cost_effectiveness_category,\n        \n        case\n            when quality_weighted_output >= 50 then 'High Quality Output'\n            when quality_weighted_output >= 30 then 'Good Quality Output'\n            when quality_weighted_output >= 20 then 'Adequate Quality Output'\n            else 'Low Quality Output'\n        end as quality_output_category\n    from cost_benefit_analysis cba\n),\n\noptimization_opportunities as (\n    select\n        pb.*,\n        -- Budget optimization score (0-100)\n        round(\n            (case when revenue_efficiency_percentile >= 0.8 then 25\n                  when revenue_efficiency_percentile >= 0.6 then 20\n                  when revenue_efficiency_percentile >= 0.4 then 15\n                  else 10 end) +\n            (case when cost_effectiveness_percentile >= 0.8 then 25\n                  when cost_effectiveness_percentile >= 0.6 then 20\n                  when cost_effectiveness_percentile >= 0.4 then 15\n                  else 10 end) +\n            (case when quality_output_percentile >= 0.8 then 25\n                  when quality_output_percentile >= 0.6 then 20\n                  when quality_output_percentile >= 0.4 then 15\n                  else 10 end) +\n            (case when graduate_productivity_percentile >= 0.8 then 25\n                  when graduate_productivity_percentile >= 0.6 then 20\n                  when graduate_productivity_percentile >= 0.4 then 15\n                  else 10 end), 0\n        ) as budget_optimization_score,\n        \n        -- Specific optimization recommendations\n        case\n            when revenue_to_budget_ratio < 0.8 and student_faculty_ratio < 15 then 'Increase class sizes or reduce faculty'\n            when revenue_to_budget_ratio < 0.8 and course_offerings > student_count * 0.8 then 'Consolidate course offerings'\n            when cost_per_graduate > 150000 and dept_avg_gpa < 3.0 then 'Improve academic support for better retention'\n            when faculty_cost_percentage > 80 then 'Review faculty compensation structure'\n            when student_count < 100 and allocated_budget > 1000000 then 'Consider program consolidation or growth'\n            when revenue_to_budget_ratio > 1.5 and quality_weighted_output > 50 then 'Model department - consider expansion'\n            else 'Minor optimizations recommended'\n        end as primary_optimization_recommendation,\n        \n        -- Budget reallocation suggestions\n        case\n            when revenue_performance_category = 'High Revenue Generator' and cost_effectiveness_category = 'Highly Cost Effective' then\n                'Increase budget allocation for expansion'\n            when revenue_performance_category in ('Moderate Loss', 'High Loss') and cost_effectiveness_category = 'Costly' then\n                'Reduce budget allocation and restructure'\n            when quality_output_category = 'Low Quality Output' then\n                'Reallocate funds to academic support and faculty development'\n            when student_faculty_ratio > institutional_avg_ratio * 1.5 then\n                'Allocate additional faculty positions'\n            else 'Maintain current allocation with efficiency improvements'\n        end as budget_reallocation_suggestion\n    from performance_benchmarking pb\n),\n\nbudget_adjustments as (\n    select\n        oo.*,\n        -- Estimated budget adjustment\n        case\n            when oo.budget_optimization_score >= 80 then round(oo.allocated_budget * 1.1, 0)  -- 10% increase\n            when oo.budget_optimization_score >= 60 then oo.allocated_budget  -- No change\n            when oo.budget_optimization_score >= 40 then round(oo.allocated_budget * 0.95, 0)  -- 5% decrease\n            else round(oo.allocated_budget * 0.85, 0)  -- 15% decrease\n        end as suggested_budget_allocation\n    from optimization_opportunities oo\n),\n\nportfolio_optimization as (\n    select\n        ba.*,\n        ba.suggested_budget_allocation - ba.allocated_budget as budget_change_amount,\n        round(\n            (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100, 2\n        ) as budget_change_percentage,\n        \n        -- Portfolio impact analysis\n        sum(ba.suggested_budget_allocation) over () as total_suggested_budget,\n        sum(ba.allocated_budget) over () as total_current_budget,\n        round(\n            (sum(ba.suggested_budget_allocation) over () - sum(ba.allocated_budget) over ()) /\n            nullif(sum(ba.allocated_budget) over (), 0) * 100, 2\n        ) as institutional_budget_change_percentage,\n\n        -- ROI projections\n        case\n            when (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100 > 0 then\n                round(ba.graduates_per_100k_budget * 1.1, 2)  -- Projected 10% improvement\n            when (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100 = 0 then\n                ba.graduates_per_100k_budget\n            else\n                round(ba.graduates_per_100k_budget * 0.9, 2)  -- Potential 10% decline\n        end as projected_graduate_productivity,\n\n        case\n            when (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100 > 0 then\n                round(ba.revenue_to_budget_ratio * 1.05, 2)  -- Projected 5% improvement\n            when (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100 = 0 then\n                ba.revenue_to_budget_ratio\n            else\n                round(ba.revenue_to_budget_ratio * 1.02, 2)  -- Small improvement from efficiency\n        end as projected_revenue_ratio,\n\n        -- Strategic priority classification\n        case\n            when ba.revenue_performance_category = 'High Revenue Generator' and ba.quality_output_category = 'High Quality Output' then 'Strategic Growth Investment'\n            when ba.revenue_performance_category in ('Moderate Loss', 'High Loss') and ba.cost_effectiveness_category = 'Costly' then 'Restructuring Priority'\n            when ba.quality_output_category = 'Low Quality Output' and ba.student_count > 200 then 'Quality Improvement Priority'\n            when ba.student_count < 50 and ba.revenue_performance_category != 'High Revenue Generator' then 'Viability Assessment Required'\n            else 'Efficiency Optimization'\n        end as strategic_priority\n    from budget_adjustments ba\n)\n\nselect * from portfolio_optimization\norder by budget_optimization_score desc, strategic_priority", "language": "sql", "refs": [{"name": "stg_departments", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_tuition_payments", "package": null, "version": null}, {"name": "stg_financial_aid", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_tuition_payments", "model.DbtEducationalDataProject.stg_financial_aid"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/finance/budget_allocation_optimization.sql", "compiled": true, "compiled_code": "\n\nwith departmental_financial_data as (\n    select\n        d.department_id,\n        d.department_name,\n        d.department_code,\n        d.budget as allocated_budget,\n        d.budget_millions,\n        d.department_size,\n        count(distinct f.faculty_id) as faculty_count,\n        count(distinct s.student_id) as student_count,\n        count(distinct c.course_id) as course_offerings,\n        sum(f.salary) as total_faculty_salaries,\n        avg(f.salary) as avg_faculty_salary,\n        sum(tp.amount) as total_tuition_revenue,\n        sum(fa.amount) as total_aid_disbursed,\n        count(distinct e.enrollment_id) as total_enrollments,\n        avg(e.grade_points) as dept_avg_gpa,\n        count(case when s.student_status = 'graduated' then 1 end) as graduates_produced,\n        round(avg(e.attendance_percentage), 2) as dept_avg_attendance\n    from \"postgres\".\"edu_dbt\".\"stg_departments\" d\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on d.department_id = f.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on d.department_id = c.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on d.department_id = s.major_id\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on c.course_id = e.course_id and s.student_id = e.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_tuition_payments\" tp on s.student_id = tp.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_financial_aid\" fa on s.student_id = fa.student_id\n    group by \n        d.department_id, d.department_name, d.department_code, d.budget, \n        d.budget_millions, d.department_size\n),\n\ncost_benefit_analysis as (\n    select\n        dfd.*,\n        -- Cost efficiency metrics\n        round(allocated_budget / nullif(student_count, 0), 2) as cost_per_student,\n        round(allocated_budget / nullif(faculty_count, 0), 2) as cost_per_faculty,\n        round(allocated_budget / nullif(graduates_produced, 0), 2) as cost_per_graduate,\n        round(allocated_budget / nullif(total_enrollments, 0), 2) as cost_per_enrollment,\n        \n        -- Revenue efficiency metrics\n        round(total_tuition_revenue / nullif(allocated_budget, 0), 2) as revenue_to_budget_ratio,\n        round(total_tuition_revenue / nullif(student_count, 0), 2) as revenue_per_student,\n        round((total_tuition_revenue - total_aid_disbursed) / nullif(allocated_budget, 0), 2) as net_revenue_ratio,\n        \n        -- Academic output metrics\n        round(graduates_produced / nullif(allocated_budget, 0) * 100000, 2) as graduates_per_100k_budget,\n        round(dept_avg_gpa * total_enrollments / nullif(allocated_budget, 0) * 10000, 2) as quality_weighted_output,\n        \n        -- Resource utilization metrics\n        round(total_faculty_salaries / nullif(allocated_budget, 0) * 100, 2) as faculty_cost_percentage,\n        round(student_count / nullif(faculty_count, 0), 2) as student_faculty_ratio,\n        round(total_enrollments / nullif(course_offerings, 0), 2) as avg_class_size\n    from departmental_financial_data dfd\n),\n\nperformance_benchmarking as (\n    select\n        cba.*,\n        -- Percentile rankings for benchmarking\n        percent_rank() over (order by revenue_to_budget_ratio) as revenue_efficiency_percentile,\n        percent_rank() over (order by cost_per_graduate) as cost_effectiveness_percentile,\n        percent_rank() over (order by quality_weighted_output desc) as quality_output_percentile,\n        percent_rank() over (order by graduates_per_100k_budget desc) as graduate_productivity_percentile,\n        \n        -- Comparative analysis\n        avg(cost_per_student) over () as institutional_avg_cost_per_student,\n        avg(revenue_to_budget_ratio) over () as institutional_avg_revenue_ratio,\n        avg(dept_avg_gpa) over () as institutional_avg_gpa,\n        avg(student_faculty_ratio) over () as institutional_avg_ratio,\n        \n        -- Performance categories\n        case\n            when revenue_to_budget_ratio >= 1.5 then 'High Revenue Generator'\n            when revenue_to_budget_ratio >= 1.2 then 'Good Revenue Generator'\n            when revenue_to_budget_ratio >= 1.0 then 'Break-Even'\n            when revenue_to_budget_ratio >= 0.8 then 'Moderate Loss'\n            else 'High Loss'\n        end as revenue_performance_category,\n        \n        case\n            when cost_per_graduate <= 50000 then 'Highly Cost Effective'\n            when cost_per_graduate <= 100000 then 'Cost Effective'\n            when cost_per_graduate <= 200000 then 'Moderately Cost Effective'\n            else 'Costly'\n        end as cost_effectiveness_category,\n        \n        case\n            when quality_weighted_output >= 50 then 'High Quality Output'\n            when quality_weighted_output >= 30 then 'Good Quality Output'\n            when quality_weighted_output >= 20 then 'Adequate Quality Output'\n            else 'Low Quality Output'\n        end as quality_output_category\n    from cost_benefit_analysis cba\n),\n\noptimization_opportunities as (\n    select\n        pb.*,\n        -- Budget optimization score (0-100)\n        round(\n            (case when revenue_efficiency_percentile >= 0.8 then 25\n                  when revenue_efficiency_percentile >= 0.6 then 20\n                  when revenue_efficiency_percentile >= 0.4 then 15\n                  else 10 end) +\n            (case when cost_effectiveness_percentile >= 0.8 then 25\n                  when cost_effectiveness_percentile >= 0.6 then 20\n                  when cost_effectiveness_percentile >= 0.4 then 15\n                  else 10 end) +\n            (case when quality_output_percentile >= 0.8 then 25\n                  when quality_output_percentile >= 0.6 then 20\n                  when quality_output_percentile >= 0.4 then 15\n                  else 10 end) +\n            (case when graduate_productivity_percentile >= 0.8 then 25\n                  when graduate_productivity_percentile >= 0.6 then 20\n                  when graduate_productivity_percentile >= 0.4 then 15\n                  else 10 end), 0\n        ) as budget_optimization_score,\n        \n        -- Specific optimization recommendations\n        case\n            when revenue_to_budget_ratio < 0.8 and student_faculty_ratio < 15 then 'Increase class sizes or reduce faculty'\n            when revenue_to_budget_ratio < 0.8 and course_offerings > student_count * 0.8 then 'Consolidate course offerings'\n            when cost_per_graduate > 150000 and dept_avg_gpa < 3.0 then 'Improve academic support for better retention'\n            when faculty_cost_percentage > 80 then 'Review faculty compensation structure'\n            when student_count < 100 and allocated_budget > 1000000 then 'Consider program consolidation or growth'\n            when revenue_to_budget_ratio > 1.5 and quality_weighted_output > 50 then 'Model department - consider expansion'\n            else 'Minor optimizations recommended'\n        end as primary_optimization_recommendation,\n        \n        -- Budget reallocation suggestions\n        case\n            when revenue_performance_category = 'High Revenue Generator' and cost_effectiveness_category = 'Highly Cost Effective' then\n                'Increase budget allocation for expansion'\n            when revenue_performance_category in ('Moderate Loss', 'High Loss') and cost_effectiveness_category = 'Costly' then\n                'Reduce budget allocation and restructure'\n            when quality_output_category = 'Low Quality Output' then\n                'Reallocate funds to academic support and faculty development'\n            when student_faculty_ratio > institutional_avg_ratio * 1.5 then\n                'Allocate additional faculty positions'\n            else 'Maintain current allocation with efficiency improvements'\n        end as budget_reallocation_suggestion\n    from performance_benchmarking pb\n),\n\nbudget_adjustments as (\n    select\n        oo.*,\n        -- Estimated budget adjustment\n        case\n            when oo.budget_optimization_score >= 80 then round(oo.allocated_budget * 1.1, 0)  -- 10% increase\n            when oo.budget_optimization_score >= 60 then oo.allocated_budget  -- No change\n            when oo.budget_optimization_score >= 40 then round(oo.allocated_budget * 0.95, 0)  -- 5% decrease\n            else round(oo.allocated_budget * 0.85, 0)  -- 15% decrease\n        end as suggested_budget_allocation\n    from optimization_opportunities oo\n),\n\nportfolio_optimization as (\n    select\n        ba.*,\n        ba.suggested_budget_allocation - ba.allocated_budget as budget_change_amount,\n        round(\n            (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100, 2\n        ) as budget_change_percentage,\n        \n        -- Portfolio impact analysis\n        sum(ba.suggested_budget_allocation) over () as total_suggested_budget,\n        sum(ba.allocated_budget) over () as total_current_budget,\n        round(\n            (sum(ba.suggested_budget_allocation) over () - sum(ba.allocated_budget) over ()) /\n            nullif(sum(ba.allocated_budget) over (), 0) * 100, 2\n        ) as institutional_budget_change_percentage,\n\n        -- ROI projections\n        case\n            when (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100 > 0 then\n                round(ba.graduates_per_100k_budget * 1.1, 2)  -- Projected 10% improvement\n            when (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100 = 0 then\n                ba.graduates_per_100k_budget\n            else\n                round(ba.graduates_per_100k_budget * 0.9, 2)  -- Potential 10% decline\n        end as projected_graduate_productivity,\n\n        case\n            when (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100 > 0 then\n                round(ba.revenue_to_budget_ratio * 1.05, 2)  -- Projected 5% improvement\n            when (ba.suggested_budget_allocation - ba.allocated_budget) / nullif(ba.allocated_budget, 0) * 100 = 0 then\n                ba.revenue_to_budget_ratio\n            else\n                round(ba.revenue_to_budget_ratio * 1.02, 2)  -- Small improvement from efficiency\n        end as projected_revenue_ratio,\n\n        -- Strategic priority classification\n        case\n            when ba.revenue_performance_category = 'High Revenue Generator' and ba.quality_output_category = 'High Quality Output' then 'Strategic Growth Investment'\n            when ba.revenue_performance_category in ('Moderate Loss', 'High Loss') and ba.cost_effectiveness_category = 'Costly' then 'Restructuring Priority'\n            when ba.quality_output_category = 'Low Quality Output' and ba.student_count > 200 then 'Quality Improvement Priority'\n            when ba.student_count < 50 and ba.revenue_performance_category != 'High Revenue Generator' then 'Viability Assessment Required'\n            else 'Efficiency Optimization'\n        end as strategic_priority\n    from budget_adjustments ba\n)\n\nselect * from portfolio_optimization\norder by budget_optimization_score desc, strategic_priority", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.competitive_program_benchmarking": {"database": "postgres", "schema": "edu_dbt", "name": "competitive_program_benchmarking", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/academic/competitive_program_benchmarking.sql", "original_file_path": "models/marts/academic/competitive_program_benchmarking.sql", "unique_id": "model.DbtEducationalDataProject.competitive_program_benchmarking", "fqn": ["DbtEducationalDataProject", "marts", "academic", "competitive_program_benchmarking"], "alias": "competitive_program_benchmarking", "checksum": {"name": "sha256", "checksum": "6ff1478a96da49a675524a63ac39ee4759a572b1344455dae9a10a4ccb17a296"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764374187.927481, "relation_name": "\"postgres\".\"edu_dbt\".\"competitive_program_benchmarking\"", "raw_code": "{{ config(materialized='table') }}\n\nwith program_performance_metrics as (\n    select\n        d.department_name as program_name,\n        d.department_code,\n        d.budget,\n        d.department_size,\n        count(distinct s.student_id) as total_students,\n        count(distinct f.faculty_id) as faculty_count,\n        count(distinct c.course_id) as course_offerings,\n        avg(s.gpa) as program_avg_gpa,\n        count(case when s.student_status = 'graduated' then 1 end) as graduates,\n        count(case when s.academic_standing = 'Deans List' then 1 end) as honors_students,\n        avg(e.attendance_percentage) as avg_student_engagement,\n        round(\n            count(case when s.student_status = 'graduated' then 1 end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as graduation_rate,\n        round(\n            count(case when s.academic_standing = 'Deans List' then 1 end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as honors_percentage,\n        round(\n            count(case when s.student_status = 'dropped' then 1 end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as dropout_rate\n    from {{ ref('stg_departments') }} d\n    left join {{ ref('stg_students') }} s on d.department_id = s.major_id\n    left join {{ ref('stg_faculty') }} f on d.department_id = f.department_id\n    left join {{ ref('stg_courses') }} c on d.department_id = c.department_id\n    left join {{ ref('stg_enrollments') }} e on s.student_id = e.student_id and c.course_id = e.course_id\n    group by d.department_name, d.department_code, d.budget, d.department_size\n),\n\nfinancial_performance_metrics as (\n    select\n        d.department_name,\n        sum(tp.amount) as total_revenue,\n        sum(fa.amount) as aid_disbursed,\n        sum(f.salary) as faculty_costs,\n        round(sum(tp.amount) / nullif(count(distinct s.student_id), 0), 2) as revenue_per_student,\n        round(d.budget / nullif(count(distinct s.student_id), 0), 2) as cost_per_student,\n        round(sum(tp.amount) / nullif(d.budget, 0), 2) as revenue_efficiency_ratio,\n        round(sum(f.salary) / nullif(d.budget, 0) * 100, 2) as faculty_cost_ratio\n    from {{ ref('stg_departments') }} d\n    left join {{ ref('stg_students') }} s on d.department_id = s.major_id\n    left join {{ ref('stg_tuition_payments') }} tp on s.student_id = tp.student_id\n    left join {{ ref('stg_financial_aid') }} fa on s.student_id = fa.student_id\n    left join {{ ref('stg_faculty') }} f on d.department_id = f.department_id\n    group by d.department_name, d.budget\n),\n\nfaculty_quality_metrics as (\n    select\n        d.department_name,\n        avg(f.years_of_service) as avg_faculty_experience,\n        count(case when f.position = 'Professor' then 1 end) as senior_faculty_count,\n        round(\n            count(case when f.position = 'Professor' then 1 end) * 100.0 / \n            nullif(count(distinct f.faculty_id), 0), 2\n        ) as senior_faculty_percentage,\n        avg(f.salary) as avg_faculty_compensation,\n        round(count(distinct s.student_id) / nullif(count(distinct f.faculty_id), 0), 2) as student_faculty_ratio\n    from {{ ref('stg_departments') }} d\n    left join {{ ref('stg_faculty') }} f on d.department_id = f.department_id\n    left join {{ ref('stg_students') }} s on d.department_id = s.major_id\n    group by d.department_name\n),\n\ncourse_quality_metrics as (\n    select\n        d.department_name,\n        avg(c.difficulty_level) as avg_course_rigor,\n        count(case when c.difficulty_level >= 4 then 1 end) as advanced_courses,\n        round(\n            count(case when c.difficulty_level >= 4 then 1 end) * 100.0 / \n            nullif(count(distinct c.course_id), 0), 2\n        ) as advanced_course_percentage,\n        avg(cpm.pass_rate) as avg_course_success_rate,\n        avg(cpm.avg_grade_points) as avg_course_gpa\n    from {{ ref('stg_departments') }} d\n    left join {{ ref('stg_courses') }} c on d.department_id = c.department_id\n    left join {{ ref('int_course_performance_metrics') }} cpm on c.course_id = cpm.course_id\n    group by d.department_name\n),\n\ncompetitive_analysis as (\n    select\n        ppm.program_name,\n        ppm.department_code,\n        ppm.total_students,\n        ppm.faculty_count,\n        ppm.course_offerings,\n        ppm.program_avg_gpa,\n        ppm.graduation_rate,\n        ppm.honors_percentage,\n        ppm.dropout_rate,\n        fpm.revenue_per_student,\n        fpm.cost_per_student,\n        fpm.revenue_efficiency_ratio,\n        fpm.faculty_cost_ratio,\n        fqm.avg_faculty_experience,\n        fqm.senior_faculty_percentage,\n        fqm.avg_faculty_compensation,\n        fqm.student_faculty_ratio,\n        cqm.avg_course_rigor,\n        cqm.advanced_course_percentage,\n        cqm.avg_course_success_rate,\n        cqm.avg_course_gpa,\n        \n        -- Competitive positioning scores (0-100 each)\n        round(\n            (case when ppm.graduation_rate >= 90 then 25\n                  when ppm.graduation_rate >= 80 then 20\n                  when ppm.graduation_rate >= 70 then 15\n                  else 10 end) +\n            (case when ppm.honors_percentage >= 15 then 25\n                  when ppm.honors_percentage >= 10 then 20\n                  when ppm.honors_percentage >= 5 then 15\n                  else 10 end) +\n            (case when ppm.program_avg_gpa >= 3.5 then 25\n                  when ppm.program_avg_gpa >= 3.0 then 20\n                  when ppm.program_avg_gpa >= 2.5 then 15\n                  else 10 end) +\n            (case when ppm.dropout_rate <= 5 then 25\n                  when ppm.dropout_rate <= 10 then 20\n                  when ppm.dropout_rate <= 15 then 15\n                  else 10 end), 0\n        ) as academic_excellence_score,\n        \n        round(\n            (case when fpm.revenue_efficiency_ratio >= 1.5 then 30\n                  when fpm.revenue_efficiency_ratio >= 1.2 then 25\n                  when fpm.revenue_efficiency_ratio >= 1.0 then 20\n                  else 10 end) +\n            (case when fpm.cost_per_student <= 5000 then 35\n                  when fpm.cost_per_student <= 8000 then 25\n                  when fpm.cost_per_student <= 12000 then 15\n                  else 5 end) +\n            (case when fpm.faculty_cost_ratio <= 60 then 35\n                  when fpm.faculty_cost_ratio <= 75 then 25\n                  when fpm.faculty_cost_ratio <= 85 then 15\n                  else 5 end), 0\n        ) as financial_efficiency_score,\n        \n        round(\n            (case when fqm.senior_faculty_percentage >= 40 then 30\n                  when fqm.senior_faculty_percentage >= 30 then 25\n                  when fqm.senior_faculty_percentage >= 20 then 20\n                  else 15 end) +\n            (case when fqm.avg_faculty_experience >= 15 then 25\n                  when fqm.avg_faculty_experience >= 10 then 20\n                  when fqm.avg_faculty_experience >= 7 then 15\n                  else 10 end) +\n            (case when fqm.student_faculty_ratio between 15 and 25 then 25\n                  when fqm.student_faculty_ratio between 10 and 30 then 20\n                  when fqm.student_faculty_ratio between 8 and 35 then 15\n                  else 10 end) +\n            (case when cqm.advanced_course_percentage >= 30 then 20\n                  when cqm.advanced_course_percentage >= 20 then 15\n                  when cqm.advanced_course_percentage >= 10 then 10\n                  else 5 end), 0\n        ) as program_quality_score\n    from program_performance_metrics ppm\n    left join financial_performance_metrics fpm on ppm.program_name = fpm.department_name\n    left join faculty_quality_metrics fqm on ppm.program_name = fqm.department_name\n    left join course_quality_metrics cqm on ppm.program_name = cqm.department_name\n),\n\nbenchmarking_analysis as (\n    select\n        ca.*,\n        (academic_excellence_score + financial_efficiency_score + program_quality_score) / 3 as overall_competitiveness_score,\n        \n        -- Rankings within institution\n        row_number() over (order by academic_excellence_score desc) as academic_excellence_rank,\n        row_number() over (order by financial_efficiency_score desc) as financial_efficiency_rank,\n        row_number() over (order by program_quality_score desc) as program_quality_rank,\n        row_number() over (order by (academic_excellence_score + financial_efficiency_score + program_quality_score) desc) as overall_competitiveness_rank,\n        \n        -- Percentile rankings\n        percent_rank() over (order by graduation_rate) as graduation_rate_percentile,\n        percent_rank() over (order by revenue_efficiency_ratio) as revenue_efficiency_percentile,\n        percent_rank() over (order by program_avg_gpa) as gpa_percentile,\n        percent_rank() over (order by senior_faculty_percentage) as faculty_quality_percentile,\n        \n        -- Institutional averages for comparison\n        avg(graduation_rate) over () as institutional_avg_graduation_rate,\n        avg(program_avg_gpa) over () as institutional_avg_gpa,\n        avg(revenue_efficiency_ratio) over () as institutional_avg_revenue_efficiency,\n        avg(senior_faculty_percentage) over () as institutional_avg_senior_faculty\n    from competitive_analysis ca\n),\n\nstrategic_positioning as (\n    select\n        ba.*,\n        case\n            when overall_competitiveness_score >= 80 then 'Market Leader'\n            when overall_competitiveness_score >= 65 then 'Strong Competitor'\n            when overall_competitiveness_score >= 50 then 'Average Performer'\n            when overall_competitiveness_score >= 35 then 'Below Average'\n            else 'Needs Significant Improvement'\n        end as competitive_position,\n\n        case\n            when academic_excellence_score > program_quality_score and academic_excellence_score > financial_efficiency_score then 'Academic Excellence Focus'\n            when financial_efficiency_score > program_quality_score then 'Cost Leadership Focus'\n            when program_quality_score > financial_efficiency_score then 'Quality Differentiation Focus'\n            else 'Balanced Approach'\n        end as strategic_strength,\n\n        case\n            when academic_excellence_score < 40 then 'Improve academic outcomes and retention'\n            when financial_efficiency_score < 40 then 'Optimize costs and improve revenue generation'\n            when program_quality_score < 40 then 'Enhance faculty quality and curriculum rigor'\n            when overall_competitiveness_rank > count(*) over () * 0.75 then 'Focus on core competency development'\n            else 'Maintain competitive advantage and explore growth'\n        end as strategic_recommendation,\n\n        case\n            when graduation_rate > institutional_avg_graduation_rate * 1.2 and\n                 program_avg_gpa > institutional_avg_gpa * 1.1 then 'Flagship Program'\n            when revenue_efficiency_ratio > institutional_avg_revenue_efficiency * 1.3 then 'High Value Program'\n            when senior_faculty_percentage > institutional_avg_senior_faculty * 1.5 then 'Premium Quality Program'\n            when graduation_rate < institutional_avg_graduation_rate * 0.8 then 'At-Risk Program'\n            else 'Standard Program'\n        end as program_classification\n    from benchmarking_analysis ba\n),\n\ninvestment_priorities as (\n    select\n        sp.*,\n        -- Investment priority\n        case\n            when sp.competitive_position = 'Market Leader' and sp.program_classification = 'Flagship Program' then 'High Growth Investment'\n            when sp.competitive_position = 'Strong Competitor' and sp.financial_efficiency_score >= 70 then 'Expansion Investment'\n            when sp.competitive_position in ('Average Performer', 'Below Average') and sp.program_classification != 'At-Risk Program' then 'Improvement Investment'\n            when sp.competitive_position = 'Needs Significant Improvement' or sp.program_classification = 'At-Risk Program' then 'Restructuring Required'\n            else 'Maintenance Investment'\n        end as investment_priority\n    from strategic_positioning sp\n)\n\nselect * from investment_priorities\norder by overall_competitiveness_score desc", "language": "sql", "refs": [{"name": "stg_departments", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_tuition_payments", "package": null, "version": null}, {"name": "stg_financial_aid", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "int_course_performance_metrics", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_tuition_payments", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.int_course_performance_metrics"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/academic/competitive_program_benchmarking.sql", "compiled": true, "compiled_code": "\n\nwith program_performance_metrics as (\n    select\n        d.department_name as program_name,\n        d.department_code,\n        d.budget,\n        d.department_size,\n        count(distinct s.student_id) as total_students,\n        count(distinct f.faculty_id) as faculty_count,\n        count(distinct c.course_id) as course_offerings,\n        avg(s.gpa) as program_avg_gpa,\n        count(case when s.student_status = 'graduated' then 1 end) as graduates,\n        count(case when s.academic_standing = 'Deans List' then 1 end) as honors_students,\n        avg(e.attendance_percentage) as avg_student_engagement,\n        round(\n            count(case when s.student_status = 'graduated' then 1 end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as graduation_rate,\n        round(\n            count(case when s.academic_standing = 'Deans List' then 1 end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as honors_percentage,\n        round(\n            count(case when s.student_status = 'dropped' then 1 end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as dropout_rate\n    from \"postgres\".\"edu_dbt\".\"stg_departments\" d\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on d.department_id = s.major_id\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on d.department_id = f.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on d.department_id = c.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on s.student_id = e.student_id and c.course_id = e.course_id\n    group by d.department_name, d.department_code, d.budget, d.department_size\n),\n\nfinancial_performance_metrics as (\n    select\n        d.department_name,\n        sum(tp.amount) as total_revenue,\n        sum(fa.amount) as aid_disbursed,\n        sum(f.salary) as faculty_costs,\n        round(sum(tp.amount) / nullif(count(distinct s.student_id), 0), 2) as revenue_per_student,\n        round(d.budget / nullif(count(distinct s.student_id), 0), 2) as cost_per_student,\n        round(sum(tp.amount) / nullif(d.budget, 0), 2) as revenue_efficiency_ratio,\n        round(sum(f.salary) / nullif(d.budget, 0) * 100, 2) as faculty_cost_ratio\n    from \"postgres\".\"edu_dbt\".\"stg_departments\" d\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on d.department_id = s.major_id\n    left join \"postgres\".\"edu_dbt\".\"stg_tuition_payments\" tp on s.student_id = tp.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_financial_aid\" fa on s.student_id = fa.student_id\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on d.department_id = f.department_id\n    group by d.department_name, d.budget\n),\n\nfaculty_quality_metrics as (\n    select\n        d.department_name,\n        avg(f.years_of_service) as avg_faculty_experience,\n        count(case when f.position = 'Professor' then 1 end) as senior_faculty_count,\n        round(\n            count(case when f.position = 'Professor' then 1 end) * 100.0 / \n            nullif(count(distinct f.faculty_id), 0), 2\n        ) as senior_faculty_percentage,\n        avg(f.salary) as avg_faculty_compensation,\n        round(count(distinct s.student_id) / nullif(count(distinct f.faculty_id), 0), 2) as student_faculty_ratio\n    from \"postgres\".\"edu_dbt\".\"stg_departments\" d\n    left join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on d.department_id = f.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on d.department_id = s.major_id\n    group by d.department_name\n),\n\ncourse_quality_metrics as (\n    select\n        d.department_name,\n        avg(c.difficulty_level) as avg_course_rigor,\n        count(case when c.difficulty_level >= 4 then 1 end) as advanced_courses,\n        round(\n            count(case when c.difficulty_level >= 4 then 1 end) * 100.0 / \n            nullif(count(distinct c.course_id), 0), 2\n        ) as advanced_course_percentage,\n        avg(cpm.pass_rate) as avg_course_success_rate,\n        avg(cpm.avg_grade_points) as avg_course_gpa\n    from \"postgres\".\"edu_dbt\".\"stg_departments\" d\n    left join \"postgres\".\"edu_dbt\".\"stg_courses\" c on d.department_id = c.department_id\n    left join \"postgres\".\"edu_dbt\".\"int_course_performance_metrics\" cpm on c.course_id = cpm.course_id\n    group by d.department_name\n),\n\ncompetitive_analysis as (\n    select\n        ppm.program_name,\n        ppm.department_code,\n        ppm.total_students,\n        ppm.faculty_count,\n        ppm.course_offerings,\n        ppm.program_avg_gpa,\n        ppm.graduation_rate,\n        ppm.honors_percentage,\n        ppm.dropout_rate,\n        fpm.revenue_per_student,\n        fpm.cost_per_student,\n        fpm.revenue_efficiency_ratio,\n        fpm.faculty_cost_ratio,\n        fqm.avg_faculty_experience,\n        fqm.senior_faculty_percentage,\n        fqm.avg_faculty_compensation,\n        fqm.student_faculty_ratio,\n        cqm.avg_course_rigor,\n        cqm.advanced_course_percentage,\n        cqm.avg_course_success_rate,\n        cqm.avg_course_gpa,\n        \n        -- Competitive positioning scores (0-100 each)\n        round(\n            (case when ppm.graduation_rate >= 90 then 25\n                  when ppm.graduation_rate >= 80 then 20\n                  when ppm.graduation_rate >= 70 then 15\n                  else 10 end) +\n            (case when ppm.honors_percentage >= 15 then 25\n                  when ppm.honors_percentage >= 10 then 20\n                  when ppm.honors_percentage >= 5 then 15\n                  else 10 end) +\n            (case when ppm.program_avg_gpa >= 3.5 then 25\n                  when ppm.program_avg_gpa >= 3.0 then 20\n                  when ppm.program_avg_gpa >= 2.5 then 15\n                  else 10 end) +\n            (case when ppm.dropout_rate <= 5 then 25\n                  when ppm.dropout_rate <= 10 then 20\n                  when ppm.dropout_rate <= 15 then 15\n                  else 10 end), 0\n        ) as academic_excellence_score,\n        \n        round(\n            (case when fpm.revenue_efficiency_ratio >= 1.5 then 30\n                  when fpm.revenue_efficiency_ratio >= 1.2 then 25\n                  when fpm.revenue_efficiency_ratio >= 1.0 then 20\n                  else 10 end) +\n            (case when fpm.cost_per_student <= 5000 then 35\n                  when fpm.cost_per_student <= 8000 then 25\n                  when fpm.cost_per_student <= 12000 then 15\n                  else 5 end) +\n            (case when fpm.faculty_cost_ratio <= 60 then 35\n                  when fpm.faculty_cost_ratio <= 75 then 25\n                  when fpm.faculty_cost_ratio <= 85 then 15\n                  else 5 end), 0\n        ) as financial_efficiency_score,\n        \n        round(\n            (case when fqm.senior_faculty_percentage >= 40 then 30\n                  when fqm.senior_faculty_percentage >= 30 then 25\n                  when fqm.senior_faculty_percentage >= 20 then 20\n                  else 15 end) +\n            (case when fqm.avg_faculty_experience >= 15 then 25\n                  when fqm.avg_faculty_experience >= 10 then 20\n                  when fqm.avg_faculty_experience >= 7 then 15\n                  else 10 end) +\n            (case when fqm.student_faculty_ratio between 15 and 25 then 25\n                  when fqm.student_faculty_ratio between 10 and 30 then 20\n                  when fqm.student_faculty_ratio between 8 and 35 then 15\n                  else 10 end) +\n            (case when cqm.advanced_course_percentage >= 30 then 20\n                  when cqm.advanced_course_percentage >= 20 then 15\n                  when cqm.advanced_course_percentage >= 10 then 10\n                  else 5 end), 0\n        ) as program_quality_score\n    from program_performance_metrics ppm\n    left join financial_performance_metrics fpm on ppm.program_name = fpm.department_name\n    left join faculty_quality_metrics fqm on ppm.program_name = fqm.department_name\n    left join course_quality_metrics cqm on ppm.program_name = cqm.department_name\n),\n\nbenchmarking_analysis as (\n    select\n        ca.*,\n        (academic_excellence_score + financial_efficiency_score + program_quality_score) / 3 as overall_competitiveness_score,\n        \n        -- Rankings within institution\n        row_number() over (order by academic_excellence_score desc) as academic_excellence_rank,\n        row_number() over (order by financial_efficiency_score desc) as financial_efficiency_rank,\n        row_number() over (order by program_quality_score desc) as program_quality_rank,\n        row_number() over (order by (academic_excellence_score + financial_efficiency_score + program_quality_score) desc) as overall_competitiveness_rank,\n        \n        -- Percentile rankings\n        percent_rank() over (order by graduation_rate) as graduation_rate_percentile,\n        percent_rank() over (order by revenue_efficiency_ratio) as revenue_efficiency_percentile,\n        percent_rank() over (order by program_avg_gpa) as gpa_percentile,\n        percent_rank() over (order by senior_faculty_percentage) as faculty_quality_percentile,\n        \n        -- Institutional averages for comparison\n        avg(graduation_rate) over () as institutional_avg_graduation_rate,\n        avg(program_avg_gpa) over () as institutional_avg_gpa,\n        avg(revenue_efficiency_ratio) over () as institutional_avg_revenue_efficiency,\n        avg(senior_faculty_percentage) over () as institutional_avg_senior_faculty\n    from competitive_analysis ca\n),\n\nstrategic_positioning as (\n    select\n        ba.*,\n        case\n            when overall_competitiveness_score >= 80 then 'Market Leader'\n            when overall_competitiveness_score >= 65 then 'Strong Competitor'\n            when overall_competitiveness_score >= 50 then 'Average Performer'\n            when overall_competitiveness_score >= 35 then 'Below Average'\n            else 'Needs Significant Improvement'\n        end as competitive_position,\n\n        case\n            when academic_excellence_score > program_quality_score and academic_excellence_score > financial_efficiency_score then 'Academic Excellence Focus'\n            when financial_efficiency_score > program_quality_score then 'Cost Leadership Focus'\n            when program_quality_score > financial_efficiency_score then 'Quality Differentiation Focus'\n            else 'Balanced Approach'\n        end as strategic_strength,\n\n        case\n            when academic_excellence_score < 40 then 'Improve academic outcomes and retention'\n            when financial_efficiency_score < 40 then 'Optimize costs and improve revenue generation'\n            when program_quality_score < 40 then 'Enhance faculty quality and curriculum rigor'\n            when overall_competitiveness_rank > count(*) over () * 0.75 then 'Focus on core competency development'\n            else 'Maintain competitive advantage and explore growth'\n        end as strategic_recommendation,\n\n        case\n            when graduation_rate > institutional_avg_graduation_rate * 1.2 and\n                 program_avg_gpa > institutional_avg_gpa * 1.1 then 'Flagship Program'\n            when revenue_efficiency_ratio > institutional_avg_revenue_efficiency * 1.3 then 'High Value Program'\n            when senior_faculty_percentage > institutional_avg_senior_faculty * 1.5 then 'Premium Quality Program'\n            when graduation_rate < institutional_avg_graduation_rate * 0.8 then 'At-Risk Program'\n            else 'Standard Program'\n        end as program_classification\n    from benchmarking_analysis ba\n),\n\ninvestment_priorities as (\n    select\n        sp.*,\n        -- Investment priority\n        case\n            when sp.competitive_position = 'Market Leader' and sp.program_classification = 'Flagship Program' then 'High Growth Investment'\n            when sp.competitive_position = 'Strong Competitor' and sp.financial_efficiency_score >= 70 then 'Expansion Investment'\n            when sp.competitive_position in ('Average Performer', 'Below Average') and sp.program_classification != 'At-Risk Program' then 'Improvement Investment'\n            when sp.competitive_position = 'Needs Significant Improvement' or sp.program_classification = 'At-Risk Program' then 'Restructuring Required'\n            else 'Maintenance Investment'\n        end as investment_priority\n    from strategic_positioning sp\n)\n\nselect * from investment_priorities\norder by overall_competitiveness_score desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.institutional_kpi_dashboard": {"database": "postgres", "schema": "edu_dbt", "name": "institutional_kpi_dashboard", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/core/institutional_kpi_dashboard.sql", "original_file_path": "models/marts/core/institutional_kpi_dashboard.sql", "unique_id": "model.DbtEducationalDataProject.institutional_kpi_dashboard", "fqn": ["DbtEducationalDataProject", "marts", "core", "institutional_kpi_dashboard"], "alias": "institutional_kpi_dashboard", "checksum": {"name": "sha256", "checksum": "d5b9769111a11e80b883015930118905c2ab22e07be6ecf116f0a0731fe23d9e"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764374187.9386733, "relation_name": "\"postgres\".\"edu_dbt\".\"institutional_kpi_dashboard\"", "raw_code": "{{ config(materialized='table') }}\n\nwith enrollment_kpis as (\n    select\n        current_date as report_date,\n        'Enrollment Metrics' as kpi_category,\n        count(distinct s.student_id) as total_active_students,\n        count(distinct case when s.student_status = 'active' then s.student_id end) as currently_enrolled_students,\n        count(distinct case when s.student_status = 'graduated' then s.student_id end) as total_graduates,\n        count(distinct e.enrollment_id) as total_course_enrollments,\n        round(avg(s.gpa), 2) as institutional_avg_gpa,\n        round(\n            count(distinct case when s.student_status = 'graduated' then s.student_id end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as overall_graduation_rate,\n        round(\n            count(distinct case when s.academic_standing = 'Deans List' then s.student_id end) * 100.0 / \n            nullif(count(distinct case when s.student_status = 'active' then s.student_id end), 0), 2\n        ) as honors_student_percentage,\n        round(\n            count(distinct case when s.student_status = 'dropped' then s.student_id end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as dropout_rate\n    from {{ ref('stg_students') }} s\n    left join {{ ref('stg_enrollments') }} e on s.student_id = e.student_id\n),\n\nacademic_performance_kpis as (\n    select\n        current_date as report_date,\n        'Academic Performance' as kpi_category,\n        round(avg(e.grade_points), 2) as avg_course_performance,\n        round(avg(e.attendance_percentage), 2) as avg_student_attendance,\n        round(\n            count(case when e.grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) * 100.0 / \n            nullif(count(case when e.grade_category != 'Unknown' then 1 end), 0), 2\n        ) as course_success_rate,\n        round(\n            count(case when e.enrollment_status = 'Withdrawn' then 1 end) * 100.0 / \n            nullif(count(e.enrollment_id), 0), 2\n        ) as course_withdrawal_rate,\n        count(distinct c.course_id) as total_courses_offered,\n        round(avg(c.difficulty_level), 1) as avg_course_difficulty,\n        count(case when c.difficulty_level >= 4 then 1 end) as advanced_courses_offered\n    from {{ ref('stg_enrollments') }} e\n    inner join {{ ref('stg_courses') }} c on e.course_id = c.course_id\n    inner join {{ ref('stg_semesters') }} sem on e.semester_id = sem.semester_id\n),\n\nfaculty_kpis as (\n    select\n        current_date as report_date,\n        'Faculty Metrics' as kpi_category,\n        count(distinct f.faculty_id) as total_faculty,\n        round(avg(f.salary), 0) as avg_faculty_salary,\n        round(avg(f.years_of_service), 1) as avg_years_of_service,\n        count(case when f.position = 'Professor' then 1 end) as full_professors,\n        count(case when f.position = 'Associate Professor' then 1 end) as associate_professors,\n        count(case when f.position = 'Assistant Professor' then 1 end) as assistant_professors,\n        round(\n            count(case when f.position = 'Professor' then 1 end) * 100.0 / \n            nullif(count(f.faculty_id), 0), 2\n        ) as senior_faculty_percentage,\n        round(\n            count(distinct s.student_id) / nullif(count(distinct f.faculty_id), 0), 2\n        ) as student_faculty_ratio\n    from {{ ref('stg_faculty') }} f\n    left join {{ ref('stg_class_sessions') }} cs on f.faculty_id = cs.faculty_id\n    left join {{ ref('stg_enrollments') }} e on cs.course_id = e.course_id and cs.semester_id = e.semester_id\n    left join {{ ref('stg_students') }} s on e.student_id = s.student_id\n),\n\nfinancial_kpis as (\n    select\n        current_date as report_date,\n        'Financial Metrics' as kpi_category,\n        sum(tp.amount) as total_tuition_revenue,\n        sum(fa.amount) as total_financial_aid,\n        sum(d.budget) as total_departmental_budgets,\n        sum(f.salary) as total_faculty_compensation,\n        round(sum(tp.amount) / nullif(count(distinct s.student_id), 0), 2) as revenue_per_student,\n        round(sum(d.budget) / nullif(count(distinct s.student_id), 0), 2) as cost_per_student,\n        round(sum(tp.amount) / nullif(sum(d.budget), 0), 2) as revenue_to_budget_ratio,\n        round(sum(f.salary) / nullif(sum(d.budget), 0) * 100, 2) as faculty_cost_percentage,\n        round(\n            sum(fa.amount) * 100.0 / nullif(sum(tp.amount) + sum(fa.amount), 0), 2\n        ) as financial_aid_percentage\n    from {{ ref('stg_tuition_payments') }} tp\n    full outer join {{ ref('stg_financial_aid') }} fa on tp.student_id = fa.student_id\n    full outer join {{ ref('stg_students') }} s on coalesce(tp.student_id, fa.student_id) = s.student_id\n    full outer join {{ ref('stg_departments') }} d on s.major_id = d.department_id\n    full outer join {{ ref('stg_faculty') }} f on d.department_id = f.department_id\n),\n\noperational_kpis as (\n    select\n        current_date as report_date,\n        'Operational Metrics' as kpi_category,\n        count(distinct d.department_id) as total_departments,\n        count(distinct cs.room_id) as total_classrooms_used,\n        count(distinct cs.session_date) as total_class_sessions,\n        round(avg(cs.attendance_count), 1) as avg_class_attendance,\n        count(distinct a.assignment_id) as total_assignments_given,\n        round(avg(ap.avg_percentage_score), 1) as avg_assignment_performance,\n        round(avg(ap.late_submission_rate), 1) as avg_late_submission_rate,\n        count(distinct sem.semester_id) as semesters_tracked\n    from {{ ref('stg_departments') }} d\n    left join {{ ref('stg_class_sessions') }} cs on 1=1\n    left join {{ ref('stg_assignments') }} a on 1=1\n    left join {{ ref('int_assignment_performance') }} ap on a.assignment_id = ap.assignment_id\n    left join {{ ref('stg_semesters') }} sem on 1=1\n),\n\nsemester_metrics as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.start_date,\n        count(distinct e.student_id) as semester_students,\n        round(avg(e.grade_points), 2) as semester_gpa\n    from {{ ref('stg_semesters') }} sem\n    left join {{ ref('stg_enrollments') }} e on sem.semester_id = e.semester_id\n    group by sem.semester_id, sem.semester_name, sem.start_date\n),\n\nsemester_trends as (\n    select\n        current_date as report_date,\n        'Trend Analysis' as kpi_category,\n        semester_name as current_semester,\n        lag(semester_name) over (order by start_date) as previous_semester,\n        semester_students as current_semester_students,\n        lag(semester_students) over (order by start_date) as previous_semester_students,\n        semester_gpa as current_semester_gpa,\n        lag(semester_gpa) over (order by start_date) as previous_semester_gpa,\n        round(\n            (semester_students - lag(semester_students) over (order by start_date)) * 100.0 /\n            nullif(lag(semester_students) over (order by start_date), 0), 2\n        ) as enrollment_growth_rate,\n        round(\n            (semester_gpa - lag(semester_gpa) over (order by start_date)), 2\n        ) as gpa_change\n    from semester_metrics\n    order by start_date desc\n    limit 1\n),\n\nkpi_targets_and_status as (\n    select\n        ekpi.report_date,\n        ekpi.kpi_category,\n        'Total Active Students' as kpi_name,\n        ekpi.total_active_students as actual_value,\n        1200 as target_value,  -- Example target\n        case \n            when ekpi.total_active_students >= 1200 then 'On Target'\n            when ekpi.total_active_students >= 1080 then 'Close to Target' \n            else 'Below Target'\n        end as status,\n        round((ekpi.total_active_students / 1200.0) * 100, 1) as achievement_percentage\n    from enrollment_kpis ekpi\n    \n    union all\n    \n    select\n        akpi.report_date,\n        akpi.kpi_category,\n        'Course Success Rate' as kpi_name,\n        akpi.course_success_rate as actual_value,\n        85.0 as target_value,\n        case \n            when akpi.course_success_rate >= 85 then 'On Target'\n            when akpi.course_success_rate >= 76.5 then 'Close to Target'\n            else 'Below Target'\n        end as status,\n        round((akpi.course_success_rate / 85.0) * 100, 1) as achievement_percentage\n    from academic_performance_kpis akpi\n    \n    union all\n    \n    select\n        fkpi.report_date,\n        fkpi.kpi_category,\n        'Student Faculty Ratio' as kpi_name,\n        fkpi.student_faculty_ratio as actual_value,\n        20.0 as target_value,\n        case \n            when fkpi.student_faculty_ratio between 15 and 25 then 'On Target'\n            when fkpi.student_faculty_ratio between 12 and 28 then 'Close to Target'\n            else 'Below Target'\n        end as status,\n        case \n            when fkpi.student_faculty_ratio between 15 and 25 then 100.0\n            else round((20.0 / abs(fkpi.student_faculty_ratio - 20.0)) * 100, 1)\n        end as achievement_percentage\n    from faculty_kpis fkpi\n    \n    union all\n    \n    select\n        fikpi.report_date,\n        fikpi.kpi_category,\n        'Revenue to Budget Ratio' as kpi_name,\n        fikpi.revenue_to_budget_ratio as actual_value,\n        1.2 as target_value,\n        case \n            when fikpi.revenue_to_budget_ratio >= 1.2 then 'On Target'\n            when fikpi.revenue_to_budget_ratio >= 1.08 then 'Close to Target'\n            else 'Below Target'\n        end as status,\n        round((fikpi.revenue_to_budget_ratio / 1.2) * 100, 1) as achievement_percentage\n    from financial_kpis fikpi\n),\n\nexecutive_dashboard_summary as (\n    select\n        current_date as dashboard_date,\n        count(*) as total_kpis_tracked,\n        count(case when status = 'On Target' then 1 end) as kpis_on_target,\n        count(case when status = 'Close to Target' then 1 end) as kpis_close_to_target,\n        count(case when status = 'Below Target' then 1 end) as kpis_below_target,\n        round(\n            count(case when status = 'On Target' then 1 end) * 100.0 / count(*), 1\n        ) as overall_kpi_success_rate,\n        round(avg(achievement_percentage), 1) as avg_achievement_percentage,\n        case\n            when count(case when status = 'Below Target' then 1 end) >= 3 then 'Critical - Multiple KPIs Below Target'\n            when count(case when status = 'Below Target' then 1 end) >= 2 then 'Warning - Some KPIs Below Target'\n            when count(case when status = 'On Target' then 1 end) >= count(*) * 0.8 then 'Excellent - Most KPIs On Target'\n            else 'Good - Majority of KPIs Performing Well'\n        end as overall_institutional_health\n    from kpi_targets_and_status\n)\n\n-- Final comprehensive KPI dashboard\nselect\n    kts.*,\n    eds.overall_kpi_success_rate,\n    eds.overall_institutional_health,\n    case\n        when kts.status = 'Below Target' and kts.kpi_name in ('Course Success Rate', 'Student Faculty Ratio') then 'High Priority Action Required'\n        when kts.status = 'Below Target' then 'Action Required'\n        when kts.status = 'Close to Target' then 'Monitor Closely'\n        else 'Continue Current Strategy'\n    end as action_priority,\n    case\n        when kts.kpi_name = 'Total Active Students' and kts.status = 'Below Target' then 'Enhance recruitment and retention programs'\n        when kts.kpi_name = 'Course Success Rate' and kts.status = 'Below Target' then 'Improve academic support and teaching effectiveness'\n        when kts.kpi_name = 'Student Faculty Ratio' and kts.status = 'Below Target' then 'Optimize faculty allocation or adjust enrollment'\n        when kts.kpi_name = 'Revenue to Budget Ratio' and kts.status = 'Below Target' then 'Review pricing strategy and cost management'\n        else 'Maintain current practices'\n    end as improvement_recommendation\nfrom kpi_targets_and_status kts\ncross join executive_dashboard_summary eds\norder by \n    case when kts.status = 'Below Target' then 1\n         when kts.status = 'Close to Target' then 2\n         else 3 end,\n    kts.achievement_percentage asc", "language": "sql", "refs": [{"name": "stg_students", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_tuition_payments", "package": null, "version": null}, {"name": "stg_financial_aid", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_assignments", "package": null, "version": null}, {"name": "int_assignment_performance", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_tuition_payments", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.int_assignment_performance"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/core/institutional_kpi_dashboard.sql", "compiled": true, "compiled_code": "\n\nwith enrollment_kpis as (\n    select\n        current_date as report_date,\n        'Enrollment Metrics' as kpi_category,\n        count(distinct s.student_id) as total_active_students,\n        count(distinct case when s.student_status = 'active' then s.student_id end) as currently_enrolled_students,\n        count(distinct case when s.student_status = 'graduated' then s.student_id end) as total_graduates,\n        count(distinct e.enrollment_id) as total_course_enrollments,\n        round(avg(s.gpa), 2) as institutional_avg_gpa,\n        round(\n            count(distinct case when s.student_status = 'graduated' then s.student_id end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as overall_graduation_rate,\n        round(\n            count(distinct case when s.academic_standing = 'Deans List' then s.student_id end) * 100.0 / \n            nullif(count(distinct case when s.student_status = 'active' then s.student_id end), 0), 2\n        ) as honors_student_percentage,\n        round(\n            count(distinct case when s.student_status = 'dropped' then s.student_id end) * 100.0 / \n            nullif(count(distinct s.student_id), 0), 2\n        ) as dropout_rate\n    from \"postgres\".\"edu_dbt\".\"stg_students\" s\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on s.student_id = e.student_id\n),\n\nacademic_performance_kpis as (\n    select\n        current_date as report_date,\n        'Academic Performance' as kpi_category,\n        round(avg(e.grade_points), 2) as avg_course_performance,\n        round(avg(e.attendance_percentage), 2) as avg_student_attendance,\n        round(\n            count(case when e.grade_category in ('Excellent', 'Good', 'Satisfactory') then 1 end) * 100.0 / \n            nullif(count(case when e.grade_category != 'Unknown' then 1 end), 0), 2\n        ) as course_success_rate,\n        round(\n            count(case when e.enrollment_status = 'Withdrawn' then 1 end) * 100.0 / \n            nullif(count(e.enrollment_id), 0), 2\n        ) as course_withdrawal_rate,\n        count(distinct c.course_id) as total_courses_offered,\n        round(avg(c.difficulty_level), 1) as avg_course_difficulty,\n        count(case when c.difficulty_level >= 4 then 1 end) as advanced_courses_offered\n    from \"postgres\".\"edu_dbt\".\"stg_enrollments\" e\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e.course_id = c.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e.semester_id = sem.semester_id\n),\n\nfaculty_kpis as (\n    select\n        current_date as report_date,\n        'Faculty Metrics' as kpi_category,\n        count(distinct f.faculty_id) as total_faculty,\n        round(avg(f.salary), 0) as avg_faculty_salary,\n        round(avg(f.years_of_service), 1) as avg_years_of_service,\n        count(case when f.position = 'Professor' then 1 end) as full_professors,\n        count(case when f.position = 'Associate Professor' then 1 end) as associate_professors,\n        count(case when f.position = 'Assistant Professor' then 1 end) as assistant_professors,\n        round(\n            count(case when f.position = 'Professor' then 1 end) * 100.0 / \n            nullif(count(f.faculty_id), 0), 2\n        ) as senior_faculty_percentage,\n        round(\n            count(distinct s.student_id) / nullif(count(distinct f.faculty_id), 0), 2\n        ) as student_faculty_ratio\n    from \"postgres\".\"edu_dbt\".\"stg_faculty\" f\n    left join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on f.faculty_id = cs.faculty_id\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on cs.course_id = e.course_id and cs.semester_id = e.semester_id\n    left join \"postgres\".\"edu_dbt\".\"stg_students\" s on e.student_id = s.student_id\n),\n\nfinancial_kpis as (\n    select\n        current_date as report_date,\n        'Financial Metrics' as kpi_category,\n        sum(tp.amount) as total_tuition_revenue,\n        sum(fa.amount) as total_financial_aid,\n        sum(d.budget) as total_departmental_budgets,\n        sum(f.salary) as total_faculty_compensation,\n        round(sum(tp.amount) / nullif(count(distinct s.student_id), 0), 2) as revenue_per_student,\n        round(sum(d.budget) / nullif(count(distinct s.student_id), 0), 2) as cost_per_student,\n        round(sum(tp.amount) / nullif(sum(d.budget), 0), 2) as revenue_to_budget_ratio,\n        round(sum(f.salary) / nullif(sum(d.budget), 0) * 100, 2) as faculty_cost_percentage,\n        round(\n            sum(fa.amount) * 100.0 / nullif(sum(tp.amount) + sum(fa.amount), 0), 2\n        ) as financial_aid_percentage\n    from \"postgres\".\"edu_dbt\".\"stg_tuition_payments\" tp\n    full outer join \"postgres\".\"edu_dbt\".\"stg_financial_aid\" fa on tp.student_id = fa.student_id\n    full outer join \"postgres\".\"edu_dbt\".\"stg_students\" s on coalesce(tp.student_id, fa.student_id) = s.student_id\n    full outer join \"postgres\".\"edu_dbt\".\"stg_departments\" d on s.major_id = d.department_id\n    full outer join \"postgres\".\"edu_dbt\".\"stg_faculty\" f on d.department_id = f.department_id\n),\n\noperational_kpis as (\n    select\n        current_date as report_date,\n        'Operational Metrics' as kpi_category,\n        count(distinct d.department_id) as total_departments,\n        count(distinct cs.room_id) as total_classrooms_used,\n        count(distinct cs.session_date) as total_class_sessions,\n        round(avg(cs.attendance_count), 1) as avg_class_attendance,\n        count(distinct a.assignment_id) as total_assignments_given,\n        round(avg(ap.avg_percentage_score), 1) as avg_assignment_performance,\n        round(avg(ap.late_submission_rate), 1) as avg_late_submission_rate,\n        count(distinct sem.semester_id) as semesters_tracked\n    from \"postgres\".\"edu_dbt\".\"stg_departments\" d\n    left join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs on 1=1\n    left join \"postgres\".\"edu_dbt\".\"stg_assignments\" a on 1=1\n    left join \"postgres\".\"edu_dbt\".\"int_assignment_performance\" ap on a.assignment_id = ap.assignment_id\n    left join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on 1=1\n),\n\nsemester_metrics as (\n    select\n        sem.semester_id,\n        sem.semester_name,\n        sem.start_date,\n        count(distinct e.student_id) as semester_students,\n        round(avg(e.grade_points), 2) as semester_gpa\n    from \"postgres\".\"edu_dbt\".\"stg_semesters\" sem\n    left join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on sem.semester_id = e.semester_id\n    group by sem.semester_id, sem.semester_name, sem.start_date\n),\n\nsemester_trends as (\n    select\n        current_date as report_date,\n        'Trend Analysis' as kpi_category,\n        semester_name as current_semester,\n        lag(semester_name) over (order by start_date) as previous_semester,\n        semester_students as current_semester_students,\n        lag(semester_students) over (order by start_date) as previous_semester_students,\n        semester_gpa as current_semester_gpa,\n        lag(semester_gpa) over (order by start_date) as previous_semester_gpa,\n        round(\n            (semester_students - lag(semester_students) over (order by start_date)) * 100.0 /\n            nullif(lag(semester_students) over (order by start_date), 0), 2\n        ) as enrollment_growth_rate,\n        round(\n            (semester_gpa - lag(semester_gpa) over (order by start_date)), 2\n        ) as gpa_change\n    from semester_metrics\n    order by start_date desc\n    limit 1\n),\n\nkpi_targets_and_status as (\n    select\n        ekpi.report_date,\n        ekpi.kpi_category,\n        'Total Active Students' as kpi_name,\n        ekpi.total_active_students as actual_value,\n        1200 as target_value,  -- Example target\n        case \n            when ekpi.total_active_students >= 1200 then 'On Target'\n            when ekpi.total_active_students >= 1080 then 'Close to Target' \n            else 'Below Target'\n        end as status,\n        round((ekpi.total_active_students / 1200.0) * 100, 1) as achievement_percentage\n    from enrollment_kpis ekpi\n    \n    union all\n    \n    select\n        akpi.report_date,\n        akpi.kpi_category,\n        'Course Success Rate' as kpi_name,\n        akpi.course_success_rate as actual_value,\n        85.0 as target_value,\n        case \n            when akpi.course_success_rate >= 85 then 'On Target'\n            when akpi.course_success_rate >= 76.5 then 'Close to Target'\n            else 'Below Target'\n        end as status,\n        round((akpi.course_success_rate / 85.0) * 100, 1) as achievement_percentage\n    from academic_performance_kpis akpi\n    \n    union all\n    \n    select\n        fkpi.report_date,\n        fkpi.kpi_category,\n        'Student Faculty Ratio' as kpi_name,\n        fkpi.student_faculty_ratio as actual_value,\n        20.0 as target_value,\n        case \n            when fkpi.student_faculty_ratio between 15 and 25 then 'On Target'\n            when fkpi.student_faculty_ratio between 12 and 28 then 'Close to Target'\n            else 'Below Target'\n        end as status,\n        case \n            when fkpi.student_faculty_ratio between 15 and 25 then 100.0\n            else round((20.0 / abs(fkpi.student_faculty_ratio - 20.0)) * 100, 1)\n        end as achievement_percentage\n    from faculty_kpis fkpi\n    \n    union all\n    \n    select\n        fikpi.report_date,\n        fikpi.kpi_category,\n        'Revenue to Budget Ratio' as kpi_name,\n        fikpi.revenue_to_budget_ratio as actual_value,\n        1.2 as target_value,\n        case \n            when fikpi.revenue_to_budget_ratio >= 1.2 then 'On Target'\n            when fikpi.revenue_to_budget_ratio >= 1.08 then 'Close to Target'\n            else 'Below Target'\n        end as status,\n        round((fikpi.revenue_to_budget_ratio / 1.2) * 100, 1) as achievement_percentage\n    from financial_kpis fikpi\n),\n\nexecutive_dashboard_summary as (\n    select\n        current_date as dashboard_date,\n        count(*) as total_kpis_tracked,\n        count(case when status = 'On Target' then 1 end) as kpis_on_target,\n        count(case when status = 'Close to Target' then 1 end) as kpis_close_to_target,\n        count(case when status = 'Below Target' then 1 end) as kpis_below_target,\n        round(\n            count(case when status = 'On Target' then 1 end) * 100.0 / count(*), 1\n        ) as overall_kpi_success_rate,\n        round(avg(achievement_percentage), 1) as avg_achievement_percentage,\n        case\n            when count(case when status = 'Below Target' then 1 end) >= 3 then 'Critical - Multiple KPIs Below Target'\n            when count(case when status = 'Below Target' then 1 end) >= 2 then 'Warning - Some KPIs Below Target'\n            when count(case when status = 'On Target' then 1 end) >= count(*) * 0.8 then 'Excellent - Most KPIs On Target'\n            else 'Good - Majority of KPIs Performing Well'\n        end as overall_institutional_health\n    from kpi_targets_and_status\n)\n\n-- Final comprehensive KPI dashboard\nselect\n    kts.*,\n    eds.overall_kpi_success_rate,\n    eds.overall_institutional_health,\n    case\n        when kts.status = 'Below Target' and kts.kpi_name in ('Course Success Rate', 'Student Faculty Ratio') then 'High Priority Action Required'\n        when kts.status = 'Below Target' then 'Action Required'\n        when kts.status = 'Close to Target' then 'Monitor Closely'\n        else 'Continue Current Strategy'\n    end as action_priority,\n    case\n        when kts.kpi_name = 'Total Active Students' and kts.status = 'Below Target' then 'Enhance recruitment and retention programs'\n        when kts.kpi_name = 'Course Success Rate' and kts.status = 'Below Target' then 'Improve academic support and teaching effectiveness'\n        when kts.kpi_name = 'Student Faculty Ratio' and kts.status = 'Below Target' then 'Optimize faculty allocation or adjust enrollment'\n        when kts.kpi_name = 'Revenue to Budget Ratio' and kts.status = 'Below Target' then 'Review pricing strategy and cost management'\n        else 'Maintain current practices'\n    end as improvement_recommendation\nfrom kpi_targets_and_status kts\ncross join executive_dashboard_summary eds\norder by \n    case when kts.status = 'Below Target' then 1\n         when kts.status = 'Close to Target' then 2\n         else 3 end,\n    kts.achievement_percentage asc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.instructor_effectiveness_scorecard": {"database": "postgres", "schema": "edu_dbt", "name": "instructor_effectiveness_scorecard", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "marts/academic/instructor_effectiveness_scorecard.sql", "original_file_path": "models/marts/academic/instructor_effectiveness_scorecard.sql", "unique_id": "model.DbtEducationalDataProject.instructor_effectiveness_scorecard", "fqn": ["DbtEducationalDataProject", "marts", "academic", "instructor_effectiveness_scorecard"], "alias": "instructor_effectiveness_scorecard", "checksum": {"name": "sha256", "checksum": "9df51e33aee647e4d8b00289d415bf743883851759d1e765e89cf8155bfc52d7"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "table"}, "created_at": 1764374187.9405804, "relation_name": "\"postgres\".\"edu_dbt\".\"instructor_effectiveness_scorecard\"", "raw_code": "{{ config(materialized='table') }}\n\nwith instructor_metrics as (\n    select\n        f.faculty_id,\n        f.faculty_name,\n        f.position,\n        f.department_name,\n        f.years_of_service,\n        f.salary,\n        f.unique_courses_taught,\n        f.total_students_taught,\n        f.avg_class_attendance,\n        f.teaching_load_category,\n        fsi.student_success_rate,\n        fsi.avg_grade_given,\n        fsi.grade_consistency,\n        fsi.avg_incoming_student_gpa,\n        fsi.teaching_effectiveness_category,\n        fsi.student_engagement_level,\n        fsi.grading_consistency_level,\n        ap.avg_percentage_score as avg_assignment_performance,\n        ap.late_submission_rate as avg_late_submission_rate,\n        ap.grading_completion_rate as avg_grading_completion_rate\n    from {{ ref('int_faculty_teaching_load') }} f\n    left join {{ ref('int_faculty_student_interactions') }} fsi \n        on f.faculty_id = fsi.faculty_id\n    left join (\n        select\n            course_id,\n            avg(avg_percentage_score) as avg_percentage_score,\n            avg(late_submission_rate) as late_submission_rate,\n            avg(grading_completion_rate) as grading_completion_rate\n        from {{ ref('int_assignment_performance') }}\n        group by course_id\n    ) ap on f.faculty_id = ap.course_id  -- Simplified for this example\n),\n\nperformance_scoring as (\n    select\n        *,\n        -- Teaching effectiveness score (0-100)\n        round(\n            (case \n                when student_success_rate >= 90 then 25\n                when student_success_rate >= 80 then 20\n                when student_success_rate >= 70 then 15\n                when student_success_rate >= 60 then 10\n                else 5\n            end +\n            case \n                when avg_class_attendance >= 95 then 25\n                when avg_class_attendance >= 85 then 20\n                when avg_class_attendance >= 75 then 15\n                when avg_class_attendance >= 65 then 10\n                else 5\n            end +\n            case \n                when grade_consistency <= 0.5 then 25\n                when grade_consistency <= 1.0 then 20\n                when grade_consistency <= 1.5 then 15\n                when grade_consistency <= 2.0 then 10\n                else 5\n            end +\n            case \n                when avg_grading_completion_rate >= 95 then 25\n                when avg_grading_completion_rate >= 85 then 20\n                when avg_grading_completion_rate >= 75 then 15\n                when avg_grading_completion_rate >= 65 then 10\n                else 5\n            end), 0\n        ) as effectiveness_score,\n        \n        -- Student impact score based on numbers taught and success\n        round(\n            (total_students_taught * student_success_rate / 100), 0\n        ) as student_impact_score,\n        \n        -- Experience factor\n        case\n            when years_of_service >= 15 then 'Veteran'\n            when years_of_service >= 10 then 'Senior'\n            when years_of_service >= 5 then 'Experienced'\n            else 'Junior'\n        end as experience_level,\n        \n        -- Workload efficiency\n        round(\n            student_success_rate / nullif(unique_courses_taught, 0), 2\n        ) as success_per_course_ratio\n    from instructor_metrics\n),\n\npeer_comparisons as (\n    select\n        ps.*,\n        avg(effectiveness_score) over (partition by department_name) as dept_avg_effectiveness,\n        avg(student_impact_score) over (partition by department_name) as dept_avg_impact,\n        avg(student_success_rate) over (partition by department_name) as dept_avg_success_rate,\n        avg(total_students_taught) over (partition by department_name) as dept_avg_students_taught,\n        avg(effectiveness_score) over (partition by position) as position_avg_effectiveness,\n        avg(student_impact_score) over (partition by position) as position_avg_impact,\n        row_number() over (partition by department_name order by effectiveness_score desc) as dept_effectiveness_rank,\n        row_number() over (partition by position order by effectiveness_score desc) as position_effectiveness_rank,\n        row_number() over (order by effectiveness_score desc) as overall_effectiveness_rank\n    from performance_scoring ps\n),\n\nfinal_scorecard as (\n    select\n        pc.*,\n        case\n            when effectiveness_score >= 90 then 'Outstanding'\n            when effectiveness_score >= 80 then 'Excellent'\n            when effectiveness_score >= 70 then 'Good'\n            when effectiveness_score >= 60 then 'Satisfactory'\n            else 'Needs Improvement'\n        end as overall_performance_rating,\n        \n        case\n            when dept_effectiveness_rank <= 3 then 'Top Performer in Department'\n            when dept_effectiveness_rank <= dept_avg_effectiveness * 0.25 then 'Above Average in Department'\n            when dept_effectiveness_rank <= dept_avg_effectiveness * 0.75 then 'Average in Department'\n            else 'Below Average in Department'\n        end as departmental_standing,\n        \n        case\n            when effectiveness_score > dept_avg_effectiveness * 1.2 then 'Significantly Above Department Average'\n            when effectiveness_score > dept_avg_effectiveness * 1.1 then 'Above Department Average'\n            when effectiveness_score between dept_avg_effectiveness * 0.9 and dept_avg_effectiveness * 1.1 then 'Near Department Average'\n            when effectiveness_score > dept_avg_effectiveness * 0.8 then 'Below Department Average'\n            else 'Significantly Below Department Average'\n        end as performance_vs_peers,\n        \n        -- Recommendations\n        case\n            when effectiveness_score < 60 and avg_class_attendance < 75 then 'Focus on student engagement strategies'\n            when effectiveness_score < 60 and student_success_rate < 70 then 'Review grading standards and course difficulty'\n            when effectiveness_score < 60 and grade_consistency > 2.0 then 'Work on grading consistency'\n            when effectiveness_score >= 80 then 'Mentor other faculty members'\n            else 'Continue professional development'\n        end as improvement_recommendations,\n        \n        -- Recognition eligibility\n        case\n            when effectiveness_score >= 90 and student_impact_score >= 150 then 'Eligible for Teaching Excellence Award'\n            when effectiveness_score >= 85 and years_of_service >= 10 then 'Eligible for Veteran Educator Recognition'\n            when effectiveness_score >= 80 and experience_level = 'Junior' then 'Eligible for Rising Star Award'\n            else 'Standard Recognition'\n        end as award_eligibility\n    from peer_comparisons pc\n)\n\nselect * from final_scorecard\norder by effectiveness_score desc", "language": "sql", "refs": [{"name": "int_faculty_teaching_load", "package": null, "version": null}, {"name": "int_faculty_student_interactions", "package": null, "version": null}, {"name": "int_assignment_performance", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.int_faculty_teaching_load", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_assignment_performance"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/marts/academic/instructor_effectiveness_scorecard.sql", "compiled": true, "compiled_code": "\n\nwith instructor_metrics as (\n    select\n        f.faculty_id,\n        f.faculty_name,\n        f.position,\n        f.department_name,\n        f.years_of_service,\n        f.salary,\n        f.unique_courses_taught,\n        f.total_students_taught,\n        f.avg_class_attendance,\n        f.teaching_load_category,\n        fsi.student_success_rate,\n        fsi.avg_grade_given,\n        fsi.grade_consistency,\n        fsi.avg_incoming_student_gpa,\n        fsi.teaching_effectiveness_category,\n        fsi.student_engagement_level,\n        fsi.grading_consistency_level,\n        ap.avg_percentage_score as avg_assignment_performance,\n        ap.late_submission_rate as avg_late_submission_rate,\n        ap.grading_completion_rate as avg_grading_completion_rate\n    from \"postgres\".\"edu_dbt\".\"int_faculty_teaching_load\" f\n    left join \"postgres\".\"edu_dbt\".\"int_faculty_student_interactions\" fsi \n        on f.faculty_id = fsi.faculty_id\n    left join (\n        select\n            course_id,\n            avg(avg_percentage_score) as avg_percentage_score,\n            avg(late_submission_rate) as late_submission_rate,\n            avg(grading_completion_rate) as grading_completion_rate\n        from \"postgres\".\"edu_dbt\".\"int_assignment_performance\"\n        group by course_id\n    ) ap on f.faculty_id = ap.course_id  -- Simplified for this example\n),\n\nperformance_scoring as (\n    select\n        *,\n        -- Teaching effectiveness score (0-100)\n        round(\n            (case \n                when student_success_rate >= 90 then 25\n                when student_success_rate >= 80 then 20\n                when student_success_rate >= 70 then 15\n                when student_success_rate >= 60 then 10\n                else 5\n            end +\n            case \n                when avg_class_attendance >= 95 then 25\n                when avg_class_attendance >= 85 then 20\n                when avg_class_attendance >= 75 then 15\n                when avg_class_attendance >= 65 then 10\n                else 5\n            end +\n            case \n                when grade_consistency <= 0.5 then 25\n                when grade_consistency <= 1.0 then 20\n                when grade_consistency <= 1.5 then 15\n                when grade_consistency <= 2.0 then 10\n                else 5\n            end +\n            case \n                when avg_grading_completion_rate >= 95 then 25\n                when avg_grading_completion_rate >= 85 then 20\n                when avg_grading_completion_rate >= 75 then 15\n                when avg_grading_completion_rate >= 65 then 10\n                else 5\n            end), 0\n        ) as effectiveness_score,\n        \n        -- Student impact score based on numbers taught and success\n        round(\n            (total_students_taught * student_success_rate / 100), 0\n        ) as student_impact_score,\n        \n        -- Experience factor\n        case\n            when years_of_service >= 15 then 'Veteran'\n            when years_of_service >= 10 then 'Senior'\n            when years_of_service >= 5 then 'Experienced'\n            else 'Junior'\n        end as experience_level,\n        \n        -- Workload efficiency\n        round(\n            student_success_rate / nullif(unique_courses_taught, 0), 2\n        ) as success_per_course_ratio\n    from instructor_metrics\n),\n\npeer_comparisons as (\n    select\n        ps.*,\n        avg(effectiveness_score) over (partition by department_name) as dept_avg_effectiveness,\n        avg(student_impact_score) over (partition by department_name) as dept_avg_impact,\n        avg(student_success_rate) over (partition by department_name) as dept_avg_success_rate,\n        avg(total_students_taught) over (partition by department_name) as dept_avg_students_taught,\n        avg(effectiveness_score) over (partition by position) as position_avg_effectiveness,\n        avg(student_impact_score) over (partition by position) as position_avg_impact,\n        row_number() over (partition by department_name order by effectiveness_score desc) as dept_effectiveness_rank,\n        row_number() over (partition by position order by effectiveness_score desc) as position_effectiveness_rank,\n        row_number() over (order by effectiveness_score desc) as overall_effectiveness_rank\n    from performance_scoring ps\n),\n\nfinal_scorecard as (\n    select\n        pc.*,\n        case\n            when effectiveness_score >= 90 then 'Outstanding'\n            when effectiveness_score >= 80 then 'Excellent'\n            when effectiveness_score >= 70 then 'Good'\n            when effectiveness_score >= 60 then 'Satisfactory'\n            else 'Needs Improvement'\n        end as overall_performance_rating,\n        \n        case\n            when dept_effectiveness_rank <= 3 then 'Top Performer in Department'\n            when dept_effectiveness_rank <= dept_avg_effectiveness * 0.25 then 'Above Average in Department'\n            when dept_effectiveness_rank <= dept_avg_effectiveness * 0.75 then 'Average in Department'\n            else 'Below Average in Department'\n        end as departmental_standing,\n        \n        case\n            when effectiveness_score > dept_avg_effectiveness * 1.2 then 'Significantly Above Department Average'\n            when effectiveness_score > dept_avg_effectiveness * 1.1 then 'Above Department Average'\n            when effectiveness_score between dept_avg_effectiveness * 0.9 and dept_avg_effectiveness * 1.1 then 'Near Department Average'\n            when effectiveness_score > dept_avg_effectiveness * 0.8 then 'Below Department Average'\n            else 'Significantly Below Department Average'\n        end as performance_vs_peers,\n        \n        -- Recommendations\n        case\n            when effectiveness_score < 60 and avg_class_attendance < 75 then 'Focus on student engagement strategies'\n            when effectiveness_score < 60 and student_success_rate < 70 then 'Review grading standards and course difficulty'\n            when effectiveness_score < 60 and grade_consistency > 2.0 then 'Work on grading consistency'\n            when effectiveness_score >= 80 then 'Mentor other faculty members'\n            else 'Continue professional development'\n        end as improvement_recommendations,\n        \n        -- Recognition eligibility\n        case\n            when effectiveness_score >= 90 and student_impact_score >= 150 then 'Eligible for Teaching Excellence Award'\n            when effectiveness_score >= 85 and years_of_service >= 10 then 'Eligible for Veteran Educator Recognition'\n            when effectiveness_score >= 80 and experience_level = 'Junior' then 'Eligible for Rising Star Award'\n            else 'Standard Recognition'\n        end as award_eligibility\n    from peer_comparisons pc\n)\n\nselect * from final_scorecard\norder by effectiveness_score desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}, "model.DbtEducationalDataProject.int_academic_collaboration_networks": {"database": "postgres", "schema": "edu_dbt", "name": "int_academic_collaboration_networks", "resource_type": "model", "package_name": "DbtEducationalDataProject", "path": "intermediate/int_academic_collaboration_networks.sql", "original_file_path": "models/intermediate/int_academic_collaboration_networks.sql", "unique_id": "model.DbtEducationalDataProject.int_academic_collaboration_networks", "fqn": ["DbtEducationalDataProject", "intermediate", "int_academic_collaboration_networks"], "alias": "int_academic_collaboration_networks", "checksum": {"name": "sha256", "checksum": "1244eaf2e098076e125864450fe9f0614f297241c4d5f320ddbb5f983b3dd421"}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "access": "protected"}, "tags": [], "description": "", "columns": {}, "meta": {}, "group": null, "docs": {"show": true, "node_color": null}, "patch_path": null, "build_path": null, "unrendered_config": {"materialized": "view"}, "created_at": 1764374305.6070516, "relation_name": "\"postgres\".\"edu_dbt\".\"int_academic_collaboration_networks\"", "raw_code": "{{ config(materialized='view') }}\n\nwith student_course_connections as (\n    select\n        e1.student_id as student_a,\n        e2.student_id as student_b,\n        e1.course_id,\n        e1.semester_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        d.department_name,\n        sem.semester_name,\n        sem.academic_year,\n        s1.full_name as student_a_name,\n        s2.full_name as student_b_name,\n        s1.gpa as student_a_gpa,\n        s2.gpa as student_b_gpa,\n        s1.major_id as student_a_major,\n        s2.major_id as student_b_major,\n        e1.grade_points as student_a_grade,\n        e2.grade_points as student_b_grade,\n        abs(e1.grade_points - e2.grade_points) as grade_difference\n    from {{ ref('stg_enrollments') }} e1\n    inner join {{ ref('stg_enrollments') }} e2 \n        on e1.course_id = e2.course_id \n        and e1.semester_id = e2.semester_id\n        and e1.student_id < e2.student_id  -- Avoid duplicates\n    inner join {{ ref('stg_courses') }} c on e1.course_id = c.course_id\n    inner join {{ ref('stg_departments') }} d on c.department_id = d.department_id\n    inner join {{ ref('stg_semesters') }} sem on e1.semester_id = sem.semester_id\n    inner join {{ ref('stg_students') }} s1 on e1.student_id = s1.student_id\n    inner join {{ ref('stg_students') }} s2 on e2.student_id = s2.student_id\n    where e1.enrollment_status = 'Completed' and e2.enrollment_status = 'Completed'\n),\n\nstudent_collaboration_strength as (\n    select\n        student_a,\n        student_b,\n        student_a_name,\n        student_b_name,\n        count(distinct course_id) as shared_courses,\n        count(distinct semester_id) as shared_semesters,\n        count(distinct department_name) as shared_departments,\n        avg(difficulty_level) as avg_shared_course_difficulty,\n        avg(grade_difference) as avg_grade_difference,\n        corr(student_a_grade, student_b_grade) as grade_correlation,\n        case when student_a_major = student_b_major then 1 else 0 end as same_major,\n        abs(student_a_gpa - student_b_gpa) as gpa_difference,\n        least(student_a_gpa, student_b_gpa) as min_gpa,\n        greatest(student_a_gpa, student_b_gpa) as max_gpa\n    from student_course_connections\n    group by \n        student_a, student_b, student_a_name, student_b_name, \n        student_a_major, student_b_major, student_a_gpa, student_b_gpa\n    having count(distinct course_id) >= 2  -- Only pairs who took multiple courses together\n),\n\ncollaboration_analysis as (\n    select\n        *,\n        case\n            when shared_courses >= 6 then 'Very Strong Connection'\n            when shared_courses >= 4 then 'Strong Connection'\n            when shared_courses >= 3 then 'Moderate Connection'\n            else 'Weak Connection'\n        end as connection_strength,\n        \n        case\n            when grade_correlation >= 0.7 then 'Very Similar Performance'\n            when grade_correlation >= 0.4 then 'Similar Performance'\n            when grade_correlation >= 0.1 then 'Somewhat Similar Performance'\n            when grade_correlation >= -0.1 then 'Unrelated Performance'\n            else 'Opposite Performance Patterns'\n        end as performance_similarity,\n        \n        case\n            when avg_grade_difference <= 0.3 then 'Very Close Academic Peers'\n            when avg_grade_difference <= 0.7 then 'Close Academic Peers'\n            when avg_grade_difference <= 1.2 then 'Moderate Academic Difference'\n            else 'Significant Academic Difference'\n        end as academic_peer_level,\n        \n        case\n            when gpa_difference <= 0.2 and same_major = 1 then 'Ideal Study Partners'\n            when gpa_difference <= 0.5 and shared_departments >= 2 then 'Good Study Partners'\n            when max_gpa - min_gpa >= 1.0 and same_major = 1 then 'Mentoring Opportunity'\n            else 'Diverse Learning Partnership'\n        end as collaboration_type\n    from student_collaboration_strength scs\n),\n\nfaculty_collaboration_networks as (\n    select\n        f1.faculty_id as faculty_a,\n        f2.faculty_id as faculty_b,\n        f1.full_name as faculty_a_name,\n        f2.full_name as faculty_b_name,\n        d1.department_name as faculty_a_dept,\n        d2.department_name as faculty_b_dept,\n        count(distinct cs1.course_id) as shared_teaching_opportunities,\n        count(distinct cs1.semester_id) as semesters_co_teaching,\n        count(distinct e.student_id) as shared_students,\n        avg(e.grade_points) as avg_shared_student_performance,\n        case when f1.department_id = f2.department_id then 1 else 0 end as same_department\n    from {{ ref('stg_faculty') }} f1\n    inner join {{ ref('stg_faculty') }} f2 on f1.faculty_id < f2.faculty_id\n    left join {{ ref('stg_departments') }} d1 on f1.department_id = d1.department_id\n    left join {{ ref('stg_departments') }} d2 on f2.department_id = d2.department_id\n    inner join {{ ref('stg_class_sessions') }} cs1 on f1.faculty_id = cs1.faculty_id\n    inner join {{ ref('stg_class_sessions') }} cs2 on f2.faculty_id = cs2.faculty_id\n        and cs1.semester_id = cs2.semester_id\n    inner join {{ ref('stg_enrollments') }} e on cs1.course_id = e.course_id\n        and cs1.semester_id = e.semester_id\n    inner join {{ ref('stg_enrollments') }} e2 on cs2.course_id = e2.course_id\n        and cs2.semester_id = e2.semester_id\n        and e.student_id = e2.student_id  -- Same student in both courses\n    group by\n        f1.faculty_id, f2.faculty_id, f1.full_name, f2.full_name,\n        d1.department_name, d2.department_name, f1.department_id, f2.department_id\n    having count(distinct e.student_id) >= 3  -- Faculty who share multiple students\n),\n\ndepartment_collaboration_metrics as (\n    select\n        scc.department_name,\n        count(distinct ca.student_a) + count(distinct ca.student_b) as unique_students_in_collaborations,\n        avg(ca.shared_courses) as avg_shared_courses_per_pair,\n        count(case when ca.connection_strength in ('Strong Connection', 'Very Strong Connection') then 1 end) as strong_collaborations,\n        count(case when ca.same_major = 1 then 1 end) as same_major_collaborations,\n        count(case when ca.collaboration_type like '%Mentoring%' then 1 end) as mentoring_opportunities,\n        round(\n            count(case when ca.performance_similarity like '%Similar%' then 1 end) * 100.0 / count(*), 2\n        ) as performance_similarity_rate\n    from student_course_connections scc\n    inner join collaboration_analysis ca\n        on scc.student_a = ca.student_a and scc.student_b = ca.student_b\n    group by scc.department_name\n),\n\nnetwork_insights as (\n    select\n        ca.*,\n        dcm.avg_shared_courses_per_pair as dept_avg_shared_courses,\n        dcm.performance_similarity_rate as dept_similarity_rate,\n        case\n            when ca.shared_courses > dcm.avg_shared_courses_per_pair * 1.5 then 'Above Average Collaboration'\n            when ca.shared_courses < dcm.avg_shared_courses_per_pair * 0.5 then 'Below Average Collaboration'\n            else 'Average Collaboration'\n        end as relative_collaboration_level,\n        \n        -- Network value score\n        round(\n            (case when connection_strength = 'Very Strong Connection' then 25\n                  when connection_strength = 'Strong Connection' then 20\n                  when connection_strength = 'Moderate Connection' then 15\n                  else 10 end) +\n            (case when performance_similarity like '%Very Similar%' then 20\n                  when performance_similarity like '%Similar%' then 15\n                  else 10 end) +\n            (case when collaboration_type like '%Ideal%' then 25\n                  when collaboration_type like '%Good%' then 20\n                  when collaboration_type like '%Mentoring%' then 30\n                  else 15 end) +\n            (case when same_major = 1 then 15 else 10 end) +\n            (case when avg_shared_course_difficulty >= 4 then 15\n                  when avg_shared_course_difficulty >= 3 then 10\n                  else 5 end), 0\n        ) as collaboration_value_score\n    from collaboration_analysis ca\n    left join department_collaboration_metrics dcm \n        on ca.student_a in (\n            select distinct student_a from student_course_connections \n            where department_name = dcm.department_name\n        )\n)\n\nselect * from network_insights\norder by collaboration_value_score desc", "language": "sql", "refs": [{"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_courses", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_semesters", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_students", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_faculty", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_departments", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_class_sessions", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}, {"name": "stg_enrollments", "package": null, "version": null}], "sources": [], "metrics": [], "depends_on": {"macros": [], "nodes": ["model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_class_sessions"]}, "compiled_path": "target/compiled/DbtEducationalDataProject/models/intermediate/int_academic_collaboration_networks.sql", "compiled": true, "compiled_code": "\n\nwith student_course_connections as (\n    select\n        e1.student_id as student_a,\n        e2.student_id as student_b,\n        e1.course_id,\n        e1.semester_id,\n        c.course_code,\n        c.course_name,\n        c.difficulty_level,\n        d.department_name,\n        sem.semester_name,\n        sem.academic_year,\n        s1.full_name as student_a_name,\n        s2.full_name as student_b_name,\n        s1.gpa as student_a_gpa,\n        s2.gpa as student_b_gpa,\n        s1.major_id as student_a_major,\n        s2.major_id as student_b_major,\n        e1.grade_points as student_a_grade,\n        e2.grade_points as student_b_grade,\n        abs(e1.grade_points - e2.grade_points) as grade_difference\n    from \"postgres\".\"edu_dbt\".\"stg_enrollments\" e1\n    inner join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e2 \n        on e1.course_id = e2.course_id \n        and e1.semester_id = e2.semester_id\n        and e1.student_id < e2.student_id  -- Avoid duplicates\n    inner join \"postgres\".\"edu_dbt\".\"stg_courses\" c on e1.course_id = c.course_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_departments\" d on c.department_id = d.department_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_semesters\" sem on e1.semester_id = sem.semester_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_students\" s1 on e1.student_id = s1.student_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_students\" s2 on e2.student_id = s2.student_id\n    where e1.enrollment_status = 'Completed' and e2.enrollment_status = 'Completed'\n),\n\nstudent_collaboration_strength as (\n    select\n        student_a,\n        student_b,\n        student_a_name,\n        student_b_name,\n        count(distinct course_id) as shared_courses,\n        count(distinct semester_id) as shared_semesters,\n        count(distinct department_name) as shared_departments,\n        avg(difficulty_level) as avg_shared_course_difficulty,\n        avg(grade_difference) as avg_grade_difference,\n        corr(student_a_grade, student_b_grade) as grade_correlation,\n        case when student_a_major = student_b_major then 1 else 0 end as same_major,\n        abs(student_a_gpa - student_b_gpa) as gpa_difference,\n        least(student_a_gpa, student_b_gpa) as min_gpa,\n        greatest(student_a_gpa, student_b_gpa) as max_gpa\n    from student_course_connections\n    group by \n        student_a, student_b, student_a_name, student_b_name, \n        student_a_major, student_b_major, student_a_gpa, student_b_gpa\n    having count(distinct course_id) >= 2  -- Only pairs who took multiple courses together\n),\n\ncollaboration_analysis as (\n    select\n        *,\n        case\n            when shared_courses >= 6 then 'Very Strong Connection'\n            when shared_courses >= 4 then 'Strong Connection'\n            when shared_courses >= 3 then 'Moderate Connection'\n            else 'Weak Connection'\n        end as connection_strength,\n        \n        case\n            when grade_correlation >= 0.7 then 'Very Similar Performance'\n            when grade_correlation >= 0.4 then 'Similar Performance'\n            when grade_correlation >= 0.1 then 'Somewhat Similar Performance'\n            when grade_correlation >= -0.1 then 'Unrelated Performance'\n            else 'Opposite Performance Patterns'\n        end as performance_similarity,\n        \n        case\n            when avg_grade_difference <= 0.3 then 'Very Close Academic Peers'\n            when avg_grade_difference <= 0.7 then 'Close Academic Peers'\n            when avg_grade_difference <= 1.2 then 'Moderate Academic Difference'\n            else 'Significant Academic Difference'\n        end as academic_peer_level,\n        \n        case\n            when gpa_difference <= 0.2 and same_major = 1 then 'Ideal Study Partners'\n            when gpa_difference <= 0.5 and shared_departments >= 2 then 'Good Study Partners'\n            when max_gpa - min_gpa >= 1.0 and same_major = 1 then 'Mentoring Opportunity'\n            else 'Diverse Learning Partnership'\n        end as collaboration_type\n    from student_collaboration_strength scs\n),\n\nfaculty_collaboration_networks as (\n    select\n        f1.faculty_id as faculty_a,\n        f2.faculty_id as faculty_b,\n        f1.full_name as faculty_a_name,\n        f2.full_name as faculty_b_name,\n        d1.department_name as faculty_a_dept,\n        d2.department_name as faculty_b_dept,\n        count(distinct cs1.course_id) as shared_teaching_opportunities,\n        count(distinct cs1.semester_id) as semesters_co_teaching,\n        count(distinct e.student_id) as shared_students,\n        avg(e.grade_points) as avg_shared_student_performance,\n        case when f1.department_id = f2.department_id then 1 else 0 end as same_department\n    from \"postgres\".\"edu_dbt\".\"stg_faculty\" f1\n    inner join \"postgres\".\"edu_dbt\".\"stg_faculty\" f2 on f1.faculty_id < f2.faculty_id\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d1 on f1.department_id = d1.department_id\n    left join \"postgres\".\"edu_dbt\".\"stg_departments\" d2 on f2.department_id = d2.department_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs1 on f1.faculty_id = cs1.faculty_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_class_sessions\" cs2 on f2.faculty_id = cs2.faculty_id\n        and cs1.semester_id = cs2.semester_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e on cs1.course_id = e.course_id\n        and cs1.semester_id = e.semester_id\n    inner join \"postgres\".\"edu_dbt\".\"stg_enrollments\" e2 on cs2.course_id = e2.course_id\n        and cs2.semester_id = e2.semester_id\n        and e.student_id = e2.student_id  -- Same student in both courses\n    group by\n        f1.faculty_id, f2.faculty_id, f1.full_name, f2.full_name,\n        d1.department_name, d2.department_name, f1.department_id, f2.department_id\n    having count(distinct e.student_id) >= 3  -- Faculty who share multiple students\n),\n\ndepartment_collaboration_metrics as (\n    select\n        scc.department_name,\n        count(distinct ca.student_a) + count(distinct ca.student_b) as unique_students_in_collaborations,\n        avg(ca.shared_courses) as avg_shared_courses_per_pair,\n        count(case when ca.connection_strength in ('Strong Connection', 'Very Strong Connection') then 1 end) as strong_collaborations,\n        count(case when ca.same_major = 1 then 1 end) as same_major_collaborations,\n        count(case when ca.collaboration_type like '%Mentoring%' then 1 end) as mentoring_opportunities,\n        round(\n            count(case when ca.performance_similarity like '%Similar%' then 1 end) * 100.0 / count(*), 2\n        ) as performance_similarity_rate\n    from student_course_connections scc\n    inner join collaboration_analysis ca\n        on scc.student_a = ca.student_a and scc.student_b = ca.student_b\n    group by scc.department_name\n),\n\nnetwork_insights as (\n    select\n        ca.*,\n        dcm.avg_shared_courses_per_pair as dept_avg_shared_courses,\n        dcm.performance_similarity_rate as dept_similarity_rate,\n        case\n            when ca.shared_courses > dcm.avg_shared_courses_per_pair * 1.5 then 'Above Average Collaboration'\n            when ca.shared_courses < dcm.avg_shared_courses_per_pair * 0.5 then 'Below Average Collaboration'\n            else 'Average Collaboration'\n        end as relative_collaboration_level,\n        \n        -- Network value score\n        round(\n            (case when connection_strength = 'Very Strong Connection' then 25\n                  when connection_strength = 'Strong Connection' then 20\n                  when connection_strength = 'Moderate Connection' then 15\n                  else 10 end) +\n            (case when performance_similarity like '%Very Similar%' then 20\n                  when performance_similarity like '%Similar%' then 15\n                  else 10 end) +\n            (case when collaboration_type like '%Ideal%' then 25\n                  when collaboration_type like '%Good%' then 20\n                  when collaboration_type like '%Mentoring%' then 30\n                  else 15 end) +\n            (case when same_major = 1 then 15 else 10 end) +\n            (case when avg_shared_course_difficulty >= 4 then 15\n                  when avg_shared_course_difficulty >= 3 then 10\n                  else 5 end), 0\n        ) as collaboration_value_score\n    from collaboration_analysis ca\n    left join department_collaboration_metrics dcm \n        on ca.student_a in (\n            select distinct student_a from student_course_connections \n            where department_name = dcm.department_name\n        )\n)\n\nselect * from network_insights\norder by collaboration_value_score desc", "extra_ctes_injected": true, "extra_ctes": [], "contract": {"enforced": false, "alias_types": true, "checksum": null}, "access": "protected", "constraints": [], "version": null, "latest_version": null, "deprecation_date": null}}, "sources": {"source.DbtEducationalDataProject.raw_edu.students": {"database": "postgres", "schema": "raw_edu", "name": "students", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.students", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "students"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "students", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Student master data", "columns": {"student_id": {"name": "student_id", "description": "Unique student identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "email": {"name": "email", "description": "Student email address", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"students\"", "created_at": 1764371903.5270097}, "source.DbtEducationalDataProject.raw_edu.courses": {"database": "postgres", "schema": "raw_edu", "name": "courses", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.courses", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "courses"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "courses", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Course catalog", "columns": {"course_id": {"name": "course_id", "description": "Unique course identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}, "course_code": {"name": "course_code", "description": "Course code", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"courses\"", "created_at": 1764371903.5298288}, "source.DbtEducationalDataProject.raw_edu.departments": {"database": "postgres", "schema": "raw_edu", "name": "departments", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.departments", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "departments"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "departments", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Academic departments", "columns": {"department_id": {"name": "department_id", "description": "Unique department identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"departments\"", "created_at": 1764371903.531426}, "source.DbtEducationalDataProject.raw_edu.faculty": {"database": "postgres", "schema": "raw_edu", "name": "faculty", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.faculty", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "faculty"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "faculty", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Faculty and staff information", "columns": {"faculty_id": {"name": "faculty_id", "description": "Unique faculty identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"faculty\"", "created_at": 1764371903.532794}, "source.DbtEducationalDataProject.raw_edu.enrollments": {"database": "postgres", "schema": "raw_edu", "name": "enrollments", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.enrollments", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "enrollments"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "enrollments", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Student course enrollments", "columns": {"enrollment_id": {"name": "enrollment_id", "description": "Unique enrollment identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"enrollments\"", "created_at": 1764371903.5342274}, "source.DbtEducationalDataProject.raw_edu.semesters": {"database": "postgres", "schema": "raw_edu", "name": "semesters", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.semesters", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "semesters"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "semesters", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Academic semester information", "columns": {"semester_id": {"name": "semester_id", "description": "Unique semester identifier", "meta": {}, "data_type": null, "constraints": [], "quote": null, "tags": []}}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"semesters\"", "created_at": 1764371903.535504}, "source.DbtEducationalDataProject.raw_edu.class_sessions": {"database": "postgres", "schema": "raw_edu", "name": "class_sessions", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.class_sessions", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "class_sessions"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "class_sessions", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Individual class session records", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"class_sessions\"", "created_at": 1764371903.5355725}, "source.DbtEducationalDataProject.raw_edu.assignments": {"database": "postgres", "schema": "raw_edu", "name": "assignments", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.assignments", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "assignments"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "assignments", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Course assignments", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"assignments\"", "created_at": 1764371903.535628}, "source.DbtEducationalDataProject.raw_edu.assignment_submissions": {"database": "postgres", "schema": "raw_edu", "name": "assignment_submissions", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.assignment_submissions", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "assignment_submissions"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "assignment_submissions", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Student assignment submissions", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"assignment_submissions\"", "created_at": 1764371903.5356936}, "source.DbtEducationalDataProject.raw_edu.financial_aid": {"database": "postgres", "schema": "raw_edu", "name": "financial_aid", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.financial_aid", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "financial_aid"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "financial_aid", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Student financial aid records", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"financial_aid\"", "created_at": 1764371903.5358212}, "source.DbtEducationalDataProject.raw_edu.tuition_payments": {"database": "postgres", "schema": "raw_edu", "name": "tuition_payments", "resource_type": "source", "package_name": "DbtEducationalDataProject", "path": "models/staging/sources.yml", "original_file_path": "models/staging/sources.yml", "unique_id": "source.DbtEducationalDataProject.raw_edu.tuition_payments", "fqn": ["DbtEducationalDataProject", "staging", "raw_edu", "tuition_payments"], "source_name": "raw_edu", "source_description": "Raw educational data from various systems", "loader": "", "identifier": "tuition_payments", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "Student tuition payment records", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "\"postgres\".\"raw_edu\".\"tuition_payments\"", "created_at": 1764371903.535909}}, "macros": {"macro.DbtEducationalDataProject.test_referential_integrity": {"name": "test_referential_integrity", "resource_type": "macro", "package_name": "DbtEducationalDataProject", "path": "macros/test_referential_integrity.sql", "original_file_path": "macros/test_referential_integrity.sql", "unique_id": "macro.DbtEducationalDataProject.test_referential_integrity", "macro_sql": "{% macro test_referential_integrity(model, column, ref_model, ref_column) %}\n  select count(*)\n  from {{ model }}\n  where {{ column }} is not null\n    and {{ column }} not in (\n      select {{ ref_column }}\n      from {{ ref_model }}\n      where {{ ref_column }} is not null\n    )\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.8988683, "supported_languages": null}, "macro.DbtEducationalDataProject.calculate_gpa": {"name": "calculate_gpa", "resource_type": "macro", "package_name": "DbtEducationalDataProject", "path": "macros/calculate_gpa.sql", "original_file_path": "macros/calculate_gpa.sql", "unique_id": "macro.DbtEducationalDataProject.calculate_gpa", "macro_sql": "{% macro calculate_gpa(grade_points_column, credits_column, partition_by=none) %}\n    {% if partition_by %}\n        round(\n            sum({{ grade_points_column }} * {{ credits_column }}) over (partition by {{ partition_by }}) / \n            nullif(sum({{ credits_column }}) over (partition by {{ partition_by }}), 0), \n            2\n        )\n    {% else %}\n        round(\n            sum({{ grade_points_column }} * {{ credits_column }}) / \n            nullif(sum({{ credits_column }}), 0), \n            2\n        )\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.8992298, "supported_languages": null}, "macro.DbtEducationalDataProject.grade_point_calculator": {"name": "grade_point_calculator", "resource_type": "macro", "package_name": "DbtEducationalDataProject", "path": "macros/grade_point_calculator.sql", "original_file_path": "macros/grade_point_calculator.sql", "unique_id": "macro.DbtEducationalDataProject.grade_point_calculator", "macro_sql": "{% macro grade_point_calculator(grade_column) %}\n    case \n        when {{ grade_column }} = 'A+' then 4.0\n        when {{ grade_column }} = 'A' then 4.0\n        when {{ grade_column }} = 'A-' then 3.7\n        when {{ grade_column }} = 'B+' then 3.3\n        when {{ grade_column }} = 'B' then 3.0\n        when {{ grade_column }} = 'B-' then 2.7\n        when {{ grade_column }} = 'C+' then 2.3\n        when {{ grade_column }} = 'C' then 2.0\n        when {{ grade_column }} = 'C-' then 1.7\n        when {{ grade_column }} = 'D+' then 1.3\n        when {{ grade_column }} = 'D' then 1.0\n        when {{ grade_column }} = 'D-' then 0.7\n        when {{ grade_column }} in ('F', 'WF') then 0.0\n        else null\n    end\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.8995624, "supported_languages": null}, "macro.DbtEducationalDataProject.academic_year_from_date": {"name": "academic_year_from_date", "resource_type": "macro", "package_name": "DbtEducationalDataProject", "path": "macros/academic_year_from_date.sql", "original_file_path": "macros/academic_year_from_date.sql", "unique_id": "macro.DbtEducationalDataProject.academic_year_from_date", "macro_sql": "{% macro academic_year_from_date(date_column) %}\n    case \n        when extract(month from {{ date_column }}) >= 8 then \n            extract(year from {{ date_column }})::text || '-' || (extract(year from {{ date_column }}) + 1)::text\n        else \n            (extract(year from {{ date_column }}) - 1)::text || '-' || extract(year from {{ date_column }})::text\n    end\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.8997464, "supported_languages": null}, "macro.dbt_postgres.postgres__current_timestamp": {"name": "postgres__current_timestamp", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__current_timestamp", "macro_sql": "{% macro postgres__current_timestamp() -%}\n    now()\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.8999038, "supported_languages": null}, "macro.dbt_postgres.postgres__snapshot_string_as_time": {"name": "postgres__snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__snapshot_string_as_time", "macro_sql": "{% macro postgres__snapshot_string_as_time(timestamp) -%}\n    {%- set result = \"'\" ~ timestamp ~ \"'::timestamp without time zone\" -%}\n    {{ return(result) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9000714, "supported_languages": null}, "macro.dbt_postgres.postgres__snapshot_get_time": {"name": "postgres__snapshot_get_time", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__snapshot_get_time", "macro_sql": "{% macro postgres__snapshot_get_time() -%}\n  {{ current_timestamp() }}::timestamp without time zone\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9001658, "supported_languages": null}, "macro.dbt_postgres.postgres__current_timestamp_backcompat": {"name": "postgres__current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__current_timestamp_backcompat", "macro_sql": "{% macro postgres__current_timestamp_backcompat() %}\n    current_timestamp::{{ type_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9002402, "supported_languages": null}, "macro.dbt_postgres.postgres__current_timestamp_in_utc_backcompat": {"name": "postgres__current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/timestamps.sql", "original_file_path": "macros/timestamps.sql", "unique_id": "macro.dbt_postgres.postgres__current_timestamp_in_utc_backcompat", "macro_sql": "{% macro postgres__current_timestamp_in_utc_backcompat() %}\n    (current_timestamp at time zone 'utc')::{{ type_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9003103, "supported_languages": null}, "macro.dbt_postgres.postgres__get_catalog_relations": {"name": "postgres__get_catalog_relations", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_postgres.postgres__get_catalog_relations", "macro_sql": "{% macro postgres__get_catalog_relations(information_schema, relations) -%}\n  {%- call statement('catalog', fetch_result=True) -%}\n\n    {#\n      If the user has multiple databases set and the first one is wrong, this will fail.\n      But we won't fail in the case where there are multiple quoting-difference-only dbs, which is better.\n    #}\n    {% set database = information_schema.database %}\n    {{ adapter.verify_database(database) }}\n\n    select\n        '{{ database }}' as table_database,\n        sch.nspname as table_schema,\n        tbl.relname as table_name,\n        case tbl.relkind\n            when 'v' then 'VIEW'\n            when 'm' then 'MATERIALIZED VIEW'\n            else 'BASE TABLE'\n        end as table_type,\n        tbl_desc.description as table_comment,\n        col.attname as column_name,\n        col.attnum as column_index,\n        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,\n        col_desc.description as column_comment,\n        pg_get_userbyid(tbl.relowner) as table_owner\n\n    from pg_catalog.pg_namespace sch\n    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid\n    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid\n    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)\n    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)\n    where (\n      {%- for relation in relations -%}\n        {%- if relation.identifier -%}\n          (upper(sch.nspname) = upper('{{ relation.schema }}') and\n           upper(tbl.relname) = upper('{{ relation.identifier }}'))\n        {%- else-%}\n          upper(sch.nspname) = upper('{{ relation.schema }}')\n        {%- endif -%}\n        {%- if not loop.last %} or {% endif -%}\n      {%- endfor -%}\n    )\n      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session\n      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables\n      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table\n      and col.attnum > 0 -- negative numbers are used for system columns such as oid\n      and not col.attisdropped -- column as not been dropped\n\n    order by\n        sch.nspname,\n        tbl.relname,\n        col.attnum\n\n  {%- endcall -%}\n\n  {{ return(load_result('catalog').table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9010637, "supported_languages": null}, "macro.dbt_postgres.postgres__get_catalog": {"name": "postgres__get_catalog", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "unique_id": "macro.dbt_postgres.postgres__get_catalog", "macro_sql": "{% macro postgres__get_catalog(information_schema, schemas) -%}\n  {%- set relations = [] -%}\n  {%- for schema in schemas -%}\n    {%- set dummy = relations.append({'schema': schema}) -%}\n  {%- endfor -%}\n  {{ return(postgres__get_catalog_relations(information_schema, relations)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_catalog_relations"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9012895, "supported_languages": null}, "macro.dbt_postgres.postgres__get_relations": {"name": "postgres__get_relations", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations.sql", "original_file_path": "macros/relations.sql", "unique_id": "macro.dbt_postgres.postgres__get_relations", "macro_sql": "{% macro postgres__get_relations() -%}\n\n  {#\n      -- in pg_depend, objid is the dependent, refobjid is the referenced object\n      --  > a pg_depend entry indicates that the referenced object cannot be\n      --  > dropped without also dropping the dependent object.\n  #}\n\n  {%- call statement('relations', fetch_result=True) -%}\n    with relation as (\n        select\n            pg_rewrite.ev_class as class,\n            pg_rewrite.oid as id\n        from pg_rewrite\n    ),\n    class as (\n        select\n            oid as id,\n            relname as name,\n            relnamespace as schema,\n            relkind as kind\n        from pg_class\n    ),\n    dependency as (\n        select distinct\n            pg_depend.objid as id,\n            pg_depend.refobjid as ref\n        from pg_depend\n    ),\n    schema as (\n        select\n            pg_namespace.oid as id,\n            pg_namespace.nspname as name\n        from pg_namespace\n        where nspname != 'information_schema' and nspname not like 'pg\\_%'\n    ),\n    referenced as (\n        select\n            relation.id AS id,\n            referenced_class.name ,\n            referenced_class.schema ,\n            referenced_class.kind\n        from relation\n        join class as referenced_class on relation.class=referenced_class.id\n        where referenced_class.kind in ('r', 'v', 'm')\n    ),\n    relationships as (\n        select\n            referenced.name as referenced_name,\n            referenced.schema as referenced_schema_id,\n            dependent_class.name as dependent_name,\n            dependent_class.schema as dependent_schema_id,\n            referenced.kind as kind\n        from referenced\n        join dependency on referenced.id=dependency.id\n        join class as dependent_class on dependency.ref=dependent_class.id\n        where\n            (referenced.name != dependent_class.name or\n             referenced.schema != dependent_class.schema)\n    )\n\n    select\n        referenced_schema.name as referenced_schema,\n        relationships.referenced_name as referenced_name,\n        dependent_schema.name as dependent_schema,\n        relationships.dependent_name as dependent_name\n    from relationships\n    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id\n    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id\n    group by referenced_schema, referenced_name, dependent_schema, dependent_name\n    order by referenced_schema, referenced_name, dependent_schema, dependent_name;\n\n  {%- endcall -%}\n\n  {{ return(load_result('relations').table) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9017162, "supported_languages": null}, "macro.dbt_postgres.postgres_get_relations": {"name": "postgres_get_relations", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations.sql", "original_file_path": "macros/relations.sql", "unique_id": "macro.dbt_postgres.postgres_get_relations", "macro_sql": "{% macro postgres_get_relations() %}\n  {{ return(postgres__get_relations()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_relations"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9017982, "supported_languages": null}, "macro.dbt_postgres.postgres__create_table_as": {"name": "postgres__create_table_as", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__create_table_as", "macro_sql": "{% macro postgres__create_table_as(temporary, relation, sql) -%}\n  {%- set unlogged = config.get('unlogged', default=false) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary -%}\n    temporary\n  {%- elif unlogged -%}\n    unlogged\n  {%- endif %} table {{ relation }}\n  {% set contract_config = config.get('contract') %}\n  {% if contract_config.enforced %}\n    {{ get_assert_columns_equivalent(sql) }}\n  {% endif -%}\n  {% if contract_config.enforced and (not temporary) -%}\n      {{ get_table_columns_and_constraints() }} ;\n    insert into {{ relation }} (\n      {{ adapter.dispatch('get_column_names', 'dbt')() }}\n    )\n    {%- set sql = get_select_subquery(sql) %}\n  {% else %}\n    as\n  {% endif %}\n  (\n    {{ sql }}\n  );\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_table_columns_and_constraints", "macro.dbt.default__get_column_names", "macro.dbt.get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.903547, "supported_languages": null}, "macro.dbt_postgres.postgres__get_create_index_sql": {"name": "postgres__get_create_index_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__get_create_index_sql", "macro_sql": "{% macro postgres__get_create_index_sql(relation, index_dict) -%}\n  {%- set index_config = adapter.parse_index(index_dict) -%}\n  {%- set comma_separated_columns = \", \".join(index_config.columns) -%}\n  {%- set index_name = index_config.render(relation) -%}\n\n  create {% if index_config.unique -%}\n    unique\n  {%- endif %} index if not exists\n  \"{{ index_name }}\"\n  on {{ relation }} {% if index_config.type -%}\n    using {{ index_config.type }}\n  {%- endif %}\n  ({{ comma_separated_columns }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9044964, "supported_languages": null}, "macro.dbt_postgres.postgres__create_schema": {"name": "postgres__create_schema", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__create_schema", "macro_sql": "{% macro postgres__create_schema(relation) -%}\n  {% if relation.database -%}\n    {{ adapter.verify_database(relation.database) }}\n  {%- endif -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier().include(database=False) }}\n  {%- endcall -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9049473, "supported_languages": null}, "macro.dbt_postgres.postgres__drop_schema": {"name": "postgres__drop_schema", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__drop_schema", "macro_sql": "{% macro postgres__drop_schema(relation) -%}\n  {% if relation.database -%}\n    {{ adapter.verify_database(relation.database) }}\n  {%- endif -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier().include(database=False) }} cascade\n  {%- endcall -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.905462, "supported_languages": null}, "macro.dbt_postgres.postgres__get_columns_in_relation": {"name": "postgres__get_columns_in_relation", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__get_columns_in_relation", "macro_sql": "{% macro postgres__get_columns_in_relation(relation) -%}\n  {% call statement('get_columns_in_relation', fetch_result=True) %}\n      select\n          column_name,\n          data_type,\n          character_maximum_length,\n          numeric_precision,\n          numeric_scale\n\n      from {{ relation.information_schema('columns') }}\n      where table_name = '{{ relation.identifier }}'\n        {% if relation.schema %}\n        and table_schema = '{{ relation.schema }}'\n        {% endif %}\n      order by ordinal_position\n\n  {% endcall %}\n  {% set table = load_result('get_columns_in_relation').table %}\n  {{ return(sql_convert_columns_in_relation(table)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.sql_convert_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9059234, "supported_languages": null}, "macro.dbt_postgres.postgres__list_relations_without_caching": {"name": "postgres__list_relations_without_caching", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__list_relations_without_caching", "macro_sql": "{% macro postgres__list_relations_without_caching(schema_relation) %}\n  {% call statement('list_relations_without_caching', fetch_result=True) -%}\n    select\n      '{{ schema_relation.database }}' as database,\n      tablename as name,\n      schemaname as schema,\n      'table' as type\n    from pg_tables\n    where schemaname ilike '{{ schema_relation.schema }}'\n    union all\n    select\n      '{{ schema_relation.database }}' as database,\n      viewname as name,\n      schemaname as schema,\n      'view' as type\n    from pg_views\n    where schemaname ilike '{{ schema_relation.schema }}'\n    union all\n    select\n      '{{ schema_relation.database }}' as database,\n      matviewname as name,\n      schemaname as schema,\n      'materialized_view' as type\n    from pg_matviews\n    where schemaname ilike '{{ schema_relation.schema }}'\n  {% endcall %}\n  {{ return(load_result('list_relations_without_caching').table) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9062605, "supported_languages": null}, "macro.dbt_postgres.postgres__information_schema_name": {"name": "postgres__information_schema_name", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__information_schema_name", "macro_sql": "{% macro postgres__information_schema_name(database) -%}\n  {% if database_name -%}\n    {{ adapter.verify_database(database_name) }}\n  {%- endif -%}\n  information_schema\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9063888, "supported_languages": null}, "macro.dbt_postgres.postgres__list_schemas": {"name": "postgres__list_schemas", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__list_schemas", "macro_sql": "{% macro postgres__list_schemas(database) %}\n  {% if database -%}\n    {{ adapter.verify_database(database) }}\n  {%- endif -%}\n  {% call statement('list_schemas', fetch_result=True, auto_begin=False) %}\n    select distinct nspname from pg_namespace\n  {% endcall %}\n  {{ return(load_result('list_schemas').table) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.906617, "supported_languages": null}, "macro.dbt_postgres.postgres__check_schema_exists": {"name": "postgres__check_schema_exists", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__check_schema_exists", "macro_sql": "{% macro postgres__check_schema_exists(information_schema, schema) -%}\n  {% if information_schema.database -%}\n    {{ adapter.verify_database(information_schema.database) }}\n  {%- endif -%}\n  {% call statement('check_schema_exists', fetch_result=True, auto_begin=False) %}\n    select count(*) from pg_namespace where nspname = '{{ schema }}'\n  {% endcall %}\n  {{ return(load_result('check_schema_exists').table) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.906867, "supported_languages": null}, "macro.dbt_postgres.postgres__make_relation_with_suffix": {"name": "postgres__make_relation_with_suffix", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__make_relation_with_suffix", "macro_sql": "{% macro postgres__make_relation_with_suffix(base_relation, suffix, dstring) %}\n    {% if dstring %}\n      {% set dt = modules.datetime.datetime.now() %}\n      {% set dtstring = dt.strftime(\"%H%M%S%f\") %}\n      {% set suffix = suffix ~ dtstring %}\n    {% endif %}\n    {% set suffix_length = suffix|length %}\n    {% set relation_max_name_length = base_relation.relation_max_name_length() %}\n    {% if suffix_length > relation_max_name_length %}\n        {% do exceptions.raise_compiler_error('Relation suffix is too long (' ~ suffix_length ~ ' characters). Maximum length is ' ~ relation_max_name_length ~ ' characters.') %}\n    {% endif %}\n    {% set identifier = base_relation.identifier[:relation_max_name_length - suffix_length] ~ suffix %}\n\n    {{ return(base_relation.incorporate(path={\"identifier\": identifier })) }}\n\n  {% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9074426, "supported_languages": null}, "macro.dbt_postgres.postgres__make_intermediate_relation": {"name": "postgres__make_intermediate_relation", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__make_intermediate_relation", "macro_sql": "{% macro postgres__make_intermediate_relation(base_relation, suffix) %}\n    {{ return(postgres__make_relation_with_suffix(base_relation, suffix, dstring=False)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9075766, "supported_languages": null}, "macro.dbt_postgres.postgres__make_temp_relation": {"name": "postgres__make_temp_relation", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__make_temp_relation", "macro_sql": "{% macro postgres__make_temp_relation(base_relation, suffix) %}\n    {% set temp_relation = postgres__make_relation_with_suffix(base_relation, suffix, dstring=True) %}\n    {{ return(temp_relation.incorporate(path={\"schema\": none,\n                                              \"database\": none})) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.90778, "supported_languages": null}, "macro.dbt_postgres.postgres__make_backup_relation": {"name": "postgres__make_backup_relation", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__make_backup_relation", "macro_sql": "{% macro postgres__make_backup_relation(base_relation, backup_relation_type, suffix) %}\n    {% set backup_relation = postgres__make_relation_with_suffix(base_relation, suffix, dstring=False) %}\n    {{ return(backup_relation.incorporate(type=backup_relation_type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_relation_with_suffix"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9079409, "supported_languages": null}, "macro.dbt_postgres.postgres_escape_comment": {"name": "postgres_escape_comment", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres_escape_comment", "macro_sql": "{% macro postgres_escape_comment(comment) -%}\n  {% if comment is not string %}\n    {% do exceptions.raise_compiler_error('cannot escape a non-string: ' ~ comment) %}\n  {% endif %}\n  {%- set magic = '$dbt_comment_literal_block$' -%}\n  {%- if magic in comment -%}\n    {%- do exceptions.raise_compiler_error('The string ' ~ magic ~ ' is not allowed in comments.') -%}\n  {%- endif -%}\n  {{ magic }}{{ comment }}{{ magic }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9082057, "supported_languages": null}, "macro.dbt_postgres.postgres__alter_relation_comment": {"name": "postgres__alter_relation_comment", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__alter_relation_comment", "macro_sql": "{% macro postgres__alter_relation_comment(relation, comment) %}\n  {% set escaped_comment = postgres_escape_comment(comment) %}\n  comment on {{ relation.type }} {{ relation }} is {{ escaped_comment }};\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres_escape_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9083424, "supported_languages": null}, "macro.dbt_postgres.postgres__alter_column_comment": {"name": "postgres__alter_column_comment", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__alter_column_comment", "macro_sql": "{% macro postgres__alter_column_comment(relation, column_dict) %}\n  {% set existing_columns = adapter.get_columns_in_relation(relation) | map(attribute=\"name\") | list %}\n  {% for column_name in column_dict if (column_name in existing_columns) %}\n    {% set comment = column_dict[column_name]['description'] %}\n    {% set escaped_comment = postgres_escape_comment(comment) %}\n    comment on column {{ relation }}.{{ adapter.quote(column_name) if column_dict[column_name]['quote'] else column_name }} is {{ escaped_comment }};\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres_escape_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9088345, "supported_languages": null}, "macro.dbt_postgres.postgres__get_show_grant_sql": {"name": "postgres__get_show_grant_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__get_show_grant_sql", "macro_sql": "\n\n{%- macro postgres__get_show_grant_sql(relation) -%}\n  select grantee, privilege_type\n  from {{ relation.information_schema('role_table_grants') }}\n      where grantor = current_role\n        and grantee != current_role\n        and table_schema = '{{ relation.schema }}'\n        and table_name = '{{ relation.identifier }}'\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9090018, "supported_languages": null}, "macro.dbt_postgres.postgres__copy_grants": {"name": "postgres__copy_grants", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__copy_grants", "macro_sql": "{% macro postgres__copy_grants() %}\n    {{ return(False) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9091065, "supported_languages": null}, "macro.dbt_postgres.postgres__get_show_indexes_sql": {"name": "postgres__get_show_indexes_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__get_show_indexes_sql", "macro_sql": "{% macro postgres__get_show_indexes_sql(relation) %}\n    select\n        i.relname                                   as name,\n        m.amname                                    as method,\n        ix.indisunique                              as \"unique\",\n        array_to_string(array_agg(a.attname), ',')  as column_names\n    from pg_index ix\n    join pg_class i\n        on i.oid = ix.indexrelid\n    join pg_am m\n        on m.oid=i.relam\n    join pg_class t\n        on t.oid = ix.indrelid\n    join pg_namespace n\n        on n.oid = t.relnamespace\n    join pg_attribute a\n        on a.attrelid = t.oid\n        and a.attnum = ANY(ix.indkey)\n    where t.relname = '{{ relation.identifier }}'\n      and n.nspname = '{{ relation.schema }}'\n      and t.relkind in ('r', 'm')\n    group by 1, 2, 3\n    order by 1, 2, 3\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.909238, "supported_languages": null}, "macro.dbt_postgres.postgres__get_drop_index_sql": {"name": "postgres__get_drop_index_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "unique_id": "macro.dbt_postgres.postgres__get_drop_index_sql", "macro_sql": "\n\n\n{%- macro postgres__get_drop_index_sql(relation, index_name) -%}\n    drop index if exists \"{{ relation.schema }}\".\"{{ index_name }}\"\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9093316, "supported_languages": null}, "macro.dbt_postgres.postgres__listagg": {"name": "postgres__listagg", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "unique_id": "macro.dbt_postgres.postgres__listagg", "macro_sql": "{% macro postgres__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        (array_agg(\n            {{ measure }}\n            {% if order_by_clause -%}\n            {{ order_by_clause }}\n            {%- endif %}\n        ))[1:{{ limit_num }}],\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    string_agg(\n        {{ measure }},\n        {{ delimiter_text }}\n        {% if order_by_clause -%}\n        {{ order_by_clause }}\n        {%- endif %}\n        )\n    {%- endif %}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.909694, "supported_languages": null}, "macro.dbt_postgres.postgres__datediff": {"name": "postgres__datediff", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "unique_id": "macro.dbt_postgres.postgres__datediff", "macro_sql": "{% macro postgres__datediff(first_date, second_date, datepart) -%}\n\n    {% if datepart == 'year' %}\n        (date_part('year', ({{second_date}})::date) - date_part('year', ({{first_date}})::date))\n    {% elif datepart == 'quarter' %}\n        ({{ datediff(first_date, second_date, 'year') }} * 4 + date_part('quarter', ({{second_date}})::date) - date_part('quarter', ({{first_date}})::date))\n    {% elif datepart == 'month' %}\n        ({{ datediff(first_date, second_date, 'year') }} * 12 + date_part('month', ({{second_date}})::date) - date_part('month', ({{first_date}})::date))\n    {% elif datepart == 'day' %}\n        (({{second_date}})::date - ({{first_date}})::date)\n    {% elif datepart == 'week' %}\n        ({{ datediff(first_date, second_date, 'day') }} / 7 + case\n            when date_part('dow', ({{first_date}})::timestamp) <= date_part('dow', ({{second_date}})::timestamp) then\n                case when {{first_date}} <= {{second_date}} then 0 else -1 end\n            else\n                case when {{first_date}} <= {{second_date}} then 1 else 0 end\n        end)\n    {% elif datepart == 'hour' %}\n        ({{ datediff(first_date, second_date, 'day') }} * 24 + date_part('hour', ({{second_date}})::timestamp) - date_part('hour', ({{first_date}})::timestamp))\n    {% elif datepart == 'minute' %}\n        ({{ datediff(first_date, second_date, 'hour') }} * 60 + date_part('minute', ({{second_date}})::timestamp) - date_part('minute', ({{first_date}})::timestamp))\n    {% elif datepart == 'second' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60 + floor(date_part('second', ({{second_date}})::timestamp)) - floor(date_part('second', ({{first_date}})::timestamp)))\n    {% elif datepart == 'millisecond' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60000 + floor(date_part('millisecond', ({{second_date}})::timestamp)) - floor(date_part('millisecond', ({{first_date}})::timestamp)))\n    {% elif datepart == 'microsecond' %}\n        ({{ datediff(first_date, second_date, 'minute') }} * 60000000 + floor(date_part('microsecond', ({{second_date}})::timestamp)) - floor(date_part('microsecond', ({{first_date}})::timestamp)))\n    {% else %}\n        {{ exceptions.raise_compiler_error(\"Unsupported datepart for macro datediff in postgres: {!r}\".format(datepart)) }}\n    {% endif %}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9109552, "supported_languages": null}, "macro.dbt_postgres.postgres__split_part": {"name": "postgres__split_part", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt_postgres.postgres__split_part", "macro_sql": "{% macro postgres__split_part(string_text, delimiter_text, part_number) %}\n\n  {% if part_number >= 0 %}\n    {{ dbt.default__split_part(string_text, delimiter_text, part_number) }}\n  {% else %}\n    {{ dbt._split_part_negative(string_text, delimiter_text, part_number) }}\n  {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__split_part", "macro.dbt._split_part_negative"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9112427, "supported_languages": null}, "macro.dbt_postgres.postgres__dateadd": {"name": "postgres__dateadd", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "unique_id": "macro.dbt_postgres.postgres__dateadd", "macro_sql": "{% macro postgres__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    {{ from_date_or_timestamp }} + ((interval '1 {{ datepart }}') * ({{ interval }}))\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9113746, "supported_languages": null}, "macro.dbt_postgres.postgres__any_value": {"name": "postgres__any_value", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "unique_id": "macro.dbt_postgres.postgres__any_value", "macro_sql": "{% macro postgres__any_value(expression) -%}\n\n    min({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9114678, "supported_languages": null}, "macro.dbt_postgres.postgres__last_day": {"name": "postgres__last_day", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt_postgres.postgres__last_day", "macro_sql": "{% macro postgres__last_day(date, datepart) -%}\n\n    {%- if datepart == 'quarter' -%}\n    -- postgres dateadd does not support quarter interval.\n    cast(\n        {{dbt.dateadd('day', '-1',\n        dbt.dateadd('month', '3', dbt.date_trunc(datepart, date))\n        )}}\n        as date)\n    {%- else -%}\n    {{dbt.default_last_day(date, datepart)}}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.date_trunc", "macro.dbt.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9117746, "supported_languages": null}, "macro.dbt_postgres.postgres__get_replace_view_sql": {"name": "postgres__get_replace_view_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt_postgres.postgres__get_replace_view_sql", "macro_sql": "{% macro postgres__get_replace_view_sql(relation, sql) -%}\n\n    {%- set sql_header = config.get('sql_header', none) -%}\n    {{ sql_header if sql_header is not none }}\n\n    create or replace view {{ relation }}\n        {% set contract_config = config.get('contract') %}\n        {% if contract_config.enforced %}\n            {{ get_assert_columns_equivalent(sql) }}\n        {%- endif %}\n    as (\n        {{ sql }}\n    );\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9121182, "supported_languages": null}, "macro.dbt_postgres.postgres__drop_view": {"name": "postgres__drop_view", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/view/drop.sql", "original_file_path": "macros/relations/view/drop.sql", "unique_id": "macro.dbt_postgres.postgres__drop_view", "macro_sql": "{% macro postgres__drop_view(relation) -%}\n    drop view if exists {{ relation }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.912213, "supported_languages": null}, "macro.dbt_postgres.postgres__get_rename_view_sql": {"name": "postgres__get_rename_view_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/view/rename.sql", "original_file_path": "macros/relations/view/rename.sql", "unique_id": "macro.dbt_postgres.postgres__get_rename_view_sql", "macro_sql": "{% macro postgres__get_rename_view_sql(relation, new_name) %}\n    alter view {{ relation }} rename to {{ new_name }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.912318, "supported_languages": null}, "macro.dbt_postgres.postgres__get_replace_table_sql": {"name": "postgres__get_replace_table_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/table/replace.sql", "original_file_path": "macros/relations/table/replace.sql", "unique_id": "macro.dbt_postgres.postgres__get_replace_table_sql", "macro_sql": "{% macro postgres__get_replace_table_sql(relation, sql) -%}\n\n    {%- set sql_header = config.get('sql_header', none) -%}\n    {{ sql_header if sql_header is not none }}\n\n    create or replace table {{ relation }}\n        {% set contract_config = config.get('contract') %}\n        {% if contract_config.enforced %}\n            {{ get_assert_columns_equivalent(sql) }}\n            {{ get_table_columns_and_constraints() }}\n            {%- set sql = get_select_subquery(sql) %}\n        {% endif %}\n    as (\n        {{ sql }}\n    );\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_table_columns_and_constraints", "macro.dbt.get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9127982, "supported_languages": null}, "macro.dbt_postgres.postgres__drop_table": {"name": "postgres__drop_table", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/table/drop.sql", "original_file_path": "macros/relations/table/drop.sql", "unique_id": "macro.dbt_postgres.postgres__drop_table", "macro_sql": "{% macro postgres__drop_table(relation) -%}\n    drop table if exists {{ relation }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9128952, "supported_languages": null}, "macro.dbt_postgres.postgres__get_rename_table_sql": {"name": "postgres__get_rename_table_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/table/rename.sql", "original_file_path": "macros/relations/table/rename.sql", "unique_id": "macro.dbt_postgres.postgres__get_rename_table_sql", "macro_sql": "{% macro postgres__get_rename_table_sql(relation, new_name) %}\n    alter table {{ relation }} rename to {{ new_name }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.913001, "supported_languages": null}, "macro.dbt_postgres.postgres__get_alter_materialized_view_as_sql": {"name": "postgres__get_alter_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt_postgres.postgres__get_alter_materialized_view_as_sql", "macro_sql": "{% macro postgres__get_alter_materialized_view_as_sql(\n    relation,\n    configuration_changes,\n    sql,\n    existing_relation,\n    backup_relation,\n    intermediate_relation\n) %}\n\n    -- apply a full refresh immediately if needed\n    {% if configuration_changes.requires_full_refresh %}\n\n        {{ get_replace_sql(existing_relation, relation, sql) }}\n\n    -- otherwise apply individual changes as needed\n    {% else %}\n\n        {{ postgres__update_indexes_on_materialized_view(relation, configuration_changes.indexes) }}\n\n    {%- endif -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_replace_sql", "macro.dbt_postgres.postgres__update_indexes_on_materialized_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9133556, "supported_languages": null}, "macro.dbt_postgres.postgres__update_indexes_on_materialized_view": {"name": "postgres__update_indexes_on_materialized_view", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt_postgres.postgres__update_indexes_on_materialized_view", "macro_sql": "\n\n\n{%- macro postgres__update_indexes_on_materialized_view(relation, index_changes) -%}\n    {{- log(\"Applying UPDATE INDEXES to: \" ~ relation) -}}\n\n    {%- for _index_change in index_changes -%}\n        {%- set _index = _index_change.context -%}\n\n        {%- if _index_change.action == \"drop\" -%}\n\n            {{ postgres__get_drop_index_sql(relation, _index.name) }};\n\n        {%- elif _index_change.action == \"create\" -%}\n\n            {{ postgres__get_create_index_sql(relation, _index.as_node_config) }}\n\n        {%- endif -%}\n\n    {%- endfor -%}\n\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_drop_index_sql", "macro.dbt_postgres.postgres__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9136477, "supported_languages": null}, "macro.dbt_postgres.postgres__get_materialized_view_configuration_changes": {"name": "postgres__get_materialized_view_configuration_changes", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt_postgres.postgres__get_materialized_view_configuration_changes", "macro_sql": "{% macro postgres__get_materialized_view_configuration_changes(existing_relation, new_config) %}\n    {% set _existing_materialized_view = postgres__describe_materialized_view(existing_relation) %}\n    {% set _configuration_changes = existing_relation.get_materialized_view_config_change_collection(_existing_materialized_view, new_config.model) %}\n    {% do return(_configuration_changes) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__describe_materialized_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9138343, "supported_languages": null}, "macro.dbt_postgres.postgres__get_create_materialized_view_as_sql": {"name": "postgres__get_create_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/materialized_view/create.sql", "original_file_path": "macros/relations/materialized_view/create.sql", "unique_id": "macro.dbt_postgres.postgres__get_create_materialized_view_as_sql", "macro_sql": "{% macro postgres__get_create_materialized_view_as_sql(relation, sql) %}\n    create materialized view if not exists {{ relation }} as {{ sql }};\n\n    {% for _index_dict in config.get('indexes', []) -%}\n        {{- get_create_index_sql(relation, _index_dict) -}}\n    {%- endfor -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9140654, "supported_languages": null}, "macro.dbt_postgres.postgres__drop_materialized_view": {"name": "postgres__drop_materialized_view", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/materialized_view/drop.sql", "original_file_path": "macros/relations/materialized_view/drop.sql", "unique_id": "macro.dbt_postgres.postgres__drop_materialized_view", "macro_sql": "{% macro postgres__drop_materialized_view(relation) -%}\n    drop materialized view if exists {{ relation }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9141662, "supported_languages": null}, "macro.dbt_postgres.postgres__get_rename_materialized_view_sql": {"name": "postgres__get_rename_materialized_view_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/materialized_view/rename.sql", "original_file_path": "macros/relations/materialized_view/rename.sql", "unique_id": "macro.dbt_postgres.postgres__get_rename_materialized_view_sql", "macro_sql": "{% macro postgres__get_rename_materialized_view_sql(relation, new_name) %}\n    alter materialized view {{ relation }} rename to {{ new_name }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9142754, "supported_languages": null}, "macro.dbt_postgres.postgres__refresh_materialized_view": {"name": "postgres__refresh_materialized_view", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/materialized_view/refresh.sql", "original_file_path": "macros/relations/materialized_view/refresh.sql", "unique_id": "macro.dbt_postgres.postgres__refresh_materialized_view", "macro_sql": "{% macro postgres__refresh_materialized_view(relation) %}\n    refresh materialized view {{ relation }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9143622, "supported_languages": null}, "macro.dbt_postgres.postgres__describe_materialized_view": {"name": "postgres__describe_materialized_view", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/relations/materialized_view/describe.sql", "original_file_path": "macros/relations/materialized_view/describe.sql", "unique_id": "macro.dbt_postgres.postgres__describe_materialized_view", "macro_sql": "{% macro postgres__describe_materialized_view(relation) %}\n    -- for now just get the indexes, we don't need the name or the query yet\n    {% set _indexes = run_query(get_show_indexes_sql(relation)) %}\n    {% do return({'indexes': _indexes}) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.get_show_indexes_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9145737, "supported_languages": null}, "macro.dbt_postgres.postgres__get_incremental_default_sql": {"name": "postgres__get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/materializations/incremental_strategies.sql", "original_file_path": "macros/materializations/incremental_strategies.sql", "unique_id": "macro.dbt_postgres.postgres__get_incremental_default_sql", "macro_sql": "{% macro postgres__get_incremental_default_sql(arg_dict) %}\n\n  {% if arg_dict[\"unique_key\"] %}\n    {% do return(get_incremental_delete_insert_sql(arg_dict)) %}\n  {% else %}\n    {% do return(get_incremental_append_sql(arg_dict)) %}\n  {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_incremental_delete_insert_sql", "macro.dbt.get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9147995, "supported_languages": null}, "macro.dbt_postgres.postgres__snapshot_merge_sql": {"name": "postgres__snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt_postgres", "path": "macros/materializations/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshot_merge.sql", "unique_id": "macro.dbt_postgres.postgres__snapshot_merge_sql", "macro_sql": "{% macro postgres__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    update {{ target }}\n    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n    from {{ source }} as DBT_INTERNAL_SOURCE\n    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = {{ target }}.dbt_scd_id::text\n      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)\n      and {{ target }}.dbt_valid_to is null;\n\n    insert into {{ target }} ({{ insert_cols_csv }})\n    select {% for column in insert_cols -%}\n        DBT_INTERNAL_SOURCE.{{ column }} {%- if not loop.last %}, {%- endif %}\n    {%- endfor %}\n    from {{ source }} as DBT_INTERNAL_SOURCE\n    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.915192, "supported_languages": null}, "macro.dbt.create_schema": {"name": "create_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema', 'dbt')(relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__create_schema"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.915404, "supported_languages": null}, "macro.dbt.default__create_schema": {"name": "default__create_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9155164, "supported_languages": null}, "macro.dbt.drop_schema": {"name": "drop_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema', 'dbt')(relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__drop_schema"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9156194, "supported_languages": null}, "macro.dbt.default__drop_schema": {"name": "default__drop_schema", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "unique_id": "macro.dbt.default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9157338, "supported_languages": null}, "macro.dbt.copy_grants": {"name": "copy_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.copy_grants", "macro_sql": "{% macro copy_grants() %}\n    {{ return(adapter.dispatch('copy_grants', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9164832, "supported_languages": null}, "macro.dbt.default__copy_grants": {"name": "default__copy_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__copy_grants", "macro_sql": "{% macro default__copy_grants() %}\n    {{ return(True) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9165535, "supported_languages": null}, "macro.dbt.support_multiple_grantees_per_dcl_statement": {"name": "support_multiple_grantees_per_dcl_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.support_multiple_grantees_per_dcl_statement", "macro_sql": "{% macro support_multiple_grantees_per_dcl_statement() %}\n    {{ return(adapter.dispatch('support_multiple_grantees_per_dcl_statement', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9166608, "supported_languages": null}, "macro.dbt.default__support_multiple_grantees_per_dcl_statement": {"name": "default__support_multiple_grantees_per_dcl_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__support_multiple_grantees_per_dcl_statement", "macro_sql": "\n\n{%- macro default__support_multiple_grantees_per_dcl_statement() -%}\n    {{ return(True) }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9167309, "supported_languages": null}, "macro.dbt.should_revoke": {"name": "should_revoke", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.should_revoke", "macro_sql": "{% macro should_revoke(existing_relation, full_refresh_mode=True) %}\n\n    {% if not existing_relation %}\n        {#-- The table doesn't already exist, so no grants to copy over --#}\n        {{ return(False) }}\n    {% elif full_refresh_mode %}\n        {#-- The object is being REPLACED -- whether grants are copied over depends on the value of user config --#}\n        {{ return(copy_grants()) }}\n    {% else %}\n        {#-- The table is being merged/upserted/inserted -- grants will be carried over --#}\n        {{ return(True) }}\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.copy_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9169421, "supported_languages": null}, "macro.dbt.get_show_grant_sql": {"name": "get_show_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_show_grant_sql", "macro_sql": "{% macro get_show_grant_sql(relation) %}\n    {{ return(adapter.dispatch(\"get_show_grant_sql\", \"dbt\")(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_show_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9170568, "supported_languages": null}, "macro.dbt.default__get_show_grant_sql": {"name": "default__get_show_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_show_grant_sql", "macro_sql": "{% macro default__get_show_grant_sql(relation) %}\n    show grants on {{ relation.render() }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.917137, "supported_languages": null}, "macro.dbt.get_grant_sql": {"name": "get_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_grant_sql", "macro_sql": "{% macro get_grant_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_grant_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_grant_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9172711, "supported_languages": null}, "macro.dbt.default__get_grant_sql": {"name": "default__get_grant_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_grant_sql", "macro_sql": "\n\n{%- macro default__get_grant_sql(relation, privilege, grantees) -%}\n    grant {{ privilege }} on {{ relation.render() }} to {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9174712, "supported_languages": null}, "macro.dbt.get_revoke_sql": {"name": "get_revoke_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_revoke_sql", "macro_sql": "{% macro get_revoke_sql(relation, privilege, grantees) %}\n    {{ return(adapter.dispatch('get_revoke_sql', 'dbt')(relation, privilege, grantees)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_revoke_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.917606, "supported_languages": null}, "macro.dbt.default__get_revoke_sql": {"name": "default__get_revoke_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_revoke_sql", "macro_sql": "\n\n{%- macro default__get_revoke_sql(relation, privilege, grantees) -%}\n    revoke {{ privilege }} on {{ relation.render() }} from {{ grantees | join(', ') }}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.917737, "supported_languages": null}, "macro.dbt.get_dcl_statement_list": {"name": "get_dcl_statement_list", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.get_dcl_statement_list", "macro_sql": "{% macro get_dcl_statement_list(relation, grant_config, get_dcl_macro) %}\n    {{ return(adapter.dispatch('get_dcl_statement_list', 'dbt')(relation, grant_config, get_dcl_macro)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_dcl_statement_list"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9178672, "supported_languages": null}, "macro.dbt.default__get_dcl_statement_list": {"name": "default__get_dcl_statement_list", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__get_dcl_statement_list", "macro_sql": "\n\n{%- macro default__get_dcl_statement_list(relation, grant_config, get_dcl_macro) -%}\n    {#\n      -- Unpack grant_config into specific privileges and the set of users who need them granted/revoked.\n      -- Depending on whether this database supports multiple grantees per statement, pass in the list of\n      -- all grantees per privilege, or (if not) template one statement per privilege-grantee pair.\n      -- `get_dcl_macro` will be either `get_grant_sql` or `get_revoke_sql`\n    #}\n    {%- set dcl_statements = [] -%}\n    {%- for privilege, grantees in grant_config.items() %}\n        {%- if support_multiple_grantees_per_dcl_statement() and grantees -%}\n          {%- set dcl = get_dcl_macro(relation, privilege, grantees) -%}\n          {%- do dcl_statements.append(dcl) -%}\n        {%- else -%}\n          {%- for grantee in grantees -%}\n              {% set dcl = get_dcl_macro(relation, privilege, [grantee]) %}\n              {%- do dcl_statements.append(dcl) -%}\n          {% endfor -%}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return(dcl_statements) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.support_multiple_grantees_per_dcl_statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9182923, "supported_languages": null}, "macro.dbt.call_dcl_statements": {"name": "call_dcl_statements", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.call_dcl_statements", "macro_sql": "{% macro call_dcl_statements(dcl_statement_list) %}\n    {{ return(adapter.dispatch(\"call_dcl_statements\", \"dbt\")(dcl_statement_list)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9184046, "supported_languages": null}, "macro.dbt.default__call_dcl_statements": {"name": "default__call_dcl_statements", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__call_dcl_statements", "macro_sql": "{% macro default__call_dcl_statements(dcl_statement_list) %}\n    {#\n      -- By default, supply all grant + revoke statements in a single semicolon-separated block,\n      -- so that they're all processed together.\n\n      -- Some databases do not support this. Those adapters will need to override this macro\n      -- to run each statement individually.\n    #}\n    {% call statement('grants') %}\n        {% for dcl_statement in dcl_statement_list %}\n            {{ dcl_statement }};\n        {% endfor %}\n    {% endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9185567, "supported_languages": null}, "macro.dbt.apply_grants": {"name": "apply_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.apply_grants", "macro_sql": "{% macro apply_grants(relation, grant_config, should_revoke) %}\n    {{ return(adapter.dispatch(\"apply_grants\", \"dbt\")(relation, grant_config, should_revoke)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9186933, "supported_languages": null}, "macro.dbt.default__apply_grants": {"name": "default__apply_grants", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/apply_grants.sql", "original_file_path": "macros/adapters/apply_grants.sql", "unique_id": "macro.dbt.default__apply_grants", "macro_sql": "{% macro default__apply_grants(relation, grant_config, should_revoke=True) %}\n    {#-- If grant_config is {} or None, this is a no-op --#}\n    {% if grant_config %}\n        {% if should_revoke %}\n            {#-- We think previous grants may have carried over --#}\n            {#-- Show current grants and calculate diffs --#}\n            {% set current_grants_table = run_query(get_show_grant_sql(relation)) %}\n            {% set current_grants_dict = adapter.standardize_grants_dict(current_grants_table) %}\n            {% set needs_granting = diff_of_two_dicts(grant_config, current_grants_dict) %}\n            {% set needs_revoking = diff_of_two_dicts(current_grants_dict, grant_config) %}\n            {% if not (needs_granting or needs_revoking) %}\n                {{ log('On ' ~ relation.render() ~': All grants are in place, no revocation or granting needed.')}}\n            {% endif %}\n        {% else %}\n            {#-- We don't think there's any chance of previous grants having carried over. --#}\n            {#-- Jump straight to granting what the user has configured. --#}\n            {% set needs_revoking = {} %}\n            {% set needs_granting = grant_config %}\n        {% endif %}\n        {% if needs_granting or needs_revoking %}\n            {% set revoke_statement_list = get_dcl_statement_list(relation, needs_revoking, get_revoke_sql) %}\n            {% set grant_statement_list = get_dcl_statement_list(relation, needs_granting, get_grant_sql) %}\n            {% set dcl_statement_list = revoke_statement_list + grant_statement_list %}\n            {% if dcl_statement_list %}\n                {{ call_dcl_statements(dcl_statement_list) }}\n            {% endif %}\n        {% endif %}\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.get_show_grant_sql", "macro.dbt.get_dcl_statement_list", "macro.dbt.call_dcl_statements"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9194033, "supported_languages": null}, "macro.dbt.current_timestamp": {"name": "current_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp", "macro_sql": "{%- macro current_timestamp() -%}\n    {{ adapter.dispatch('current_timestamp', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_postgres.postgres__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9197288, "supported_languages": null}, "macro.dbt.default__current_timestamp": {"name": "default__current_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter ' + adapter.type()) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9198241, "supported_languages": null}, "macro.dbt.snapshot_get_time": {"name": "snapshot_get_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.snapshot_get_time", "macro_sql": "\n\n{%- macro snapshot_get_time() -%}\n    {{ adapter.dispatch('snapshot_get_time', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.91991, "supported_languages": null}, "macro.dbt.default__snapshot_get_time": {"name": "default__snapshot_get_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() %}\n    {{ current_timestamp() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9199753, "supported_languages": null}, "macro.dbt.get_snapshot_get_time_data_type": {"name": "get_snapshot_get_time_data_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.get_snapshot_get_time_data_type", "macro_sql": "{% macro get_snapshot_get_time_data_type() %}\n    {% set snapshot_time = adapter.dispatch('snapshot_get_time', 'dbt')() %}\n    {% set time_data_type_sql = 'select ' ~ snapshot_time ~ ' as dbt_snapshot_time' %}\n    {% set snapshot_time_column_schema = get_column_schema_from_query(time_data_type_sql) %}\n    {% set time_data_type = snapshot_time_column_schema[0].dtype %}\n    {{ return(time_data_type or none) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt_postgres.postgres__snapshot_get_time", "macro.dbt.get_column_schema_from_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9202452, "supported_languages": null}, "macro.dbt.current_timestamp_backcompat": {"name": "current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp_backcompat", "macro_sql": "{% macro current_timestamp_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__current_timestamp_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9203556, "supported_languages": null}, "macro.dbt.default__current_timestamp_backcompat": {"name": "default__current_timestamp_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp_backcompat", "macro_sql": "{% macro default__current_timestamp_backcompat() %}\n    current_timestamp::timestamp\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.920406, "supported_languages": null}, "macro.dbt.current_timestamp_in_utc_backcompat": {"name": "current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.current_timestamp_in_utc_backcompat", "macro_sql": "{% macro current_timestamp_in_utc_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_in_utc_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__current_timestamp_in_utc_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.920522, "supported_languages": null}, "macro.dbt.default__current_timestamp_in_utc_backcompat": {"name": "default__current_timestamp_in_utc_backcompat", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/timestamps.sql", "original_file_path": "macros/adapters/timestamps.sql", "unique_id": "macro.dbt.default__current_timestamp_in_utc_backcompat", "macro_sql": "{% macro default__current_timestamp_in_utc_backcompat() %}\n    {{ return(adapter.dispatch('current_timestamp_backcompat', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.current_timestamp_backcompat", "macro.dbt_postgres.postgres__current_timestamp_backcompat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9206276, "supported_languages": null}, "macro.dbt.get_catalog_relations": {"name": "get_catalog_relations", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_catalog_relations", "macro_sql": "{% macro get_catalog_relations(information_schema, relations) -%}\n  {{ return(adapter.dispatch('get_catalog_relations', 'dbt')(information_schema, relations)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_catalog_relations"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9212089, "supported_languages": null}, "macro.dbt.default__get_catalog_relations": {"name": "default__get_catalog_relations", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_catalog_relations", "macro_sql": "{% macro default__get_catalog_relations(information_schema, relations) -%}\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog_relations not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.92137, "supported_languages": null}, "macro.dbt.get_catalog": {"name": "get_catalog", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog', 'dbt')(information_schema, schemas)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_catalog"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9214911, "supported_languages": null}, "macro.dbt.default__get_catalog": {"name": "default__get_catalog", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9216423, "supported_languages": null}, "macro.dbt.information_schema_name": {"name": "information_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name', 'dbt')(database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9217546, "supported_languages": null}, "macro.dbt.default__information_schema_name": {"name": "default__information_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.921854, "supported_languages": null}, "macro.dbt.list_schemas": {"name": "list_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas', 'dbt')(database)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9219632, "supported_languages": null}, "macro.dbt.default__list_schemas": {"name": "default__list_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.information_schema_name", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9221125, "supported_languages": null}, "macro.dbt.check_schema_exists": {"name": "check_schema_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists', 'dbt')(information_schema, schema)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__check_schema_exists"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9225056, "supported_languages": null}, "macro.dbt.default__check_schema_exists": {"name": "default__check_schema_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.replace", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.922697, "supported_languages": null}, "macro.dbt.list_relations_without_caching": {"name": "list_relations_without_caching", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching', 'dbt')(schema_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9228156, "supported_languages": null}, "macro.dbt.default__list_relations_without_caching": {"name": "default__list_relations_without_caching", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9229114, "supported_languages": null}, "macro.dbt.get_catalog_for_single_relation": {"name": "get_catalog_for_single_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_catalog_for_single_relation", "macro_sql": "{% macro get_catalog_for_single_relation(relation) %}\n  {{ return(adapter.dispatch('get_catalog_for_single_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_catalog_for_single_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9230163, "supported_languages": null}, "macro.dbt.default__get_catalog_for_single_relation": {"name": "default__get_catalog_for_single_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_catalog_for_single_relation", "macro_sql": "{% macro default__get_catalog_for_single_relation(relation) %}\n  {{ exceptions.raise_not_implemented(\n    'get_catalog_for_single_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9231286, "supported_languages": null}, "macro.dbt.get_relations": {"name": "get_relations", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_relations", "macro_sql": "{% macro get_relations() %}\n  {{ return(adapter.dispatch('get_relations', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_relations"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.923226, "supported_languages": null}, "macro.dbt.default__get_relations": {"name": "default__get_relations", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_relations", "macro_sql": "{% macro default__get_relations() %}\n  {{ exceptions.raise_not_implemented(\n    'get_relations macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9233162, "supported_languages": null}, "macro.dbt.get_relation_last_modified": {"name": "get_relation_last_modified", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.get_relation_last_modified", "macro_sql": "{% macro get_relation_last_modified(information_schema, relations) %}\n  {{ return(adapter.dispatch('get_relation_last_modified', 'dbt')(information_schema, relations)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_relation_last_modified"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9234393, "supported_languages": null}, "macro.dbt.default__get_relation_last_modified": {"name": "default__get_relation_last_modified", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "unique_id": "macro.dbt.default__get_relation_last_modified", "macro_sql": "{% macro default__get_relation_last_modified(information_schema, relations) %}\n  {{ exceptions.raise_not_implemented(\n    'get_relation_last_modified macro not implemented for adapter ' + adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9235446, "supported_languages": null}, "macro.dbt.make_intermediate_relation": {"name": "make_intermediate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_intermediate_relation", "macro_sql": "{% macro make_intermediate_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_intermediate_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_intermediate_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9239695, "supported_languages": null}, "macro.dbt.default__make_intermediate_relation": {"name": "default__make_intermediate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_intermediate_relation", "macro_sql": "{% macro default__make_intermediate_relation(base_relation, suffix) %}\n    {{ return(default__make_temp_relation(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9240668, "supported_languages": null}, "macro.dbt.make_temp_relation": {"name": "make_temp_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_temp_relation', 'dbt')(base_relation, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9241996, "supported_languages": null}, "macro.dbt.default__make_temp_relation": {"name": "default__make_temp_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {%- set temp_identifier = base_relation.identifier ~ suffix -%}\n    {%- set temp_relation = base_relation.incorporate(\n                                path={\"identifier\": temp_identifier}) -%}\n\n    {{ return(temp_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9243708, "supported_languages": null}, "macro.dbt.make_backup_relation": {"name": "make_backup_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.make_backup_relation", "macro_sql": "{% macro make_backup_relation(base_relation, backup_relation_type, suffix='__dbt_backup') %}\n    {{ return(adapter.dispatch('make_backup_relation', 'dbt')(base_relation, backup_relation_type, suffix)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__make_backup_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9245133, "supported_languages": null}, "macro.dbt.default__make_backup_relation": {"name": "default__make_backup_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__make_backup_relation", "macro_sql": "{% macro default__make_backup_relation(base_relation, backup_relation_type, suffix) %}\n    {%- set backup_identifier = base_relation.identifier ~ suffix -%}\n    {%- set backup_relation = base_relation.incorporate(\n                                  path={\"identifier\": backup_identifier},\n                                  type=backup_relation_type\n    ) -%}\n    {{ return(backup_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.924703, "supported_languages": null}, "macro.dbt.truncate_relation": {"name": "truncate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__truncate_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9248161, "supported_languages": null}, "macro.dbt.default__truncate_relation": {"name": "default__truncate_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation.render() }}\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9249258, "supported_languages": null}, "macro.dbt.get_or_create_relation": {"name": "get_or_create_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) -%}\n  {{ return(adapter.dispatch('get_or_create_relation', 'dbt')(database, schema, identifier, type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_or_create_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9250677, "supported_languages": null}, "macro.dbt.default__get_or_create_relation": {"name": "default__get_or_create_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.default__get_or_create_relation", "macro_sql": "{% macro default__get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9253917, "supported_languages": null}, "macro.dbt.load_cached_relation": {"name": "load_cached_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.load_cached_relation", "macro_sql": "{% macro load_cached_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9255424, "supported_languages": null}, "macro.dbt.load_relation": {"name": "load_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "unique_id": "macro.dbt.load_relation", "macro_sql": "{% macro load_relation(relation) %}\n    {{ return(load_cached_relation(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.925629, "supported_languages": null}, "macro.dbt.get_create_index_sql": {"name": "get_create_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.get_create_index_sql", "macro_sql": "{% macro get_create_index_sql(relation, index_dict) -%}\n  {{ return(adapter.dispatch('get_create_index_sql', 'dbt')(relation, index_dict)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.925931, "supported_languages": null}, "macro.dbt.default__get_create_index_sql": {"name": "default__get_create_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__get_create_index_sql", "macro_sql": "{% macro default__get_create_index_sql(relation, index_dict) -%}\n  {% do return(None) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9260142, "supported_languages": null}, "macro.dbt.create_indexes": {"name": "create_indexes", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.create_indexes", "macro_sql": "{% macro create_indexes(relation) -%}\n  {{ adapter.dispatch('create_indexes', 'dbt')(relation) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.926123, "supported_languages": null}, "macro.dbt.default__create_indexes": {"name": "default__create_indexes", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__create_indexes", "macro_sql": "{% macro default__create_indexes(relation) -%}\n  {%- set _indexes = config.get('indexes', default=[]) -%}\n\n  {% for _index_dict in _indexes %}\n    {% set create_index_sql = get_create_index_sql(relation, _index_dict) %}\n    {% if create_index_sql %}\n      {% do run_query(create_index_sql) %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_create_index_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9263618, "supported_languages": null}, "macro.dbt.get_drop_index_sql": {"name": "get_drop_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.get_drop_index_sql", "macro_sql": "{% macro get_drop_index_sql(relation, index_name) -%}\n    {{ adapter.dispatch('get_drop_index_sql', 'dbt')(relation, index_name) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_drop_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9264717, "supported_languages": null}, "macro.dbt.default__get_drop_index_sql": {"name": "default__get_drop_index_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__get_drop_index_sql", "macro_sql": "{% macro default__get_drop_index_sql(relation, index_name) -%}\n    {{ exceptions.raise_compiler_error(\"`get_drop_index_sql has not been implemented for this adapter.\") }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.926553, "supported_languages": null}, "macro.dbt.get_show_indexes_sql": {"name": "get_show_indexes_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.get_show_indexes_sql", "macro_sql": "{% macro get_show_indexes_sql(relation) -%}\n    {{ adapter.dispatch('get_show_indexes_sql', 'dbt')(relation) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_show_indexes_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9267118, "supported_languages": null}, "macro.dbt.default__get_show_indexes_sql": {"name": "default__get_show_indexes_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "unique_id": "macro.dbt.default__get_show_indexes_sql", "macro_sql": "{% macro default__get_show_indexes_sql(relation) -%}\n    {{ exceptions.raise_compiler_error(\"`get_show_indexes_sql has not been implemented for this adapter.\") }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9267874, "supported_languages": null}, "macro.dbt.alter_column_comment": {"name": "alter_column_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment', 'dbt')(relation, column_dict)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.927062, "supported_languages": null}, "macro.dbt.default__alter_column_comment": {"name": "default__alter_column_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9271758, "supported_languages": null}, "macro.dbt.alter_relation_comment": {"name": "alter_relation_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment', 'dbt')(relation, relation_comment)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__alter_relation_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.927294, "supported_languages": null}, "macro.dbt.default__alter_relation_comment": {"name": "default__alter_relation_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9273965, "supported_languages": null}, "macro.dbt.persist_docs": {"name": "persist_docs", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs', 'dbt')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9275541, "supported_languages": null}, "macro.dbt.default__persist_docs": {"name": "default__persist_docs", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "unique_id": "macro.dbt.default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.alter_relation_comment", "macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9278383, "supported_languages": null}, "macro.dbt.get_columns_in_relation": {"name": "get_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9285793, "supported_languages": null}, "macro.dbt.default__get_columns_in_relation": {"name": "default__get_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9286757, "supported_languages": null}, "macro.dbt.sql_convert_columns_in_relation": {"name": "sql_convert_columns_in_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9288545, "supported_languages": null}, "macro.dbt.get_empty_subquery_sql": {"name": "get_empty_subquery_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_empty_subquery_sql", "macro_sql": "{% macro get_empty_subquery_sql(select_sql, select_sql_header=none) -%}\n  {{ return(adapter.dispatch('get_empty_subquery_sql', 'dbt')(select_sql, select_sql_header)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9289813, "supported_languages": null}, "macro.dbt.default__get_empty_subquery_sql": {"name": "default__get_empty_subquery_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_empty_subquery_sql", "macro_sql": "{% macro default__get_empty_subquery_sql(select_sql, select_sql_header=none) %}\n    {%- if select_sql_header is not none -%}\n    {{ select_sql_header }}\n    {%- endif -%}\n    select * from (\n        {{ select_sql }}\n    ) as __dbt_sbq\n    where false\n    limit 0\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9291096, "supported_languages": null}, "macro.dbt.get_empty_schema_sql": {"name": "get_empty_schema_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_empty_schema_sql", "macro_sql": "{% macro get_empty_schema_sql(columns) -%}\n  {{ return(adapter.dispatch('get_empty_schema_sql', 'dbt')(columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_empty_schema_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9292133, "supported_languages": null}, "macro.dbt.default__get_empty_schema_sql": {"name": "default__get_empty_schema_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_empty_schema_sql", "macro_sql": "{% macro default__get_empty_schema_sql(columns) %}\n    {%- set col_err = [] -%}\n    {%- set col_naked_numeric = [] -%}\n    select\n    {% for i in columns %}\n      {%- set col = columns[i] -%}\n      {%- if col['data_type'] is not defined -%}\n        {%- do col_err.append(col['name']) -%}\n      {#-- If this column's type is just 'numeric' then it is missing precision/scale, raise a warning --#}\n      {%- elif col['data_type'].strip().lower() in ('numeric', 'decimal', 'number') -%}\n        {%- do col_naked_numeric.append(col['name']) -%}\n      {%- endif -%}\n      {% set col_name = adapter.quote(col['name']) if col.get('quote') else col['name'] %}\n      {{ cast('null', col['data_type']) }} as {{ col_name }}{{ \", \" if not loop.last }}\n    {%- endfor -%}\n    {%- if (col_err | length) > 0 -%}\n      {{ exceptions.column_type_missing(column_names=col_err) }}\n    {%- elif (col_naked_numeric | length) > 0 -%}\n      {{ exceptions.warn(\"Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: \" ~ col_naked_numeric ~ \"`\") }}\n    {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9298935, "supported_languages": null}, "macro.dbt.get_column_schema_from_query": {"name": "get_column_schema_from_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_column_schema_from_query", "macro_sql": "{% macro get_column_schema_from_query(select_sql, select_sql_header=none) -%}\n    {% set columns = [] %}\n    {# -- Using an 'empty subquery' here to get the same schema as the given select_sql statement, without necessitating a data scan.#}\n    {% set sql = get_empty_subquery_sql(select_sql, select_sql_header) %}\n    {% set column_schema = adapter.get_column_schema_from_query(sql) %}\n    {{ return(column_schema) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9301054, "supported_languages": null}, "macro.dbt.get_columns_in_query": {"name": "get_columns_in_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query', 'dbt')(select_sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9302158, "supported_languages": null}, "macro.dbt.default__get_columns_in_query": {"name": "default__get_columns_in_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        {{ get_empty_subquery_sql(select_sql) }}\n    {% endcall %}\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.get_empty_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9304178, "supported_languages": null}, "macro.dbt.alter_column_type": {"name": "alter_column_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type', 'dbt')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.93055, "supported_languages": null}, "macro.dbt.default__alter_column_type": {"name": "default__alter_column_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation.render() }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation.render() }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation.render() }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation.render() }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9309354, "supported_languages": null}, "macro.dbt.alter_relation_add_remove_columns": {"name": "alter_relation_add_remove_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.alter_relation_add_remove_columns", "macro_sql": "{% macro alter_relation_add_remove_columns(relation, add_columns = none, remove_columns = none) -%}\n  {{ return(adapter.dispatch('alter_relation_add_remove_columns', 'dbt')(relation, add_columns, remove_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__alter_relation_add_remove_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.931086, "supported_languages": null}, "macro.dbt.default__alter_relation_add_remove_columns": {"name": "default__alter_relation_add_remove_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "unique_id": "macro.dbt.default__alter_relation_add_remove_columns", "macro_sql": "{% macro default__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n\n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n\n  {% set sql -%}\n\n     alter {{ relation.type }} {{ relation.render() }}\n\n            {% for column in add_columns %}\n               add column {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n            {% endfor %}{{ ',' if add_columns and remove_columns }}\n\n            {% for column in remove_columns %}\n                drop column {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n\n  {%- endset -%}\n\n  {% do run_query(sql) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9315658, "supported_languages": null}, "macro.dbt.get_show_sql": {"name": "get_show_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/show.sql", "original_file_path": "macros/adapters/show.sql", "unique_id": "macro.dbt.get_show_sql", "macro_sql": "{% macro get_show_sql(compiled_code, sql_header, limit) -%}\n  {%- if sql_header is not none -%}\n  {{ sql_header }}\n  {%- endif %}\n  {{ get_limit_subquery_sql(compiled_code, limit) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_limit_subquery_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.931811, "supported_languages": null}, "macro.dbt.get_limit_subquery_sql": {"name": "get_limit_subquery_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/show.sql", "original_file_path": "macros/adapters/show.sql", "unique_id": "macro.dbt.get_limit_subquery_sql", "macro_sql": "\n{%- macro get_limit_subquery_sql(sql, limit) -%}\n  {{ adapter.dispatch('get_limit_sql', 'dbt')(sql, limit) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__get_limit_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9319222, "supported_languages": null}, "macro.dbt.default__get_limit_sql": {"name": "default__get_limit_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/show.sql", "original_file_path": "macros/adapters/show.sql", "unique_id": "macro.dbt.default__get_limit_sql", "macro_sql": "{% macro default__get_limit_sql(sql, limit) %}\n  {{ compiled_code }}\n  {% if limit is not none %}\n  limit {{ limit }}\n  {%- endif -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.932034, "supported_languages": null}, "macro.dbt.validate_sql": {"name": "validate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/validate_sql.sql", "original_file_path": "macros/adapters/validate_sql.sql", "unique_id": "macro.dbt.validate_sql", "macro_sql": "{% macro validate_sql(sql) -%}\n  {{ return(adapter.dispatch('validate_sql', 'dbt')(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__validate_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9322116, "supported_languages": null}, "macro.dbt.default__validate_sql": {"name": "default__validate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/validate_sql.sql", "original_file_path": "macros/adapters/validate_sql.sql", "unique_id": "macro.dbt.default__validate_sql", "macro_sql": "{% macro default__validate_sql(sql) -%}\n  {% call statement('validate_sql') -%}\n    explain {{ sql }}\n  {% endcall %}\n  {{ return(load_result('validate_sql')) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9324126, "supported_languages": null}, "macro.dbt.collect_freshness": {"name": "collect_freshness", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "unique_id": "macro.dbt.collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness', 'dbt')(source, loaded_at_field, filter))}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.932647, "supported_languages": null}, "macro.dbt.default__collect_freshness": {"name": "default__collect_freshness", "resource_type": "macro", "package_name": "dbt", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "unique_id": "macro.dbt.default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness')) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9328995, "supported_languages": null}, "macro.dbt.get_fixture_sql": {"name": "get_fixture_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.get_fixture_sql", "macro_sql": "{% macro get_fixture_sql(rows, column_name_to_data_types) %}\n-- Fixture for {{ model.name }}\n{% set default_row = {} %}\n\n{%- if not column_name_to_data_types -%}\n{#-- Use defer_relation IFF it is available in the manifest and 'this' is missing from the database --#}\n{%-   set this_or_defer_relation = defer_relation if (defer_relation and not load_relation(this)) else this -%}\n{%-   set columns_in_relation = adapter.get_columns_in_relation(this_or_defer_relation) -%}\n\n{%-   set column_name_to_data_types = {} -%}\n{%-   for column in columns_in_relation -%}\n{#-- This needs to be a case-insensitive comparison --#}\n{%-     do column_name_to_data_types.update({column.name|lower: column.data_type}) -%}\n{%-   endfor -%}\n{%- endif -%}\n\n{%- if not column_name_to_data_types -%}\n    {{ exceptions.raise_compiler_error(\"Not able to get columns for unit test '\" ~ model.name ~ \"' from relation \" ~ this ~ \" because the relation doesn't exist\") }}\n{%- endif -%}\n\n{%- for column_name, column_type in column_name_to_data_types.items() -%}\n    {%- do default_row.update({column_name: (safe_cast(\"null\", column_type) | trim )}) -%}\n{%- endfor -%}\n\n{{ validate_fixture_rows(rows, row_number) }}\n\n{%- for row in rows -%}\n{%-   set formatted_row = format_row(row, column_name_to_data_types) -%}\n{%-   set default_row_copy = default_row.copy() -%}\n{%-   do default_row_copy.update(formatted_row) -%}\nselect\n{%-   for column_name, column_value in default_row_copy.items() %} {{ column_value }} as {{ column_name }}{% if not loop.last -%}, {%- endif %}\n{%-   endfor %}\n{%-   if not loop.last %}\nunion all\n{%    endif %}\n{%- endfor -%}\n\n{%- if (rows | length) == 0 -%}\n    select\n    {%- for column_name, column_value in default_row.items() %} {{ column_value }} as {{ column_name }}{% if not loop.last -%},{%- endif %}\n    {%- endfor %}\n    limit 0\n{%- endif -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.load_relation", "macro.dbt.safe_cast", "macro.dbt.validate_fixture_rows", "macro.dbt.format_row"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9344857, "supported_languages": null}, "macro.dbt.get_expected_sql": {"name": "get_expected_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.get_expected_sql", "macro_sql": "{% macro get_expected_sql(rows, column_name_to_data_types) %}\n\n{%- if (rows | length) == 0 -%}\n    select * from dbt_internal_unit_test_actual\n    limit 0\n{%- else -%}\n{%- for row in rows -%}\n{%- set formatted_row = format_row(row, column_name_to_data_types) -%}\nselect\n{%- for column_name, column_value in formatted_row.items() %} {{ column_value }} as {{ column_name }}{% if not loop.last -%}, {%- endif %}\n{%- endfor %}\n{%- if not loop.last %}\nunion all\n{% endif %}\n{%- endfor -%}\n{%- endif -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.format_row"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.934832, "supported_languages": null}, "macro.dbt.format_row": {"name": "format_row", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.format_row", "macro_sql": "\n\n{%- macro format_row(row, column_name_to_data_types) -%}\n    {#-- generate case-insensitive formatted row --#}\n    {% set formatted_row = {} %}\n    {%- for column_name, column_value in row.items() -%}\n        {% set column_name = column_name|lower %}\n\n        {%- if column_name not in column_name_to_data_types %}\n            {#-- if user-provided row contains column name that relation does not contain, raise an error --#}\n            {% set fixture_name = \"expected output\" if model.resource_type == 'unit_test' else (\"'\" ~ model.name ~ \"'\") %}\n            {{ exceptions.raise_compiler_error(\n                \"Invalid column name: '\" ~ column_name ~ \"' in unit test fixture for \" ~ fixture_name ~ \".\"\n                \"\\nAccepted columns for \" ~ fixture_name ~ \" are: \" ~ (column_name_to_data_types.keys()|list)\n            ) }}\n        {%- endif -%}\n\n        {%- set column_type = column_name_to_data_types[column_name] %}\n\n        {#-- sanitize column_value: wrap yaml strings in quotes, apply cast --#}\n        {%- set column_value_clean = column_value -%}\n        {%- if column_value is string -%}\n            {%- set column_value_clean = dbt.string_literal(dbt.escape_single_quotes(column_value)) -%}\n        {%- elif column_value is none -%}\n            {%- set column_value_clean = 'null' -%}\n        {%- endif -%}\n\n        {%- set row_update = {column_name: safe_cast(column_value_clean, column_type) } -%}\n        {%- do formatted_row.update(row_update) -%}\n    {%- endfor -%}\n    {{ return(formatted_row) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.string_literal", "macro.dbt.escape_single_quotes", "macro.dbt.safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.935527, "supported_languages": null}, "macro.dbt.validate_fixture_rows": {"name": "validate_fixture_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.validate_fixture_rows", "macro_sql": "{%- macro validate_fixture_rows(rows, row_number) -%}\n  {{ return(adapter.dispatch('validate_fixture_rows', 'dbt')(rows, row_number)) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__validate_fixture_rows"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.935672, "supported_languages": null}, "macro.dbt.default__validate_fixture_rows": {"name": "default__validate_fixture_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/unit_test_sql/get_fixture_sql.sql", "original_file_path": "macros/unit_test_sql/get_fixture_sql.sql", "unique_id": "macro.dbt.default__validate_fixture_rows", "macro_sql": "{%- macro default__validate_fixture_rows(rows, row_number) -%}\n  {# This is an abstract method for adapter overrides as needed #}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9357398, "supported_languages": null}, "macro.dbt.resolve_model_name": {"name": "resolve_model_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.resolve_model_name", "macro_sql": "{% macro resolve_model_name(input_model_name) %}\n    {{ return(adapter.dispatch('resolve_model_name', 'dbt')(input_model_name)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9361916, "supported_languages": null}, "macro.dbt.default__resolve_model_name": {"name": "default__resolve_model_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.default__resolve_model_name", "macro_sql": "\n\n{%- macro default__resolve_model_name(input_model_name) -%}\n    {{  input_model_name | string | replace('\"', '\\\"') }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.936283, "supported_languages": null}, "macro.dbt.build_ref_function": {"name": "build_ref_function", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_ref_function", "macro_sql": "{% macro build_ref_function(model) %}\n\n    {%- set ref_dict = {} -%}\n    {%- for _ref in model.refs -%}\n        {% set _ref_args = [_ref.get('package'), _ref['name']] if _ref.get('package') else [_ref['name'],] %}\n        {%- set resolved = ref(*_ref_args, v=_ref.get('version')) -%}\n        {%- if _ref.get('version') -%}\n            {% do _ref_args.extend([\"v\" ~ _ref['version']]) %}\n        {%- endif -%}\n       {%- do ref_dict.update({_ref_args | join('.'): resolve_model_name(resolved)}) -%}\n    {%- endfor -%}\n\ndef ref(*args, **kwargs):\n    refs = {{ ref_dict | tojson }}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.93676, "supported_languages": null}, "macro.dbt.build_source_function": {"name": "build_source_function", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_source_function", "macro_sql": "{% macro build_source_function(model) %}\n\n    {%- set source_dict = {} -%}\n    {%- for _source in model.sources -%}\n        {%- set resolved = source(*_source) -%}\n        {%- do source_dict.update({_source | join('.'): resolve_model_name(resolved)}) -%}\n    {%- endfor -%}\n\ndef source(*args, dbt_load_df_function):\n    sources = {{ source_dict | tojson }}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.resolve_model_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9370036, "supported_languages": null}, "macro.dbt.build_config_dict": {"name": "build_config_dict", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.build_config_dict", "macro_sql": "{% macro build_config_dict(model) %}\n    {%- set config_dict = {} -%}\n    {% set config_dbt_used = zip(model.config.config_keys_used, model.config.config_keys_defaults) | list %}\n    {%- for key, default in config_dbt_used -%}\n        {# weird type testing with enum, would be much easier to write this logic in Python! #}\n        {%- if key == \"language\" -%}\n          {%- set value = \"python\" -%}\n        {%- endif -%}\n        {%- set value = model.config.get(key, default) -%}\n        {%- do config_dict.update({key: value}) -%}\n    {%- endfor -%}\nconfig_dict = {{ config_dict }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.937369, "supported_languages": null}, "macro.dbt.py_script_postfix": {"name": "py_script_postfix", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.py_script_postfix", "macro_sql": "{% macro py_script_postfix(model) %}\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\n{{ build_ref_function(model ) }}\n{{ build_source_function(model ) }}\n{{ build_config_dict(model) }}\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"{{ this.database }}\"\n    schema = \"{{ this.schema }}\"\n    identifier = \"{{ this.identifier }}\"\n    {% set this_relation_name = resolve_model_name(this) %}\n    def __repr__(self):\n        return '{{ this_relation_name  }}'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = {{ is_incremental() }}\n\n# COMMAND ----------\n{{py_script_comment()}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.build_ref_function", "macro.dbt.build_source_function", "macro.dbt.build_config_dict", "macro.dbt.resolve_model_name", "macro.dbt.is_incremental", "macro.dbt.py_script_comment"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9376535, "supported_languages": null}, "macro.dbt.py_script_comment": {"name": "py_script_comment", "resource_type": "macro", "package_name": "dbt", "path": "macros/python_model/python.sql", "original_file_path": "macros/python_model/python.sql", "unique_id": "macro.dbt.py_script_comment", "macro_sql": "{%macro py_script_comment()%}\n{%endmacro%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9377, "supported_languages": null}, "macro.dbt.listagg": {"name": "listagg", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "unique_id": "macro.dbt.listagg", "macro_sql": "{% macro listagg(measure, delimiter_text=\"','\", order_by_clause=none, limit_num=none) -%}\n    {{ return(adapter.dispatch('listagg', 'dbt') (measure, delimiter_text, order_by_clause, limit_num)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__listagg"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.937979, "supported_languages": null}, "macro.dbt.default__listagg": {"name": "default__listagg", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/listagg.sql", "original_file_path": "macros/utils/listagg.sql", "unique_id": "macro.dbt.default__listagg", "macro_sql": "{% macro default__listagg(measure, delimiter_text, order_by_clause, limit_num) -%}\n\n    {% if limit_num -%}\n    array_to_string(\n        array_slice(\n            array_agg(\n                {{ measure }}\n            ){% if order_by_clause -%}\n            within group ({{ order_by_clause }})\n            {%- endif %}\n            ,0\n            ,{{ limit_num }}\n        ),\n        {{ delimiter_text }}\n        )\n    {%- else %}\n    listagg(\n        {{ measure }},\n        {{ delimiter_text }}\n        )\n        {% if order_by_clause -%}\n        within group ({{ order_by_clause }})\n        {%- endif %}\n    {%- endif %}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9382331, "supported_languages": null}, "macro.dbt.hash": {"name": "hash", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/hash.sql", "original_file_path": "macros/utils/hash.sql", "unique_id": "macro.dbt.hash", "macro_sql": "{% macro hash(field) -%}\n  {{ return(adapter.dispatch('hash', 'dbt') (field)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9383907, "supported_languages": null}, "macro.dbt.default__hash": {"name": "default__hash", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/hash.sql", "original_file_path": "macros/utils/hash.sql", "unique_id": "macro.dbt.default__hash", "macro_sql": "{% macro default__hash(field) -%}\n    md5(cast({{ field }} as {{ api.Column.translate_type('string') }}))\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.938485, "supported_languages": null}, "macro.dbt.date_trunc": {"name": "date_trunc", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_trunc.sql", "original_file_path": "macros/utils/date_trunc.sql", "unique_id": "macro.dbt.date_trunc", "macro_sql": "{% macro date_trunc(datepart, date) -%}\n  {{ return(adapter.dispatch('date_trunc', 'dbt') (datepart, date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9386473, "supported_languages": null}, "macro.dbt.default__date_trunc": {"name": "default__date_trunc", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_trunc.sql", "original_file_path": "macros/utils/date_trunc.sql", "unique_id": "macro.dbt.default__date_trunc", "macro_sql": "{% macro default__date_trunc(datepart, date) -%}\n    date_trunc('{{datepart}}', {{date}})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9387255, "supported_languages": null}, "macro.dbt.array_construct": {"name": "array_construct", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_construct.sql", "original_file_path": "macros/utils/array_construct.sql", "unique_id": "macro.dbt.array_construct", "macro_sql": "{% macro array_construct(inputs=[], data_type=api.Column.translate_type('integer')) -%}\n  {{ return(adapter.dispatch('array_construct', 'dbt')(inputs, data_type)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__array_construct"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9389539, "supported_languages": null}, "macro.dbt.default__array_construct": {"name": "default__array_construct", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_construct.sql", "original_file_path": "macros/utils/array_construct.sql", "unique_id": "macro.dbt.default__array_construct", "macro_sql": "{% macro default__array_construct(inputs, data_type) -%}\n    {% if inputs|length > 0 %}\n    array[ {{ inputs|join(' , ') }} ]\n    {% else %}\n    array[]::{{data_type}}[]\n    {% endif %}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9391057, "supported_languages": null}, "macro.dbt.length": {"name": "length", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/length.sql", "original_file_path": "macros/utils/length.sql", "unique_id": "macro.dbt.length", "macro_sql": "{% macro length(expression) -%}\n    {{ return(adapter.dispatch('length', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__length"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9392574, "supported_languages": null}, "macro.dbt.default__length": {"name": "default__length", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/length.sql", "original_file_path": "macros/utils/length.sql", "unique_id": "macro.dbt.default__length", "macro_sql": "{% macro default__length(expression) %}\n\n    length(\n        {{ expression }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.939326, "supported_languages": null}, "macro.dbt.date": {"name": "date", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date.sql", "original_file_path": "macros/utils/date.sql", "unique_id": "macro.dbt.date", "macro_sql": "{% macro date(year, month, day) %}\n  {{ return(adapter.dispatch('date', 'dbt') (year, month, day)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__date"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9395182, "supported_languages": null}, "macro.dbt.default__date": {"name": "default__date", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date.sql", "original_file_path": "macros/utils/date.sql", "unique_id": "macro.dbt.default__date", "macro_sql": "{% macro default__date(year, month, day) -%}\n    {%- set dt = modules.datetime.date(year, month, day) -%}\n    {%- set iso_8601_formatted_date = dt.strftime('%Y-%m-%d') -%}\n    to_date('{{ iso_8601_formatted_date }}', 'YYYY-MM-DD')\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9397585, "supported_languages": null}, "macro.dbt.get_powers_of_two": {"name": "get_powers_of_two", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/generate_series.sql", "original_file_path": "macros/utils/generate_series.sql", "unique_id": "macro.dbt.get_powers_of_two", "macro_sql": "{% macro get_powers_of_two(upper_bound) %}\n    {{ return(adapter.dispatch('get_powers_of_two', 'dbt')(upper_bound)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9400313, "supported_languages": null}, "macro.dbt.default__get_powers_of_two": {"name": "default__get_powers_of_two", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/generate_series.sql", "original_file_path": "macros/utils/generate_series.sql", "unique_id": "macro.dbt.default__get_powers_of_two", "macro_sql": "{% macro default__get_powers_of_two(upper_bound) %}\n\n    {% if upper_bound <= 0 %}\n    {{ exceptions.raise_compiler_error(\"upper bound must be positive\") }}\n    {% endif %}\n\n    {% for _ in range(1, 100) %}\n       {% if upper_bound <= 2 ** loop.index %}{{ return(loop.index) }}{% endif %}\n    {% endfor %}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.940297, "supported_languages": null}, "macro.dbt.generate_series": {"name": "generate_series", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/generate_series.sql", "original_file_path": "macros/utils/generate_series.sql", "unique_id": "macro.dbt.generate_series", "macro_sql": "{% macro generate_series(upper_bound) %}\n    {{ return(adapter.dispatch('generate_series', 'dbt')(upper_bound)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_series"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9404113, "supported_languages": null}, "macro.dbt.default__generate_series": {"name": "default__generate_series", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/generate_series.sql", "original_file_path": "macros/utils/generate_series.sql", "unique_id": "macro.dbt.default__generate_series", "macro_sql": "{% macro default__generate_series(upper_bound) %}\n\n    {% set n = dbt.get_powers_of_two(upper_bound) %}\n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    {% for i in range(n) %}\n    p{{i}}.generated_number * power(2, {{i}})\n    {% if not loop.last %} + {% endif %}\n    {% endfor %}\n    + 1\n    as generated_number\n\n    from\n\n    {% for i in range(n) %}\n    p as p{{i}}\n    {% if not loop.last %} cross join {% endif %}\n    {% endfor %}\n\n    )\n\n    select *\n    from unioned\n    where generated_number <= {{upper_bound}}\n    order by generated_number\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9407237, "supported_languages": null}, "macro.dbt.datediff": {"name": "datediff", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "unique_id": "macro.dbt.datediff", "macro_sql": "{% macro datediff(first_date, second_date, datepart) %}\n  {{ return(adapter.dispatch('datediff', 'dbt')(first_date, second_date, datepart)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.940915, "supported_languages": null}, "macro.dbt.default__datediff": {"name": "default__datediff", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/datediff.sql", "original_file_path": "macros/utils/datediff.sql", "unique_id": "macro.dbt.default__datediff", "macro_sql": "{% macro default__datediff(first_date, second_date, datepart) -%}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9410188, "supported_languages": null}, "macro.dbt.right": {"name": "right", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "unique_id": "macro.dbt.right", "macro_sql": "{% macro right(string_text, length_expression) -%}\n    {{ return(adapter.dispatch('right', 'dbt') (string_text, length_expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__right"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9412224, "supported_languages": null}, "macro.dbt.default__right": {"name": "default__right", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/right.sql", "original_file_path": "macros/utils/right.sql", "unique_id": "macro.dbt.default__right", "macro_sql": "{% macro default__right(string_text, length_expression) %}\n\n    right(\n        {{ string_text }},\n        {{ length_expression }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9413054, "supported_languages": null}, "macro.dbt.cast": {"name": "cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast.sql", "original_file_path": "macros/utils/cast.sql", "unique_id": "macro.dbt.cast", "macro_sql": "{% macro cast(field, type) %}\n  {{ return(adapter.dispatch('cast', 'dbt') (field, type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9414678, "supported_languages": null}, "macro.dbt.default__cast": {"name": "default__cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast.sql", "original_file_path": "macros/utils/cast.sql", "unique_id": "macro.dbt.default__cast", "macro_sql": "{% macro default__cast(field, type) %}\n    cast({{field}} as {{type}})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9415495, "supported_languages": null}, "macro.dbt.split_part": {"name": "split_part", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt.split_part", "macro_sql": "{% macro split_part(string_text, delimiter_text, part_number) %}\n  {{ return(adapter.dispatch('split_part', 'dbt') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__split_part"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9417744, "supported_languages": null}, "macro.dbt.default__split_part": {"name": "default__split_part", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt.default__split_part", "macro_sql": "{% macro default__split_part(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n        {{ part_number }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9418836, "supported_languages": null}, "macro.dbt._split_part_negative": {"name": "_split_part_negative", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/split_part.sql", "original_file_path": "macros/utils/split_part.sql", "unique_id": "macro.dbt._split_part_negative", "macro_sql": "{% macro _split_part_negative(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n          length({{ string_text }})\n          - length(\n              replace({{ string_text }},  {{ delimiter_text }}, '')\n          ) + 2 + {{ part_number }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9420147, "supported_languages": null}, "macro.dbt.except": {"name": "except", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/except.sql", "original_file_path": "macros/utils/except.sql", "unique_id": "macro.dbt.except", "macro_sql": "{% macro except() %}\n  {{ return(adapter.dispatch('except', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__except"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9421558, "supported_languages": null}, "macro.dbt.default__except": {"name": "default__except", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/except.sql", "original_file_path": "macros/utils/except.sql", "unique_id": "macro.dbt.default__except", "macro_sql": "{% macro default__except() %}\n\n    except\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9422007, "supported_languages": null}, "macro.dbt.type_string": {"name": "type_string", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_string", "macro_sql": "\n\n{%- macro type_string() -%}\n  {{ return(adapter.dispatch('type_string', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_string"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9426627, "supported_languages": null}, "macro.dbt.default__type_string": {"name": "default__type_string", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_string", "macro_sql": "{% macro default__type_string() %}\n    {{ return(api.Column.translate_type(\"string\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9427507, "supported_languages": null}, "macro.dbt.type_timestamp": {"name": "type_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_timestamp", "macro_sql": "\n\n{%- macro type_timestamp() -%}\n  {{ return(adapter.dispatch('type_timestamp', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9428508, "supported_languages": null}, "macro.dbt.default__type_timestamp": {"name": "default__type_timestamp", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() %}\n    {{ return(api.Column.translate_type(\"timestamp\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9429379, "supported_languages": null}, "macro.dbt.type_float": {"name": "type_float", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_float", "macro_sql": "\n\n{%- macro type_float() -%}\n  {{ return(adapter.dispatch('type_float', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_float"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.94304, "supported_languages": null}, "macro.dbt.default__type_float": {"name": "default__type_float", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_float", "macro_sql": "{% macro default__type_float() %}\n    {{ return(api.Column.translate_type(\"float\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9431393, "supported_languages": null}, "macro.dbt.type_numeric": {"name": "type_numeric", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_numeric", "macro_sql": "\n\n{%- macro type_numeric() -%}\n  {{ return(adapter.dispatch('type_numeric', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9432356, "supported_languages": null}, "macro.dbt.default__type_numeric": {"name": "default__type_numeric", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_numeric", "macro_sql": "{% macro default__type_numeric() %}\n    {{ return(api.Column.numeric_type(\"numeric\", 28, 6)) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9433398, "supported_languages": null}, "macro.dbt.type_bigint": {"name": "type_bigint", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_bigint", "macro_sql": "\n\n{%- macro type_bigint() -%}\n  {{ return(adapter.dispatch('type_bigint', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9434361, "supported_languages": null}, "macro.dbt.default__type_bigint": {"name": "default__type_bigint", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_bigint", "macro_sql": "{% macro default__type_bigint() %}\n    {{ return(api.Column.translate_type(\"bigint\")) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.943525, "supported_languages": null}, "macro.dbt.type_int": {"name": "type_int", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_int", "macro_sql": "\n\n{%- macro type_int() -%}\n  {{ return(adapter.dispatch('type_int', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_int"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9436867, "supported_languages": null}, "macro.dbt.default__type_int": {"name": "default__type_int", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_int", "macro_sql": "{%- macro default__type_int() -%}\n  {{ return(api.Column.translate_type(\"integer\")) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.943773, "supported_languages": null}, "macro.dbt.type_boolean": {"name": "type_boolean", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.type_boolean", "macro_sql": "\n\n{%- macro type_boolean() -%}\n  {{ return(adapter.dispatch('type_boolean', 'dbt')()) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__type_boolean"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9438696, "supported_languages": null}, "macro.dbt.default__type_boolean": {"name": "default__type_boolean", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/data_types.sql", "original_file_path": "macros/utils/data_types.sql", "unique_id": "macro.dbt.default__type_boolean", "macro_sql": "{%- macro default__type_boolean() -%}\n  {{ return(api.Column.translate_type(\"boolean\")) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9439588, "supported_languages": null}, "macro.dbt.array_concat": {"name": "array_concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_concat.sql", "original_file_path": "macros/utils/array_concat.sql", "unique_id": "macro.dbt.array_concat", "macro_sql": "{% macro array_concat(array_1, array_2) -%}\n  {{ return(adapter.dispatch('array_concat', 'dbt')(array_1, array_2)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__array_concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.944138, "supported_languages": null}, "macro.dbt.default__array_concat": {"name": "default__array_concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_concat.sql", "original_file_path": "macros/utils/array_concat.sql", "unique_id": "macro.dbt.default__array_concat", "macro_sql": "{% macro default__array_concat(array_1, array_2) -%}\n    array_cat({{ array_1 }}, {{ array_2 }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9442186, "supported_languages": null}, "macro.dbt.string_literal": {"name": "string_literal", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/literal.sql", "original_file_path": "macros/utils/literal.sql", "unique_id": "macro.dbt.string_literal", "macro_sql": "{%- macro string_literal(value) -%}\n  {{ return(adapter.dispatch('string_literal', 'dbt') (value)) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9443665, "supported_languages": null}, "macro.dbt.default__string_literal": {"name": "default__string_literal", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/literal.sql", "original_file_path": "macros/utils/literal.sql", "unique_id": "macro.dbt.default__string_literal", "macro_sql": "{% macro default__string_literal(value) -%}\n    '{{ value }}'\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9444304, "supported_languages": null}, "macro.dbt.dateadd": {"name": "dateadd", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "unique_id": "macro.dbt.dateadd", "macro_sql": "{% macro dateadd(datepart, interval, from_date_or_timestamp) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9446206, "supported_languages": null}, "macro.dbt.default__dateadd": {"name": "default__dateadd", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/dateadd.sql", "original_file_path": "macros/utils/dateadd.sql", "unique_id": "macro.dbt.default__dateadd", "macro_sql": "{% macro default__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    dateadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_date_or_timestamp }}\n        )\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9447234, "supported_languages": null}, "macro.dbt.replace": {"name": "replace", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/replace.sql", "original_file_path": "macros/utils/replace.sql", "unique_id": "macro.dbt.replace", "macro_sql": "{% macro replace(field, old_chars, new_chars) -%}\n    {{ return(adapter.dispatch('replace', 'dbt') (field, old_chars, new_chars)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.944907, "supported_languages": null}, "macro.dbt.default__replace": {"name": "default__replace", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/replace.sql", "original_file_path": "macros/utils/replace.sql", "unique_id": "macro.dbt.default__replace", "macro_sql": "{% macro default__replace(field, old_chars, new_chars) %}\n\n    replace(\n        {{ field }},\n        {{ old_chars }},\n        {{ new_chars }}\n    )\n\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9450035, "supported_languages": null}, "macro.dbt.safe_cast": {"name": "safe_cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "unique_id": "macro.dbt.safe_cast", "macro_sql": "{% macro safe_cast(field, type) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt') (field, type)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9451945, "supported_languages": null}, "macro.dbt.default__safe_cast": {"name": "default__safe_cast", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/safe_cast.sql", "original_file_path": "macros/utils/safe_cast.sql", "unique_id": "macro.dbt.default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n    {# most databases don't support this function yet\n    so we just need to use cast #}\n    cast({{field}} as {{type}})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.945279, "supported_languages": null}, "macro.dbt.intersect": {"name": "intersect", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/intersect.sql", "original_file_path": "macros/utils/intersect.sql", "unique_id": "macro.dbt.intersect", "macro_sql": "{% macro intersect() %}\n  {{ return(adapter.dispatch('intersect', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9454143, "supported_languages": null}, "macro.dbt.default__intersect": {"name": "default__intersect", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/intersect.sql", "original_file_path": "macros/utils/intersect.sql", "unique_id": "macro.dbt.default__intersect", "macro_sql": "{% macro default__intersect() %}\n\n    intersect\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9454603, "supported_languages": null}, "macro.dbt.cast_bool_to_text": {"name": "cast_bool_to_text", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast_bool_to_text.sql", "original_file_path": "macros/utils/cast_bool_to_text.sql", "unique_id": "macro.dbt.cast_bool_to_text", "macro_sql": "{% macro cast_bool_to_text(field) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt') (field) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9456046, "supported_languages": null}, "macro.dbt.default__cast_bool_to_text": {"name": "default__cast_bool_to_text", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/cast_bool_to_text.sql", "original_file_path": "macros/utils/cast_bool_to_text.sql", "unique_id": "macro.dbt.default__cast_bool_to_text", "macro_sql": "{% macro default__cast_bool_to_text(field) %}\n    cast({{ field }} as {{ api.Column.translate_type('string') }})\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.945697, "supported_languages": null}, "macro.dbt.any_value": {"name": "any_value", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "unique_id": "macro.dbt.any_value", "macro_sql": "{% macro any_value(expression) -%}\n    {{ return(adapter.dispatch('any_value', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__any_value"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9458447, "supported_languages": null}, "macro.dbt.default__any_value": {"name": "default__any_value", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/any_value.sql", "original_file_path": "macros/utils/any_value.sql", "unique_id": "macro.dbt.default__any_value", "macro_sql": "{% macro default__any_value(expression) -%}\n\n    any_value({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9459088, "supported_languages": null}, "macro.dbt.bool_or": {"name": "bool_or", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "unique_id": "macro.dbt.bool_or", "macro_sql": "{% macro bool_or(expression) -%}\n    {{ return(adapter.dispatch('bool_or', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9460526, "supported_languages": null}, "macro.dbt.default__bool_or": {"name": "default__bool_or", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/bool_or.sql", "original_file_path": "macros/utils/bool_or.sql", "unique_id": "macro.dbt.default__bool_or", "macro_sql": "{% macro default__bool_or(expression) -%}\n\n    bool_or({{ expression }})\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9461212, "supported_languages": null}, "macro.dbt.array_append": {"name": "array_append", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_append.sql", "original_file_path": "macros/utils/array_append.sql", "unique_id": "macro.dbt.array_append", "macro_sql": "{% macro array_append(array, new_element) -%}\n  {{ return(adapter.dispatch('array_append', 'dbt')(array, new_element)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__array_append"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9462924, "supported_languages": null}, "macro.dbt.default__array_append": {"name": "default__array_append", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/array_append.sql", "original_file_path": "macros/utils/array_append.sql", "unique_id": "macro.dbt.default__array_append", "macro_sql": "{% macro default__array_append(array, new_element) -%}\n    array_append({{ array }}, {{ new_element }})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9463725, "supported_languages": null}, "macro.dbt.concat": {"name": "concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/concat.sql", "original_file_path": "macros/utils/concat.sql", "unique_id": "macro.dbt.concat", "macro_sql": "{% macro concat(fields) -%}\n  {{ return(adapter.dispatch('concat', 'dbt')(fields)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9465218, "supported_languages": null}, "macro.dbt.default__concat": {"name": "default__concat", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/concat.sql", "original_file_path": "macros/utils/concat.sql", "unique_id": "macro.dbt.default__concat", "macro_sql": "{% macro default__concat(fields) -%}\n    {{ fields|join(' || ') }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.946607, "supported_languages": null}, "macro.dbt.last_day": {"name": "last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.last_day", "macro_sql": "{% macro last_day(date, datepart) %}\n  {{ return(adapter.dispatch('last_day', 'dbt') (date, datepart)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9468093, "supported_languages": null}, "macro.dbt.default_last_day": {"name": "default_last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.default_last_day", "macro_sql": "\n\n{%- macro default_last_day(date, datepart) -%}\n    cast(\n        {{dbt.dateadd('day', '-1',\n        dbt.dateadd(datepart, '1', dbt.date_trunc(datepart, date))\n        )}}\n        as date)\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.dateadd", "macro.dbt.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.947033, "supported_languages": null}, "macro.dbt.default__last_day": {"name": "default__last_day", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/last_day.sql", "original_file_path": "macros/utils/last_day.sql", "unique_id": "macro.dbt.default__last_day", "macro_sql": "{% macro default__last_day(date, datepart) -%}\n    {{dbt.default_last_day(date, datepart)}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9471273, "supported_languages": null}, "macro.dbt.get_intervals_between": {"name": "get_intervals_between", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_spine.sql", "original_file_path": "macros/utils/date_spine.sql", "unique_id": "macro.dbt.get_intervals_between", "macro_sql": "{% macro get_intervals_between(start_date, end_date, datepart) -%}\n    {{ return(adapter.dispatch('get_intervals_between', 'dbt')(start_date, end_date, datepart)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_intervals_between"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9474633, "supported_languages": null}, "macro.dbt.default__get_intervals_between": {"name": "default__get_intervals_between", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_spine.sql", "original_file_path": "macros/utils/date_spine.sql", "unique_id": "macro.dbt.default__get_intervals_between", "macro_sql": "{% macro default__get_intervals_between(start_date, end_date, datepart) -%}\n    {%- call statement('get_intervals_between', fetch_result=True) %}\n\n        select {{ dbt.datediff(start_date, end_date, datepart) }}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_intervals_between') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values[0]) }}\n    {%- else -%}\n        {{ return(1) }}\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.datediff"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9478157, "supported_languages": null}, "macro.dbt.date_spine": {"name": "date_spine", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_spine.sql", "original_file_path": "macros/utils/date_spine.sql", "unique_id": "macro.dbt.date_spine", "macro_sql": "{% macro date_spine(datepart, start_date, end_date) %}\n    {{ return(adapter.dispatch('date_spine', 'dbt')(datepart, start_date, end_date)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__date_spine"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9479547, "supported_languages": null}, "macro.dbt.default__date_spine": {"name": "default__date_spine", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/date_spine.sql", "original_file_path": "macros/utils/date_spine.sql", "unique_id": "macro.dbt.default__date_spine", "macro_sql": "{% macro default__date_spine(datepart, start_date, end_date) %}\n\n\n    {# call as follows:\n\n    date_spine(\n        \"day\",\n        \"to_date('01/01/2016', 'mm/dd/yyyy')\",\n        \"dbt.dateadd(week, 1, current_date)\"\n    ) #}\n\n\n    with rawdata as (\n\n        {{dbt.generate_series(\n            dbt.get_intervals_between(start_date, end_date, datepart)\n        )}}\n\n    ),\n\n    all_periods as (\n\n        select (\n            {{\n                dbt.dateadd(\n                    datepart,\n                    \"row_number() over (order by 1) - 1\",\n                    start_date\n                )\n            }}\n        ) as date_{{datepart}}\n        from rawdata\n\n    ),\n\n    filtered as (\n\n        select *\n        from all_periods\n        where date_{{datepart}} <= {{ end_date }}\n\n    )\n\n    select * from filtered\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.generate_series", "macro.dbt.get_intervals_between", "macro.dbt.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9481802, "supported_languages": null}, "macro.dbt.escape_single_quotes": {"name": "escape_single_quotes", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "unique_id": "macro.dbt.escape_single_quotes", "macro_sql": "{% macro escape_single_quotes(expression) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt') (expression)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9483457, "supported_languages": null}, "macro.dbt.default__escape_single_quotes": {"name": "default__escape_single_quotes", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/escape_single_quotes.sql", "original_file_path": "macros/utils/escape_single_quotes.sql", "unique_id": "macro.dbt.default__escape_single_quotes", "macro_sql": "{% macro default__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\",\"''\") }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.948429, "supported_languages": null}, "macro.dbt.position": {"name": "position", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/position.sql", "original_file_path": "macros/utils/position.sql", "unique_id": "macro.dbt.position", "macro_sql": "{% macro position(substring_text, string_text) -%}\n    {{ return(adapter.dispatch('position', 'dbt') (substring_text, string_text)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__position"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9486022, "supported_languages": null}, "macro.dbt.default__position": {"name": "default__position", "resource_type": "macro", "package_name": "dbt", "path": "macros/utils/position.sql", "original_file_path": "macros/utils/position.sql", "unique_id": "macro.dbt.default__position", "macro_sql": "{% macro default__position(substring_text, string_text) %}\n\n    position(\n        {{ substring_text }} in {{ string_text }}\n    )\n\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9486835, "supported_languages": null}, "macro.dbt.default__test_not_null": {"name": "default__test_not_null", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/not_null.sql", "original_file_path": "macros/generic_test_sql/not_null.sql", "unique_id": "macro.dbt.default__test_not_null", "macro_sql": "{% macro default__test_not_null(model, column_name) %}\n\n{% set column_list = '*' if should_store_failures() else column_name %}\n\nselect {{ column_list }}\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_store_failures"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9488587, "supported_languages": null}, "macro.dbt.default__test_relationships": {"name": "default__test_relationships", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/relationships.sql", "original_file_path": "macros/generic_test_sql/relationships.sql", "unique_id": "macro.dbt.default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, column_name, to, field) %}\n\nwith child as (\n    select {{ column_name }} as from_field\n    from {{ model }}\n    where {{ column_name }} is not null\n),\n\nparent as (\n    select {{ field }} as to_field\n    from {{ to }}\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.949047, "supported_languages": null}, "macro.dbt.default__test_accepted_values": {"name": "default__test_accepted_values", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/accepted_values.sql", "original_file_path": "macros/generic_test_sql/accepted_values.sql", "unique_id": "macro.dbt.default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, column_name, values, quote=True) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field,\n        count(*) as n_records\n\n    from {{ model }}\n    group by {{ column_name }}\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    {% for value in values -%}\n        {% if quote -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n    {%- endfor %}\n)\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.949381, "supported_languages": null}, "macro.dbt.default__test_unique": {"name": "default__test_unique", "resource_type": "macro", "package_name": "dbt", "path": "macros/generic_test_sql/unique.sql", "original_file_path": "macros/generic_test_sql/unique.sql", "unique_id": "macro.dbt.default__test_unique", "macro_sql": "{% macro default__test_unique(model, column_name) %}\n\nselect\n    {{ column_name }} as unique_field,\n    count(*) as n_records\n\nfrom {{ model }}\nwhere {{ column_name }} is not null\ngroup by {{ column_name }}\nhaving count(*) > 1\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9495254, "supported_languages": null}, "macro.dbt.drop_schema_named": {"name": "drop_schema_named", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/schema.sql", "original_file_path": "macros/relations/schema.sql", "unique_id": "macro.dbt.drop_schema_named", "macro_sql": "{% macro drop_schema_named(schema_name) %}\n    {{ return(adapter.dispatch('drop_schema_named', 'dbt') (schema_name)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_schema_named"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.949685, "supported_languages": null}, "macro.dbt.default__drop_schema_named": {"name": "default__drop_schema_named", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/schema.sql", "original_file_path": "macros/relations/schema.sql", "unique_id": "macro.dbt.default__drop_schema_named", "macro_sql": "{% macro default__drop_schema_named(schema_name) %}\n  {% set schema_relation = api.Relation.create(schema=schema_name) %}\n  {{ adapter.drop_schema(schema_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9498124, "supported_languages": null}, "macro.dbt.get_create_intermediate_sql": {"name": "get_create_intermediate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create_intermediate.sql", "original_file_path": "macros/relations/create_intermediate.sql", "unique_id": "macro.dbt.get_create_intermediate_sql", "macro_sql": "{%- macro get_create_intermediate_sql(relation, sql) -%}\n    {{- log('Applying CREATE INTERMEDIATE to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_create_intermediate_sql', 'dbt')(relation, sql) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_create_intermediate_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9500184, "supported_languages": null}, "macro.dbt.default__get_create_intermediate_sql": {"name": "default__get_create_intermediate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create_intermediate.sql", "original_file_path": "macros/relations/create_intermediate.sql", "unique_id": "macro.dbt.default__get_create_intermediate_sql", "macro_sql": "{%- macro default__get_create_intermediate_sql(relation, sql) -%}\n\n    -- get the standard intermediate name\n    {% set intermediate_relation = make_intermediate_relation(relation) %}\n\n    -- drop any pre-existing intermediate\n    {{ get_drop_sql(intermediate_relation) }};\n\n    {{ get_create_sql(intermediate_relation, sql) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_intermediate_relation", "macro.dbt.get_drop_sql", "macro.dbt.get_create_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9501767, "supported_languages": null}, "macro.dbt.get_drop_backup_sql": {"name": "get_drop_backup_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop_backup.sql", "original_file_path": "macros/relations/drop_backup.sql", "unique_id": "macro.dbt.get_drop_backup_sql", "macro_sql": "{%- macro get_drop_backup_sql(relation) -%}\n    {{- log('Applying DROP BACKUP to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_drop_backup_sql', 'dbt')(relation) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_drop_backup_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9503598, "supported_languages": null}, "macro.dbt.default__get_drop_backup_sql": {"name": "default__get_drop_backup_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop_backup.sql", "original_file_path": "macros/relations/drop_backup.sql", "unique_id": "macro.dbt.default__get_drop_backup_sql", "macro_sql": "{%- macro default__get_drop_backup_sql(relation) -%}\n\n    -- get the standard backup name\n    {% set backup_relation = make_backup_relation(relation, relation.type) %}\n\n    {{ get_drop_sql(backup_relation) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_backup_relation", "macro.dbt.get_drop_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9504824, "supported_languages": null}, "macro.dbt.get_replace_sql": {"name": "get_replace_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/replace.sql", "original_file_path": "macros/relations/replace.sql", "unique_id": "macro.dbt.get_replace_sql", "macro_sql": "{% macro get_replace_sql(existing_relation, target_relation, sql) %}\n    {{- log('Applying REPLACE to: ' ~ existing_relation) -}}\n    {{- adapter.dispatch('get_replace_sql', 'dbt')(existing_relation, target_relation, sql) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_replace_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.950832, "supported_languages": null}, "macro.dbt.default__get_replace_sql": {"name": "default__get_replace_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/replace.sql", "original_file_path": "macros/relations/replace.sql", "unique_id": "macro.dbt.default__get_replace_sql", "macro_sql": "{% macro default__get_replace_sql(existing_relation, target_relation, sql) %}\n\n    {# /* use a create or replace statement if possible */ #}\n\n    {% set is_replaceable = existing_relation.type == target_relation_type and existing_relation.can_be_replaced %}\n\n    {% if is_replaceable and existing_relation.is_view %}\n        {{ get_replace_view_sql(target_relation, sql) }}\n\n    {% elif is_replaceable and existing_relation.is_table %}\n        {{ get_replace_table_sql(target_relation, sql) }}\n\n    {% elif is_replaceable and existing_relation.is_materialized_view %}\n        {{ get_replace_materialized_view_sql(target_relation, sql) }}\n\n    {# /* a create or replace statement is not possible, so try to stage and/or backup to be safe */ #}\n\n    {# /* create target_relation as an intermediate relation, then swap it out with the existing one using a backup */ #}\n    {%- elif target_relation.can_be_renamed and existing_relation.can_be_renamed -%}\n        {{ get_create_intermediate_sql(target_relation, sql) }};\n        {{ get_create_backup_sql(existing_relation) }};\n        {{ get_rename_intermediate_sql(target_relation) }};\n        {{ get_drop_backup_sql(existing_relation) }}\n\n    {# /* create target_relation as an intermediate relation, then swap it out with the existing one without using a backup */ #}\n    {%- elif target_relation.can_be_renamed -%}\n        {{ get_create_intermediate_sql(target_relation, sql) }};\n        {{ get_drop_sql(existing_relation) }};\n        {{ get_rename_intermediate_sql(target_relation) }}\n\n    {# /* create target_relation in place by first backing up the existing relation */ #}\n    {%- elif existing_relation.can_be_renamed -%}\n        {{ get_create_backup_sql(existing_relation) }};\n        {{ get_create_sql(target_relation, sql) }};\n        {{ get_drop_backup_sql(existing_relation) }}\n\n    {# /* no renaming is allowed, so just drop and create */ #}\n    {%- else -%}\n        {{ get_drop_sql(existing_relation) }};\n        {{ get_create_sql(target_relation, sql) }}\n\n    {%- endif -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_replace_view_sql", "macro.dbt.get_replace_table_sql", "macro.dbt.get_replace_materialized_view_sql", "macro.dbt.get_create_intermediate_sql", "macro.dbt.get_create_backup_sql", "macro.dbt.get_rename_intermediate_sql", "macro.dbt.get_drop_backup_sql", "macro.dbt.get_drop_sql", "macro.dbt.get_create_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9516008, "supported_languages": null}, "macro.dbt.get_rename_intermediate_sql": {"name": "get_rename_intermediate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename_intermediate.sql", "original_file_path": "macros/relations/rename_intermediate.sql", "unique_id": "macro.dbt.get_rename_intermediate_sql", "macro_sql": "{%- macro get_rename_intermediate_sql(relation) -%}\n    {{- log('Applying RENAME INTERMEDIATE to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_rename_intermediate_sql', 'dbt')(relation) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_rename_intermediate_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.951794, "supported_languages": null}, "macro.dbt.default__get_rename_intermediate_sql": {"name": "default__get_rename_intermediate_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename_intermediate.sql", "original_file_path": "macros/relations/rename_intermediate.sql", "unique_id": "macro.dbt.default__get_rename_intermediate_sql", "macro_sql": "{%- macro default__get_rename_intermediate_sql(relation) -%}\n\n    -- get the standard intermediate name\n    {% set intermediate_relation = make_intermediate_relation(relation) %}\n\n    {{ get_rename_sql(intermediate_relation, relation.identifier) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_intermediate_relation", "macro.dbt.get_rename_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9519198, "supported_languages": null}, "macro.dbt.get_create_sql": {"name": "get_create_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create.sql", "original_file_path": "macros/relations/create.sql", "unique_id": "macro.dbt.get_create_sql", "macro_sql": "{%- macro get_create_sql(relation, sql) -%}\n    {{- log('Applying CREATE to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_create_sql', 'dbt')(relation, sql) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_create_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9521606, "supported_languages": null}, "macro.dbt.default__get_create_sql": {"name": "default__get_create_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create.sql", "original_file_path": "macros/relations/create.sql", "unique_id": "macro.dbt.default__get_create_sql", "macro_sql": "{%- macro default__get_create_sql(relation, sql) -%}\n\n    {%- if relation.is_view -%}\n        {{ get_create_view_as_sql(relation, sql) }}\n\n    {%- elif relation.is_table -%}\n        {{ get_create_table_as_sql(False, relation, sql) }}\n\n    {%- elif relation.is_materialized_view -%}\n        {{ get_create_materialized_view_as_sql(relation, sql) }}\n\n    {%- else -%}\n        {{- exceptions.raise_compiler_error(\"`get_create_sql` has not been implemented for: \" ~ relation.type ) -}}\n\n    {%- endif -%}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.get_create_view_as_sql", "macro.dbt.get_create_table_as_sql", "macro.dbt.get_create_materialized_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.952432, "supported_languages": null}, "macro.dbt.get_drop_sql": {"name": "get_drop_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.get_drop_sql", "macro_sql": "{%- macro get_drop_sql(relation) -%}\n    {{- log('Applying DROP to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_drop_sql', 'dbt')(relation) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_drop_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9527073, "supported_languages": null}, "macro.dbt.default__get_drop_sql": {"name": "default__get_drop_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.default__get_drop_sql", "macro_sql": "{%- macro default__get_drop_sql(relation) -%}\n\n    {%- if relation.is_view -%}\n        {{ drop_view(relation) }}\n\n    {%- elif relation.is_table -%}\n        {{ drop_table(relation) }}\n\n    {%- elif relation.is_materialized_view -%}\n        {{ drop_materialized_view(relation) }}\n\n    {%- else -%}\n        drop {{ relation.type }} if exists {{ relation.render() }} cascade\n\n    {%- endif -%}\n\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.drop_view", "macro.dbt.drop_table", "macro.dbt.drop_materialized_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.952934, "supported_languages": null}, "macro.dbt.drop_relation": {"name": "drop_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n    {{ return(adapter.dispatch('drop_relation', 'dbt')(relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9530456, "supported_languages": null}, "macro.dbt.default__drop_relation": {"name": "default__drop_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n    {% call statement('drop_relation', auto_begin=False) -%}\n        {{ get_drop_sql(relation) }}\n    {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt.get_drop_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.95317, "supported_languages": null}, "macro.dbt.drop_relation_if_exists": {"name": "drop_relation_if_exists", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/drop.sql", "original_file_path": "macros/relations/drop.sql", "unique_id": "macro.dbt.drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9532864, "supported_languages": null}, "macro.dbt.get_create_backup_sql": {"name": "get_create_backup_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create_backup.sql", "original_file_path": "macros/relations/create_backup.sql", "unique_id": "macro.dbt.get_create_backup_sql", "macro_sql": "{%- macro get_create_backup_sql(relation) -%}\n    {{- log('Applying CREATE BACKUP to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_create_backup_sql', 'dbt')(relation) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_create_backup_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9534798, "supported_languages": null}, "macro.dbt.default__get_create_backup_sql": {"name": "default__get_create_backup_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/create_backup.sql", "original_file_path": "macros/relations/create_backup.sql", "unique_id": "macro.dbt.default__get_create_backup_sql", "macro_sql": "{%- macro default__get_create_backup_sql(relation) -%}\n\n    -- get the standard backup name\n    {% set backup_relation = make_backup_relation(relation, relation.type) %}\n\n    -- drop any pre-existing backup\n    {{ get_drop_sql(backup_relation) }};\n\n    {{ get_rename_sql(relation, backup_relation.identifier) }}\n\n{%- endmacro -%}", "depends_on": {"macros": ["macro.dbt.make_backup_relation", "macro.dbt.get_drop_sql", "macro.dbt.get_rename_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9536376, "supported_languages": null}, "macro.dbt.get_rename_sql": {"name": "get_rename_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt.get_rename_sql", "macro_sql": "{%- macro get_rename_sql(relation, new_name) -%}\n    {{- log('Applying RENAME to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_rename_sql', 'dbt')(relation, new_name) -}}\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.default__get_rename_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9539227, "supported_languages": null}, "macro.dbt.default__get_rename_sql": {"name": "default__get_rename_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt.default__get_rename_sql", "macro_sql": "{%- macro default__get_rename_sql(relation, new_name) -%}\n\n    {%- if relation.is_view -%}\n        {{ get_rename_view_sql(relation, new_name) }}\n\n    {%- elif relation.is_table -%}\n        {{ get_rename_table_sql(relation, new_name) }}\n\n    {%- elif relation.is_materialized_view -%}\n        {{ get_rename_materialized_view_sql(relation, new_name) }}\n\n    {%- else -%}\n        {{- exceptions.raise_compiler_error(\"`get_rename_sql` has not been implemented for: \" ~ relation.type ) -}}\n\n    {%- endif -%}\n\n{%- endmacro -%}\n\n\n", "depends_on": {"macros": ["macro.dbt.get_rename_view_sql", "macro.dbt.get_rename_table_sql", "macro.dbt.get_rename_materialized_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9541786, "supported_languages": null}, "macro.dbt.rename_relation": {"name": "rename_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt.rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation', 'dbt')(from_relation, to_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__rename_relation"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9542983, "supported_languages": null}, "macro.dbt.default__rename_relation": {"name": "default__rename_relation", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/rename.sql", "original_file_path": "macros/relations/rename.sql", "unique_id": "macro.dbt.default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation.render() }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9544764, "supported_languages": null}, "macro.dbt.get_replace_view_sql": {"name": "get_replace_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.get_replace_view_sql", "macro_sql": "{% macro get_replace_view_sql(relation, sql) %}\n    {{- adapter.dispatch('get_replace_view_sql', 'dbt')(relation, sql) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_replace_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9548118, "supported_languages": null}, "macro.dbt.default__get_replace_view_sql": {"name": "default__get_replace_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.default__get_replace_view_sql", "macro_sql": "{% macro default__get_replace_view_sql(relation, sql) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_replace_view_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9549012, "supported_languages": null}, "macro.dbt.create_or_replace_view": {"name": "create_or_replace_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.create_or_replace_view", "macro_sql": "{% macro create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {% set should_revoke = should_revoke(exists_as_view, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.955555, "supported_languages": null}, "macro.dbt.handle_existing_table": {"name": "handle_existing_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch('handle_existing_table', 'dbt')(full_refresh, old_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__handle_existing_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.955673, "supported_languages": null}, "macro.dbt.default__handle_existing_table": {"name": "default__handle_existing_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/replace.sql", "original_file_path": "macros/relations/view/replace.sql", "unique_id": "macro.dbt.default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ log(\"Dropping relation \" ~ old_relation.render() ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9558125, "supported_languages": null}, "macro.dbt.get_create_view_as_sql": {"name": "get_create_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt.get_create_view_as_sql", "macro_sql": "{% macro get_create_view_as_sql(relation, sql) -%}\n  {{ adapter.dispatch('get_create_view_as_sql', 'dbt')(relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.956038, "supported_languages": null}, "macro.dbt.default__get_create_view_as_sql": {"name": "default__get_create_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt.default__get_create_view_as_sql", "macro_sql": "{% macro default__get_create_view_as_sql(relation, sql) -%}\n  {{ return(create_view_as(relation, sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9561365, "supported_languages": null}, "macro.dbt.create_view_as": {"name": "create_view_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt.create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as', 'dbt')(relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9562466, "supported_languages": null}, "macro.dbt.default__create_view_as": {"name": "default__create_view_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/create.sql", "original_file_path": "macros/relations/view/create.sql", "unique_id": "macro.dbt.default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation.render() }}\n    {% set contract_config = config.get('contract') %}\n    {% if contract_config.enforced %}\n      {{ get_assert_columns_equivalent(sql) }}\n    {%- endif %}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.956509, "supported_languages": null}, "macro.dbt.drop_view": {"name": "drop_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/drop.sql", "original_file_path": "macros/relations/view/drop.sql", "unique_id": "macro.dbt.drop_view", "macro_sql": "{% macro drop_view(relation) -%}\n    {{- adapter.dispatch('drop_view', 'dbt')(relation) -}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__drop_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.956664, "supported_languages": null}, "macro.dbt.default__drop_view": {"name": "default__drop_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/drop.sql", "original_file_path": "macros/relations/view/drop.sql", "unique_id": "macro.dbt.default__drop_view", "macro_sql": "{% macro default__drop_view(relation) -%}\n    drop view if exists {{ relation.render() }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.956742, "supported_languages": null}, "macro.dbt.get_rename_view_sql": {"name": "get_rename_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/rename.sql", "original_file_path": "macros/relations/view/rename.sql", "unique_id": "macro.dbt.get_rename_view_sql", "macro_sql": "{% macro get_rename_view_sql(relation, new_name) %}\n    {{- adapter.dispatch('get_rename_view_sql', 'dbt')(relation, new_name) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_rename_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.956967, "supported_languages": null}, "macro.dbt.default__get_rename_view_sql": {"name": "default__get_rename_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/view/rename.sql", "original_file_path": "macros/relations/view/rename.sql", "unique_id": "macro.dbt.default__get_rename_view_sql", "macro_sql": "{% macro default__get_rename_view_sql(relation, new_name) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_rename_view_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.957058, "supported_languages": null}, "macro.dbt.get_table_columns_and_constraints": {"name": "get_table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.get_table_columns_and_constraints", "macro_sql": "{%- macro get_table_columns_and_constraints() -%}\n  {{ adapter.dispatch('get_table_columns_and_constraints', 'dbt')() }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__get_table_columns_and_constraints"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9575503, "supported_languages": null}, "macro.dbt.default__get_table_columns_and_constraints": {"name": "default__get_table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__get_table_columns_and_constraints", "macro_sql": "{% macro default__get_table_columns_and_constraints() -%}\n  {{ return(table_columns_and_constraints()) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.table_columns_and_constraints"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9576325, "supported_languages": null}, "macro.dbt.table_columns_and_constraints": {"name": "table_columns_and_constraints", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.table_columns_and_constraints", "macro_sql": "{% macro table_columns_and_constraints() %}\n  {# loop through user_provided_columns to create DDL with data types and constraints #}\n    {%- set raw_column_constraints = adapter.render_raw_columns_constraints(raw_columns=model['columns']) -%}\n    {%- set raw_model_constraints = adapter.render_raw_model_constraints(raw_constraints=model['constraints']) -%}\n    (\n    {% for c in raw_column_constraints -%}\n      {{ c }}{{ \",\" if not loop.last or raw_model_constraints }}\n    {% endfor %}\n    {% for c in raw_model_constraints -%}\n        {{ c }}{{ \",\" if not loop.last }}\n    {% endfor -%}\n    )\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9580507, "supported_languages": null}, "macro.dbt.get_assert_columns_equivalent": {"name": "get_assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.get_assert_columns_equivalent", "macro_sql": "\n\n{%- macro get_assert_columns_equivalent(sql) -%}\n  {{ adapter.dispatch('get_assert_columns_equivalent', 'dbt')(sql) }}\n{%- endmacro -%}\n\n", "depends_on": {"macros": ["macro.dbt.default__get_assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9581788, "supported_languages": null}, "macro.dbt.default__get_assert_columns_equivalent": {"name": "default__get_assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__get_assert_columns_equivalent", "macro_sql": "{% macro default__get_assert_columns_equivalent(sql) -%}\n  {{ return(assert_columns_equivalent(sql)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.assert_columns_equivalent"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9582677, "supported_languages": null}, "macro.dbt.assert_columns_equivalent": {"name": "assert_columns_equivalent", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.assert_columns_equivalent", "macro_sql": "{% macro assert_columns_equivalent(sql) %}\n\n  {#-- First ensure the user has defined 'columns' in yaml specification --#}\n  {%- set user_defined_columns = model['columns'] -%}\n  {%- if not user_defined_columns -%}\n      {{ exceptions.raise_contract_error([], []) }}\n  {%- endif -%}\n\n  {#-- Obtain the column schema provided by sql file. #}\n  {%- set sql_file_provided_columns = get_column_schema_from_query(sql, config.get('sql_header', none)) -%}\n  {#--Obtain the column schema provided by the schema file by generating an 'empty schema' query from the model's columns. #}\n  {%- set schema_file_provided_columns = get_column_schema_from_query(get_empty_schema_sql(user_defined_columns)) -%}\n\n  {#-- create dictionaries with name and formatted data type and strings for exception #}\n  {%- set sql_columns = format_columns(sql_file_provided_columns) -%}\n  {%- set yaml_columns = format_columns(schema_file_provided_columns)  -%}\n\n  {%- if sql_columns|length != yaml_columns|length -%}\n    {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n  {%- endif -%}\n\n  {%- for sql_col in sql_columns -%}\n    {%- set yaml_col = [] -%}\n    {%- for this_col in yaml_columns -%}\n      {%- if this_col['name'] == sql_col['name'] -%}\n        {%- do yaml_col.append(this_col) -%}\n        {%- break -%}\n      {%- endif -%}\n    {%- endfor -%}\n    {%- if not yaml_col -%}\n      {#-- Column with name not found in yaml #}\n      {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n    {%- endif -%}\n    {%- if sql_col['formatted'] != yaml_col[0]['formatted'] -%}\n      {#-- Column data types don't match #}\n      {%- do exceptions.raise_contract_error(yaml_columns, sql_columns) -%}\n    {%- endif -%}\n  {%- endfor -%}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_column_schema_from_query", "macro.dbt.get_empty_schema_sql", "macro.dbt.format_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.959017, "supported_languages": null}, "macro.dbt.format_columns": {"name": "format_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.format_columns", "macro_sql": "{% macro format_columns(columns) %}\n  {% set formatted_columns = [] %}\n  {% for column in columns %}\n    {%- set formatted_column = adapter.dispatch('format_column', 'dbt')(column) -%}\n    {%- do formatted_columns.append(formatted_column) -%}\n  {% endfor %}\n  {{ return(formatted_columns) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__format_column"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9592538, "supported_languages": null}, "macro.dbt.default__format_column": {"name": "default__format_column", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/column/columns_spec_ddl.sql", "original_file_path": "macros/relations/column/columns_spec_ddl.sql", "unique_id": "macro.dbt.default__format_column", "macro_sql": "{% macro default__format_column(column) -%}\n  {% set data_type = column.dtype %}\n  {% set formatted = column.column.lower() ~ \" \" ~ data_type %}\n  {{ return({'name': column.name, 'data_type': data_type, 'formatted': formatted}) }}\n{%- endmacro -%}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9594567, "supported_languages": null}, "macro.dbt.get_replace_table_sql": {"name": "get_replace_table_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/replace.sql", "original_file_path": "macros/relations/table/replace.sql", "unique_id": "macro.dbt.get_replace_table_sql", "macro_sql": "{% macro get_replace_table_sql(relation, sql) %}\n    {{- adapter.dispatch('get_replace_table_sql', 'dbt')(relation, sql) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_replace_table_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9596376, "supported_languages": null}, "macro.dbt.default__get_replace_table_sql": {"name": "default__get_replace_table_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/replace.sql", "original_file_path": "macros/relations/table/replace.sql", "unique_id": "macro.dbt.default__get_replace_table_sql", "macro_sql": "{% macro default__get_replace_table_sql(relation, sql) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_replace_table_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9597278, "supported_languages": null}, "macro.dbt.get_create_table_as_sql": {"name": "get_create_table_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.get_create_table_as_sql", "macro_sql": "{% macro get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ adapter.dispatch('get_create_table_as_sql', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_create_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9601302, "supported_languages": null}, "macro.dbt.default__get_create_table_as_sql": {"name": "default__get_create_table_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.default__get_create_table_as_sql", "macro_sql": "{% macro default__get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ return(create_table_as(temporary, relation, sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.960237, "supported_languages": null}, "macro.dbt.create_table_as": {"name": "create_table_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, compiled_code, language='sql') -%}\n  {# backward compatibility for create_table_as that does not support language #}\n  {% if language == \"sql\" %}\n    {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, compiled_code)}}\n  {% else %}\n    {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, compiled_code, language) }}\n  {% endif %}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9604888, "supported_languages": null}, "macro.dbt.default__create_table_as": {"name": "default__create_table_as", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  {% set contract_config = config.get('contract') %}\n  {% if contract_config.enforced and (not temporary) %}\n    {{ get_assert_columns_equivalent(sql) }}\n    {{ get_table_columns_and_constraints() }}\n    {%- set sql = get_select_subquery(sql) %}\n  {% endif %}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_assert_columns_equivalent", "macro.dbt.get_table_columns_and_constraints", "macro.dbt.get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9608886, "supported_languages": null}, "macro.dbt.default__get_column_names": {"name": "default__get_column_names", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.default__get_column_names", "macro_sql": "{% macro default__get_column_names() %}\n  {#- loop through user_provided_columns to get column names -#}\n    {%- set user_provided_columns = model['columns'] -%}\n    {%- for i in user_provided_columns %}\n      {%- set col = user_provided_columns[i] -%}\n      {%- set col_name = adapter.quote(col['name']) if col.get('quote') else col['name'] -%}\n      {{ col_name }}{{ \", \" if not loop.last }}\n    {%- endfor -%}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9611745, "supported_languages": null}, "macro.dbt.get_select_subquery": {"name": "get_select_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.get_select_subquery", "macro_sql": "{% macro get_select_subquery(sql) %}\n  {{ return(adapter.dispatch('get_select_subquery', 'dbt')(sql)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_select_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.961286, "supported_languages": null}, "macro.dbt.default__get_select_subquery": {"name": "default__get_select_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/create.sql", "original_file_path": "macros/relations/table/create.sql", "unique_id": "macro.dbt.default__get_select_subquery", "macro_sql": "{% macro default__get_select_subquery(sql) %}\n    select {{ adapter.dispatch('get_column_names', 'dbt')() }}\n    from (\n        {{ sql }}\n    ) as model_subq\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_column_names"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9613905, "supported_languages": null}, "macro.dbt.drop_table": {"name": "drop_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/drop.sql", "original_file_path": "macros/relations/table/drop.sql", "unique_id": "macro.dbt.drop_table", "macro_sql": "{% macro drop_table(relation) -%}\n    {{- adapter.dispatch('drop_table', 'dbt')(relation) -}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__drop_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.961546, "supported_languages": null}, "macro.dbt.default__drop_table": {"name": "default__drop_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/drop.sql", "original_file_path": "macros/relations/table/drop.sql", "unique_id": "macro.dbt.default__drop_table", "macro_sql": "{% macro default__drop_table(relation) -%}\n    drop table if exists {{ relation.render() }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9616194, "supported_languages": null}, "macro.dbt.get_rename_table_sql": {"name": "get_rename_table_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/rename.sql", "original_file_path": "macros/relations/table/rename.sql", "unique_id": "macro.dbt.get_rename_table_sql", "macro_sql": "{% macro get_rename_table_sql(relation, new_name) %}\n    {{- adapter.dispatch('get_rename_table_sql', 'dbt')(relation, new_name) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_rename_table_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.961781, "supported_languages": null}, "macro.dbt.default__get_rename_table_sql": {"name": "default__get_rename_table_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/table/rename.sql", "original_file_path": "macros/relations/table/rename.sql", "unique_id": "macro.dbt.default__get_rename_table_sql", "macro_sql": "{% macro default__get_rename_table_sql(relation, new_name) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_rename_table_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.961869, "supported_languages": null}, "macro.dbt.get_alter_materialized_view_as_sql": {"name": "get_alter_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt.get_alter_materialized_view_as_sql", "macro_sql": "{% macro get_alter_materialized_view_as_sql(\n    relation,\n    configuration_changes,\n    sql,\n    existing_relation,\n    backup_relation,\n    intermediate_relation\n) %}\n    {{- log('Applying ALTER to: ' ~ relation) -}}\n    {{- adapter.dispatch('get_alter_materialized_view_as_sql', 'dbt')(\n        relation,\n        configuration_changes,\n        sql,\n        existing_relation,\n        backup_relation,\n        intermediate_relation\n    ) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_alter_materialized_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.962214, "supported_languages": null}, "macro.dbt.default__get_alter_materialized_view_as_sql": {"name": "default__get_alter_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt.default__get_alter_materialized_view_as_sql", "macro_sql": "{% macro default__get_alter_materialized_view_as_sql(\n    relation,\n    configuration_changes,\n    sql,\n    existing_relation,\n    backup_relation,\n    intermediate_relation\n) %}\n    {{ exceptions.raise_compiler_error(\"Materialized views have not been implemented for this adapter.\") }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9623296, "supported_languages": null}, "macro.dbt.get_materialized_view_configuration_changes": {"name": "get_materialized_view_configuration_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt.get_materialized_view_configuration_changes", "macro_sql": "{% macro get_materialized_view_configuration_changes(existing_relation, new_config) %}\n    /* {#\n    It's recommended that configuration changes be formatted as follows:\n    {\"<change_category>\": [{\"action\": \"<name>\", \"context\": ...}]}\n\n    For example:\n    {\n        \"indexes\": [\n            {\"action\": \"drop\", \"context\": \"index_abc\"},\n            {\"action\": \"create\", \"context\": {\"columns\": [\"column_1\", \"column_2\"], \"type\": \"hash\", \"unique\": True}},\n        ],\n    }\n\n    Either way, `get_materialized_view_configuration_changes` needs to align with `get_alter_materialized_view_as_sql`.\n    #} */\n    {{- log('Determining configuration changes on: ' ~ existing_relation) -}}\n    {%- do return(adapter.dispatch('get_materialized_view_configuration_changes', 'dbt')(existing_relation, new_config)) -%}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_materialized_view_configuration_changes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9625738, "supported_languages": null}, "macro.dbt.default__get_materialized_view_configuration_changes": {"name": "default__get_materialized_view_configuration_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/alter.sql", "original_file_path": "macros/relations/materialized_view/alter.sql", "unique_id": "macro.dbt.default__get_materialized_view_configuration_changes", "macro_sql": "{% macro default__get_materialized_view_configuration_changes(existing_relation, new_config) %}\n    {{ exceptions.raise_compiler_error(\"Materialized views have not been implemented for this adapter.\") }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9626646, "supported_languages": null}, "macro.dbt.get_replace_materialized_view_sql": {"name": "get_replace_materialized_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/replace.sql", "original_file_path": "macros/relations/materialized_view/replace.sql", "unique_id": "macro.dbt.get_replace_materialized_view_sql", "macro_sql": "{% macro get_replace_materialized_view_sql(relation, sql) %}\n    {{- adapter.dispatch('get_replace_materialized_view_sql', 'dbt')(relation, sql) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_replace_materialized_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9628303, "supported_languages": null}, "macro.dbt.default__get_replace_materialized_view_sql": {"name": "default__get_replace_materialized_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/replace.sql", "original_file_path": "macros/relations/materialized_view/replace.sql", "unique_id": "macro.dbt.default__get_replace_materialized_view_sql", "macro_sql": "{% macro default__get_replace_materialized_view_sql(relation, sql) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_replace_materialized_view_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9629242, "supported_languages": null}, "macro.dbt.get_create_materialized_view_as_sql": {"name": "get_create_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/create.sql", "original_file_path": "macros/relations/materialized_view/create.sql", "unique_id": "macro.dbt.get_create_materialized_view_as_sql", "macro_sql": "{% macro get_create_materialized_view_as_sql(relation, sql) -%}\n    {{- adapter.dispatch('get_create_materialized_view_as_sql', 'dbt')(relation, sql) -}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_create_materialized_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.963084, "supported_languages": null}, "macro.dbt.default__get_create_materialized_view_as_sql": {"name": "default__get_create_materialized_view_as_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/create.sql", "original_file_path": "macros/relations/materialized_view/create.sql", "unique_id": "macro.dbt.default__get_create_materialized_view_as_sql", "macro_sql": "{% macro default__get_create_materialized_view_as_sql(relation, sql) -%}\n    {{ exceptions.raise_compiler_error(\n        \"`get_create_materialized_view_as_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.963176, "supported_languages": null}, "macro.dbt.drop_materialized_view": {"name": "drop_materialized_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/drop.sql", "original_file_path": "macros/relations/materialized_view/drop.sql", "unique_id": "macro.dbt.drop_materialized_view", "macro_sql": "{% macro drop_materialized_view(relation) -%}\n    {{- adapter.dispatch('drop_materialized_view', 'dbt')(relation) -}}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__drop_materialized_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.963328, "supported_languages": null}, "macro.dbt.default__drop_materialized_view": {"name": "default__drop_materialized_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/drop.sql", "original_file_path": "macros/relations/materialized_view/drop.sql", "unique_id": "macro.dbt.default__drop_materialized_view", "macro_sql": "{% macro default__drop_materialized_view(relation) -%}\n    drop materialized view if exists {{ relation.render() }} cascade\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.963403, "supported_languages": null}, "macro.dbt.get_rename_materialized_view_sql": {"name": "get_rename_materialized_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/rename.sql", "original_file_path": "macros/relations/materialized_view/rename.sql", "unique_id": "macro.dbt.get_rename_materialized_view_sql", "macro_sql": "{% macro get_rename_materialized_view_sql(relation, new_name) %}\n    {{- adapter.dispatch('get_rename_materialized_view_sql', 'dbt')(relation, new_name) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_rename_materialized_view_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9635673, "supported_languages": null}, "macro.dbt.default__get_rename_materialized_view_sql": {"name": "default__get_rename_materialized_view_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/rename.sql", "original_file_path": "macros/relations/materialized_view/rename.sql", "unique_id": "macro.dbt.default__get_rename_materialized_view_sql", "macro_sql": "{% macro default__get_rename_materialized_view_sql(relation, new_name) %}\n    {{ exceptions.raise_compiler_error(\n        \"`get_rename_materialized_view_sql` has not been implemented for this adapter.\"\n    ) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9636595, "supported_languages": null}, "macro.dbt.refresh_materialized_view": {"name": "refresh_materialized_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/refresh.sql", "original_file_path": "macros/relations/materialized_view/refresh.sql", "unique_id": "macro.dbt.refresh_materialized_view", "macro_sql": "{% macro refresh_materialized_view(relation) %}\n    {{- log('Applying REFRESH to: ' ~ relation) -}}\n    {{- adapter.dispatch('refresh_materialized_view', 'dbt')(relation) -}}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__refresh_materialized_view"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9638436, "supported_languages": null}, "macro.dbt.default__refresh_materialized_view": {"name": "default__refresh_materialized_view", "resource_type": "macro", "package_name": "dbt", "path": "macros/relations/materialized_view/refresh.sql", "original_file_path": "macros/relations/materialized_view/refresh.sql", "unique_id": "macro.dbt.default__refresh_materialized_view", "macro_sql": "{% macro default__refresh_materialized_view(relation) %}\n    {{ exceptions.raise_compiler_error(\"`refresh_materialized_view` has not been implemented for this adapter.\") }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9639256, "supported_languages": null}, "macro.dbt.run_hooks": {"name": "run_hooks", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9644556, "supported_languages": null}, "macro.dbt.make_hook_config": {"name": "make_hook_config", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9645739, "supported_languages": null}, "macro.dbt.before_begin": {"name": "before_begin", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9646633, "supported_languages": null}, "macro.dbt.in_transaction": {"name": "in_transaction", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9647472, "supported_languages": null}, "macro.dbt.after_commit": {"name": "after_commit", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "unique_id": "macro.dbt.after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9648328, "supported_languages": null}, "macro.dbt.set_sql_header": {"name": "set_sql_header", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9650204, "supported_languages": null}, "macro.dbt.should_full_refresh": {"name": "should_full_refresh", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9652038, "supported_languages": null}, "macro.dbt.should_store_failures": {"name": "should_store_failures", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "unique_id": "macro.dbt.should_store_failures", "macro_sql": "{% macro should_store_failures() %}\n  {% set config_store_failures = config.get('store_failures') %}\n  {% if config_store_failures is none %}\n    {% set config_store_failures = flags.STORE_FAILURES %}\n  {% endif %}\n  {% do return(config_store_failures) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9653788, "supported_languages": null}, "macro.dbt.get_where_subquery": {"name": "get_where_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "unique_id": "macro.dbt.get_where_subquery", "macro_sql": "{% macro get_where_subquery(relation) -%}\n    {% do return(adapter.dispatch('get_where_subquery', 'dbt')(relation)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_where_subquery"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9655807, "supported_languages": null}, "macro.dbt.default__get_where_subquery": {"name": "default__get_where_subquery", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "unique_id": "macro.dbt.default__get_where_subquery", "macro_sql": "{% macro default__get_where_subquery(relation) -%}\n    {% set where = config.get('where', '') %}\n    {% if where %}\n        {%- set filtered -%}\n            (select * from {{ relation }} where {{ where }}) dbt_subquery\n        {%- endset -%}\n        {% do return(filtered) %}\n    {%- else -%}\n        {% do return(relation) %}\n    {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9658122, "supported_languages": null}, "macro.dbt.materialization_test_default": {"name": "materialization_test_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/test.sql", "original_file_path": "macros/materializations/tests/test.sql", "unique_id": "macro.dbt.materialization_test_default", "macro_sql": "{%- materialization test, default -%}\n\n  {% set relations = [] %}\n\n  {% if should_store_failures() %}\n\n    {% set identifier = model['alias'] %}\n    {% set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n    {% set store_failures_as = config.get('store_failures_as') %}\n    -- if `--store-failures` is invoked via command line and `store_failures_as` is not set,\n    -- config.get('store_failures_as', 'table') returns None, not 'table'\n    {% if store_failures_as == none %}{% set store_failures_as = 'table' %}{% endif %}\n    {% if store_failures_as not in ['table', 'view'] %}\n        {{ exceptions.raise_compiler_error(\n            \"'\" ~ store_failures_as ~ \"' is not a valid value for `store_failures_as`. \"\n            \"Accepted values are: ['ephemeral', 'table', 'view']\"\n        ) }}\n    {% endif %}\n\n    {% set target_relation = api.Relation.create(\n        identifier=identifier, schema=schema, database=database, type=store_failures_as) -%} %}\n\n    {% if old_relation %}\n        {% do adapter.drop_relation(old_relation) %}\n    {% endif %}\n\n    {% call statement(auto_begin=True) %}\n        {{ get_create_sql(target_relation, sql) }}\n    {% endcall %}\n\n    {% do relations.append(target_relation) %}\n\n    {% set main_sql %}\n        select *\n        from {{ target_relation }}\n    {% endset %}\n\n    {{ adapter.commit() }}\n\n  {% else %}\n\n      {% set main_sql = sql %}\n\n  {% endif %}\n\n  {% set limit = config.get('limit') %}\n  {% set fail_calc = config.get('fail_calc') %}\n  {% set warn_if = config.get('warn_if') %}\n  {% set error_if = config.get('error_if') %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ get_test_sql(main_sql, fail_calc, warn_if, error_if, limit)}}\n\n  {%- endcall %}\n\n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.should_store_failures", "macro.dbt.statement", "macro.dbt.get_create_sql", "macro.dbt.get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9671645, "supported_languages": ["sql"]}, "macro.dbt.get_test_sql": {"name": "get_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.get_test_sql", "macro_sql": "{% macro get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n  {{ adapter.dispatch('get_test_sql', 'dbt')(main_sql, fail_calc, warn_if, error_if, limit) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9675288, "supported_languages": null}, "macro.dbt.default__get_test_sql": {"name": "default__get_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.default__get_test_sql", "macro_sql": "{% macro default__get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n    select\n      {{ fail_calc }} as failures,\n      {{ fail_calc }} {{ warn_if }} as should_warn,\n      {{ fail_calc }} {{ error_if }} as should_error\n    from (\n      {{ main_sql }}\n      {{ \"limit \" ~ limit if limit != none }}\n    ) dbt_internal_test\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9677181, "supported_languages": null}, "macro.dbt.get_unit_test_sql": {"name": "get_unit_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.get_unit_test_sql", "macro_sql": "{% macro get_unit_test_sql(main_sql, expected_fixture_sql, expected_column_names) -%}\n  {{ adapter.dispatch('get_unit_test_sql', 'dbt')(main_sql, expected_fixture_sql, expected_column_names) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_unit_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9678423, "supported_languages": null}, "macro.dbt.default__get_unit_test_sql": {"name": "default__get_unit_test_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "unique_id": "macro.dbt.default__get_unit_test_sql", "macro_sql": "{% macro default__get_unit_test_sql(main_sql, expected_fixture_sql, expected_column_names) -%}\n-- Build actual result given inputs\nwith dbt_internal_unit_test_actual as (\n  select\n    {% for expected_column_name in expected_column_names %}{{expected_column_name}}{% if not loop.last -%},{% endif %}{%- endfor -%}, {{ dbt.string_literal(\"actual\") }} as {{ adapter.quote(\"actual_or_expected\") }}\n  from (\n    {{ main_sql }}\n  ) _dbt_internal_unit_test_actual\n),\n-- Build expected result\ndbt_internal_unit_test_expected as (\n  select\n    {% for expected_column_name in expected_column_names %}{{expected_column_name}}{% if not loop.last -%}, {% endif %}{%- endfor -%}, {{ dbt.string_literal(\"expected\") }} as {{ adapter.quote(\"actual_or_expected\") }}\n  from (\n    {{ expected_fixture_sql }}\n  ) _dbt_internal_unit_test_expected\n)\n-- Union actual and expected results\nselect * from dbt_internal_unit_test_actual\nunion all\nselect * from dbt_internal_unit_test_expected\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.string_literal"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9682243, "supported_languages": null}, "macro.dbt.materialization_unit_default": {"name": "materialization_unit_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/tests/unit.sql", "original_file_path": "macros/materializations/tests/unit.sql", "unique_id": "macro.dbt.materialization_unit_default", "macro_sql": "{%- materialization unit, default -%}\n\n  {% set relations = [] %}\n\n  {% set expected_rows = config.get('expected_rows') %}\n  {% set expected_sql = config.get('expected_sql') %}\n  {% set tested_expected_column_names = expected_rows[0].keys() if (expected_rows | length ) > 0 else get_columns_in_query(sql) %} %}\n\n  {%- set target_relation = this.incorporate(type='table') -%}\n  {%- set temp_relation = make_temp_relation(target_relation)-%}\n  {% do run_query(get_create_table_as_sql(True, temp_relation, get_empty_subquery_sql(sql))) %}\n  {%- set columns_in_relation = adapter.get_columns_in_relation(temp_relation) -%}\n  {%- set column_name_to_data_types = {} -%}\n  {%- for column in columns_in_relation -%}\n  {%-   do column_name_to_data_types.update({column.name|lower: column.data_type}) -%}\n  {%- endfor -%}\n\n  {% if not expected_sql %}\n  {%   set expected_sql = get_expected_sql(expected_rows, column_name_to_data_types) %}\n  {% endif %}\n  {% set unit_test_sql = get_unit_test_sql(sql, expected_sql, tested_expected_column_names) %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ unit_test_sql }}\n\n  {%- endcall %}\n\n  {% do adapter.drop_relation(temp_relation) %}\n\n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.get_columns_in_query", "macro.dbt.make_temp_relation", "macro.dbt.run_query", "macro.dbt.get_create_table_as_sql", "macro.dbt.get_empty_subquery_sql", "macro.dbt.get_expected_sql", "macro.dbt.get_unit_test_sql", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.969158, "supported_languages": ["sql"]}, "macro.dbt.materialization_view_default": {"name": "materialization_view_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/view.sql", "original_file_path": "macros/materializations/models/view.sql", "unique_id": "macro.dbt.materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='view') -%}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"existing_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the existing_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the existing_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if existing_relation is not none %}\n     /* Do the equivalent of rename_if_exists. 'existing_relation' could have been dropped\n        since the variable was first set. */\n    {% set existing_relation = load_cached_relation(existing_relation) %}\n    {% if existing_relation is not none %}\n        {{ adapter.rename_relation(existing_relation, backup_relation) }}\n    {% endif %}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9704611, "supported_languages": ["sql"]}, "macro.dbt.materialization_materialized_view_default": {"name": "materialization_materialized_view_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialization_materialized_view_default", "macro_sql": "{% materialization materialized_view, default %}\n    {% set existing_relation = load_cached_relation(this) %}\n    {% set target_relation = this.incorporate(type=this.MaterializedView) %}\n    {% set intermediate_relation = make_intermediate_relation(target_relation) %}\n    {% set backup_relation_type = target_relation.MaterializedView if existing_relation is none else existing_relation.type %}\n    {% set backup_relation = make_backup_relation(target_relation, backup_relation_type) %}\n\n    {{ materialized_view_setup(backup_relation, intermediate_relation, pre_hooks) }}\n\n        {% set build_sql = materialized_view_get_build_sql(existing_relation, target_relation, backup_relation, intermediate_relation) %}\n\n        {% if build_sql == '' %}\n            {{ materialized_view_execute_no_op(target_relation) }}\n        {% else %}\n            {{ materialized_view_execute_build_sql(build_sql, existing_relation, target_relation, post_hooks) }}\n        {% endif %}\n\n    {{ materialized_view_teardown(backup_relation, intermediate_relation, post_hooks) }}\n\n    {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.materialized_view_setup", "macro.dbt.materialized_view_get_build_sql", "macro.dbt.materialized_view_execute_no_op", "macro.dbt.materialized_view_execute_build_sql", "macro.dbt.materialized_view_teardown"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9714475, "supported_languages": ["sql"]}, "macro.dbt.materialized_view_setup": {"name": "materialized_view_setup", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_setup", "macro_sql": "{% macro materialized_view_setup(backup_relation, intermediate_relation, pre_hooks) %}\n\n    -- backup_relation and intermediate_relation should not already exist in the database\n    -- it's possible these exist because of a previous run that exited unexpectedly\n    {% set preexisting_backup_relation = load_cached_relation(backup_relation) %}\n    {% set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) %}\n\n    -- drop the temp relations if they exist already in the database\n    {{ drop_relation_if_exists(preexisting_backup_relation) }}\n    {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n\n    {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9716783, "supported_languages": null}, "macro.dbt.materialized_view_teardown": {"name": "materialized_view_teardown", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_teardown", "macro_sql": "{% macro materialized_view_teardown(backup_relation, intermediate_relation, post_hooks) %}\n\n    -- drop the temp relations if they exist to leave the database clean for the next run\n    {{ drop_relation_if_exists(backup_relation) }}\n    {{ drop_relation_if_exists(intermediate_relation) }}\n\n    {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9718251, "supported_languages": null}, "macro.dbt.materialized_view_get_build_sql": {"name": "materialized_view_get_build_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_get_build_sql", "macro_sql": "{% macro materialized_view_get_build_sql(existing_relation, target_relation, backup_relation, intermediate_relation) %}\n\n    {% set full_refresh_mode = should_full_refresh() %}\n\n    -- determine the scenario we're in: create, full_refresh, alter, refresh data\n    {% if existing_relation is none %}\n        {% set build_sql = get_create_materialized_view_as_sql(target_relation, sql) %}\n    {% elif full_refresh_mode or not existing_relation.is_materialized_view %}\n        {% set build_sql = get_replace_sql(existing_relation, target_relation, sql) %}\n    {% else %}\n\n        -- get config options\n        {% set on_configuration_change = config.get('on_configuration_change') %}\n        {% set configuration_changes = get_materialized_view_configuration_changes(existing_relation, config) %}\n\n        {% if configuration_changes is none %}\n            {% set build_sql = refresh_materialized_view(target_relation) %}\n\n        {% elif on_configuration_change == 'apply' %}\n            {% set build_sql = get_alter_materialized_view_as_sql(target_relation, configuration_changes, sql, existing_relation, backup_relation, intermediate_relation) %}\n        {% elif on_configuration_change == 'continue' %}\n            {% set build_sql = '' %}\n            {{ exceptions.warn(\"Configuration changes were identified and `on_configuration_change` was set to `continue` for `\" ~ target_relation.render() ~ \"`\") }}\n        {% elif on_configuration_change == 'fail' %}\n            {{ exceptions.raise_fail_fast_error(\"Configuration changes were identified and `on_configuration_change` was set to `fail` for `\" ~ target_relation.render() ~ \"`\") }}\n\n        {% else %}\n            -- this only happens if the user provides a value other than `apply`, 'skip', 'fail'\n            {{ exceptions.raise_compiler_error(\"Unexpected configuration scenario\") }}\n\n        {% endif %}\n\n    {% endif %}\n\n    {% do return(build_sql) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.get_create_materialized_view_as_sql", "macro.dbt.get_replace_sql", "macro.dbt.get_materialized_view_configuration_changes", "macro.dbt.refresh_materialized_view", "macro.dbt.get_alter_materialized_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.972595, "supported_languages": null}, "macro.dbt.materialized_view_execute_no_op": {"name": "materialized_view_execute_no_op", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_execute_no_op", "macro_sql": "{% macro materialized_view_execute_no_op(target_relation) %}\n    {% do store_raw_result(\n        name=\"main\",\n        message=\"skip \" ~ target_relation,\n        code=\"skip\",\n        rows_affected=\"-1\"\n    ) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9727385, "supported_languages": null}, "macro.dbt.materialized_view_execute_build_sql": {"name": "materialized_view_execute_build_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/materialized_view.sql", "original_file_path": "macros/materializations/models/materialized_view.sql", "unique_id": "macro.dbt.materialized_view_execute_build_sql", "macro_sql": "{% macro materialized_view_execute_build_sql(build_sql, existing_relation, target_relation, post_hooks) %}\n\n    -- `BEGIN` happens here:\n    {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n    {% set grant_config = config.get('grants') %}\n\n    {% call statement(name=\"main\") %}\n        {{ build_sql }}\n    {% endcall %}\n\n    {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n    {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n    {% do persist_docs(target_relation, model) %}\n\n    {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n    {{ adapter.commit() }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9731262, "supported_languages": null}, "macro.dbt.materialization_table_default": {"name": "materialization_table_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/table.sql", "original_file_path": "macros/materializations/models/table.sql", "unique_id": "macro.dbt.materialization_table_default", "macro_sql": "{% materialization table, default %}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') %}\n  {%- set intermediate_relation =  make_intermediate_relation(target_relation) -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation) -%}\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n  -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_table_as_sql(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  {% if existing_relation is not none %}\n     /* Do the equivalent of rename_if_exists. 'existing_relation' could have been dropped\n        since the variable was first set. */\n    {% set existing_relation = load_cached_relation(existing_relation) %}\n    {% if existing_relation is not none %}\n        {{ adapter.rename_relation(existing_relation, backup_relation) }}\n    {% endif %}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do create_indexes(target_relation) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.get_create_table_as_sql", "macro.dbt.create_indexes", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.974393, "supported_languages": ["sql"]}, "macro.dbt.create_or_replace_clone": {"name": "create_or_replace_clone", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/create_or_replace_clone.sql", "original_file_path": "macros/materializations/models/clone/create_or_replace_clone.sql", "unique_id": "macro.dbt.create_or_replace_clone", "macro_sql": "{% macro create_or_replace_clone(this_relation, defer_relation) %}\n    {{ return(adapter.dispatch('create_or_replace_clone', 'dbt')(this_relation, defer_relation)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_or_replace_clone"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.97458, "supported_languages": null}, "macro.dbt.default__create_or_replace_clone": {"name": "default__create_or_replace_clone", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/create_or_replace_clone.sql", "original_file_path": "macros/materializations/models/clone/create_or_replace_clone.sql", "unique_id": "macro.dbt.default__create_or_replace_clone", "macro_sql": "{% macro default__create_or_replace_clone(this_relation, defer_relation) %}\n    create or replace table {{ this_relation.render() }} clone {{ defer_relation.render() }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9746811, "supported_languages": null}, "macro.dbt.materialization_clone_default": {"name": "materialization_clone_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/clone.sql", "original_file_path": "macros/materializations/models/clone/clone.sql", "unique_id": "macro.dbt.materialization_clone_default", "macro_sql": "{%- materialization clone, default -%}\n\n  {%- set relations = {'relations': []} -%}\n\n  {%- if not defer_relation -%}\n      -- nothing to do\n      {{ log(\"No relation found in state manifest for \" ~ model.unique_id, info=True) }}\n      {{ return(relations) }}\n  {%- endif -%}\n\n  {%- set existing_relation = load_cached_relation(this) -%}\n\n  {%- if existing_relation and not flags.FULL_REFRESH -%}\n      -- noop!\n      {{ log(\"Relation \" ~ existing_relation ~ \" already exists\", info=True) }}\n      {{ return(relations) }}\n  {%- endif -%}\n\n  {%- set other_existing_relation = load_cached_relation(defer_relation) -%}\n\n  -- If this is a database that can do zero-copy cloning of tables, and the other relation is a table, then this will be a table\n  -- Otherwise, this will be a view\n\n  {% set can_clone_table = can_clone_table() %}\n\n  {%- if other_existing_relation and other_existing_relation.type == 'table' and can_clone_table -%}\n\n      {%- set target_relation = this.incorporate(type='table') -%}\n      {% if existing_relation is not none and not existing_relation.is_table %}\n        {{ log(\"Dropping relation \" ~ existing_relation.render() ~ \" because it is of type \" ~ existing_relation.type) }}\n        {{ drop_relation_if_exists(existing_relation) }}\n      {% endif %}\n\n      -- as a general rule, data platforms that can clone tables can also do atomic 'create or replace'\n      {% call statement('main') %}\n          {% if target_relation and defer_relation and target_relation == defer_relation %}\n              {{ log(\"Target relation and defer relation are the same, skipping clone for relation: \" ~ target_relation.render()) }}\n          {% else %}\n              {{ create_or_replace_clone(target_relation, defer_relation) }}\n          {% endif %}\n\n      {% endcall %}\n\n      {% set should_revoke = should_revoke(existing_relation, full_refresh_mode=True) %}\n      {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n      {% do persist_docs(target_relation, model) %}\n\n      {{ return({'relations': [target_relation]}) }}\n\n  {%- else -%}\n\n      {%- set target_relation = this.incorporate(type='view') -%}\n\n      -- reuse the view materialization\n      -- TODO: support actual dispatch for materialization macros\n      -- Tracking ticket: https://github.com/dbt-labs/dbt-core/issues/7799\n      {% set search_name = \"materialization_view_\" ~ adapter.type() %}\n      {% if not search_name in context %}\n          {% set search_name = \"materialization_view_default\" %}\n      {% endif %}\n      {% set materialization_macro = context[search_name] %}\n      {% set relations = materialization_macro() %}\n      {{ return(relations) }}\n\n  {%- endif -%}\n\n{%- endmaterialization -%}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.can_clone_table", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.create_or_replace_clone", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9761653, "supported_languages": ["sql"]}, "macro.dbt.can_clone_table": {"name": "can_clone_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/can_clone_table.sql", "original_file_path": "macros/materializations/models/clone/can_clone_table.sql", "unique_id": "macro.dbt.can_clone_table", "macro_sql": "{% macro can_clone_table() %}\n    {{ return(adapter.dispatch('can_clone_table', 'dbt')()) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__can_clone_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9763265, "supported_languages": null}, "macro.dbt.default__can_clone_table": {"name": "default__can_clone_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/clone/can_clone_table.sql", "original_file_path": "macros/materializations/models/clone/can_clone_table.sql", "unique_id": "macro.dbt.default__can_clone_table", "macro_sql": "{% macro default__can_clone_table() %}\n    {{ return(False) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.976404, "supported_languages": null}, "macro.dbt.get_incremental_append_sql": {"name": "get_incremental_append_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_append_sql", "macro_sql": "{% macro get_incremental_append_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_append_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9768174, "supported_languages": null}, "macro.dbt.default__get_incremental_append_sql": {"name": "default__get_incremental_append_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_append_sql", "macro_sql": "{% macro default__get_incremental_append_sql(arg_dict) %}\n\n  {% do return(get_insert_into_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"dest_columns\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_insert_into_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9769535, "supported_languages": null}, "macro.dbt.get_incremental_delete_insert_sql": {"name": "get_incremental_delete_insert_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_delete_insert_sql", "macro_sql": "{% macro get_incremental_delete_insert_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_delete_insert_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_delete_insert_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9770682, "supported_languages": null}, "macro.dbt.default__get_incremental_delete_insert_sql": {"name": "default__get_incremental_delete_insert_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_delete_insert_sql", "macro_sql": "{% macro default__get_incremental_delete_insert_sql(arg_dict) %}\n\n  {% do return(get_delete_insert_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9772553, "supported_languages": null}, "macro.dbt.get_incremental_merge_sql": {"name": "get_incremental_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_merge_sql", "macro_sql": "{% macro get_incremental_merge_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_merge_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9773643, "supported_languages": null}, "macro.dbt.default__get_incremental_merge_sql": {"name": "default__get_incremental_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_merge_sql", "macro_sql": "{% macro default__get_incremental_merge_sql(arg_dict) %}\n\n  {% do return(get_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"unique_key\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9775965, "supported_languages": null}, "macro.dbt.get_incremental_insert_overwrite_sql": {"name": "get_incremental_insert_overwrite_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_insert_overwrite_sql", "macro_sql": "{% macro get_incremental_insert_overwrite_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_insert_overwrite_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_insert_overwrite_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9777198, "supported_languages": null}, "macro.dbt.default__get_incremental_insert_overwrite_sql": {"name": "default__get_incremental_insert_overwrite_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_insert_overwrite_sql", "macro_sql": "{% macro default__get_incremental_insert_overwrite_sql(arg_dict) %}\n\n  {% do return(get_insert_overwrite_merge_sql(arg_dict[\"target_relation\"], arg_dict[\"temp_relation\"], arg_dict[\"dest_columns\"], arg_dict[\"incremental_predicates\"])) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.977879, "supported_languages": null}, "macro.dbt.get_incremental_default_sql": {"name": "get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_default_sql", "macro_sql": "{% macro get_incremental_default_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_default_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__get_incremental_default_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9779868, "supported_languages": null}, "macro.dbt.default__get_incremental_default_sql": {"name": "default__get_incremental_default_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_default_sql", "macro_sql": "{% macro default__get_incremental_default_sql(arg_dict) %}\n\n  {% do return(get_incremental_append_sql(arg_dict)) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_incremental_append_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9780805, "supported_languages": null}, "macro.dbt.get_incremental_microbatch_sql": {"name": "get_incremental_microbatch_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_incremental_microbatch_sql", "macro_sql": "{% macro get_incremental_microbatch_sql(arg_dict) %}\n\n  {{ return(adapter.dispatch('get_incremental_microbatch_sql', 'dbt')(arg_dict)) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_incremental_microbatch_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9781928, "supported_languages": null}, "macro.dbt.default__get_incremental_microbatch_sql": {"name": "default__get_incremental_microbatch_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.default__get_incremental_microbatch_sql", "macro_sql": "{% macro default__get_incremental_microbatch_sql(arg_dict) %}\n\n  {{ exceptions.raise_not_implemented('microbatch materialization strategy not implemented for adapter ' + adapter.type()) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9782937, "supported_languages": null}, "macro.dbt.get_insert_into_sql": {"name": "get_insert_into_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/strategies.sql", "original_file_path": "macros/materializations/models/incremental/strategies.sql", "unique_id": "macro.dbt.get_insert_into_sql", "macro_sql": "{% macro get_insert_into_sql(target_relation, temp_relation, dest_columns) %}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    insert into {{ target_relation }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ temp_relation }}\n    )\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9784634, "supported_languages": null}, "macro.dbt.materialization_incremental_default": {"name": "materialization_incremental_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/incremental.sql", "original_file_path": "macros/materializations/models/incremental/incremental.sql", "unique_id": "macro.dbt.materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  -- relations\n  {%- set existing_relation = load_cached_relation(this) -%}\n  {%- set target_relation = this.incorporate(type='table') -%}\n  {%- set temp_relation = make_temp_relation(target_relation)-%}\n  {%- set intermediate_relation = make_intermediate_relation(target_relation)-%}\n  {%- set backup_relation_type = 'table' if existing_relation is none else existing_relation.type -%}\n  {%- set backup_relation = make_backup_relation(target_relation, backup_relation_type) -%}\n\n  -- configs\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()  or existing_relation.is_view) -%}\n  {%- set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') -%}\n\n  -- the temp_ and backup_ relations should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation. This has to happen before\n  -- BEGIN, in a separate transaction\n  {%- set preexisting_intermediate_relation = load_cached_relation(intermediate_relation)-%}\n  {%- set preexisting_backup_relation = load_cached_relation(backup_relation) -%}\n   -- grab current tables grants config for comparision later on\n  {% set grant_config = config.get('grants') %}\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n\n  {% set incremental_strategy = config.get('incremental_strategy') or 'default' %}\n  {% set strategy_sql_macro_func = adapter.get_incremental_strategy_macro(context, incremental_strategy) %}\n\n  {% if existing_relation is none %}\n      {% set build_sql = get_create_table_as_sql(False, target_relation, sql) %}\n  {% elif full_refresh_mode %}\n      {% set build_sql = get_create_table_as_sql(False, intermediate_relation, sql) %}\n      {% set need_swap = true %}\n  {% else %}\n    {% do run_query(get_create_table_as_sql(True, temp_relation, sql)) %}\n    {% set contract_config = config.get('contract') %}\n    {% if not contract_config or not contract_config.enforced %}\n      {% do adapter.expand_target_column_types(\n               from_relation=temp_relation,\n               to_relation=target_relation) %}\n    {% endif %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, temp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n\n    {#-- Get the incremental_strategy, the macro to use for the strategy, and build the sql --#}\n    {% set incremental_predicates = config.get('predicates', none) or config.get('incremental_predicates', none) %}\n    {% set strategy_arg_dict = ({'target_relation': target_relation, 'temp_relation': temp_relation, 'unique_key': unique_key, 'dest_columns': dest_columns, 'incremental_predicates': incremental_predicates }) %}\n    {% set build_sql = strategy_sql_macro_func(strategy_arg_dict) %}\n\n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% if need_swap %}\n      {% do adapter.rename_relation(target_relation, backup_relation) %}\n      {% do adapter.rename_relation(intermediate_relation, target_relation) %}\n      {% do to_drop.append(backup_relation) %}\n  {% endif %}\n\n  {% set should_revoke = should_revoke(existing_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if existing_relation is none or existing_relation.is_view or should_full_refresh() %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "depends_on": {"macros": ["macro.dbt.load_cached_relation", "macro.dbt.make_temp_relation", "macro.dbt.make_intermediate_relation", "macro.dbt.make_backup_relation", "macro.dbt.should_full_refresh", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.get_create_table_as_sql", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9809504, "supported_languages": ["sql"]}, "macro.dbt.incremental_validate_on_schema_change": {"name": "incremental_validate_on_schema_change", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.incremental_validate_on_schema_change", "macro_sql": "{% macro incremental_validate_on_schema_change(on_schema_change, default='ignore') %}\n\n   {% if on_schema_change not in ['sync_all_columns', 'append_new_columns', 'fail', 'ignore'] %}\n\n     {% set log_message = 'Invalid value for on_schema_change (%s) specified. Setting default value of %s.' % (on_schema_change, default) %}\n     {% do log(log_message) %}\n\n     {{ return(default) }}\n\n   {% else %}\n\n     {{ return(on_schema_change) }}\n\n   {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9817574, "supported_languages": null}, "macro.dbt.check_for_schema_changes": {"name": "check_for_schema_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.check_for_schema_changes", "macro_sql": "{% macro check_for_schema_changes(source_relation, target_relation) %}\n\n  {% set schema_changed = False %}\n\n  {%- set source_columns = adapter.get_columns_in_relation(source_relation) -%}\n  {%- set target_columns = adapter.get_columns_in_relation(target_relation) -%}\n  {%- set source_not_in_target = diff_columns(source_columns, target_columns) -%}\n  {%- set target_not_in_source = diff_columns(target_columns, source_columns) -%}\n\n  {% set new_target_types = diff_column_data_types(source_columns, target_columns) %}\n\n  {% if source_not_in_target != [] %}\n    {% set schema_changed = True %}\n  {% elif target_not_in_source != [] or new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% elif new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% endif %}\n\n  {% set changes_dict = {\n    'schema_changed': schema_changed,\n    'source_not_in_target': source_not_in_target,\n    'target_not_in_source': target_not_in_source,\n    'source_columns': source_columns,\n    'target_columns': target_columns,\n    'new_target_types': new_target_types\n  } %}\n\n  {% set msg %}\n    In {{ target_relation }}:\n        Schema changed: {{ schema_changed }}\n        Source columns not in target: {{ source_not_in_target }}\n        Target columns not in source: {{ target_not_in_source }}\n        New column types: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(msg) %}\n\n  {{ return(changes_dict) }}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.diff_columns", "macro.dbt.diff_column_data_types"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9824734, "supported_languages": null}, "macro.dbt.sync_column_schemas": {"name": "sync_column_schemas", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.sync_column_schemas", "macro_sql": "{% macro sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n  {%- set add_to_target_arr = schema_changes_dict['source_not_in_target'] -%}\n\n  {%- if on_schema_change == 'append_new_columns'-%}\n     {%- if add_to_target_arr | length > 0 -%}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, none) -%}\n     {%- endif -%}\n\n  {% elif on_schema_change == 'sync_all_columns' %}\n     {%- set remove_from_target_arr = schema_changes_dict['target_not_in_source'] -%}\n     {%- set new_target_types = schema_changes_dict['new_target_types'] -%}\n\n     {% if add_to_target_arr | length > 0 or remove_from_target_arr | length > 0 %}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, remove_from_target_arr) -%}\n     {% endif %}\n\n     {% if new_target_types != [] %}\n       {% for ntt in new_target_types %}\n         {% set column_name = ntt['column_name'] %}\n         {% set new_type = ntt['new_type'] %}\n         {% do alter_column_type(target_relation, column_name, new_type) %}\n       {% endfor %}\n     {% endif %}\n\n  {% endif %}\n\n  {% set schema_change_message %}\n    In {{ target_relation }}:\n        Schema change approach: {{ on_schema_change }}\n        Columns added: {{ add_to_target_arr }}\n        Columns removed: {{ remove_from_target_arr }}\n        Data types changed: {{ new_target_types }}\n  {% endset %}\n\n  {% do log(schema_change_message) %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.alter_relation_add_remove_columns", "macro.dbt.alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9831827, "supported_languages": null}, "macro.dbt.process_schema_changes": {"name": "process_schema_changes", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "unique_id": "macro.dbt.process_schema_changes", "macro_sql": "{% macro process_schema_changes(on_schema_change, source_relation, target_relation) %}\n\n    {% if on_schema_change == 'ignore' %}\n\n     {{ return({}) }}\n\n    {% else %}\n\n      {% set schema_changes_dict = check_for_schema_changes(source_relation, target_relation) %}\n\n      {% if schema_changes_dict['schema_changed'] %}\n\n        {% if on_schema_change == 'fail' %}\n\n          {% set fail_msg %}\n              The source and target schemas on this incremental model are out of sync!\n              They can be reconciled in several ways:\n                - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.\n                - Re-run the incremental model with `full_refresh: True` to update the target schema.\n                - update the schema manually and re-run the process.\n\n              Additional troubleshooting context:\n                 Source columns not in target: {{ schema_changes_dict['source_not_in_target'] }}\n                 Target columns not in source: {{ schema_changes_dict['target_not_in_source'] }}\n                 New column types: {{ schema_changes_dict['new_target_types'] }}\n          {% endset %}\n\n          {% do exceptions.raise_compiler_error(fail_msg) %}\n\n        {# -- unless we ignore, run the sync operation per the config #}\n        {% else %}\n\n          {% do sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n\n        {% endif %}\n\n      {% endif %}\n\n      {{ return(schema_changes_dict['source_columns']) }}\n\n    {% endif %}\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.check_for_schema_changes", "macro.dbt.sync_column_schemas"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9836912, "supported_languages": null}, "macro.dbt.get_merge_sql": {"name": "get_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, incremental_predicates=none) -%}\n   -- back compat for old kwarg name\n  {% set incremental_predicates = kwargs.get('predicates', incremental_predicates) %}\n  {{ adapter.dispatch('get_merge_sql', 'dbt')(target, source, unique_key, dest_columns, incremental_predicates) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9844744, "supported_languages": null}, "macro.dbt.default__get_merge_sql": {"name": "default__get_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, incremental_predicates=none) -%}\n    {%- set predicates = [] if incremental_predicates is none else [] + incremental_predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set merge_update_columns = config.get('merge_update_columns') -%}\n    {%- set merge_exclude_columns = config.get('merge_exclude_columns') -%}\n    {%- set update_columns = get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not mapping and unique_key is not string %}\n            {% for key in unique_key %}\n                {% set this_key_match %}\n                    DBT_INTERNAL_SOURCE.{{ key }} = DBT_INTERNAL_DEST.{{ key }}\n                {% endset %}\n                {% do predicates.append(this_key_match) %}\n            {% endfor %}\n        {% else %}\n            {% set unique_key_match %}\n                DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n            {% endset %}\n            {% do predicates.append(unique_key_match) %}\n        {% endif %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{\"(\" ~ predicates | join(\") and (\") ~ \")\"}}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column_name in update_columns -%}\n            {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv", "macro.dbt.get_merge_update_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9854188, "supported_languages": null}, "macro.dbt.get_delete_insert_merge_sql": {"name": "get_delete_insert_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns, incremental_predicates) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql', 'dbt')(target, source, unique_key, dest_columns, incremental_predicates) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.985574, "supported_languages": null}, "macro.dbt.default__get_delete_insert_merge_sql": {"name": "default__get_delete_insert_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns, incremental_predicates) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key %}\n        {% if unique_key is sequence and unique_key is not string %}\n            delete from {{target }}\n            using {{ source }}\n            where (\n                {% for key in unique_key %}\n                    {{ source }}.{{ key }} = {{ target }}.{{ key }}\n                    {{ \"and \" if not loop.last}}\n                {% endfor %}\n                {% if incremental_predicates %}\n                    {% for predicate in incremental_predicates %}\n                        and {{ predicate }}\n                    {% endfor %}\n                {% endif %}\n            );\n        {% else %}\n            delete from {{ target }}\n            where (\n                {{ unique_key }}) in (\n                select ({{ unique_key }})\n                from {{ source }}\n            )\n            {%- if incremental_predicates %}\n                {% for predicate in incremental_predicates %}\n                    and {{ predicate }}\n                {% endfor %}\n            {%- endif -%};\n\n        {% endif %}\n    {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9861777, "supported_languages": null}, "macro.dbt.get_insert_overwrite_merge_sql": {"name": "get_insert_overwrite_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql', 'dbt')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9863424, "supported_languages": null}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"name": "default__get_insert_overwrite_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {#-- The only time include_sql_header is True: --#}\n    {#-- BigQuery + insert_overwrite strategy + \"static\" partitions config --#}\n    {#-- We should consider including the sql header at the materialization level instead --#}\n\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9867344, "supported_languages": null}, "macro.dbt.is_incremental": {"name": "is_incremental", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/is_incremental.sql", "original_file_path": "macros/materializations/models/incremental/is_incremental.sql", "unique_id": "macro.dbt.is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9871054, "supported_languages": null}, "macro.dbt.get_quoted_csv": {"name": "get_quoted_csv", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.987614, "supported_languages": null}, "macro.dbt.diff_columns": {"name": "diff_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.diff_columns", "macro_sql": "{% macro diff_columns(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% set source_names = source_columns | map(attribute = 'column') | list %}\n  {% set target_names = target_columns | map(attribute = 'column') | list %}\n\n   {# --check whether the name attribute exists in the target - this does not perform a data type check #}\n   {% for sc in source_columns %}\n     {% if sc.name not in target_names %}\n        {{ result.append(sc) }}\n     {% endif %}\n   {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9879446, "supported_languages": null}, "macro.dbt.diff_column_data_types": {"name": "diff_column_data_types", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.diff_column_data_types", "macro_sql": "{% macro diff_column_data_types(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% for sc in source_columns %}\n    {% set tc = target_columns | selectattr(\"name\", \"equalto\", sc.name) | list | first %}\n    {% if tc %}\n      {% if sc.data_type != tc.data_type and not sc.can_expand_to(other_column=tc) %}\n        {{ result.append( { 'column_name': tc.name, 'new_type': sc.data_type } ) }}\n      {% endif %}\n    {% endif %}\n  {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9883502, "supported_languages": null}, "macro.dbt.get_merge_update_columns": {"name": "get_merge_update_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.get_merge_update_columns", "macro_sql": "{% macro get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) %}\n  {{ return(adapter.dispatch('get_merge_update_columns', 'dbt')(merge_update_columns, merge_exclude_columns, dest_columns)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_merge_update_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9884949, "supported_languages": null}, "macro.dbt.default__get_merge_update_columns": {"name": "default__get_merge_update_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "unique_id": "macro.dbt.default__get_merge_update_columns", "macro_sql": "{% macro default__get_merge_update_columns(merge_update_columns, merge_exclude_columns, dest_columns) %}\n  {%- set default_cols = dest_columns | map(attribute=\"quoted\") | list -%}\n\n  {%- if merge_update_columns and merge_exclude_columns -%}\n    {{ exceptions.raise_compiler_error(\n        'Model cannot specify merge_update_columns and merge_exclude_columns. Please update model to use only one config'\n    )}}\n  {%- elif merge_update_columns -%}\n    {%- set update_columns = merge_update_columns -%}\n  {%- elif merge_exclude_columns -%}\n    {%- set update_columns = [] -%}\n    {%- for column in dest_columns -%}\n      {% if column.column | lower not in merge_exclude_columns | map(\"lower\") | list %}\n        {%- do update_columns.append(column.quoted) -%}\n      {% endif %}\n    {%- endfor -%}\n  {%- else -%}\n    {%- set update_columns = default_cols -%}\n  {%- endif -%}\n\n  {{ return(update_columns) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9889307, "supported_languages": null}, "macro.dbt.strategy_dispatch": {"name": "strategy_dispatch", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9903214, "supported_languages": null}, "macro.dbt.snapshot_hash_arguments": {"name": "snapshot_hash_arguments", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments', 'dbt')(args) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9904408, "supported_languages": null}, "macro.dbt.default__snapshot_hash_arguments": {"name": "default__snapshot_hash_arguments", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9905784, "supported_languages": null}, "macro.dbt.snapshot_timestamp_strategy": {"name": "snapshot_timestamp_strategy", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, model_config, target_exists) %}\n    {# The model_config parameter is no longer used, but is passed in anyway for compatibility. #}\n    {% set primary_key = config.get('unique_key') %}\n    {% set updated_at = config.get('updated_at') %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes') or false %}\n    {% set columns = config.get(\"snapshot_table_column_names\") or get_snapshot_table_column_names() %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/dbt-labs/dbt-core/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.{{ columns.dbt_valid_from }} < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_args = api.Relation.scd_args(primary_key, updated_at) %}\n    {% set scd_id_expr = snapshot_hash_arguments(scd_args) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_snapshot_table_column_names", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9911327, "supported_languages": null}, "macro.dbt.snapshot_string_as_time": {"name": "snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time', 'dbt')(timestamp) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_string_as_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9912364, "supported_languages": null}, "macro.dbt.default__snapshot_string_as_time": {"name": "default__snapshot_string_as_time", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.991348, "supported_languages": null}, "macro.dbt.snapshot_check_all_get_existing_columns": {"name": "snapshot_check_all_get_existing_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) -%}\n    {%- if not target_exists -%}\n        {#-- no table yet -> return whatever the query does --#}\n        {{ return((false, query_columns)) }}\n    {%- endif -%}\n\n    {#-- handle any schema changes --#}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=node.alias) -%}\n\n    {% if check_cols_config == 'all' %}\n        {%- set query_columns = get_columns_in_query(node['compiled_code']) -%}\n\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {#-- query for proper casing/quoting, to support comparison below --#}\n        {%- set select_check_cols_from_target -%}\n            {#-- N.B. The whitespace below is necessary to avoid edge case issue with comments --#}\n            {#-- See: https://github.com/dbt-labs/dbt-core/issues/6781 --#}\n            select {{ check_cols_config | join(', ') }} from (\n                {{ node['compiled_code'] }}\n            ) subq\n        {%- endset -%}\n        {% set query_columns = get_columns_in_query(select_check_cols_from_target) %}\n\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set existing_cols = adapter.get_columns_in_relation(target_relation) | map(attribute = 'name') | list -%}\n    {%- set ns = namespace() -%} {#-- handle for-loop scoping with a namespace --#}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(adapter.quote(col)) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return((ns.column_added, intersection)) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.992247, "supported_languages": null}, "macro.dbt.snapshot_check_strategy": {"name": "snapshot_check_strategy", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "unique_id": "macro.dbt.snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, model_config, target_exists) %}\n    {# The model_config parameter is no longer used, but is passed in anyway for compatibility. #}\n    {% set check_cols_config = config.get('check_cols') %}\n    {% set primary_key = config.get('unique_key') %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes') or false %}\n    {% set updated_at = config.get('updated_at') or snapshot_get_time() %}\n\n    {% set column_added = false %}\n\n    {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists, check_cols_config) %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        {{ get_true_sql() }}\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_args = api.Relation.scd_args(primary_key, updated_at) %}\n    {% set scd_id_expr = snapshot_hash_arguments(scd_args) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt.snapshot_check_all_get_existing_columns", "macro.dbt.get_true_sql", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9930792, "supported_languages": null}, "macro.dbt.materialization_snapshot_default": {"name": "materialization_snapshot_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot.sql", "original_file_path": "macros/materializations/snapshots/snapshot.sql", "unique_id": "macro.dbt.materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n  -- grab current tables grants config for comparision later on\n  {%- set grant_config = config.get('grants') -%}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {# The model['config'] parameter below is no longer used, but passing anyway for compatibility #}\n  {# It was a dictionary of config, instead of the config object from the context #}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", model['config'], target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_code']) %}\n      {% set build_or_select_sql = build_sql %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {% set columns = config.get(\"snapshot_table_column_names\") or get_snapshot_table_column_names() %}\n\n      {{ adapter.valid_snapshot_target(target_relation, columns) }}\n\n      {% set build_or_select_sql = snapshot_staging_table(strategy, sql, target_relation) %}\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set remove_columns = ['dbt_change_type', 'DBT_CHANGE_TYPE', 'dbt_unique_key', 'DBT_UNIQUE_KEY'] %}\n      {% if unique_key | is_list %}\n          {% for key in strategy.unique_key %}\n              {{ remove_columns.append('dbt_unique_key_' + loop.index|string) }}\n              {{ remove_columns.append('DBT_UNIQUE_KEY_' + loop.index|string) }}\n          {% endfor %}\n      {% endif %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'in', remove_columns)\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'in', remove_columns)\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n\n  {{ check_time_data_types(build_or_select_sql) }}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% set should_revoke = should_revoke(target_relation_exists, full_refresh_mode=False) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if not target_relation_exists %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.get_or_create_relation", "macro.dbt.run_hooks", "macro.dbt.strategy_dispatch", "macro.dbt.build_snapshot_table", "macro.dbt.create_table_as", "macro.dbt.get_snapshot_table_column_names", "macro.dbt.snapshot_staging_table", "macro.dbt.build_snapshot_staging_table", "macro.dbt.create_columns", "macro.dbt.snapshot_merge_sql", "macro.dbt.check_time_data_types", "macro.dbt.statement", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes", "macro.dbt.post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.995504, "supported_languages": ["sql"]}, "macro.dbt.create_columns": {"name": "create_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns', 'dbt')(relation, columns) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_columns"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9965398, "supported_languages": null}, "macro.dbt.default__create_columns": {"name": "default__create_columns", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation.render() }} add column \"{{ column.name }}\" {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9967227, "supported_languages": null}, "macro.dbt.post_snapshot": {"name": "post_snapshot", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot', 'dbt')(staging_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9968243, "supported_languages": null}, "macro.dbt.default__post_snapshot": {"name": "default__post_snapshot", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9968798, "supported_languages": null}, "macro.dbt.get_true_sql": {"name": "get_true_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_true_sql", "macro_sql": "{% macro get_true_sql() %}\n  {{ adapter.dispatch('get_true_sql', 'dbt')() }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_true_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9969692, "supported_languages": null}, "macro.dbt.default__get_true_sql": {"name": "default__get_true_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__get_true_sql", "macro_sql": "{% macro default__get_true_sql() %}\n    {{ return('TRUE') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9970386, "supported_languages": null}, "macro.dbt.snapshot_staging_table": {"name": "snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n  {{ adapter.dispatch('snapshot_staging_table', 'dbt')(strategy, source_sql, target_relation) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__snapshot_staging_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.997165, "supported_languages": null}, "macro.dbt.get_snapshot_table_column_names": {"name": "get_snapshot_table_column_names", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_snapshot_table_column_names", "macro_sql": "{% macro get_snapshot_table_column_names() %}\n    {{ return({'dbt_valid_to': 'dbt_valid_to', 'dbt_valid_from': 'dbt_valid_from', 'dbt_scd_id': 'dbt_scd_id', 'dbt_updated_at': 'dbt_updated_at'}) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.997302, "supported_languages": null}, "macro.dbt.default__snapshot_staging_table": {"name": "default__snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__snapshot_staging_table", "macro_sql": "{% macro default__snapshot_staging_table(strategy, source_sql, target_relation) -%}\n    {% set columns = config.get('snapshot_table_column_names') or get_snapshot_table_column_names() %}\n\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *, {{ unique_key_fields(strategy.unique_key) }}\n        from {{ target_relation }}\n        where\n            {% if config.get('dbt_valid_to_current') %}\n               {# Check for either dbt_valid_to_current OR null, in order to correctly update records with nulls #}\n               ( {{ columns.dbt_valid_to }} = {{ config.get('dbt_valid_to_current') }} or {{ columns.dbt_valid_to }} is null)\n            {% else %}\n                {{ columns.dbt_valid_to }} is null\n            {% endif %}\n\n    ),\n\n    insertions_source_data as (\n\n        select *, {{ unique_key_fields(strategy.unique_key) }},\n            {{ strategy.updated_at }} as {{ columns.dbt_updated_at }},\n            {{ strategy.updated_at }} as {{ columns.dbt_valid_from }},\n            {{ get_dbt_valid_to_current(strategy, columns) }},\n            {{ strategy.scd_id }} as {{ columns.dbt_scd_id }}\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select *, {{ unique_key_fields(strategy.unique_key) }},\n            {{ strategy.updated_at }} as {{ columns.dbt_updated_at }},\n            {{ strategy.updated_at }} as {{ columns.dbt_valid_from }},\n            {{ strategy.updated_at }} as {{ columns.dbt_valid_to }}\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.invalidate_hard_deletes %}\n\n    deletes_source_data as (\n\n        select *, {{ unique_key_fields(strategy.unique_key) }}\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data\n            on {{ unique_key_join_on(strategy.unique_key, \"snapshotted_data\", \"source_data\") }}\n            where {{ unique_key_is_null(strategy.unique_key, \"snapshotted_data\") }}\n            or ({{ unique_key_is_not_null(strategy.unique_key, \"snapshotted_data\") }} and ({{ strategy.row_changed }})\n\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.{{ columns.dbt_scd_id }}\n\n        from updates_source_data as source_data\n        join snapshotted_data\n            on {{ unique_key_join_on(strategy.unique_key, \"snapshotted_data\", \"source_data\") }}\n        where (\n            {{ strategy.row_changed }}\n        )\n    )\n\n    {%- if strategy.invalidate_hard_deletes -%}\n    ,\n\n    deletes as (\n\n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as {{ columns.dbt_valid_from }},\n            {{ snapshot_get_time() }} as {{ columns.dbt_updated_at }},\n            {{ snapshot_get_time() }} as {{ columns.dbt_valid_to }},\n            snapshotted_data.{{ columns.dbt_scd_id }}\n\n        from snapshotted_data\n        left join deletes_source_data as source_data\n            on {{ unique_key_join_on(strategy.unique_key, \"snapshotted_data\", \"source_data\") }}\n            where {{ unique_key_is_null(strategy.unique_key, \"source_data\") }}\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.invalidate_hard_deletes %}\n    union all\n    select * from deletes\n    {%- endif %}\n\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.get_snapshot_table_column_names", "macro.dbt.unique_key_fields", "macro.dbt.get_dbt_valid_to_current", "macro.dbt.unique_key_join_on", "macro.dbt.unique_key_is_null", "macro.dbt.unique_key_is_not_null", "macro.dbt.snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9984393, "supported_languages": null}, "macro.dbt.build_snapshot_table": {"name": "build_snapshot_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) -%}\n  {{ adapter.dispatch('build_snapshot_table', 'dbt')(strategy, sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__build_snapshot_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9985588, "supported_languages": null}, "macro.dbt.default__build_snapshot_table": {"name": "default__build_snapshot_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.default__build_snapshot_table", "macro_sql": "{% macro default__build_snapshot_table(strategy, sql) %}\n    {% set columns = config.get('snapshot_table_column_names') or get_snapshot_table_column_names() %}\n\n    select *,\n        {{ strategy.scd_id }} as {{ columns.dbt_scd_id }},\n        {{ strategy.updated_at }} as {{ columns.dbt_updated_at }},\n        {{ strategy.updated_at }} as {{ columns.dbt_valid_from }},\n        {{ get_dbt_valid_to_current(strategy, columns) }}\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_snapshot_table_column_names", "macro.dbt.get_dbt_valid_to_current"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.998807, "supported_languages": null}, "macro.dbt.build_snapshot_staging_table": {"name": "build_snapshot_staging_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set temp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, temp_relation, select) }}\n    {% endcall %}\n\n    {% do return(temp_relation) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.make_temp_relation", "macro.dbt.snapshot_staging_table", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9990578, "supported_languages": null}, "macro.dbt.get_updated_at_column_data_type": {"name": "get_updated_at_column_data_type", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_updated_at_column_data_type", "macro_sql": "{% macro get_updated_at_column_data_type(snapshot_sql) %}\n    {% set snapshot_sql_column_schema = get_column_schema_from_query(snapshot_sql) %}\n    {% set dbt_updated_at_data_type = null %}\n    {% set ns = namespace() -%} {#-- handle for-loop scoping with a namespace --#}\n    {% set ns.dbt_updated_at_data_type = null -%}\n    {% for column in snapshot_sql_column_schema %}\n    {%   if ((column.column == 'dbt_updated_at') or (column.column == 'DBT_UPDATED_AT')) %}\n    {%     set ns.dbt_updated_at_data_type = column.dtype %}\n    {%   endif %}\n    {% endfor %}\n    {{ return(ns.dbt_updated_at_data_type or none)  }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_column_schema_from_query"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9994214, "supported_languages": null}, "macro.dbt.check_time_data_types": {"name": "check_time_data_types", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.check_time_data_types", "macro_sql": "{% macro check_time_data_types(sql) %}\n  {% set dbt_updated_at_data_type = get_updated_at_column_data_type(sql) %}\n  {% set snapshot_get_time_data_type = get_snapshot_get_time_data_type() %}\n  {% if snapshot_get_time_data_type is not none and dbt_updated_at_data_type is not none and snapshot_get_time_data_type != dbt_updated_at_data_type %}\n  {%   if exceptions.warn_snapshot_timestamp_data_types %}\n  {{     exceptions.warn_snapshot_timestamp_data_types(snapshot_get_time_data_type, dbt_updated_at_data_type) }}\n  {%   endif %}\n  {% endif %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_updated_at_column_data_type", "macro.dbt.get_snapshot_get_time_data_type"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.999685, "supported_languages": null}, "macro.dbt.get_dbt_valid_to_current": {"name": "get_dbt_valid_to_current", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.get_dbt_valid_to_current", "macro_sql": "{% macro get_dbt_valid_to_current(strategy, columns) %}\n  {% set dbt_valid_to_current = config.get('dbt_valid_to_current') or \"null\" %}\n  coalesce(nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}), {{dbt_valid_to_current}})\n  as {{ columns.dbt_valid_to }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371902.9998512, "supported_languages": null}, "macro.dbt.unique_key_fields": {"name": "unique_key_fields", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.unique_key_fields", "macro_sql": "{% macro unique_key_fields(unique_key) %}\n    {% if unique_key | is_list %}\n        {% for key in unique_key %}\n            {{ key }} as dbt_unique_key_{{ loop.index }}\n            {%- if not loop.last %} , {%- endif %}\n        {% endfor %}\n    {% else %}\n        {{ unique_key }} as dbt_unique_key\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.000062, "supported_languages": null}, "macro.dbt.unique_key_join_on": {"name": "unique_key_join_on", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.unique_key_join_on", "macro_sql": "{% macro unique_key_join_on(unique_key, identifier, from_identifier) %}\n    {% if unique_key | is_list %}\n        {% for key in unique_key %}\n            {{ identifier }}.dbt_unique_key_{{ loop.index }} = {{ from_identifier }}.dbt_unique_key_{{ loop.index }}\n            {%- if not loop.last %} and {%- endif %}\n        {% endfor %}\n    {% else %}\n        {{ identifier }}.dbt_unique_key = {{ from_identifier }}.dbt_unique_key\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.000525, "supported_languages": null}, "macro.dbt.unique_key_is_null": {"name": "unique_key_is_null", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.unique_key_is_null", "macro_sql": "{% macro unique_key_is_null(unique_key, identifier) %}\n    {% if unique_key | is_list %}\n        {{ identifier }}.dbt_unique_key_1 is null\n    {% else %}\n        {{ identifier }}.dbt_unique_key is null\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.000657, "supported_languages": null}, "macro.dbt.unique_key_is_not_null": {"name": "unique_key_is_not_null", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "unique_id": "macro.dbt.unique_key_is_not_null", "macro_sql": "{% macro unique_key_is_not_null(unique_key, identifier) %}\n    {% if unique_key | is_list %}\n        {{ identifier }}.dbt_unique_key_1 is not null\n    {% else %}\n        {{ identifier }}.dbt_unique_key is not null\n    {% endif %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.000788, "supported_languages": null}, "macro.dbt.snapshot_merge_sql": {"name": "snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "unique_id": "macro.dbt.snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql', 'dbt')(target, source, insert_cols) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt_postgres.postgres__snapshot_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0010548, "supported_languages": null}, "macro.dbt.default__snapshot_merge_sql": {"name": "default__snapshot_merge_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "unique_id": "macro.dbt.default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    {%- set columns = config.get(\"snapshot_table_column_names\") or get_snapshot_table_column_names() -%}\n\n    merge into {{ target.render() }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.{{ columns.dbt_scd_id }} = DBT_INTERNAL_DEST.{{ columns.dbt_scd_id }}\n\n    when matched\n     {% if config.get(\"dbt_valid_to_current\") %}\n       and (DBT_INTERNAL_DEST.{{ columns.dbt_valid_to }} = {{ config.get('dbt_valid_to_current') }} or\n            DBT_INTERNAL_DEST.{{ columns.dbt_valid_to }} is null)\n     {% else %}\n       and DBT_INTERNAL_DEST.{{ columns.dbt_valid_to }} is null\n     {% endif %}\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set {{ columns.dbt_valid_to }} = DBT_INTERNAL_SOURCE.{{ columns.dbt_valid_to }}\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_snapshot_table_column_names"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.001502, "supported_languages": null}, "macro.dbt.materialization_seed_default": {"name": "materialization_seed_default", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/seed.sql", "original_file_path": "macros/materializations/seeds/seed.sql", "unique_id": "macro.dbt.materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set grant_config = config.get('grants') -%}\n  {%- set agate_table = load_agate_table() -%}\n  -- grab current tables grants config for comparison later on\n\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation.render())) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ get_csv_sql(create_table_sql, sql) }};\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n\n  {% set should_revoke = should_revoke(old_relation, full_refresh_mode) %}\n  {% do apply_grants(target_relation, grant_config, should_revoke=should_revoke) %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if full_refresh_mode or not exists_as_table %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.run_hooks", "macro.dbt.reset_csv_table", "macro.dbt.create_csv_table", "macro.dbt.load_csv_rows", "macro.dbt.noop_statement", "macro.dbt.get_csv_sql", "macro.dbt.should_revoke", "macro.dbt.apply_grants", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0030124, "supported_languages": ["sql"]}, "macro.dbt.create_csv_table": {"name": "create_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0036387, "supported_languages": null}, "macro.dbt.default__create_csv_table": {"name": "default__create_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0041747, "supported_languages": null}, "macro.dbt.reset_csv_table": {"name": "reset_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table', 'dbt')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__reset_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0043197, "supported_languages": null}, "macro.dbt.default__reset_csv_table": {"name": "default__reset_csv_table", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation.render() %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0046146, "supported_languages": null}, "macro.dbt.get_csv_sql": {"name": "get_csv_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_csv_sql", "macro_sql": "{% macro get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ adapter.dispatch('get_csv_sql', 'dbt')(create_or_truncate_sql, insert_sql) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_csv_sql"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0047324, "supported_languages": null}, "macro.dbt.default__get_csv_sql": {"name": "default__get_csv_sql", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_csv_sql", "macro_sql": "{% macro default__get_csv_sql(create_or_truncate_sql, insert_sql) %}\n    {{ create_or_truncate_sql }};\n    -- dbt seed --\n    {{ insert_sql }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0048149, "supported_languages": null}, "macro.dbt.get_binding_char": {"name": "get_binding_char", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_binding_char", "macro_sql": "{% macro get_binding_char() -%}\n  {{ adapter.dispatch('get_binding_char', 'dbt')() }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0049012, "supported_languages": null}, "macro.dbt.default__get_binding_char": {"name": "default__get_binding_char", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_binding_char", "macro_sql": "{% macro default__get_binding_char() %}\n  {{ return('%s') }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0049713, "supported_languages": null}, "macro.dbt.get_batch_size": {"name": "get_batch_size", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_batch_size", "macro_sql": "{% macro get_batch_size() -%}\n  {{ return(adapter.dispatch('get_batch_size', 'dbt')()) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__get_batch_size"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0050657, "supported_languages": null}, "macro.dbt.default__get_batch_size": {"name": "default__get_batch_size", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__get_batch_size", "macro_sql": "{% macro default__get_batch_size() %}\n  {{ return(10000) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.005142, "supported_languages": null}, "macro.dbt.get_seed_column_quoted_csv": {"name": "get_seed_column_quoted_csv", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.005432, "supported_languages": null}, "macro.dbt.load_csv_rows": {"name": "load_csv_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__load_csv_rows"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.005545, "supported_languages": null}, "macro.dbt.default__load_csv_rows": {"name": "default__load_csv_rows", "resource_type": "macro", "package_name": "dbt", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "unique_id": "macro.dbt.default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% for row in chunk %}\n          {% do bindings.extend(row) %}\n      {% endfor %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for column in agate_table.column_names -%}\n                  {{ get_binding_char() }}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.006258, "supported_languages": null}, "macro.dbt.generate_database_name": {"name": "generate_database_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "unique_id": "macro.dbt.generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name', 'dbt')(custom_database_name, node)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0065, "supported_languages": null}, "macro.dbt.default__generate_database_name": {"name": "default__generate_database_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "unique_id": "macro.dbt.default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0066624, "supported_languages": null}, "macro.dbt.generate_alias_name": {"name": "generate_alias_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "unique_id": "macro.dbt.generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_alias_name', 'dbt')(custom_alias_name, node)) %}\n{%- endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_alias_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0069075, "supported_languages": null}, "macro.dbt.default__generate_alias_name": {"name": "default__generate_alias_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "unique_id": "macro.dbt.default__generate_alias_name", "macro_sql": "{% macro default__generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- elif node.version -%}\n\n        {{ return(node.name ~ \"_v\" ~ (node.version | replace(\".\", \"_\"))) }}\n\n    {%- else -%}\n\n        {{ node.name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0071473, "supported_languages": null}, "macro.dbt.generate_schema_name": {"name": "generate_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name=none, node=none) -%}\n    {{ return(adapter.dispatch('generate_schema_name', 'dbt')(custom_schema_name, node)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.default__generate_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.007447, "supported_languages": null}, "macro.dbt.default__generate_schema_name": {"name": "default__generate_schema_name", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.default__generate_schema_name", "macro_sql": "{% macro default__generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0076113, "supported_languages": null}, "macro.dbt.generate_schema_name_for_env": {"name": "generate_schema_name_for_env", "resource_type": "macro", "package_name": "dbt", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "unique_id": "macro.dbt.generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0077915, "supported_languages": null}, "macro.dbt.statement": {"name": "statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.statement", "macro_sql": "\n{%- macro statement(name=None, fetch_result=False, auto_begin=True, language='sql') -%}\n  {%- if execute: -%}\n    {%- set compiled_code = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime {} for node \"{}\"'.format(language, model['unique_id'])) }}\n      {{ write(compiled_code) }}\n    {%- endif -%}\n    {%- if language == 'sql'-%}\n      {%- set res, table = adapter.execute(compiled_code, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- elif language == 'python' -%}\n      {%- set res = submit_python_job(model, compiled_code) -%}\n      {#-- TODO: What should table be for python models? --#}\n      {%- set table = None -%}\n    {%- else -%}\n      {% do exceptions.raise_compiler_error(\"statement macro didn't get supported language\") %}\n    {%- endif -%}\n\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.008687, "supported_languages": null}, "macro.dbt.noop_statement": {"name": "noop_statement", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0090396, "supported_languages": null}, "macro.dbt.run_query": {"name": "run_query", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "unique_id": "macro.dbt.run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0092242, "supported_languages": null}, "macro.dbt.convert_datetime": {"name": "convert_datetime", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.009712, "supported_languages": null}, "macro.dbt.dates_in_range": {"name": "dates_in_range", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partition start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.convert_datetime"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0104318, "supported_languages": null}, "macro.dbt.partition_range": {"name": "partition_range", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "depends_on": {"macros": ["macro.dbt.dates_in_range"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0108824, "supported_languages": null}, "macro.dbt.py_current_timestring": {"name": "py_current_timestring", "resource_type": "macro", "package_name": "dbt", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "unique_id": "macro.dbt.py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0110261, "supported_languages": null}, "macro.dbt.test_unique": {"name": "test_unique", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_unique", "macro_sql": "{% test unique(model, column_name) %}\n    {% set macro = adapter.dispatch('test_unique', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_unique"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0113215, "supported_languages": null}, "macro.dbt.test_not_null": {"name": "test_not_null", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_not_null", "macro_sql": "{% test not_null(model, column_name) %}\n    {% set macro = adapter.dispatch('test_not_null', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.011483, "supported_languages": null}, "macro.dbt.test_accepted_values": {"name": "test_accepted_values", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_accepted_values", "macro_sql": "{% test accepted_values(model, column_name, values, quote=True) %}\n    {% set macro = adapter.dispatch('test_accepted_values', 'dbt') %}\n    {{ macro(model, column_name, values, quote) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0116694, "supported_languages": null}, "macro.dbt.test_relationships": {"name": "test_relationships", "resource_type": "macro", "package_name": "dbt", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "unique_id": "macro.dbt.test_relationships", "macro_sql": "{% test relationships(model, column_name, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships', 'dbt') %}\n    {{ macro(model, column_name, to, field) }}\n{% endtest %}", "depends_on": {"macros": ["macro.dbt.default__test_relationships"]}, "description": "", "meta": {}, "docs": {"show": true, "node_color": null}, "patch_path": null, "arguments": [], "created_at": 1764371903.0118535, "supported_languages": null}}, "docs": {"doc.dbt.__overview__": {"name": "__overview__", "resource_type": "doc", "package_name": "dbt", "path": "overview.md", "original_file_path": "docs/overview.md", "unique_id": "doc.dbt.__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}, "exposures": {}, "metrics": {}, "groups": {}, "selectors": {}, "disabled": {}, "parent_map": {"model.DbtEducationalDataProject.stg_courses": ["source.DbtEducationalDataProject.raw_edu.courses"], "model.DbtEducationalDataProject.stg_departments": ["source.DbtEducationalDataProject.raw_edu.departments"], "model.DbtEducationalDataProject.stg_financial_aid": ["source.DbtEducationalDataProject.raw_edu.financial_aid"], "model.DbtEducationalDataProject.stg_tuition_payments": ["source.DbtEducationalDataProject.raw_edu.tuition_payments"], "model.DbtEducationalDataProject.stg_class_sessions": ["source.DbtEducationalDataProject.raw_edu.class_sessions"], "model.DbtEducationalDataProject.stg_assignments": ["source.DbtEducationalDataProject.raw_edu.assignments"], "model.DbtEducationalDataProject.stg_enrollments": ["source.DbtEducationalDataProject.raw_edu.enrollments"], "model.DbtEducationalDataProject.stg_assignment_submissions": ["source.DbtEducationalDataProject.raw_edu.assignment_submissions"], "model.DbtEducationalDataProject.stg_faculty": ["source.DbtEducationalDataProject.raw_edu.faculty"], "model.DbtEducationalDataProject.stg_semesters": ["source.DbtEducationalDataProject.raw_edu.semesters"], "model.DbtEducationalDataProject.department_efficiency_report": ["model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_department_analytics"], "model.DbtEducationalDataProject.course_catalog_enhanced": ["model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments"], "model.DbtEducationalDataProject.student_academic_summary": ["model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.faculty_performance_dashboard": ["model.DbtEducationalDataProject.int_department_analytics", "model.DbtEducationalDataProject.int_faculty_teaching_load"], "model.DbtEducationalDataProject.course_difficulty_calibration": ["model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments"], "model.DbtEducationalDataProject.course_success_predictors": ["model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.assignment_workload_analysis": ["model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_semesters"], "model.DbtEducationalDataProject.student_retention_analysis": ["model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.student_financial_profile": ["model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_tuition_payments"], "model.DbtEducationalDataProject.financial_aid_impact_analysis": ["model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.institutional_revenue_optimization": ["model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_tuition_payments"], "model.DbtEducationalDataProject.tuition_revenue_analysis": ["model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_tuition_payments"], "model.DbtEducationalDataProject.int_faculty_teaching_load": ["model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_semesters"], "model.DbtEducationalDataProject.int_course_prerequisite_chains": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments"], "model.DbtEducationalDataProject.int_department_analytics": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.int_student_at_risk_indicators": ["model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.student_financial_profile"], "model.DbtEducationalDataProject.int_assignment_performance": ["model.DbtEducationalDataProject.stg_assignment_submissions", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.int_student_enrollment_history": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.int_course_performance_metrics": ["model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_semesters"], "test.DbtEducationalDataProject.test_data_quality_checks": ["model.DbtEducationalDataProject.stg_students"], "test.DbtEducationalDataProject.test_financial_consistency": ["model.DbtEducationalDataProject.stg_financial_aid"], "test.DbtEducationalDataProject.test_enrollment_integrity": ["model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_semesters"], "seed.DbtEducationalDataProject.grade_scale_reference": [], "seed.DbtEducationalDataProject.academic_calendar_holidays": [], "seed.DbtEducationalDataProject.semester_calendar": [], "operation.DbtEducationalDataProject.DbtEducationalDataProject-on-run-start-0": [], "test.DbtEducationalDataProject.source_unique_raw_edu_students_student_id.273b9e80b8": ["source.DbtEducationalDataProject.raw_edu.students"], "test.DbtEducationalDataProject.source_not_null_raw_edu_students_student_id.68c346ddce": ["source.DbtEducationalDataProject.raw_edu.students"], "test.DbtEducationalDataProject.source_unique_raw_edu_students_email.8e5aa3c149": ["source.DbtEducationalDataProject.raw_edu.students"], "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_id.49ad13d893": ["source.DbtEducationalDataProject.raw_edu.courses"], "test.DbtEducationalDataProject.source_not_null_raw_edu_courses_course_id.5edcac83bf": ["source.DbtEducationalDataProject.raw_edu.courses"], "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_code.f3f1b74b67": ["source.DbtEducationalDataProject.raw_edu.courses"], "test.DbtEducationalDataProject.source_unique_raw_edu_departments_department_id.914559752d": ["source.DbtEducationalDataProject.raw_edu.departments"], "test.DbtEducationalDataProject.source_not_null_raw_edu_departments_department_id.8898c54eb5": ["source.DbtEducationalDataProject.raw_edu.departments"], "test.DbtEducationalDataProject.source_unique_raw_edu_faculty_faculty_id.21f766bfcb": ["source.DbtEducationalDataProject.raw_edu.faculty"], "test.DbtEducationalDataProject.source_not_null_raw_edu_faculty_faculty_id.5f1ce05a5f": ["source.DbtEducationalDataProject.raw_edu.faculty"], "test.DbtEducationalDataProject.source_unique_raw_edu_enrollments_enrollment_id.4ac0dbbc65": ["source.DbtEducationalDataProject.raw_edu.enrollments"], "test.DbtEducationalDataProject.source_not_null_raw_edu_enrollments_enrollment_id.e39474af5f": ["source.DbtEducationalDataProject.raw_edu.enrollments"], "test.DbtEducationalDataProject.source_unique_raw_edu_semesters_semester_id.075a1856be": ["source.DbtEducationalDataProject.raw_edu.semesters"], "test.DbtEducationalDataProject.source_not_null_raw_edu_semesters_semester_id.b32a2d2cfd": ["source.DbtEducationalDataProject.raw_edu.semesters"], "model.DbtEducationalDataProject.stg_students": ["source.DbtEducationalDataProject.raw_edu.students"], "model.DbtEducationalDataProject.semester_enrollment_trends": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.int_faculty_student_interactions": ["model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.institutional_effectiveness_dashboard": ["model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_tuition_payments"], "model.DbtEducationalDataProject.int_resource_utilization_analysis": ["model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_tuition_payments"], "model.DbtEducationalDataProject.int_grade_inflation_analysis": ["model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_semesters"], "model.DbtEducationalDataProject.academic_early_warning_system": ["model.DbtEducationalDataProject.stg_assignment_submissions", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.student_financial_profile"], "model.DbtEducationalDataProject.int_curriculum_flow_analysis": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.int_student_success_predictors": ["model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.student_financial_profile"], "model.DbtEducationalDataProject.graduation_pathway_analysis": ["model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.learning_outcome_assessment": ["model.DbtEducationalDataProject.course_success_predictors", "model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_students"], "model.DbtEducationalDataProject.budget_allocation_optimization": ["model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_tuition_payments"], "model.DbtEducationalDataProject.competitive_program_benchmarking": ["model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_tuition_payments"], "model.DbtEducationalDataProject.institutional_kpi_dashboard": ["model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.stg_assignments", "model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_financial_aid", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students", "model.DbtEducationalDataProject.stg_tuition_payments"], "model.DbtEducationalDataProject.instructor_effectiveness_scorecard": ["model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_faculty_teaching_load"], "model.DbtEducationalDataProject.int_academic_collaboration_networks": ["model.DbtEducationalDataProject.stg_class_sessions", "model.DbtEducationalDataProject.stg_courses", "model.DbtEducationalDataProject.stg_departments", "model.DbtEducationalDataProject.stg_enrollments", "model.DbtEducationalDataProject.stg_faculty", "model.DbtEducationalDataProject.stg_semesters", "model.DbtEducationalDataProject.stg_students"], "source.DbtEducationalDataProject.raw_edu.students": [], "source.DbtEducationalDataProject.raw_edu.courses": [], "source.DbtEducationalDataProject.raw_edu.departments": [], "source.DbtEducationalDataProject.raw_edu.faculty": [], "source.DbtEducationalDataProject.raw_edu.enrollments": [], "source.DbtEducationalDataProject.raw_edu.semesters": [], "source.DbtEducationalDataProject.raw_edu.class_sessions": [], "source.DbtEducationalDataProject.raw_edu.assignments": [], "source.DbtEducationalDataProject.raw_edu.assignment_submissions": [], "source.DbtEducationalDataProject.raw_edu.financial_aid": [], "source.DbtEducationalDataProject.raw_edu.tuition_payments": []}, "child_map": {"model.DbtEducationalDataProject.stg_courses": ["model.DbtEducationalDataProject.academic_early_warning_system", "model.DbtEducationalDataProject.assignment_workload_analysis", "model.DbtEducationalDataProject.budget_allocation_optimization", "model.DbtEducationalDataProject.competitive_program_benchmarking", "model.DbtEducationalDataProject.course_catalog_enhanced", "model.DbtEducationalDataProject.course_difficulty_calibration", "model.DbtEducationalDataProject.course_success_predictors", "model.DbtEducationalDataProject.graduation_pathway_analysis", "model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.institutional_revenue_optimization", "model.DbtEducationalDataProject.int_academic_collaboration_networks", "model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_course_prerequisite_chains", "model.DbtEducationalDataProject.int_curriculum_flow_analysis", "model.DbtEducationalDataProject.int_department_analytics", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_faculty_teaching_load", "model.DbtEducationalDataProject.int_grade_inflation_analysis", "model.DbtEducationalDataProject.int_resource_utilization_analysis", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.int_student_success_predictors", "model.DbtEducationalDataProject.learning_outcome_assessment", "model.DbtEducationalDataProject.semester_enrollment_trends"], "model.DbtEducationalDataProject.stg_departments": ["model.DbtEducationalDataProject.academic_early_warning_system", "model.DbtEducationalDataProject.assignment_workload_analysis", "model.DbtEducationalDataProject.budget_allocation_optimization", "model.DbtEducationalDataProject.competitive_program_benchmarking", "model.DbtEducationalDataProject.course_catalog_enhanced", "model.DbtEducationalDataProject.course_difficulty_calibration", "model.DbtEducationalDataProject.course_success_predictors", "model.DbtEducationalDataProject.financial_aid_impact_analysis", "model.DbtEducationalDataProject.graduation_pathway_analysis", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.institutional_revenue_optimization", "model.DbtEducationalDataProject.int_academic_collaboration_networks", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_course_prerequisite_chains", "model.DbtEducationalDataProject.int_department_analytics", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_faculty_teaching_load", "model.DbtEducationalDataProject.int_grade_inflation_analysis", "model.DbtEducationalDataProject.int_resource_utilization_analysis", "model.DbtEducationalDataProject.int_student_at_risk_indicators", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.int_student_success_predictors", "model.DbtEducationalDataProject.learning_outcome_assessment", "model.DbtEducationalDataProject.semester_enrollment_trends", "model.DbtEducationalDataProject.student_academic_summary", "model.DbtEducationalDataProject.student_financial_profile", "model.DbtEducationalDataProject.student_retention_analysis", "model.DbtEducationalDataProject.tuition_revenue_analysis"], "model.DbtEducationalDataProject.stg_financial_aid": ["model.DbtEducationalDataProject.budget_allocation_optimization", "model.DbtEducationalDataProject.competitive_program_benchmarking", "model.DbtEducationalDataProject.financial_aid_impact_analysis", "model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.institutional_revenue_optimization", "model.DbtEducationalDataProject.int_resource_utilization_analysis", "model.DbtEducationalDataProject.student_financial_profile", "test.DbtEducationalDataProject.test_financial_consistency"], "model.DbtEducationalDataProject.stg_tuition_payments": ["model.DbtEducationalDataProject.budget_allocation_optimization", "model.DbtEducationalDataProject.competitive_program_benchmarking", "model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.institutional_revenue_optimization", "model.DbtEducationalDataProject.int_resource_utilization_analysis", "model.DbtEducationalDataProject.student_financial_profile", "model.DbtEducationalDataProject.tuition_revenue_analysis"], "model.DbtEducationalDataProject.stg_class_sessions": ["model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.institutional_revenue_optimization", "model.DbtEducationalDataProject.int_academic_collaboration_networks", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_faculty_teaching_load", "model.DbtEducationalDataProject.int_grade_inflation_analysis", "model.DbtEducationalDataProject.int_resource_utilization_analysis"], "model.DbtEducationalDataProject.stg_assignments": ["model.DbtEducationalDataProject.academic_early_warning_system", "model.DbtEducationalDataProject.assignment_workload_analysis", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.int_resource_utilization_analysis"], "model.DbtEducationalDataProject.stg_enrollments": ["model.DbtEducationalDataProject.academic_early_warning_system", "model.DbtEducationalDataProject.budget_allocation_optimization", "model.DbtEducationalDataProject.competitive_program_benchmarking", "model.DbtEducationalDataProject.course_success_predictors", "model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.institutional_revenue_optimization", "model.DbtEducationalDataProject.int_academic_collaboration_networks", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_curriculum_flow_analysis", "model.DbtEducationalDataProject.int_department_analytics", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_faculty_teaching_load", "model.DbtEducationalDataProject.int_grade_inflation_analysis", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.int_student_success_predictors", "model.DbtEducationalDataProject.learning_outcome_assessment", "model.DbtEducationalDataProject.semester_enrollment_trends", "test.DbtEducationalDataProject.test_enrollment_integrity"], "model.DbtEducationalDataProject.stg_assignment_submissions": ["model.DbtEducationalDataProject.academic_early_warning_system", "model.DbtEducationalDataProject.int_assignment_performance"], "model.DbtEducationalDataProject.stg_faculty": ["model.DbtEducationalDataProject.budget_allocation_optimization", "model.DbtEducationalDataProject.competitive_program_benchmarking", "model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.institutional_revenue_optimization", "model.DbtEducationalDataProject.int_academic_collaboration_networks", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_department_analytics", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_faculty_teaching_load", "model.DbtEducationalDataProject.int_grade_inflation_analysis", "model.DbtEducationalDataProject.int_resource_utilization_analysis"], "model.DbtEducationalDataProject.stg_semesters": ["model.DbtEducationalDataProject.academic_early_warning_system", "model.DbtEducationalDataProject.assignment_workload_analysis", "model.DbtEducationalDataProject.course_success_predictors", "model.DbtEducationalDataProject.graduation_pathway_analysis", "model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.institutional_revenue_optimization", "model.DbtEducationalDataProject.int_academic_collaboration_networks", "model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.int_course_performance_metrics", "model.DbtEducationalDataProject.int_curriculum_flow_analysis", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_faculty_teaching_load", "model.DbtEducationalDataProject.int_grade_inflation_analysis", "model.DbtEducationalDataProject.int_resource_utilization_analysis", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.int_student_success_predictors", "model.DbtEducationalDataProject.semester_enrollment_trends", "model.DbtEducationalDataProject.student_financial_profile", "model.DbtEducationalDataProject.tuition_revenue_analysis", "test.DbtEducationalDataProject.test_enrollment_integrity"], "model.DbtEducationalDataProject.department_efficiency_report": [], "model.DbtEducationalDataProject.course_catalog_enhanced": [], "model.DbtEducationalDataProject.student_academic_summary": [], "model.DbtEducationalDataProject.faculty_performance_dashboard": [], "model.DbtEducationalDataProject.course_difficulty_calibration": [], "model.DbtEducationalDataProject.course_success_predictors": ["model.DbtEducationalDataProject.learning_outcome_assessment"], "model.DbtEducationalDataProject.assignment_workload_analysis": [], "model.DbtEducationalDataProject.student_retention_analysis": [], "model.DbtEducationalDataProject.student_financial_profile": ["model.DbtEducationalDataProject.academic_early_warning_system", "model.DbtEducationalDataProject.int_student_at_risk_indicators", "model.DbtEducationalDataProject.int_student_success_predictors"], "model.DbtEducationalDataProject.financial_aid_impact_analysis": [], "model.DbtEducationalDataProject.institutional_revenue_optimization": [], "model.DbtEducationalDataProject.tuition_revenue_analysis": [], "model.DbtEducationalDataProject.int_faculty_teaching_load": ["model.DbtEducationalDataProject.faculty_performance_dashboard", "model.DbtEducationalDataProject.instructor_effectiveness_scorecard"], "model.DbtEducationalDataProject.int_course_prerequisite_chains": [], "model.DbtEducationalDataProject.int_department_analytics": ["model.DbtEducationalDataProject.department_efficiency_report", "model.DbtEducationalDataProject.faculty_performance_dashboard"], "model.DbtEducationalDataProject.int_student_at_risk_indicators": [], "model.DbtEducationalDataProject.int_assignment_performance": ["model.DbtEducationalDataProject.assignment_workload_analysis", "model.DbtEducationalDataProject.course_difficulty_calibration", "model.DbtEducationalDataProject.course_success_predictors", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.instructor_effectiveness_scorecard", "model.DbtEducationalDataProject.int_resource_utilization_analysis", "model.DbtEducationalDataProject.learning_outcome_assessment"], "model.DbtEducationalDataProject.int_student_enrollment_history": ["model.DbtEducationalDataProject.financial_aid_impact_analysis", "model.DbtEducationalDataProject.graduation_pathway_analysis", "model.DbtEducationalDataProject.int_student_at_risk_indicators", "model.DbtEducationalDataProject.int_student_success_predictors", "model.DbtEducationalDataProject.learning_outcome_assessment", "model.DbtEducationalDataProject.student_academic_summary", "model.DbtEducationalDataProject.student_retention_analysis"], "model.DbtEducationalDataProject.int_course_performance_metrics": ["model.DbtEducationalDataProject.competitive_program_benchmarking", "model.DbtEducationalDataProject.course_catalog_enhanced", "model.DbtEducationalDataProject.course_difficulty_calibration", "model.DbtEducationalDataProject.department_efficiency_report", "model.DbtEducationalDataProject.learning_outcome_assessment"], "test.DbtEducationalDataProject.test_data_quality_checks": [], "test.DbtEducationalDataProject.test_financial_consistency": [], "test.DbtEducationalDataProject.test_enrollment_integrity": [], "seed.DbtEducationalDataProject.grade_scale_reference": [], "seed.DbtEducationalDataProject.academic_calendar_holidays": [], "seed.DbtEducationalDataProject.semester_calendar": [], "operation.DbtEducationalDataProject.DbtEducationalDataProject-on-run-start-0": [], "test.DbtEducationalDataProject.source_unique_raw_edu_students_student_id.273b9e80b8": [], "test.DbtEducationalDataProject.source_not_null_raw_edu_students_student_id.68c346ddce": [], "test.DbtEducationalDataProject.source_unique_raw_edu_students_email.8e5aa3c149": [], "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_id.49ad13d893": [], "test.DbtEducationalDataProject.source_not_null_raw_edu_courses_course_id.5edcac83bf": [], "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_code.f3f1b74b67": [], "test.DbtEducationalDataProject.source_unique_raw_edu_departments_department_id.914559752d": [], "test.DbtEducationalDataProject.source_not_null_raw_edu_departments_department_id.8898c54eb5": [], "test.DbtEducationalDataProject.source_unique_raw_edu_faculty_faculty_id.21f766bfcb": [], "test.DbtEducationalDataProject.source_not_null_raw_edu_faculty_faculty_id.5f1ce05a5f": [], "test.DbtEducationalDataProject.source_unique_raw_edu_enrollments_enrollment_id.4ac0dbbc65": [], "test.DbtEducationalDataProject.source_not_null_raw_edu_enrollments_enrollment_id.e39474af5f": [], "test.DbtEducationalDataProject.source_unique_raw_edu_semesters_semester_id.075a1856be": [], "test.DbtEducationalDataProject.source_not_null_raw_edu_semesters_semester_id.b32a2d2cfd": [], "model.DbtEducationalDataProject.stg_students": ["model.DbtEducationalDataProject.academic_early_warning_system", "model.DbtEducationalDataProject.budget_allocation_optimization", "model.DbtEducationalDataProject.competitive_program_benchmarking", "model.DbtEducationalDataProject.course_success_predictors", "model.DbtEducationalDataProject.financial_aid_impact_analysis", "model.DbtEducationalDataProject.graduation_pathway_analysis", "model.DbtEducationalDataProject.institutional_effectiveness_dashboard", "model.DbtEducationalDataProject.institutional_kpi_dashboard", "model.DbtEducationalDataProject.int_academic_collaboration_networks", "model.DbtEducationalDataProject.int_assignment_performance", "model.DbtEducationalDataProject.int_curriculum_flow_analysis", "model.DbtEducationalDataProject.int_department_analytics", "model.DbtEducationalDataProject.int_faculty_student_interactions", "model.DbtEducationalDataProject.int_resource_utilization_analysis", "model.DbtEducationalDataProject.int_student_at_risk_indicators", "model.DbtEducationalDataProject.int_student_enrollment_history", "model.DbtEducationalDataProject.int_student_success_predictors", "model.DbtEducationalDataProject.learning_outcome_assessment", "model.DbtEducationalDataProject.semester_enrollment_trends", "model.DbtEducationalDataProject.student_academic_summary", "model.DbtEducationalDataProject.student_financial_profile", "model.DbtEducationalDataProject.student_retention_analysis", "model.DbtEducationalDataProject.tuition_revenue_analysis", "test.DbtEducationalDataProject.test_data_quality_checks"], "model.DbtEducationalDataProject.semester_enrollment_trends": [], "model.DbtEducationalDataProject.int_faculty_student_interactions": ["model.DbtEducationalDataProject.instructor_effectiveness_scorecard"], "model.DbtEducationalDataProject.institutional_effectiveness_dashboard": [], "model.DbtEducationalDataProject.int_resource_utilization_analysis": [], "model.DbtEducationalDataProject.int_grade_inflation_analysis": [], "model.DbtEducationalDataProject.academic_early_warning_system": [], "model.DbtEducationalDataProject.int_curriculum_flow_analysis": [], "model.DbtEducationalDataProject.int_student_success_predictors": [], "model.DbtEducationalDataProject.graduation_pathway_analysis": [], "model.DbtEducationalDataProject.learning_outcome_assessment": [], "model.DbtEducationalDataProject.budget_allocation_optimization": [], "model.DbtEducationalDataProject.competitive_program_benchmarking": [], "model.DbtEducationalDataProject.institutional_kpi_dashboard": [], "model.DbtEducationalDataProject.instructor_effectiveness_scorecard": [], "model.DbtEducationalDataProject.int_academic_collaboration_networks": [], "source.DbtEducationalDataProject.raw_edu.students": ["model.DbtEducationalDataProject.stg_students", "test.DbtEducationalDataProject.source_not_null_raw_edu_students_student_id.68c346ddce", "test.DbtEducationalDataProject.source_unique_raw_edu_students_email.8e5aa3c149", "test.DbtEducationalDataProject.source_unique_raw_edu_students_student_id.273b9e80b8"], "source.DbtEducationalDataProject.raw_edu.courses": ["model.DbtEducationalDataProject.stg_courses", "test.DbtEducationalDataProject.source_not_null_raw_edu_courses_course_id.5edcac83bf", "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_code.f3f1b74b67", "test.DbtEducationalDataProject.source_unique_raw_edu_courses_course_id.49ad13d893"], "source.DbtEducationalDataProject.raw_edu.departments": ["model.DbtEducationalDataProject.stg_departments", "test.DbtEducationalDataProject.source_not_null_raw_edu_departments_department_id.8898c54eb5", "test.DbtEducationalDataProject.source_unique_raw_edu_departments_department_id.914559752d"], "source.DbtEducationalDataProject.raw_edu.faculty": ["model.DbtEducationalDataProject.stg_faculty", "test.DbtEducationalDataProject.source_not_null_raw_edu_faculty_faculty_id.5f1ce05a5f", "test.DbtEducationalDataProject.source_unique_raw_edu_faculty_faculty_id.21f766bfcb"], "source.DbtEducationalDataProject.raw_edu.enrollments": ["model.DbtEducationalDataProject.stg_enrollments", "test.DbtEducationalDataProject.source_not_null_raw_edu_enrollments_enrollment_id.e39474af5f", "test.DbtEducationalDataProject.source_unique_raw_edu_enrollments_enrollment_id.4ac0dbbc65"], "source.DbtEducationalDataProject.raw_edu.semesters": ["model.DbtEducationalDataProject.stg_semesters", "test.DbtEducationalDataProject.source_not_null_raw_edu_semesters_semester_id.b32a2d2cfd", "test.DbtEducationalDataProject.source_unique_raw_edu_semesters_semester_id.075a1856be"], "source.DbtEducationalDataProject.raw_edu.class_sessions": ["model.DbtEducationalDataProject.stg_class_sessions"], "source.DbtEducationalDataProject.raw_edu.assignments": ["model.DbtEducationalDataProject.stg_assignments"], "source.DbtEducationalDataProject.raw_edu.assignment_submissions": ["model.DbtEducationalDataProject.stg_assignment_submissions"], "source.DbtEducationalDataProject.raw_edu.financial_aid": ["model.DbtEducationalDataProject.stg_financial_aid"], "source.DbtEducationalDataProject.raw_edu.tuition_payments": ["model.DbtEducationalDataProject.stg_tuition_payments"]}, "group_map": {}, "saved_queries": {}, "semantic_models": {}, "unit_tests": {}}